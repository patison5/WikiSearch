<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>VSTO и CAB: Интеграция .NET приложения в Microsoft Word / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.0f7bdd8f.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.670ab961.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.01bb2993.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.76acc47b.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-f458c7c4.e48e8f79.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-f458c7c4.6e221df6.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.0f7bdd8f.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.01bb2993.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-f458c7c4.e48e8f79.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.4f7c12b4e1b1b4c0e44ef6f9f33b1f9f.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/54880\/"},"headline":"VSTO и CAB: Интеграция .NET приложения в Microsoft Word","datePublished":"2009-03-19T03:53:59+03:00","dateModified":"2011-11-26T13:29:35+04:00","author":{"@type":"Person","name":"acerv"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"VSTO расшифровывается как Visual Studio Tools for Office. Эти средства позволяют довольно легко скрещивать ужа с ежом &mdash; писать .NET приложения, исполняемые CLR в...","url":"https:\/\/habr.com\/ru\/post\/54880\/#post-content-body","about":["h_net","f_develop"],"image":["http:\/\/img7.imageshack.us\/img7\/6816\/addin1.png","http:\/\/img528.imageshack.us\/img528\/5795\/addin2.png","http:\/\/img528.imageshack.us\/img528\/7209\/addin3.jpg"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.47.1">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="VSTO и CAB: Интеграция .NET приложения в Microsoft Word" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="VSTO и CAB: Интеграция .NET приложения в Microsoft Word" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="VSTO и CAB: Интеграция .NET приложения в Microsoft Word" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="VSTO расшифровывается как Visual Studio Tools for Office. Эти средства позволяют довольно легко скрещивать ужа с ежом — писать .NET приложения, исполняемые CLR в среде Microsoft Office. В частности,..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="VSTO расшифровывается как Visual Studio Tools for Office. Эти средства позволяют довольно легко скрещивать ужа с ежом — писать .NET приложения, исполняемые CLR в среде Microsoft Office. В частности,..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="VSTO расшифровывается как Visual Studio Tools for Office. Эти средства позволяют довольно легко скрещивать ужа с ежом — писать .NET приложения, исполняемые CLR в среде Microsoft Office. В частности,..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="VSTO расшифровывается как Visual Studio Tools for Office. Эти средства позволяют довольно легко скрещивать ужа с ежом — писать .NET приложения, исполняемые CLR в среде Microsoft Office. В частности,..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="VSTO расшифровывается как Visual Studio Tools for Office. Эти средства позволяют довольно легко скрещивать ужа с ежом — писать .NET приложения, исполняемые CLR в среде Microsoft Office. В частности,..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/54880/8960e82cb2d61db852eea75d0746d07d/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/54880/8960e82cb2d61db852eea75d0746d07d/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/54880/8960e82cb2d61db852eea75d0746d07d/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/54880/8960e82cb2d61db852eea75d0746d07d/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/54880/8960e82cb2d61db852eea75d0746d07d/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="54880" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2009-03-19T00:53:59.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/54880/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/54880/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/54880/8960e82cb2d61db852eea75d0746d07d/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.cee85629.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
              Как стать автором
            </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.cee85629.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.cee85629.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.cee85629.svg#pull-arrow"></use></svg></div></div> <!----> <div class="tm-page-article__body"><article class="tm-page-article__content tm-page-article__content_inner"><div class="tm-page-article__head-wrapper"><!----> <div class="tm-article-snippet tm-page-article__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/acerv/" title="acerv" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_pink"><!----> <use xlink:href="/img/megazord-v24.cee85629.svg#placeholder-user"></use></svg></div></a> <span class="tm-user-info__user"><a href="/ru/users/acerv/" class="tm-user-info__username">
      acerv
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2009-03-19T00:53:59.000Z" title="2009-03-19, 03:53">19  марта  2009 в 03:53</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>VSTO и CAB: Интеграция .NET приложения в Microsoft Word</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/net/" class="tm-article-snippet__hubs-item-link"><span>.NET</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <!----> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml">VSTO расшифровывается как Visual Studio Tools for Office. Эти средства позволяют довольно легко скрещивать ужа с ежом — писать .NET приложения, исполняемые CLR в среде Microsoft Office. В частности, программисты обладают возможностью создавать подключаемые модули (плагины) и «кастомизированные» шаблоны для документов почти ко всему основному семейству продуктов Microsoft Office.<br/>
<br/>
В статье приведена инфраструктура Windows Forms проекта, в котором Microsoft Word воспринимается приложением в качестве шелла. В статье раскрыты несколько интересных моментов использования Composite UI Application Block, в частности подключение инфраструктуры доменной модели Word в сервисам расширения каркаса, а так же приведены некоторые факты и особенности разработки с использованием средств VSTO.<br/>
<a name="habracut"></a><br/>
<h4>Задача</h4><br/>
Предположим, у нас есть несколько десятков людей, которые пишут документы и постоянно работают с их редакциями. Sharepoint и другие порталы по каким-то причинам не подходят, поэтому требуется реализация собственной бизнес-логики. Усложним задачу — люди работают в области, очень далекой от компьютерной тематики и хорошо знают только пакет Microsoft Office. Еще усложним — контора бедная, Microsoft Office у большинства народа версии 2003-ей. Кое где, у больших начальников и Главного босса стоит 2007ой. Парк машин разнородный — начиная от 2000-ой винды и до Windows Vista.<br/>
<br/>
<h4>Решение</h4>Одним из решений является плагин для Microsoft Office. Его можно написать на COM-е, через голый Office Interop, или же через такой же интероп, но по хитрому обернутый в средства VSTO. Эти средства и задействуем. Пользователь будет запускать Word, среда исполнения VSTO будет подцеплять сборки .NET и каким-то образом дополнять элементы управления Microsoft Word, позволяя пользователю выполнить нужную в задаче бизнес-логику.<br/>
<br/>
<h4>А к чему все это?</h4>(Это кому не терпиться узнать, чем все закончится). На выходе я выложу Visual Studio solution, который позволит в полпинка создать свое приложение, подключаемое в Microsoft Word. По ходу дела я объясню практически все, что и как в этом солюшене используется.<br/>
<br/>
<h4>Что потребуется для работы</h4><ol>
<li>Microsoft Word 2003 SP3</li>
<li><a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=5E86CAB3-6FD6-4955-B979-E1676DB6B3CB&amp;displaylang=en">VSTO 2005 SE </a></li>
<li><a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=8315654B-A5AE-4108-B7FC-186402563F2B&amp;displaylang=en">VSTO 2005 SE Runtime</a></li>
<li><a href="http://www.microsoft.com/Downloads/details.aspx?familyid=7b9ba1a7-dd6d-4144-8ac6-df88223aee19&amp;displaylang=en">CAB</a></li>
<li>Visual Studio 2005 или 2008</li>
</ol><h4>Зачем CAB?</h4>Для того, чтобы определить явное разделение функционала, связанного с Microsoft Word от простой Windows Forms логики. Проще говоря, наш плагин будет являться модулем CAB, и при желании, мы легко сможем подключить эту логику в другие приложения CAB. Еще проще говоря, использование CAB минимизирует количество glue-кода. <br/>
<br/>
Есть еще две причины, по которым я включил CAB в решение. Первая состоит в том, что я уже давал описание этого каркаса <a href="http://habrahabr.ru/blogs/net/50322/">здесь</a>, а теперь хочу привести полноценный работающий пример. Вторая причина более банальная — мне нравится CAB, он делает мир и вещи в нем проще:)<br/>
<br/>
<h4>Подробнее про VSTO</h4>Вообще говоря, VSTO не только плагины для Word-а умеет создавать. Это мощная система, сейчас она уже есть в третьей версии. VSTO — это врата для разработчика в мир автоматизации и программирования Office-based решений. В двух словах — разработчик .NET получает доступ к доменной модели приложения Office и делает с ней что хочет.<br/>
<br/>
Все эти решения можно разделить на два типа:<ol>
<li>Уровень документа (Document Level Customization)</li>
<li>Уровень приложения (Application Level Customization)</li>
</ol><br/>
Это независимые уровни. На первом создаются шаблоны документов для приложений Microsoft Office. Можно взять шаблон Excel, разнообразить его разными пользовательскими элементами управлениями (кнопками, гридами), и добавить всякую логику — например, чтобы по событию нажатия кнопки собранные пользователем данные отправлялись через веб-сервис на какой-то сервер и обрабатывались там. На этом уровне разработчику доступен Action Pane (в 2003-ей версии), куда можно подключать свои элементы управления, плюс еще очень много всего в 2007-ой версии. <br/>
<br/>
Application Level Customization означает то, что в среду приложения Microsoft Office подключается модуль расширения (т.н. add-in). Собственно, про него я изначально и начал говорить. Этот модуль расширения является локомотивом бизнес-приложения и позволяет подключать в Microsoft Office все возможности платформы .NET. Я буду показывать именно решение второго уровня.<br/>
<br/>
Если кто заинтересовался возможностями VSTO — очень много про них есть в <a href="http://msdn.microsoft.com/en-us/library/bf68wbkb(VS.80).aspx">msdn</a>.<br/>
<br/>
<h4>Псевдозадача</h4>Создадим маленький пример, иллюстрирующий все вышесказанное. Пусть есть требование, согласно которому пользователь может выделять текст из документа Microsoft Word и получать этот выделенный текст в окошке пользовательского элемента (знаю, дурацкий пример, но более сложного делать не хочется, а менее сложный уже трудно придумать). <br/>
<br/>
Более подробно. Пользователь запускает Microsoft Word. После запуска среди тулбаров пользователю будет доступен ТР — тулбар расширения (т.е., нашего расширения). На нем находится кнопка, по нажатию которой пользователю показывется окно с кнопкой «Получить текст» и элементом управления multiline textbox. Пользователь нажимает на кнопку «Получить текст», выделенный в документе текст копируется в textbox. Все счастливы.<br/>
<br/>
Понятно, что для жизни пример малопригоден. Но создаваемая инфраструктура позволит довольно просто нарастить на него «мускулы», если это, конечно, кому-то потребуется.<br/>
<br/>
<h4>Создание solution</h4>После установки VSTO в студии при создании нового solution станут доступны Office проекты:<br/>
<br/>
<img src="/img/image-loader.svg" data-src="http://img7.imageshack.us/img7/6816/addin1.png"/><br/>
<br/>
Будьте аккуратны с названием — оно одновременно будет являться названием root namespace и поменять его можно будет только ручками через выгрузку проекта.<br/>
<br/>
На выходе получается солюшен с двумя проектами:<br/>
<img src="/img/image-loader.svg" data-src="http://img528.imageshack.us/img528/5795/addin2.png"/><br/>
<br/>
WordCAB — это, собственно, add-in. Второй — не менее важный, это deployment проект для модуля расширения. Почему он важен? <br/>
<br/>
Дело в том, что установка модуля расширения на рабочие станции пользователей — весьма трудоемкая затея. Она заключается не только в том, чтобы просто скопировать библиотеки в нужную папку. Для успешного фукнционирования модуля требуется прописать кучу ключей в реестр. Если копнуть глубже, получается, что модуль расширения подключается к Microsoft Office как COM-библиотека, со всеми вытекающими. Кому интересно, все нужные ключи реестра можно поглядеть в deployment-проекте (Нажать правой кнопкой, View->Registry). <br/>
<br/>
В классе ThisAddIn находится точка доступа в модуль:<br/>
<blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a><font color="black"><font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> ThisAddIn<br/>
{<br/>
  <font color="#0000ff">private</font> <font color="#0000ff">void</font> ThisAddIn_Startup(<font color="#0000ff">object</font> sender, System.<font color="#2B91AF">EventArgs</font> e)<br/>
  {<br/>
   new AddInApplication().Run();<br/>
  }<br/>
<br/>
  <font color="#0000ff">private</font> <font color="#0000ff">void</font> ThisAddIn_Shutdown(<font color="#0000ff">object</font> sender, System.<font color="#2B91AF">EventArgs</font> e)<br/>
  {<br/>
  }<br/>
<br/>
  <font color="#0000ff">#region</font> VSTO generated code<br/>
<br/>
  <font color="#008000">/// &lt;summary></font><br/>
  <font color="#008000">/// Required method for Designer support - do not modify</font><br/>
  <font color="#008000">/// the contents of this method with the code editor.</font><br/>
  <font color="#008000">/// &lt;/summary></font><br/>
  <font color="#0000ff">private</font> <font color="#0000ff">void</font> InternalStartup()<br/>
  {<br/>
    <font color="#0000ff">this</font>.Startup += <font color="#0000ff">new</font> System.EventHandler(ThisAddIn_Startup);<br/>
    <font color="#0000ff">this</font>.Shutdown += <font color="#0000ff">new</font> System.EventHandler(ThisAddIn_Shutdown);<br/>
  }<br/>
  <br/>
  <font color="#0000ff">#endregion</font><br/>
}</font><br/>
<br/>
<font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font>.</font></code></blockquote><br/>
<br/>
В <code>ThisAddIn_Startup</code> будем писать код. Если быть точнее, будем запускать CAB-приложение.<br/>
<br/>
<h4>Что такое CAB-приложение?</h4>Это класс такой. В нем есть точка запуска — метод <code>Run()</code>, и некоторая инфраструктура каркаса — в частности, имеются доступ к главному прецеденту «Приложение» (т.е., к основному, рутовому WorkItem) и возможности переопределить системные сервисы, добавляемые в приложения по-умолчанию. Этот класс уже реализован в базовом виде, а программисту требуется параметризировать его — указать тип рутового прецедента и тип главной формы:<br/>
<br/>
<blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a><font color="black"><font color="#0000ff">internal</font> <font color="#0000ff">sealed</font> <font color="#0000ff">class</font> AddInApplication : WindowsFormsApplication&lt;AddInWorkItem, <font color="#0000ff">object</font>><br/>
{<br/>
  <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> Start()<br/>
  {<br/>
  }<br/>
}</font><br/>
<br/>
<font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font>.</font></code></blockquote><br/>
<br/>
В качестве типа главной формы (шелловой формы), указан object. Почему? Потому что приложение запускается в Microsoft Word, поэтому необходимости создавать главную форму нет. Форма Microsoft Word и есть главная форма, правда, без традиционных для нее возможностей.<br/>
<br/>
По ходу пьесы мне пришло в голову немного прояснить модель приложения для модуля расширения в Microsoft Word.<br/>
<br/>
<h5>Модель приложения Word Add-in</h5>Итак, пользователь работает с документами. Более того, в единицу времени он может работать только с одним документом. Поэтому модуль расширения имеет четкий контекст — текущий открытый документ. (Кстати, в модели Microsoft Word VSTO этот документ обозначен как <code>Globals.ThisAddIn.Application.ActiveDocument</code>). Отсюда (я сделал) вывод (или упрощение) — показывать пользовательские бизнес-элементы имеет смысл в модальном режиме, поскольку в ином случае нарушается контекст. Элементы управления, открытые для одного документа, должны существовать только во время активности этого документа. <br/>
<br/>
Пример — пользователь открыл документ и открыл его карточку (не в модальном режиме). Переключился на другой документ, а карточка осталась для предыдущего — нарушение контекста и целостности восприятия. Разумеется, подобное поведение контролировать можно (и даже нужно, в некоторых случаях), но модальность элементов управления и жесткая их привязка к текущему активному документу делает жизнь проще.<br/>
<br/>
<h4>Modal Workspace</h4>Пользовательские элементы управления в каркасе CAB показываются в специальных так называемых рабочих зонах (Workspace). Согласно описанному выше поведению, нам требуется показывать элементы управления в модальном режиме. Поскольку родной CAB-овский WindowWorkspace оказался дубоват и выглядит некрасиво, я написал простенький свой — приводить код не буду, потому что его пара-тройка экранов. Насладиться творчеством можно скачав solution с кодом (ссылка на архив приведена в конце статьи).<br/>
<br/>
Регистрация модальной рабочей зоны происходит в методе <code>InitializeServices()</code> главного прецедента — <code>AddInWorkitem</code>:<br/>
<br/>
<blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a><font color="black">Workspaces.Add(( <font color="#0000ff">new</font> SimpleModalWorkspace() ), WorkspaceNames.MainWorkspace);</font><br/>
<br/>
<font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font>.</font></code></blockquote><br/>
<br/>
Итого: под ключем-идентификатором <code>WorkspaceNames.MainWorkspace</code> зарегистрировали модальную рабочую зону. Доступиться до нее теперь можно откуда угодно, где есть ссылка на главный прецедент: запрос интерфейса <code>IWorkspace</code> из коллекции <code>Workspaces</code> по указанному выше ключу. Все просто, как апельсин! (с) х/ф «Терминатор 2»<br/>
<br/>
<h4>Фабрика элементов управления Microsoft Word</h4>Речь пойдет о тулбаре Word и кнопках на нем. В VSTO это обертки над COM-объектами — <code>CommandBar</code> и <code>CommandBarButton</code> из пространства имен <code>Microsoft.Office.Core</code>. Жутко глючные штуки, если честно, особенно их анимация. Понять все тонкости и детали удалось только после ударного троллинга на форумах VSTO. <br/>
<br/>
В чем идея — идея состоит в том, чтобы избавить программиста и разработчиков бизнес-модулей от необходимости работать с COM-обертками. Для этого, мы (то есть, я) интегрируем модель Misrosoft Word в механизм так называемых мест расширения (UiExtensionSite) каркаса CAB.<br/>
<br/>
Механизм мест расширения состоит из функциональных связок-добавлений. Проще говоря, в коде необходимо визуализировать отношения подчиненных элементов. В нашем случае, эти отношения такие:<br/>
<ol>
<li>В массив тулбаров Microsoft Word вставляется тулбар</li>
<li>В коллекцию кнопок на тулбаре вставляется кнопка</li>
<li>В кнопку уже ничего не вставляется (не рассматриваем случае комбобоксов, хотя они присутствуют), поэтому это терминальный объект</li>
</ol><br/>
Итого, у нас получились три подчиненные друг другу сущности:<br/>
<ol>
<li><code>IWordCommandBarContainer</code> — контейнер тулбаров Microsoft Word</li>
<li><code>IWordCommandBar</code> — контейнер кнопок на тулбаре</li>
<li><code>IWordButton</code> — кнопка</li>
</ol><br/>
<br/>
К слову сказать, помимо определения элементов управления Word конкретные типы интерфейсов <code>IWordCommandBar</code> и <code>IWordButton</code> являются адаптерами к упомянутым выше <code>CommandBar</code> и <code>CommandBarButton</code> соответственно.<br/>
<br/>
Для того, чтобы каркас понял, что, куда и, главное, каким образом вставлять, ему необходимо зарегистировать фабрику адаптеров для пользовательских элементов управления. В нашем случае, вставлять можно тулбары (в коллекцию тулбаров) и кнопки (в коллекцию кнопкок на тулбаре). Поэтому, регистрировать фабрику адаптеров нужно для <code>IWordCommandBarContainer</code> и для <code>IWordCommandBar</code>. Потом, когда пользователь будет получать место расширения, каркас будет искать инстансы классов добавления подчиненных элементов для этого места расширения, после чего использовать их по назначению — добавлять элементы. Ну а чтобы не заморачиваться, эти инстансы порождаются фабрикой:<br/>
 <br/>
<blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a><font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> CommandBarUIAdapterFactory : IUIElementAdapterFactory<br/>
{<br/>
  <font color="#0000ff">public</font> IUIElementAdapter GetAdapter(<font color="#0000ff">object</font> uiElement)<br/>
  {<br/>
    <font color="#0000ff">if</font> ( uiElement <font color="#0000ff">is</font> IWordCommandBarContainer ) <font color="#008000">//тулбары</font><br/>
      <font color="#0000ff">return</font> <font color="#0000ff">new</font> CommandBarUIAdapter(( IWordCommandBarContainer )uiElement);<br/>
    <font color="#0000ff">if</font> ( uiElement <font color="#0000ff">is</font> IWordCommandBar ) <font color="#008000">//кнопки в тулбарах</font><br/>
      <font color="#0000ff">return</font> <font color="#0000ff">new</font> CommandBarButtonUIAdapter(( IWordCommandBar )uiElement);<br/>
<br/>
    <font color="#0000ff">throw</font> <font color="#0000ff">new</font> ArgumentException(<font color="#A31515">"uiElement"</font>);<br/>
  }<br/>
<br/>
  <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Supports(<font color="#0000ff">object</font> uiElement)<br/>
  {<br/>
    <font color="#0000ff">return</font> ( uiElement <font color="#0000ff">is</font> IWordCommandBarContainer ) || ( uiElement <font color="#0000ff">is</font> IWordCommandBar );<br/>
  }<br/>
}</font><br/>
<br/>
<font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font>.</font></code></blockquote><br/>
<br/>
А вот реализация коллекции тулбаров (с возможностью добавить новый!)<br/>
<blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a><font color="black"><font color="#0000ff">internal</font> <font color="#0000ff">class</font> BarCollection : IWordCommandBarContainer<br/>
{<br/>
  <font color="#0000ff">#region</font> IWordCommandBarContainer Members<br/>
<br/>
  <font color="#0000ff">public</font> <font color="#0000ff">void</font> AddBar(IWordCommandBar bar)<br/>
  {<br/>
    CommandBar commandBar = <font color="#0000ff">null</font>;<br/>
    <font color="#008000">//todo: сделать так, чтобы второй раз создать нельзя было</font><br/>
    <font color="#0000ff">try</font><br/>
    {<br/>
      commandBar = Globals.ThisAddIn.Application.CommandBars[bar.Id];<br/>
    }<br/>
    <font color="#0000ff">catch</font> ( ArgumentException ) { }<br/>
<br/>
    <font color="#0000ff">if</font> ( commandBar == <font color="#0000ff">null</font> )<br/>
      commandBar = Globals.ThisAddIn.Application.CommandBars.Add(bar.Id, ( <font color="#0000ff">object</font> )MsoBarPosition.msoBarTop, _null, <font color="#0000ff">true</font>);<br/>
<br/>
    commandBar.Visible = <font color="#0000ff">true</font>;<br/>
  }<br/>
<br/>
  <font color="#0000ff">private</font> <font color="#0000ff">object</font> _null = System.Reflection.Missing.Value;<br/>
<br/>
  <font color="#0000ff">#endregion</font><br/>
}</font><br/>
<br/>
<font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font>.</font></code></blockquote><br/>
С кнопками на тулбарах аналогично. Гляньте код на досуге.<br/>
<br/>
Пришлось, к слову, создавать фабрику самих кнопкок и тулбаров (см. <code>IWordUIElementFactory</code>). Дело в том, что модули CAB работают с интерфейсами <code>IWordCommandBar</code> и <code>IWordButton</code>. Конкретные типы этих интерфейсов находятся в сборке VSTO Word-AddIn и завязаны на <code>Microsoft.Office.Core</code>. Поэтому, чтобы в модулях (где отсутствует ссылка на Office) была возможность получать инстансы указанных элементов, создается фабрика. Она регистрируется в главном WorkItem.<br/>
<br/>
Регистрация фабрик и места расширения под тулбары:<br/>
<blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a><font color="black">Services.AddNew&lt;WordUIElementFactory, IWordUIElementFactory>();<br/>
IUIElementAdapterFactoryCatalog factoryService = <font color="#0000ff">base</font>.Services.Get&lt;IUIElementAdapterFactoryCatalog>();<br/>
factoryService.RegisterFactory(<font color="#0000ff">new</font> CommandBarUIAdapterFactory());<br/>
<br/>
UIExtensionSites.RegisterSite(UIExtensionSiteNames.WordBarsSite, <font color="#0000ff">new</font> BarCollection());</font><br/>
<br/>
<font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font>.</font></code></blockquote><br/>
<br/>
Если вы запутались, извините:) Я сам понимаю, что тут без поллитры не разберешься. (Если подебажиться, то многое становится понятным.)<br/>
<br/>
<h4>Модуль CAB</h4>Это обычная сборка. В ней должен быть класс <code>ModuleInit</code>. В этом классе есть ссылка на главный прецедент <code>AddInWorkitem</code> и, как следствие, есть доступ ко всему добру, про которое я писал выше. <br/>
<br/>
Задача модуля CAB такова — подгрузиться к главному преценденту, вставить тулбар, вставить кнопку на него, описать обработчик кнопки:<br/>
<br/>
Voila:<br/>
<blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a><font color="black">UIExtensionSite site = _rootWorkItem.UIExtensionSites[UIExtensionSiteNames.WordBarsSite];<br/>
IWordCommandBar mainBar = site.Add&lt;IWordCommandBar>(_factory.CreateBar(<font color="#A31515">"AddInToolbar"</font>));<br/>
<br/>
IWordButton btn = _factory.CreateButton(mainBar, CommandNames.OpenForm, ToolStripItemDisplayStyle.ImageAndText, <font color="#A31515">"Открыть окно"</font>,<br/>
  <font color="#A31515">"Открыть форму просмотра Custom Control"</font>, Resources.OpenForm, <font color="#0000ff">false</font>);<br/>
<br/>
mainBar.AddButton(btn);<br/>
btn.Click += <font color="#0000ff">new</font> EventHandler&lt;WordButtonClickArgs>(ButtonClick);</font><br/>
<br/>
<font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font>.</font></code></blockquote><br/>
<br/>
Обработчик кнопки будет создавать пользовательское окно с кнопкой «получить текст» и текстовым полем, после чего показывать его (применив специальный модификатор показа <code>WindowSmartPartInfo</code>) в ранее упомянутой рабочей зоне (которую, как мы помним, я зарегистрировал в прецеденте под ключем <code>WorkspaceNames.MainWorkspace</code>):<br/>
<blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a><font color="black"><font color="#0000ff">private</font> <font color="#0000ff">void</font> ButtonClick(<font color="#0000ff">object</font> sender, WordButtonClickArgs e)<br/>
{<br/>
  <font color="#0000ff">object</font> smartPart = _rootWorkItem.SmartParts.AddNew&lt;SampleSmartPart>();<br/>
  WindowSmartPartInfo info = <font color="#0000ff">new</font> WindowSmartPartInfo();<br/>
  info.FormStartPosition = FormStartPosition.CenterScreen;<br/>
  info.MaximizeBox = <font color="#0000ff">false</font>;<br/>
  info.MinimizeBox = <font color="#0000ff">false</font>;<br/>
  info.Resizable = <font color="#0000ff">false</font>;<br/>
  info.Title = <font color="#A31515">"Custom Control"</font>;<br/>
  info.ShowInTaskbar = <font color="#0000ff">false</font>;<br/>
  _rootWorkItem.Workspaces[WorkspaceNames.MainWorkspace].Show(smartPart, info);<br/>
}</font><br/>
<br/>
<font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font>.</font></code></blockquote><br/>
<br/>
<h4>Подгрузка модуля</h4>Здесь я сделал финт коленом. Обычно модули подгружаются в каркас через специальный декларативный формат подгрузки — так называемый ProfileCatalog. Обычно, это хороший способ подключить все, что нужно. Но, учитывая суровые советские реалии, имеется ненулевая вероятность того, что программисту потребуется недекларативная логика подключения модуля. Для этого мы будем переопределять специальный сервис перечисления подгружаемых модулей — <code>IModuleEnumerator</code>. Я сделал его очень простым — он глядит в папку исполняемой сборки и ищет в ней модуль под названием CustomModule.dll. Находит, и подгружает. Ну, или не подгружает, если не находит:<br/>
<blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a><font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> CustomModuleEnumerator : IModuleEnumerator<br/>
{<br/>
  <font color="#0000ff">#region</font> Constants<br/>
  <font color="#0000ff">private</font> <font color="#0000ff">const</font> <font color="#0000ff">string</font> ModuleName = <font color="#A31515">"CustomModule.dll"</font>; <br/>
  <font color="#0000ff">#endregion</font><br/>
<br/>
  <font color="#0000ff">#region</font> IModuleEnumerator Members<br/>
<br/>
  <font color="#0000ff">public</font> IModuleInfo[] EnumerateModules()<br/>
  {<br/>
    <font color="#2B91AF">List</font>&lt;IModuleInfo> result = <font color="#0000ff">new</font> <font color="#2B91AF">List</font>&lt;IModuleInfo>();<br/>
<br/>
    <font color="#0000ff">string</font> path = GetModulePath(ModuleName);<br/>
    <font color="#0000ff">if</font> ( <font color="#2B91AF">File</font>.Exists(path) )<br/>
      result.Add(<font color="#0000ff">new</font> ModuleInfo(ModuleName));<br/>
    <font color="#0000ff">return</font> result.ToArray();<br/>
  }<br/>
<br/>
  <font color="#0000ff">#endregion</font><br/>
<br/>
  <font color="#0000ff">#region</font> Private Methods<br/>
  <font color="#0000ff">private</font> <font color="#0000ff">string</font> GetModulePath(<font color="#0000ff">string</font> assemblyFile)<br/>
  {<br/>
    <font color="#0000ff">if</font> ( !Path.IsPathRooted(assemblyFile) )<br/>
      assemblyFile = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, assemblyFile);<br/>
<br/>
    <font color="#0000ff">return</font> assemblyFile;<br/>
  } <br/>
  <font color="#0000ff">#endregion</font><br/>
}</font><br/>
<br/>
<font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font>.</font></code></blockquote><br/>
<br/>
Сейчас эта служба очень простая, но при желании, разумеется, в нее можно нагородить хоть черта лысого. Например, подгружать модули из базы данных:)<br/>
<br/>
Перегрузить эту службу нужно в классе приложения CAB:<br/>
<blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a><font color="black"><font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> AddServices()<br/>
{<br/>
  <font color="#0000ff">base</font>.AddServices();<br/>
<br/>
  RootWorkItem.Services.Remove&lt;IModuleEnumerator>();<br/>
  RootWorkItem.Services.AddOnDemand&lt;CustomModuleEnumerator, IModuleEnumerator>();<br/>
}</font><br/>
<br/>
<font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font>.</font></code></blockquote><br/>
<br/>
<h4>Доктор, я устал. Что получилось?</h4>Получилось то, что задумывалось в изначальном псевдопримере:<br/>
<img src="http://img528.imageshack.us/img528/7209/addin3.jpg" data-src="http://img528.imageshack.us/img528/7209/addin3.jpg" data-blurred="true"/><br/>
В тулбарах Microsoft находится наш тулбар, на нем висит кнопка с иконкой, по событию нажатия кнопки вылезает пользовательский элемент управления, в текстовое поле которого с помощью кнопки можно загнать выделенный в документе текст:) Тривиально, но обратите внимание, как ничтожна связность между объектами! Хочется подметить, что у каркаса, при должном обращении, идеальная code maintainability.<br/>
<br/>
<h4>Внимание! Подводные камни!</h4><br/>
<h5>Security</h5>Когда скомпилируете и запустите пример, ничего не запустится. Более того, вывалится сообщение, которое скажет вам — дескать, не хватает прав на запуск стороннего модуля (в нашем случае, CustomModule.dll). Проблема в том, что по умолчанию приложение VSTO (в режиме разработки!) дает Full Trust права только на исполняемую сборку и на все сборки, от которых она зависит — т.е. на WordCAB.dll. Для того, чтобы разрешить использование кода сторонних библиотек, выполните следующее действие:<br/>
<code>C:\Windows\Microsoft.NET\Framework\v2.0.50727>caspol -u -ag All_Code -url "D:\Projects\WordCAB\bin\Debug\*" FullTrust<br/>
Microsoft (R) .NET Framework CasPol 2.0.50727.3053<br/>
Copyright (c) Microsoft Corporation. All rights reserved.<br/>
<br/>
The operation you are performing will alter security policy.<br/>
Are you sure you want to perform this operation? (yes/no)<br/>
yes<br/>
Added union code group with "-url" membership condition to the User level.<br/>
Success</code><br/>
<br/>
Вместо <code>"D:\Projects\WordCAB\bin\Debug\*"</code> нужно указать папку, из которой производится запуск Add-in. Не забудьте про звездочку.<br/>
<br/>
<h5>Add-in перестал загружаться!</h5>Иногда, когда в модуле возникает необработанный Exception, Word блокирует исполнение этого модуля при следующей загрузке. Зайдите Help->About->Disabled Items и посмотрите, нет ли в списке вашего расширения. Если есть, уберите его оттуда. При следующем Run-Debug он появится.<br/>
<br/>
<h5>Как убрать</h5>Удаление расширения не такое тривиальное. Вытащите кнопку COM-AddIns на тулбар Microsoft Word. Для этого надо зайти в Tools->Customize->Tools->(Drag'n'Drop)COM-AddIns. Кликните на нее и снимите галку с вашего расширения. Он выгрузится. Чтобы заново подгружать, наоборот, выставите галку обратно. Другой способ — зайти в панель управления и удалить из программ. <br/>
<br/>
<h5>А что с Word 2007?</h5>Add-in замечательно подгружается в Ribbon на последнюю вкладку.<br/>
<br/>
Там еще кучка мелких подводных камней. Но я тут и так уже настолько много написал, что не уверен, что кто-нибудь до конца дочитает:)<br/>
<br/>
<h4>Где взять код</h4><a href="https://github.com/head-thrash/VSTO-CAB">github.com/head-thrash/VSTO-CAB</a><br/>
<br/>
<h2>Выводы</h2>В общем, можно взять VSTO, Microsoft Office 2003, .NET Framework 2.0 и сделать решение. Базовое решение, на которое можно нарастить функционал, я привел в этой статье. Кто хочет — пользуйтесь на здоровье. Буду рад ответить на вопросы и подправить неточности, если здесь такие будут. Спасибо огромное за внимание!<br/>
</div></div> <!----> <!----></div> <div class="tm-article-body__tags"><div class="tm-article-body__tags-links"><span class="tm-article-body__tags-title">Теги:</span> <span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B.net%5D" class="tm-article-body__tags-item-link">.net</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bc%5D" class="tm-article-body__tags-item-link">c</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bvsto%5D" class="tm-article-body__tags-item-link">vsto</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bvsto%202003%5D" class="tm-article-body__tags-item-link">vsto 2003</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BCAB%5D" class="tm-article-body__tags-item-link">CAB</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bcomposite%20ui%20application%20block%5D" class="tm-article-body__tags-item-link">composite ui application block</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BMicrosoft%20Office%5D" class="tm-article-body__tags-item-link">Microsoft Office</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BMicrosoft%20Word%5D" class="tm-article-body__tags-item-link">Microsoft Word</a></span></div> <div class="tm-article-body__tags-links"><span class="tm-article-body__tags-title">Хабы:</span> <span class="tm-article-body__tags-item"><a href="/ru/hub/net/" class="tm-article-body__tags-item-link">
                  .NET
                </a></span></div></div></article> <div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 38: ↑30 и ↓8</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 38: ↑30 и ↓8" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+22</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <!----> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    42
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/54880/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      13
    </span></a> <!----></div> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div></div> <!----></div> <!----> <div class="tm-page-article__additional-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body"><div class="tm-article-author tm-page-article__author"><!----> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-two-column"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/acerv/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><svg class="tm-svg-img tm-image-placeholder tm-image-placeholder_pink"><!----> <use xlink:href="/img/megazord-v24.cee85629.svg#placeholder-user"></use></svg></div></a> <div class="tm-user-card__meta"><div title=" 186 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    98
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info"><div class="tm-user-card__title"><!----> <a href="/ru/users/acerv/" class="tm-user-card__nickname">
          @acerv
        </a> <!----></div> <p class="tm-user-card__short-info">Пользователь</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-two-column"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div></div> <!----></section> <div class="tm-page-article__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/54880/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 13 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <section class="tm-block tm-block_spacing-around"><header class="tm-block__header"><h2 class="tm-block__title">Похожие публикации</h2> <!----></header> <div class="tm-block__body"><ul class="tm-article-list-block__list"><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-09T08:37:33.000Z" title="2021-09-09, 11:37">9  сентября   в 11:37</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/ruvds/news/t/576994/" class="tm-article-title__link"><span>Новый вид атаки нулевого дня. Теперь через документы Microsoft Office</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 20: ↑20 и ↓0</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 20: ↑20 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+20</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">5.8K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    3
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/ruvds/news/t/576994/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      2
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2016-04-07T08:15:37.000Z" title="2016-04-07, 11:15">7  апреля  2016 в 11:15</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/teamlab/blog/281134/" class="tm-article-title__link"><span>Как ONLYOFFICE помирил два поколения формул Microsoft</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 16: ↑15 и ↓1</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 16: ↑15 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+14</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">17K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    28
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/teamlab/blog/281134/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      19
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2009-01-06T19:46:26.000Z" title="2009-01-06, 22:46">6  января  2009 в 22:46</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/48450/" class="tm-article-title__link"><span>Microsoft Object Builder</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 21: ↑17 и ↓4</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 21: ↑17 и ↓4" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+13</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">1.7K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    8
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/48450/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      15
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li> <!----></ul></div> <!----></section> <!----> <!----> <section class="tm-block tm-block_spacing-around"><header class="tm-block__header"><h2 class="tm-block__title">Лучшие публикации за сутки</h2> <!----></header> <div class="tm-block__body"><ul class="tm-article-list-block__list"><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-27T09:00:04.000Z" title="2021-09-27, 12:00">сегодня в 12:00</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/ruvds/blog/580060/" class="tm-article-title__link"><span>Арракис, который мы заслужили</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 94: ↑91 и ↓3</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 94: ↑91 и ↓3" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+88</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">10K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    25
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/ruvds/blog/580060/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      32
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-26T21:49:14.000Z" title="2021-09-27, 00:49">сегодня в 00:49</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/580092/" class="tm-article-title__link"><span>30 сентября: Let's Encrypt и конец срока действия IdenTrust DST Root CA X3</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 43: ↑43 и ↓0</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 43: ↑43 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+43</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">16K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    49
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/580092/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      89
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-26T19:37:10.000Z" title="2021-09-26, 22:37">вчера в 22:37</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/580086/" class="tm-article-title__link"><span>Термо принтер и JavaScript</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 44: ↑43 и ↓1</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 44: ↑43 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+42</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">8.8K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    35
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/580086/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      47
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-26T19:00:02.000Z" title="2021-09-26, 22:00">вчера в 22:00</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/funcorp/blog/579542/" class="tm-article-title__link"><span>Jetpack Compose — как легко построить UI на Android</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 39: ↑35 и ↓4</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 39: ↑35 и ↓4" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+31</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">3.7K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    53
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/funcorp/blog/579542/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      8
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-26T22:35:26.000Z" title="2021-09-27, 01:35">сегодня в 01:35</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/580094/" class="tm-article-title__link"><span>Блокчейн нас подвёл? Почему ДЭГ — это плохо и можем ли мы адекватно контролировать процесс подсчёта голосов?</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 50: ↑39 и ↓11</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 50: ↑39 и ↓11" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+28</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">12K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    22
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/580094/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      81
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li> <!----></ul></div> <!----></section> <!----> <!----></div></div></div> <div class="tm-page__sidebar"><div hl="ru" id="54880" class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/54880/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/54880/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"54880":{"id":"54880","timePublished":"2009-03-19T00:53:59+00:00","isCorporative":false,"lang":"ru","titleHtml":"VSTO и CAB: Интеграция .NET приложения в Microsoft Word","leadData":{"textHtml":"VSTO расшифровывается как Visual Studio Tools for Office. Эти средства позволяют довольно легко скрещивать ужа с ежом — писать .NET приложения, исполняемые CLR в среде Microsoft Office. В частности, программисты обладают возможностью создавать подключаемые модули (плагины) и «кастомизированные» шаблоны для документов почти ко всему основному семейству продуктов Microsoft Office.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ статье приведена инфраструктура Windows Forms проекта, в котором Microsoft Word воспринимается приложением в качестве шелла. В статье раскрыты несколько интересных моментов использования Composite UI Application Block, в частности подключение инфраструктуры доменной модели Word в сервисам расширения каркаса, а так же приведены некоторые факты и особенности разработки с использованием средств VSTO.\u003Cbr\u002F\u003E\r\n","imageUrl":null,"buttonTextHtml":"В общем, кому интересно - милости прошу","image":null},"editorVersion":"1.0","postType":"article","postLabels":[],"author":{"scoreStats":{"score":98,"votesCount":186},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"46848","alias":"acerv","fullname":null,"avatarUrl":null,"speciality":null},"statistics":{"commentsCount":13,"favoritesCount":42,"readingCount":10848,"score":22,"votesCount":38},"hubs":[{"relatedData":null,"id":"546","alias":"net","type":"collective","title":".NET","titleHtml":".NET","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EVSTO расшифровывается как Visual Studio Tools for Office. Эти средства позволяют довольно легко скрещивать ужа с ежом — писать .NET приложения, исполняемые CLR в среде Microsoft Office. В частности, программисты обладают возможностью создавать подключаемые модули (плагины) и «кастомизированные» шаблоны для документов почти ко всему основному семейству продуктов Microsoft Office.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ статье приведена инфраструктура Windows Forms проекта, в котором Microsoft Word воспринимается приложением в качестве шелла. В статье раскрыты несколько интересных моментов использования Composite UI Application Block, в частности подключение инфраструктуры доменной модели Word в сервисам расширения каркаса, а так же приведены некоторые факты и особенности разработки с использованием средств VSTO.\u003Cbr\u002F\u003E\r\n\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EЗадача\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nПредположим, у нас есть несколько десятков людей, которые пишут документы и постоянно работают с их редакциями. Sharepoint и другие порталы по каким-то причинам не подходят, поэтому требуется реализация собственной бизнес-логики. Усложним задачу — люди работают в области, очень далекой от компьютерной тематики и хорошо знают только пакет Microsoft Office. Еще усложним — контора бедная, Microsoft Office у большинства народа версии 2003-ей. Кое где, у больших начальников и Главного босса стоит 2007ой. Парк машин разнородный — начиная от 2000-ой винды и до Windows Vista.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EРешение\u003C\u002Fh4\u003EОдним из решений является плагин для Microsoft Office. Его можно написать на COM-е, через голый Office Interop, или же через такой же интероп, но по хитрому обернутый в средства VSTO. Эти средства и задействуем. Пользователь будет запускать Word, среда исполнения VSTO будет подцеплять сборки .NET и каким-то образом дополнять элементы управления Microsoft Word, позволяя пользователю выполнить нужную в задаче бизнес-логику.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EА к чему все это?\u003C\u002Fh4\u003E(Это кому не терпиться узнать, чем все закончится). На выходе я выложу Visual Studio solution, который позволит в полпинка создать свое приложение, подключаемое в Microsoft Word. По ходу дела я объясню практически все, что и как в этом солюшене используется.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EЧто потребуется для работы\u003C\u002Fh4\u003E\u003Col\u003E\r\n\u003Cli\u003EMicrosoft Word 2003 SP3\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ca href=\"http:\u002F\u002Fwww.microsoft.com\u002Fdownloads\u002Fdetails.aspx?FamilyId=5E86CAB3-6FD6-4955-B979-E1676DB6B3CB&amp;displaylang=en\"\u003EVSTO 2005 SE \u003C\u002Fa\u003E\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ca href=\"http:\u002F\u002Fwww.microsoft.com\u002Fdownloads\u002Fdetails.aspx?FamilyId=8315654B-A5AE-4108-B7FC-186402563F2B&amp;displaylang=en\"\u003EVSTO 2005 SE Runtime\u003C\u002Fa\u003E\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ca href=\"http:\u002F\u002Fwww.microsoft.com\u002FDownloads\u002Fdetails.aspx?familyid=7b9ba1a7-dd6d-4144-8ac6-df88223aee19&amp;displaylang=en\"\u003ECAB\u003C\u002Fa\u003E\u003C\u002Fli\u003E\r\n\u003Cli\u003EVisual Studio 2005 или 2008\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Ch4\u003EЗачем CAB?\u003C\u002Fh4\u003EДля того, чтобы определить явное разделение функционала, связанного с Microsoft Word от простой Windows Forms логики. Проще говоря, наш плагин будет являться модулем CAB, и при желании, мы легко сможем подключить эту логику в другие приложения CAB. Еще проще говоря, использование CAB минимизирует количество glue-кода. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсть еще две причины, по которым я включил CAB в решение. Первая состоит в том, что я уже давал описание этого каркаса \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fblogs\u002Fnet\u002F50322\u002F\"\u003Eздесь\u003C\u002Fa\u003E, а теперь хочу привести полноценный работающий пример. Вторая причина более банальная — мне нравится CAB, он делает мир и вещи в нем проще:)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EПодробнее про VSTO\u003C\u002Fh4\u003EВообще говоря, VSTO не только плагины для Word-а умеет создавать. Это мощная система, сейчас она уже есть в третьей версии. VSTO — это врата для разработчика в мир автоматизации и программирования Office-based решений. В двух словах — разработчик .NET получает доступ к доменной модели приложения Office и делает с ней что хочет.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВсе эти решения можно разделить на два типа:\u003Col\u003E\r\n\u003Cli\u003EУровень документа (Document Level Customization)\u003C\u002Fli\u003E\r\n\u003Cli\u003EУровень приложения (Application Level Customization)\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\r\nЭто независимые уровни. На первом создаются шаблоны документов для приложений Microsoft Office. Можно взять шаблон Excel, разнообразить его разными пользовательскими элементами управлениями (кнопками, гридами), и добавить всякую логику — например, чтобы по событию нажатия кнопки собранные пользователем данные отправлялись через веб-сервис на какой-то сервер и обрабатывались там. На этом уровне разработчику доступен Action Pane (в 2003-ей версии), куда можно подключать свои элементы управления, плюс еще очень много всего в 2007-ой версии. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nApplication Level Customization означает то, что в среду приложения Microsoft Office подключается модуль расширения (т.н. add-in). Собственно, про него я изначально и начал говорить. Этот модуль расширения является локомотивом бизнес-приложения и позволяет подключать в Microsoft Office все возможности платформы .NET. Я буду показывать именно решение второго уровня.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли кто заинтересовался возможностями VSTO — очень много про них есть в \u003Ca href=\"http:\u002F\u002Fmsdn.microsoft.com\u002Fen-us\u002Flibrary\u002Fbf68wbkb(VS.80).aspx\"\u003Emsdn\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EПсевдозадача\u003C\u002Fh4\u003EСоздадим маленький пример, иллюстрирующий все вышесказанное. Пусть есть требование, согласно которому пользователь может выделять текст из документа Microsoft Word и получать этот выделенный текст в окошке пользовательского элемента (знаю, дурацкий пример, но более сложного делать не хочется, а менее сложный уже трудно придумать). \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nБолее подробно. Пользователь запускает Microsoft Word. После запуска среди тулбаров пользователю будет доступен ТР — тулбар расширения (т.е., нашего расширения). На нем находится кнопка, по нажатию которой пользователю показывется окно с кнопкой «Получить текст» и элементом управления multiline textbox. Пользователь нажимает на кнопку «Получить текст», выделенный в документе текст копируется в textbox. Все счастливы.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПонятно, что для жизни пример малопригоден. Но создаваемая инфраструктура позволит довольно просто нарастить на него «мускулы», если это, конечно, кому-то потребуется.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EСоздание solution\u003C\u002Fh4\u003EПосле установки VSTO в студии при создании нового solution станут доступны Office проекты:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"http:\u002F\u002Fimg7.imageshack.us\u002Fimg7\u002F6816\u002Faddin1.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nБудьте аккуратны с названием — оно одновременно будет являться названием root namespace и поменять его можно будет только ручками через выгрузку проекта.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа выходе получается солюшен с двумя проектами:\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"http:\u002F\u002Fimg528.imageshack.us\u002Fimg528\u002F5795\u002Faddin2.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nWordCAB — это, собственно, add-in. Второй — не менее важный, это deployment проект для модуля расширения. Почему он важен? \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДело в том, что установка модуля расширения на рабочие станции пользователей — весьма трудоемкая затея. Она заключается не только в том, чтобы просто скопировать библиотеки в нужную папку. Для успешного фукнционирования модуля требуется прописать кучу ключей в реестр. Если копнуть глубже, получается, что модуль расширения подключается к Microsoft Office как COM-библиотека, со всеми вытекающими. Кому интересно, все нужные ключи реестра можно поглядеть в deployment-проекте (Нажать правой кнопкой, View-\u003ERegistry). \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ классе ThisAddIn находится точка доступа в модуль:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Ca href=\"http:\u002F\u002Fvirtser.net\u002Fblog\u002Fpost\u002Fsource-code-highlighter.aspx\"\u003E\u003C\u002Fa\u003E\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Epartial\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Eclass\u003C\u002Ffont\u003E ThisAddIn\u003Cbr\u002F\u003E\r\n{\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E ThisAddIn_Startup(\u003Cfont color=\"#0000ff\"\u003Eobject\u003C\u002Ffont\u003E sender, System.\u003Cfont color=\"#2B91AF\"\u003EEventArgs\u003C\u002Ffont\u003E e)\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n   new AddInApplication().Run();\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E ThisAddIn_Shutdown(\u003Cfont color=\"#0000ff\"\u003Eobject\u003C\u002Ffont\u003E sender, System.\u003Cfont color=\"#2B91AF\"\u003EEventArgs\u003C\u002Ffont\u003E e)\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003E#region\u003C\u002Ffont\u003E VSTO generated code\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#008000\"\u003E\u002F\u002F\u002F &lt;summary\u003E\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#008000\"\u003E\u002F\u002F\u002F Required method for Designer support - do not modify\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#008000\"\u003E\u002F\u002F\u002F the contents of this method with the code editor.\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#008000\"\u003E\u002F\u002F\u002F &lt;\u002Fsummary\u003E\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E InternalStartup()\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Ethis\u003C\u002Ffont\u003E.Startup += \u003Cfont color=\"#0000ff\"\u003Enew\u003C\u002Ffont\u003E System.EventHandler(ThisAddIn_Startup);\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Ethis\u003C\u002Ffont\u003E.Shutdown += \u003Cfont color=\"#0000ff\"\u003Enew\u003C\u002Ffont\u003E System.EventHandler(ThisAddIn_Shutdown);\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n  \u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003E#endregion\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n}\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"gray\"\u003E* This source code was highlighted with \u003Cfont color=\"gray\"\u003ESource Code Highlighter\u003C\u002Ffont\u003E.\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ \u003Ccode\u003EThisAddIn_Startup\u003C\u002Fcode\u003E будем писать код. Если быть точнее, будем запускать CAB-приложение.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EЧто такое CAB-приложение?\u003C\u002Fh4\u003EЭто класс такой. В нем есть точка запуска — метод \u003Ccode\u003ERun()\u003C\u002Fcode\u003E, и некоторая инфраструктура каркаса — в частности, имеются доступ к главному прецеденту «Приложение» (т.е., к основному, рутовому WorkItem) и возможности переопределить системные сервисы, добавляемые в приложения по-умолчанию. Этот класс уже реализован в базовом виде, а программисту требуется параметризировать его — указать тип рутового прецедента и тип главной формы:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Ca href=\"http:\u002F\u002Fvirtser.net\u002Fblog\u002Fpost\u002Fsource-code-highlighter.aspx\"\u003E\u003C\u002Fa\u003E\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003Einternal\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Esealed\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Eclass\u003C\u002Ffont\u003E AddInApplication : WindowsFormsApplication&lt;AddInWorkItem, \u003Cfont color=\"#0000ff\"\u003Eobject\u003C\u002Ffont\u003E\u003E\u003Cbr\u002F\u003E\r\n{\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprotected\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Eoverride\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E Start()\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n}\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"gray\"\u003E* This source code was highlighted with \u003Cfont color=\"gray\"\u003ESource Code Highlighter\u003C\u002Ffont\u003E.\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ качестве типа главной формы (шелловой формы), указан object. Почему? Потому что приложение запускается в Microsoft Word, поэтому необходимости создавать главную форму нет. Форма Microsoft Word и есть главная форма, правда, без традиционных для нее возможностей.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПо ходу пьесы мне пришло в голову немного прояснить модель приложения для модуля расширения в Microsoft Word.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch5\u003EМодель приложения Word Add-in\u003C\u002Fh5\u003EИтак, пользователь работает с документами. Более того, в единицу времени он может работать только с одним документом. Поэтому модуль расширения имеет четкий контекст — текущий открытый документ. (Кстати, в модели Microsoft Word VSTO этот документ обозначен как \u003Ccode\u003EGlobals.ThisAddIn.Application.ActiveDocument\u003C\u002Fcode\u003E). Отсюда (я сделал) вывод (или упрощение) — показывать пользовательские бизнес-элементы имеет смысл в модальном режиме, поскольку в ином случае нарушается контекст. Элементы управления, открытые для одного документа, должны существовать только во время активности этого документа. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПример — пользователь открыл документ и открыл его карточку (не в модальном режиме). Переключился на другой документ, а карточка осталась для предыдущего — нарушение контекста и целостности восприятия. Разумеется, подобное поведение контролировать можно (и даже нужно, в некоторых случаях), но модальность элементов управления и жесткая их привязка к текущему активному документу делает жизнь проще.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EModal Workspace\u003C\u002Fh4\u003EПользовательские элементы управления в каркасе CAB показываются в специальных так называемых рабочих зонах (Workspace). Согласно описанному выше поведению, нам требуется показывать элементы управления в модальном режиме. Поскольку родной CAB-овский WindowWorkspace оказался дубоват и выглядит некрасиво, я написал простенький свой — приводить код не буду, потому что его пара-тройка экранов. Насладиться творчеством можно скачав solution с кодом (ссылка на архив приведена в конце статьи).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nРегистрация модальной рабочей зоны происходит в методе \u003Ccode\u003EInitializeServices()\u003C\u002Fcode\u003E главного прецедента — \u003Ccode\u003EAddInWorkitem\u003C\u002Fcode\u003E:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Ca href=\"http:\u002F\u002Fvirtser.net\u002Fblog\u002Fpost\u002Fsource-code-highlighter.aspx\"\u003E\u003C\u002Fa\u003E\u003Cfont color=\"black\"\u003EWorkspaces.Add(( \u003Cfont color=\"#0000ff\"\u003Enew\u003C\u002Ffont\u003E SimpleModalWorkspace() ), WorkspaceNames.MainWorkspace);\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"gray\"\u003E* This source code was highlighted with \u003Cfont color=\"gray\"\u003ESource Code Highlighter\u003C\u002Ffont\u003E.\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nИтого: под ключем-идентификатором \u003Ccode\u003EWorkspaceNames.MainWorkspace\u003C\u002Fcode\u003E зарегистрировали модальную рабочую зону. Доступиться до нее теперь можно откуда угодно, где есть ссылка на главный прецедент: запрос интерфейса \u003Ccode\u003EIWorkspace\u003C\u002Fcode\u003E из коллекции \u003Ccode\u003EWorkspaces\u003C\u002Fcode\u003E по указанному выше ключу. Все просто, как апельсин! (с) х\u002Fф «Терминатор 2»\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EФабрика элементов управления Microsoft Word\u003C\u002Fh4\u003EРечь пойдет о тулбаре Word и кнопках на нем. В VSTO это обертки над COM-объектами — \u003Ccode\u003ECommandBar\u003C\u002Fcode\u003E и \u003Ccode\u003ECommandBarButton\u003C\u002Fcode\u003E из пространства имен \u003Ccode\u003EMicrosoft.Office.Core\u003C\u002Fcode\u003E. Жутко глючные штуки, если честно, особенно их анимация. Понять все тонкости и детали удалось только после ударного троллинга на форумах VSTO. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ чем идея — идея состоит в том, чтобы избавить программиста и разработчиков бизнес-модулей от необходимости работать с COM-обертками. Для этого, мы (то есть, я) интегрируем модель Misrosoft Word в механизм так называемых мест расширения (UiExtensionSite) каркаса CAB.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nМеханизм мест расширения состоит из функциональных связок-добавлений. Проще говоря, в коде необходимо визуализировать отношения подчиненных элементов. В нашем случае, эти отношения такие:\u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003EВ массив тулбаров Microsoft Word вставляется тулбар\u003C\u002Fli\u003E\r\n\u003Cli\u003EВ коллекцию кнопок на тулбаре вставляется кнопка\u003C\u002Fli\u003E\r\n\u003Cli\u003EВ кнопку уже ничего не вставляется (не рассматриваем случае комбобоксов, хотя они присутствуют), поэтому это терминальный объект\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\r\nИтого, у нас получились три подчиненные друг другу сущности:\u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003E\u003Ccode\u003EIWordCommandBarContainer\u003C\u002Fcode\u003E — контейнер тулбаров Microsoft Word\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ccode\u003EIWordCommandBar\u003C\u002Fcode\u003E — контейнер кнопок на тулбаре\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ccode\u003EIWordButton\u003C\u002Fcode\u003E — кнопка\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nК слову сказать, помимо определения элементов управления Word конкретные типы интерфейсов \u003Ccode\u003EIWordCommandBar\u003C\u002Fcode\u003E и \u003Ccode\u003EIWordButton\u003C\u002Fcode\u003E являются адаптерами к упомянутым выше \u003Ccode\u003ECommandBar\u003C\u002Fcode\u003E и \u003Ccode\u003ECommandBarButton\u003C\u002Fcode\u003E соответственно.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля того, чтобы каркас понял, что, куда и, главное, каким образом вставлять, ему необходимо зарегистировать фабрику адаптеров для пользовательских элементов управления. В нашем случае, вставлять можно тулбары (в коллекцию тулбаров) и кнопки (в коллекцию кнопкок на тулбаре). Поэтому, регистрировать фабрику адаптеров нужно для \u003Ccode\u003EIWordCommandBarContainer\u003C\u002Fcode\u003E и для \u003Ccode\u003EIWordCommandBar\u003C\u002Fcode\u003E. Потом, когда пользователь будет получать место расширения, каркас будет искать инстансы классов добавления подчиненных элементов для этого места расширения, после чего использовать их по назначению — добавлять элементы. Ну а чтобы не заморачиваться, эти инстансы порождаются фабрикой:\u003Cbr\u002F\u003E\r\n \u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Ca href=\"http:\u002F\u002Fvirtser.net\u002Fblog\u002Fpost\u002Fsource-code-highlighter.aspx\"\u003E\u003C\u002Fa\u003E\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Eclass\u003C\u002Ffont\u003E CommandBarUIAdapterFactory : IUIElementAdapterFactory\u003Cbr\u002F\u003E\r\n{\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E IUIElementAdapter GetAdapter(\u003Cfont color=\"#0000ff\"\u003Eobject\u003C\u002Ffont\u003E uiElement)\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E ( uiElement \u003Cfont color=\"#0000ff\"\u003Eis\u003C\u002Ffont\u003E IWordCommandBarContainer ) \u003Cfont color=\"#008000\"\u003E\u002F\u002Fтулбары\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Enew\u003C\u002Ffont\u003E CommandBarUIAdapter(( IWordCommandBarContainer )uiElement);\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E ( uiElement \u003Cfont color=\"#0000ff\"\u003Eis\u003C\u002Ffont\u003E IWordCommandBar ) \u003Cfont color=\"#008000\"\u003E\u002F\u002Fкнопки в тулбарах\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Enew\u003C\u002Ffont\u003E CommandBarButtonUIAdapter(( IWordCommandBar )uiElement);\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Ethrow\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Enew\u003C\u002Ffont\u003E ArgumentException(\u003Cfont color=\"#A31515\"\u003E\"uiElement\"\u003C\u002Ffont\u003E);\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Ebool\u003C\u002Ffont\u003E Supports(\u003Cfont color=\"#0000ff\"\u003Eobject\u003C\u002Ffont\u003E uiElement)\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E ( uiElement \u003Cfont color=\"#0000ff\"\u003Eis\u003C\u002Ffont\u003E IWordCommandBarContainer ) || ( uiElement \u003Cfont color=\"#0000ff\"\u003Eis\u003C\u002Ffont\u003E IWordCommandBar );\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n}\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"gray\"\u003E* This source code was highlighted with \u003Cfont color=\"gray\"\u003ESource Code Highlighter\u003C\u002Ffont\u003E.\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nА вот реализация коллекции тулбаров (с возможностью добавить новый!)\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Ca href=\"http:\u002F\u002Fvirtser.net\u002Fblog\u002Fpost\u002Fsource-code-highlighter.aspx\"\u003E\u003C\u002Fa\u003E\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003Einternal\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Eclass\u003C\u002Ffont\u003E BarCollection : IWordCommandBarContainer\u003Cbr\u002F\u003E\r\n{\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003E#region\u003C\u002Ffont\u003E IWordCommandBarContainer Members\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E AddBar(IWordCommandBar bar)\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    CommandBar commandBar = \u003Cfont color=\"#0000ff\"\u003Enull\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#008000\"\u003E\u002F\u002Ftodo: сделать так, чтобы второй раз создать нельзя было\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Etry\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      commandBar = Globals.ThisAddIn.Application.CommandBars[bar.Id];\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Ecatch\u003C\u002Ffont\u003E ( ArgumentException ) { }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E ( commandBar == \u003Cfont color=\"#0000ff\"\u003Enull\u003C\u002Ffont\u003E )\u003Cbr\u002F\u003E\r\n      commandBar = Globals.ThisAddIn.Application.CommandBars.Add(bar.Id, ( \u003Cfont color=\"#0000ff\"\u003Eobject\u003C\u002Ffont\u003E )MsoBarPosition.msoBarTop, _null, \u003Cfont color=\"#0000ff\"\u003Etrue\u003C\u002Ffont\u003E);\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    commandBar.Visible = \u003Cfont color=\"#0000ff\"\u003Etrue\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Eobject\u003C\u002Ffont\u003E _null = System.Reflection.Missing.Value;\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003E#endregion\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n}\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"gray\"\u003E* This source code was highlighted with \u003Cfont color=\"gray\"\u003ESource Code Highlighter\u003C\u002Ffont\u003E.\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nС кнопками на тулбарах аналогично. Гляньте код на досуге.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПришлось, к слову, создавать фабрику самих кнопкок и тулбаров (см. \u003Ccode\u003EIWordUIElementFactory\u003C\u002Fcode\u003E). Дело в том, что модули CAB работают с интерфейсами \u003Ccode\u003EIWordCommandBar\u003C\u002Fcode\u003E и \u003Ccode\u003EIWordButton\u003C\u002Fcode\u003E. Конкретные типы этих интерфейсов находятся в сборке VSTO Word-AddIn и завязаны на \u003Ccode\u003EMicrosoft.Office.Core\u003C\u002Fcode\u003E. Поэтому, чтобы в модулях (где отсутствует ссылка на Office) была возможность получать инстансы указанных элементов, создается фабрика. Она регистрируется в главном WorkItem.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nРегистрация фабрик и места расширения под тулбары:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Ca href=\"http:\u002F\u002Fvirtser.net\u002Fblog\u002Fpost\u002Fsource-code-highlighter.aspx\"\u003E\u003C\u002Fa\u003E\u003Cfont color=\"black\"\u003EServices.AddNew&lt;WordUIElementFactory, IWordUIElementFactory\u003E();\u003Cbr\u002F\u003E\r\nIUIElementAdapterFactoryCatalog factoryService = \u003Cfont color=\"#0000ff\"\u003Ebase\u003C\u002Ffont\u003E.Services.Get&lt;IUIElementAdapterFactoryCatalog\u003E();\u003Cbr\u002F\u003E\r\nfactoryService.RegisterFactory(\u003Cfont color=\"#0000ff\"\u003Enew\u003C\u002Ffont\u003E CommandBarUIAdapterFactory());\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nUIExtensionSites.RegisterSite(UIExtensionSiteNames.WordBarsSite, \u003Cfont color=\"#0000ff\"\u003Enew\u003C\u002Ffont\u003E BarCollection());\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"gray\"\u003E* This source code was highlighted with \u003Cfont color=\"gray\"\u003ESource Code Highlighter\u003C\u002Ffont\u003E.\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли вы запутались, извините:) Я сам понимаю, что тут без поллитры не разберешься. (Если подебажиться, то многое становится понятным.)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EМодуль CAB\u003C\u002Fh4\u003EЭто обычная сборка. В ней должен быть класс \u003Ccode\u003EModuleInit\u003C\u002Fcode\u003E. В этом классе есть ссылка на главный прецедент \u003Ccode\u003EAddInWorkitem\u003C\u002Fcode\u003E и, как следствие, есть доступ ко всему добру, про которое я писал выше. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЗадача модуля CAB такова — подгрузиться к главному преценденту, вставить тулбар, вставить кнопку на него, описать обработчик кнопки:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nVoila:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Ca href=\"http:\u002F\u002Fvirtser.net\u002Fblog\u002Fpost\u002Fsource-code-highlighter.aspx\"\u003E\u003C\u002Fa\u003E\u003Cfont color=\"black\"\u003EUIExtensionSite site = _rootWorkItem.UIExtensionSites[UIExtensionSiteNames.WordBarsSite];\u003Cbr\u002F\u003E\r\nIWordCommandBar mainBar = site.Add&lt;IWordCommandBar\u003E(_factory.CreateBar(\u003Cfont color=\"#A31515\"\u003E\"AddInToolbar\"\u003C\u002Ffont\u003E));\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nIWordButton btn = _factory.CreateButton(mainBar, CommandNames.OpenForm, ToolStripItemDisplayStyle.ImageAndText, \u003Cfont color=\"#A31515\"\u003E\"Открыть окно\"\u003C\u002Ffont\u003E,\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#A31515\"\u003E\"Открыть форму просмотра Custom Control\"\u003C\u002Ffont\u003E, Resources.OpenForm, \u003Cfont color=\"#0000ff\"\u003Efalse\u003C\u002Ffont\u003E);\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nmainBar.AddButton(btn);\u003Cbr\u002F\u003E\r\nbtn.Click += \u003Cfont color=\"#0000ff\"\u003Enew\u003C\u002Ffont\u003E EventHandler&lt;WordButtonClickArgs\u003E(ButtonClick);\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"gray\"\u003E* This source code was highlighted with \u003Cfont color=\"gray\"\u003ESource Code Highlighter\u003C\u002Ffont\u003E.\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОбработчик кнопки будет создавать пользовательское окно с кнопкой «получить текст» и текстовым полем, после чего показывать его (применив специальный модификатор показа \u003Ccode\u003EWindowSmartPartInfo\u003C\u002Fcode\u003E) в ранее упомянутой рабочей зоне (которую, как мы помним, я зарегистрировал в прецеденте под ключем \u003Ccode\u003EWorkspaceNames.MainWorkspace\u003C\u002Fcode\u003E):\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Ca href=\"http:\u002F\u002Fvirtser.net\u002Fblog\u002Fpost\u002Fsource-code-highlighter.aspx\"\u003E\u003C\u002Fa\u003E\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E ButtonClick(\u003Cfont color=\"#0000ff\"\u003Eobject\u003C\u002Ffont\u003E sender, WordButtonClickArgs e)\u003Cbr\u002F\u003E\r\n{\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eobject\u003C\u002Ffont\u003E smartPart = _rootWorkItem.SmartParts.AddNew&lt;SampleSmartPart\u003E();\u003Cbr\u002F\u003E\r\n  WindowSmartPartInfo info = \u003Cfont color=\"#0000ff\"\u003Enew\u003C\u002Ffont\u003E WindowSmartPartInfo();\u003Cbr\u002F\u003E\r\n  info.FormStartPosition = FormStartPosition.CenterScreen;\u003Cbr\u002F\u003E\r\n  info.MaximizeBox = \u003Cfont color=\"#0000ff\"\u003Efalse\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n  info.MinimizeBox = \u003Cfont color=\"#0000ff\"\u003Efalse\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n  info.Resizable = \u003Cfont color=\"#0000ff\"\u003Efalse\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n  info.Title = \u003Cfont color=\"#A31515\"\u003E\"Custom Control\"\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n  info.ShowInTaskbar = \u003Cfont color=\"#0000ff\"\u003Efalse\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n  _rootWorkItem.Workspaces[WorkspaceNames.MainWorkspace].Show(smartPart, info);\u003Cbr\u002F\u003E\r\n}\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"gray\"\u003E* This source code was highlighted with \u003Cfont color=\"gray\"\u003ESource Code Highlighter\u003C\u002Ffont\u003E.\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EПодгрузка модуля\u003C\u002Fh4\u003EЗдесь я сделал финт коленом. Обычно модули подгружаются в каркас через специальный декларативный формат подгрузки — так называемый ProfileCatalog. Обычно, это хороший способ подключить все, что нужно. Но, учитывая суровые советские реалии, имеется ненулевая вероятность того, что программисту потребуется недекларативная логика подключения модуля. Для этого мы будем переопределять специальный сервис перечисления подгружаемых модулей — \u003Ccode\u003EIModuleEnumerator\u003C\u002Fcode\u003E. Я сделал его очень простым — он глядит в папку исполняемой сборки и ищет в ней модуль под названием CustomModule.dll. Находит, и подгружает. Ну, или не подгружает, если не находит:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Ca href=\"http:\u002F\u002Fvirtser.net\u002Fblog\u002Fpost\u002Fsource-code-highlighter.aspx\"\u003E\u003C\u002Fa\u003E\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Eclass\u003C\u002Ffont\u003E CustomModuleEnumerator : IModuleEnumerator\u003Cbr\u002F\u003E\r\n{\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003E#region\u003C\u002Ffont\u003E Constants\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Estring\u003C\u002Ffont\u003E ModuleName = \u003Cfont color=\"#A31515\"\u003E\"CustomModule.dll\"\u003C\u002Ffont\u003E; \u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003E#endregion\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003E#region\u003C\u002Ffont\u003E IModuleEnumerator Members\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E IModuleInfo[] EnumerateModules()\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#2B91AF\"\u003EList\u003C\u002Ffont\u003E&lt;IModuleInfo\u003E result = \u003Cfont color=\"#0000ff\"\u003Enew\u003C\u002Ffont\u003E \u003Cfont color=\"#2B91AF\"\u003EList\u003C\u002Ffont\u003E&lt;IModuleInfo\u003E();\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Estring\u003C\u002Ffont\u003E path = GetModulePath(ModuleName);\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E ( \u003Cfont color=\"#2B91AF\"\u003EFile\u003C\u002Ffont\u003E.Exists(path) )\u003Cbr\u002F\u003E\r\n      result.Add(\u003Cfont color=\"#0000ff\"\u003Enew\u003C\u002Ffont\u003E ModuleInfo(ModuleName));\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E result.ToArray();\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003E#endregion\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003E#region\u003C\u002Ffont\u003E Private Methods\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Estring\u003C\u002Ffont\u003E GetModulePath(\u003Cfont color=\"#0000ff\"\u003Estring\u003C\u002Ffont\u003E assemblyFile)\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E ( !Path.IsPathRooted(assemblyFile) )\u003Cbr\u002F\u003E\r\n      assemblyFile = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, assemblyFile);\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E assemblyFile;\u003Cbr\u002F\u003E\r\n  } \u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003E#endregion\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n}\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"gray\"\u003E* This source code was highlighted with \u003Cfont color=\"gray\"\u003ESource Code Highlighter\u003C\u002Ffont\u003E.\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСейчас эта служба очень простая, но при желании, разумеется, в нее можно нагородить хоть черта лысого. Например, подгружать модули из базы данных:)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПерегрузить эту службу нужно в классе приложения CAB:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Ca href=\"http:\u002F\u002Fvirtser.net\u002Fblog\u002Fpost\u002Fsource-code-highlighter.aspx\"\u003E\u003C\u002Fa\u003E\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003Eprotected\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Eoverride\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E AddServices()\u003Cbr\u002F\u003E\r\n{\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Ebase\u003C\u002Ffont\u003E.AddServices();\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  RootWorkItem.Services.Remove&lt;IModuleEnumerator\u003E();\u003Cbr\u002F\u003E\r\n  RootWorkItem.Services.AddOnDemand&lt;CustomModuleEnumerator, IModuleEnumerator\u003E();\u003Cbr\u002F\u003E\r\n}\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"gray\"\u003E* This source code was highlighted with \u003Cfont color=\"gray\"\u003ESource Code Highlighter\u003C\u002Ffont\u003E.\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EДоктор, я устал. Что получилось?\u003C\u002Fh4\u003EПолучилось то, что задумывалось в изначальном псевдопримере:\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"http:\u002F\u002Fimg528.imageshack.us\u002Fimg528\u002F7209\u002Faddin3.jpg\" data-src=\"http:\u002F\u002Fimg528.imageshack.us\u002Fimg528\u002F7209\u002Faddin3.jpg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\nВ тулбарах Microsoft находится наш тулбар, на нем висит кнопка с иконкой, по событию нажатия кнопки вылезает пользовательский элемент управления, в текстовое поле которого с помощью кнопки можно загнать выделенный в документе текст:) Тривиально, но обратите внимание, как ничтожна связность между объектами! Хочется подметить, что у каркаса, при должном обращении, идеальная code maintainability.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EВнимание! Подводные камни!\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\n\u003Ch5\u003ESecurity\u003C\u002Fh5\u003EКогда скомпилируете и запустите пример, ничего не запустится. Более того, вывалится сообщение, которое скажет вам — дескать, не хватает прав на запуск стороннего модуля (в нашем случае, CustomModule.dll). Проблема в том, что по умолчанию приложение VSTO (в режиме разработки!) дает Full Trust права только на исполняемую сборку и на все сборки, от которых она зависит — т.е. на WordCAB.dll. Для того, чтобы разрешить использование кода сторонних библиотек, выполните следующее действие:\u003Cbr\u002F\u003E\r\n\u003Ccode\u003EC:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\u003Ecaspol -u -ag All_Code -url \"D:\\Projects\\WordCAB\\bin\\Debug\\*\" FullTrust\u003Cbr\u002F\u003E\r\nMicrosoft (R) .NET Framework CasPol 2.0.50727.3053\u003Cbr\u002F\u003E\r\nCopyright (c) Microsoft Corporation. All rights reserved.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nThe operation you are performing will alter security policy.\u003Cbr\u002F\u003E\r\nAre you sure you want to perform this operation? (yes\u002Fno)\u003Cbr\u002F\u003E\r\nyes\u003Cbr\u002F\u003E\r\nAdded union code group with \"-url\" membership condition to the User level.\u003Cbr\u002F\u003E\r\nSuccess\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВместо \u003Ccode\u003E\"D:\\Projects\\WordCAB\\bin\\Debug\\*\"\u003C\u002Fcode\u003E нужно указать папку, из которой производится запуск Add-in. Не забудьте про звездочку.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch5\u003EAdd-in перестал загружаться!\u003C\u002Fh5\u003EИногда, когда в модуле возникает необработанный Exception, Word блокирует исполнение этого модуля при следующей загрузке. Зайдите Help-\u003EAbout-\u003EDisabled Items и посмотрите, нет ли в списке вашего расширения. Если есть, уберите его оттуда. При следующем Run-Debug он появится.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch5\u003EКак убрать\u003C\u002Fh5\u003EУдаление расширения не такое тривиальное. Вытащите кнопку COM-AddIns на тулбар Microsoft Word. Для этого надо зайти в Tools-\u003ECustomize-\u003ETools-\u003E(Drag'n'Drop)COM-AddIns. Кликните на нее и снимите галку с вашего расширения. Он выгрузится. Чтобы заново подгружать, наоборот, выставите галку обратно. Другой способ — зайти в панель управления и удалить из программ. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch5\u003EА что с Word 2007?\u003C\u002Fh5\u003EAdd-in замечательно подгружается в Ribbon на последнюю вкладку.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТам еще кучка мелких подводных камней. Но я тут и так уже настолько много написал, что не уверен, что кто-нибудь до конца дочитает:)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EГде взять код\u003C\u002Fh4\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fhead-thrash\u002FVSTO-CAB\"\u003Egithub.com\u002Fhead-thrash\u002FVSTO-CAB\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EВыводы\u003C\u002Fh2\u003EВ общем, можно взять VSTO, Microsoft Office 2003, .NET Framework 2.0 и сделать решение. Базовое решение, на которое можно нарастить функционал, я привел в этой статье. Кто хочет — пользуйтесь на здоровье. Буду рад ответить на вопросы и подправить неточности, если здесь такие будут. Спасибо огромное за внимание!\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E","tags":[{"titleHtml":".net"},{"titleHtml":"c"},{"titleHtml":"vsto"},{"titleHtml":"vsto 2003"},{"titleHtml":"CAB"},{"titleHtml":"composite ui application block"},{"titleHtml":"Microsoft Office"},{"titleHtml":"Microsoft Word"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F54880\u002F8960e82cb2d61db852eea75d0746d07d\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F54880\u002F8960e82cb2d61db852eea75d0746d07d\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F54880\\\u002F\"},\"headline\":\"VSTO и CAB: Интеграция .NET приложения в Microsoft Word\",\"datePublished\":\"2009-03-19T03:53:59+03:00\",\"dateModified\":\"2011-11-26T13:29:35+04:00\",\"author\":{\"@type\":\"Person\",\"name\":\"acerv\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"VSTO расшифровывается как Visual Studio Tools for Office. Эти средства позволяют довольно легко скрещивать ужа с ежом &mdash; писать .NET приложения, исполняемые CLR в...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F54880\\\u002F#post-content-body\",\"about\":[\"h_net\",\"f_develop\"],\"image\":[\"http:\\\u002F\\\u002Fimg7.imageshack.us\\\u002Fimg7\\\u002F6816\\\u002Faddin1.png\",\"http:\\\u002F\\\u002Fimg528.imageshack.us\\\u002Fimg528\\\u002F5795\\\u002Faddin2.png\",\"http:\\\u002F\\\u002Fimg528.imageshack.us\\\u002Fimg528\\\u002F7209\\\u002Faddin3.jpg\"]}","metaDescription":"VSTO расшифровывается как Visual Studio Tools for Office. Эти средства позволяют довольно легко скрещивать ужа с ежом — писать .NET приложения, исполняемые CLR в среде Microsoft Office. В частности,...","mainImageUrl":null,"amp":false},"polls":[],"commentsEnabled":true,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false},"578296":{"id":"578296","timePublished":"2021-09-26T14:00:02+00:00","isCorporative":true,"lang":"ru","titleHtml":"Вектор? Растр? А может — и то, и другое?","editorVersion":"1.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Zach Leatherman","originalUrl":"https:\u002F\u002Fwww.zachleat.com\u002Fweb\u002Fvector-raster-split\u002F"}}],"author":{"id":"1220775","alias":"ru_vds","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fe36\u002F812\u002Fd3d\u002Fe36812d3de38eb3d479d7a13228717ef.png","speciality":"Пользователь"},"statistics":{"commentsCount":8,"favoritesCount":32,"readingCount":2754,"score":25,"votesCount":27},"hubs":[{"relatedData":null,"id":"19791","alias":"ruvds","type":"corporative","title":"Блог компании RUVDS.com","titleHtml":"Блог компании RUVDS.com","isProfiled":false},{"relatedData":null,"id":"449","alias":"vector_graphics","type":"collective","title":"Работа с векторной графикой","titleHtml":"Работа с векторной графикой","isProfiled":true},{"relatedData":null,"id":"8880","alias":"server_side_optimization","type":"collective","title":"Серверная оптимизация","titleHtml":"Серверная оптимизация","isProfiled":true},{"relatedData":null,"id":"17175","alias":"image_processing","type":"collective","title":"Обработка изображений","titleHtml":"Обработка изображений","isProfiled":true},{"relatedData":null,"id":"19802","alias":"graph_design","type":"collective","title":"Графический дизайн","titleHtml":"Графический дизайн","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"2","alias":"design","title":"Дизайн"},{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"На этой неделе я столкнулся с интересным классом задач, для решения которых, как я теперь понимаю, можно было использовать гораздо более удачный подход и раньше. Но существует ли такой подход?\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F578296\u002F\"\u003E\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fge\u002Fkf\u002F1n\u002Fgekf1nauxn50imhrqyil4rlzj5m.jpeg\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fa\u003E\u003Cbr\u003E\r\n\u003Ci\u003E\u003Cfont color=\"#999999\"\u003EИзображение для верхней части сайта\u003C\u002Ffont\u003E\u003C\u002Fi\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nРечь идёт о подготовке изображения, рассчитанного на использовании в верхней правой части сайта \u003Ca href=\"https:\u002F\u002Fjamstackconf.com\" rel=\"nofollow noopener noreferrer\"\u003Ejamstackconf.com\u003C\u002Fa\u003E. Мы, в маркетинговой команде Netlify, используем Figma. Первая моя попытка экспорта этого изображения для использования его на сайте оказалась далеко не самой удачной.\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"графика"},{"titleHtml":"веб-разработка"},{"titleHtml":"ruvds_перевод"}]},"579542":{"id":"579542","timePublished":"2021-09-26T19:00:02+00:00","isCorporative":true,"lang":"ru","titleHtml":"Jetpack Compose — как легко построить UI на Android","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2713395","alias":"i15in","fullname":"Иван","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F25f\u002Fe4b\u002Ff94\u002F25fe4bf94867d9647a0ae809abf2e429.jpg","speciality":"Android developer"},"statistics":{"commentsCount":8,"favoritesCount":53,"readingCount":3685,"score":31,"votesCount":39},"hubs":[{"relatedData":null,"id":"18232","alias":"funcorp","type":"corporative","title":"Блог компании FUNCORP","titleHtml":"Блог компании FUNCORP","isProfiled":false},{"relatedData":null,"id":"6345","alias":"mobile_dev","type":"collective","title":"Разработка мобильных приложений","titleHtml":"Разработка мобильных приложений","isProfiled":true},{"relatedData":null,"id":"9188","alias":"ui","type":"collective","title":"Интерфейсы","titleHtml":"Интерфейсы","isProfiled":true},{"relatedData":null,"id":"17107","alias":"android_dev","type":"collective","title":"Разработка под Android","titleHtml":"Разработка под Android","isProfiled":true},{"relatedData":null,"id":"19441","alias":"kotlin","type":"collective","title":"Kotlin","titleHtml":"Kotlin","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"2","alias":"design","title":"Дизайн"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EВ июле этого года вместе с Android Studio Arctic Fox вышла одна из долгожданных библиотек — Jetpack Compose. Она позволяет создавать пользовательский интерфейс в декларативном стиле и обещает быть революцией в построении UI.\u003C\u002Fp\u003E\u003Cp\u003EРазбираемся, так ли это на самом деле, какие у библиотеки преимущества и недостатки. Подробности — в статье.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5da\u002F63d\u002F3cb\u002F5da63d3cbeb8e38de3dde2792d851722.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5da\u002F63d\u002F3cb\u002F5da63d3cbeb8e38de3dde2792d851722.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"разработка мобильных приложений"},{"titleHtml":"jetpack compose"},{"titleHtml":"ui"},{"titleHtml":"интерфейсы"},{"titleHtml":"android"},{"titleHtml":"kotlin"},{"titleHtml":"android studio"},{"titleHtml":"arctic fox"},{"titleHtml":"пользовательские интерфейсы"}]},"579772":{"id":"579772","timePublished":"2021-09-27T05:32:01+00:00","isCorporative":true,"lang":"ru","titleHtml":"Сливы процветают. Эксперт-«параноик» Майкл Баззель о защите личных данных","editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Michael Bazzell","originalUrl":"https:\u002F\u002Finteltechniques.com\u002Fblog\u002F2021\u002F07\u002F23\u002Fpersonal-ransomware-exposure\u002F"}}],"author":{"id":"2297567","alias":"SearchInform_team","fullname":null,"avatarUrl":"","speciality":"Пользователь"},"statistics":{"commentsCount":0,"favoritesCount":6,"readingCount":2024,"score":9,"votesCount":9},"hubs":[{"relatedData":null,"id":"22418","alias":"searchinform","type":"corporative","title":"Блог компании SearchInform","titleHtml":"Блог компании SearchInform","isProfiled":false},{"relatedData":null,"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EНаш очередной пост из серии «интересное на иностранном языке» – рассказ Майкла Баззеля о том, как сберечь свои персональные данные от утечек. Майкл – знаковая фигура в сфере OSINT, работал в правительстве США и ФБР, его приглашали в качестве технического эксперта в сериал «Мистер Робот», который считают достойным с точки зрения достоверности. В личной жизни эксперт придерживается настолько жестких правил в отношении информационной гигиены, что некоторые считают его «неадекватом». Так ли это – может быть несколько мнений. \u003C\u002Fp\u003E\u003Cp\u003EОдин из факторов, который убеждает в правильном подходе Майкла, – что риски обнаружить свои данные в интернете стали существенно выше, потому что шифровальщики без разбору сливают в сеть все, до чего дотягиваются при атаках на бизнес. Приводим перевод \u003Ca href=\"https:\u002F\u002Finteltechniques.com\u002Fblog\u002F2021\u002F07\u002F23\u002Fpersonal-ransomware-exposure\u002F\"\u003Eпоста Майкла Баззеля\u003C\u002Fa\u003E. \u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EАтакуют корпорации, а страдают люди\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003EБольшинство людей не задумываются о том, как их касается проблема распространения вирусов-шифровальщиков. Логика такова: речь идет о проблемах компаний, это они вынуждены платить выкуп. При чем тут, казалось бы, обычные люди?! \u003C\u002Fp\u003E\u003Cp\u003EА при том, что преступники сменили тактику: сейчас они не просто шифруют данные, но и скачивают их, выкладывают в открытый доступ, если компании не платят им выкуп. Теперь давайте подумаем, что в этих слитых базах? Множество данных о сотрудниках, клиентах, контрагентах, с которыми компания-жертва работает.\u003C\u002Fp\u003E\u003Cp\u003EХочу сразу уточнить: я это пишу не потому что выступаю за уплату выкупа. Я за то, чтобы сопротивляться избыточному сбору данных там, где это не обязательно. Мы халатно относимся к своим ПДн, раздавая их по первому требованию.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe3b\u002F3e1\u002F2c2\u002Fe3b3e12c2036d90018b804276e31ebea.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe3b\u002F3e1\u002F2c2\u002Fe3b3e12c2036d90018b804276e31ebea.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"персональные данные"},{"titleHtml":"пдн"},{"titleHtml":"сёрчинформ"},{"titleHtml":"Майкл Баззел"},{"titleHtml":"утечки информации"}]},"579854":{"id":"579854","timePublished":"2021-09-27T06:03:01+00:00","isCorporative":true,"lang":"ru","titleHtml":"Видишь уязвимости? А они есть! Наше исследование популярных CMS-систем","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2684283","alias":"Solar_Pentest","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":8,"favoritesCount":15,"readingCount":2683,"score":25,"votesCount":27},"hubs":[{"relatedData":null,"id":"20826","alias":"solarsecurity","type":"corporative","title":"Блог компании Ростелеком-Солар","titleHtml":"Блог компании Ростелеком-Солар","isProfiled":false},{"relatedData":null,"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true},{"relatedData":null,"id":"260","alias":"php","type":"collective","title":"PHP","titleHtml":"PHP","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЛьвиная доля всех работ по анализу защищенности внешнего периметра – это тестирование веб-приложений. Здесь могут быть как корпоративные решения, так и «домашние» разработки на базе различных публичных систем управления контентом (CMS). Мы всегда проводим глубокий анализ подобных решений на тестовых стендах и зачастую находим уязвимости нулевого дня. Собственно, из опыта таких проектов и родилась идея собрать исследовательскую команду и провести глубокий анализ популярных CMS-систем и различных плагинов для них. В этом посте мы поделимся результатами нашего исследования, а также продемонстрируем примеры уязвимого кода наиболее интересных, на наш взгляд, уязвимостей и примеры их эксплуатации. Конечно все эти уязвимости уже исправлены и описываются здесь с разрешения владельцев систем.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6df\u002F317\u002F4e6\u002F6df3174e60bbe263a70bcafdf9e51e6b.jpg","buttonTextHtml":"Не всё то в безопасности, что с Bug Bounty","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6df\u002F317\u002F4e6\u002F6df3174e60bbe263a70bcafdf9e51e6b.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"cms"},{"titleHtml":"уязвимости"},{"titleHtml":"уязвимости и их эксплуатация"},{"titleHtml":"уязвимость нулевого дня"}]},"580008":{"id":"580008","timePublished":"2021-09-27T06:30:02+00:00","isCorporative":false,"lang":"ru","titleHtml":"Летний Магнитогорск","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2614609","alias":"city_scraper","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F8f8\u002Fd6c\u002F328\u002F8f8d6c328ec3a513103b6757c2c21610.png","speciality":"Пользователь"},"statistics":{"commentsCount":5,"favoritesCount":3,"readingCount":2921,"score":9,"votesCount":15},"hubs":[{"relatedData":null,"id":"22012","alias":"Ecology","type":"collective","title":"Экология","titleHtml":"Экология","isProfiled":false},{"relatedData":null,"id":"22024","alias":"urban","type":"collective","title":"Урбанизм","titleHtml":"Урбанизм","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EМагнитогорск Челябинской области – один из крупнейших мировых центров чёрной металлургии. В России это шестой из крупнейших городов, которые не являются центрами субъектов страны. \u003C\u002Fp\u003E\u003Cp\u003EСовсем недавно город был одним из наиболее неблагополучных с точки зрения загрязнения атмосферного воздуха, но в 2021 году был зафиксирован «повышенный» уровень – то есть не «высокий» или «очень высокий», как раньше. \u003C\u002Fp\u003E\u003Cp\u003EКак этот город выглядит летом? Где и как его жители могут проводить время?\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F030\u002F0d1\u002Fcff\u002F0300d1cff2029948d33d803000331724.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F030\u002F0d1\u002Fcff\u002F0300d1cff2029948d33d803000331724.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Магнитогорск"},{"titleHtml":"промышленность"},{"titleHtml":"промышленные города"},{"titleHtml":"урбанизм\u002Fурбания"},{"titleHtml":"урбанистика"},{"titleHtml":"города России"},{"titleHtml":"города"}]},"580048":{"id":"580048","timePublished":"2021-09-26T14:22:36+00:00","isCorporative":false,"lang":"ru","titleHtml":"Будь строже к себе: как ограничения помогают сделать код лучше","editorVersion":"2.0","postType":"article","postLabels":[{"type":"sandbox","data":null}],"author":{"id":"2787821","alias":"ZeBrains_team","fullname":"Станислав Маслов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fae3\u002F3ee\u002F4f1\u002Fae33ee4f1a117aeeab42ec5a9e2eba25.jpg","speciality":"директор продакшена в IT-компании"},"statistics":{"commentsCount":10,"favoritesCount":50,"readingCount":4718,"score":8,"votesCount":16},"hubs":[{"relatedData":null,"id":"19583","alias":"dev_management","type":"collective","title":"Управление разработкой","titleHtml":"Управление разработкой","isProfiled":true},{"relatedData":null,"id":"20682","alias":"pm","type":"collective","title":"Управление проектами","titleHtml":"Управление проектами","isProfiled":true},{"relatedData":null,"id":"20726","alias":"productpm","type":"collective","title":"Управление продуктом","titleHtml":"Управление продуктом","isProfiled":true}],"flows":[{"id":"3","alias":"management","title":"Менеджмент"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003E\u003Cstrong\u003E\u003Cem\u003EЕсли вам приходилось задумываться о построении эффективной экосистемы проекта и определении ролей тимлида и разработчика — статья Артема Прозорова из ZeBrains для вас. \u003C\u002Fem\u003E\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003EПредлагаю вам задуматься над одним вопросом. Но не спешите с ответом, потому что он не так очевиден, как может показаться:\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EКакая из команд может реализовать более технически стабильный продукт?&nbsp;\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EКоманда №1:\u003C\u002Fstrong\u003E Проектный менеджер, аналитик, тестировщик и несколько разработчиков, у каждого из которых за плечами минимум три года опыта. Все работают в одном офисе, посвящая свое время одному проекту в режиме fulltime.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EКоманда №2:\u003C\u002Fstrong\u003E Один сильный разработчик. Ему помогают множество не знакомых между собой людей из разных часовых поясов. У каждого — свой набор компетенций и уровень опыта. Работой над проектом участники занимаются в свободном режиме, по несколько часов в неделю.\u003C\u002Fp\u003E\u003Cp\u003E* * *\u003C\u002Fp\u003E\u003Cp\u003EОтвет на этот вопрос получим к концу статьи.\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fefe\u002F413\u002Feb2\u002Fefe413eb27c391cfcfef0484e6997aab.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"управление проектами"},{"titleHtml":"управление продуктом"},{"titleHtml":"управление командой разработки"},{"titleHtml":"управление командами разработчиков"},{"titleHtml":"тимлид"},{"titleHtml":"тимлиды и разработчики"}]},"580052":{"id":"580052","timePublished":"2021-09-26T15:29:26+00:00","isCorporative":false,"lang":"ru","titleHtml":"Почему экология не может быть плохой?","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2568695","alias":"phanerozoi_evidence","fullname":"Фанерозой","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fdcc\u002F862\u002F561\u002Fdcc862561429f2ed85090ac53e39cf7d.jpg","speciality":"Биологи, врач, научный популяризатор, палеонтолог"},"statistics":{"commentsCount":47,"favoritesCount":28,"readingCount":5086,"score":8,"votesCount":28},"hubs":[{"relatedData":null,"id":"20742","alias":"read","type":"collective","title":"Читальный зал","titleHtml":"Читальный зал","isProfiled":false},{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"22012","alias":"Ecology","type":"collective","title":"Экология","titleHtml":"Экология","isProfiled":false},{"relatedData":null,"id":"22750","alias":"biology","type":"collective","title":"Биология","titleHtml":"Биология","isProfiled":false}],"flows":[{"id":"3","alias":"management","title":"Менеджмент"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003E\u003Cem\u003EСо второй половины ХХ в мы всё чаще слышим из средств массовой информации выражения «плохая экология», «сохранить экологию», «экология строительных материалов». Но, к сожалению, не многие знают, что такое «экология» на самом деле. Для разгадки тайн экологии нам предстоит окунуться в удивительный мир науки...\u003C\u002Fem\u003E\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F9a4\u002Fecf\u002Fd11\u002F9a4ecfd1144e299873622d45d23d2ce0.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F9a4\u002Fecf\u002Fd11\u002F9a4ecfd1144e299873622d45d23d2ce0.png","fit":"cover","positionY":29.545454545455,"positionX":1.4102564102564}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"виды"},{"titleHtml":"охрана окружающей среды"},{"titleHtml":"мифы"},{"titleHtml":"экосистема"},{"titleHtml":"биогеоценоз"},{"titleHtml":"экология"},{"titleHtml":"экосистемы"},{"titleHtml":"биоценозы"},{"titleHtml":"биология"},{"titleHtml":"вирусы"}]},"580060":{"id":"580060","timePublished":"2021-09-27T09:00:04+00:00","isCorporative":true,"lang":"ru","titleHtml":"Арракис, который мы заслужили","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"238277","alias":"Zelenyikot","fullname":"Виталий Егоров","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F22b\u002F2d7\u002F7a5\u002F22b2d77a57b687aae24784a3e53089c9.jpg","speciality":"Популяризатор космонавтики"},"statistics":{"commentsCount":32,"favoritesCount":25,"readingCount":10495,"score":88,"votesCount":94},"hubs":[{"relatedData":null,"id":"19791","alias":"ruvds","type":"corporative","title":"Блог компании RUVDS.com","titleHtml":"Блог компании RUVDS.com","isProfiled":false},{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"21962","alias":"space","type":"collective","title":"Космонавтика","titleHtml":"Космонавтика","isProfiled":false},{"relatedData":null,"id":"21984","alias":"sci-fi","type":"collective","title":"Научная фантастика","titleHtml":"Научная фантастика","isProfiled":false},{"relatedData":null,"id":"22014","alias":"futurenow","type":"collective","title":"Будущее здесь","titleHtml":"Будущее здесь","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F580060\u002F\"\u003E\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fk0\u002Fds\u002Fy5\u002Fk0dsy5npxclyjdytiroqga7-leu.jpeg\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fa\u003E\u003Cbr\u003E\r\nВо вселенной писателя-фантаста Фрэнка Герберта, Дюна, она же Арракис &mdash; это пустынная и маловодная планета с двумя лунами. По сюжету, она находится за пределами Солнечной системы, но если мы захотим поискать ближайшую схожую параллель,&nbsp;то больше всего подходит планета Марс. Предлагаю воспользоваться возможностями, которые даёт современная космонавтика, и совершить воображаемую прогулку на нашу Дюну.\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Марс"},{"titleHtml":"Дюна"},{"titleHtml":"MRO"},{"titleHtml":"Curiosity"},{"titleHtml":"марсоход"},{"titleHtml":"ruvds_статьи"}]},"580080":{"id":"580080","timePublished":"2021-09-26T19:12:55+00:00","isCorporative":false,"lang":"ru","titleHtml":"Дайджест свежих материалов из мира фронтенда за последнюю неделю №486 (20 — 26 сентября 2021)","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"59347","alias":"alexzfort","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd2a\u002Fe8a\u002F5ac\u002Fd2ae8a5ac9876f838ebdd45f3ea3bc3b.png","speciality":""},"statistics":{"commentsCount":2,"favoritesCount":20,"readingCount":3390,"score":17,"votesCount":17},"hubs":[{"relatedData":null,"id":"91","alias":"webdev","type":"collective","title":"Разработка веб-сайтов","titleHtml":"Разработка веб-сайтов","isProfiled":true},{"relatedData":null,"id":"307","alias":"css","type":"collective","title":"CSS","titleHtml":"CSS","isProfiled":true},{"relatedData":null,"id":"357","alias":"javascript","type":"collective","title":"JavaScript","titleHtml":"JavaScript","isProfiled":true},{"relatedData":null,"id":"17103","alias":"html5","type":"collective","title":"HTML","titleHtml":"HTML","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"Предлагаем вашему вниманию подборку с ссылками на новые материалы из области фронтенда и около него.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fec\u002F0x\u002Fkx\u002Fec0xkxfr5jd-rci1wjo9bmr4cns.jpeg\"\u003E\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"дайджест"},{"titleHtml":"фронтенд"},{"titleHtml":"css"},{"titleHtml":"js"},{"titleHtml":"es6"},{"titleHtml":"vue"},{"titleHtml":"react"},{"titleHtml":"angular"},{"titleHtml":"ember"},{"titleHtml":"html5"},{"titleHtml":"браузеры"},{"titleHtml":"ссылки"}]},"580084":{"id":"580084","timePublished":"2021-09-26T19:30:13+00:00","isCorporative":false,"lang":"ru","titleHtml":"Telegram Bots vs Google Forms","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2705023","alias":"dm_aq","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":4,"favoritesCount":21,"readingCount":4039,"score":7,"votesCount":7},"hubs":[{"relatedData":null,"id":"144","alias":"open_source","type":"collective","title":"Open source","titleHtml":"Open source","isProfiled":true},{"relatedData":null,"id":"19441","alias":"kotlin","type":"collective","title":"Kotlin","titleHtml":"Kotlin","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EGoogle forms отличный инструмент для решения простых организационных задач, например, сбор информации для регистрации людей на небольшое мероприятие. Но что если мы попытаемся решить эту задачу по другому? Например через telegram.&nbsp;\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"telegrambot"},{"titleHtml":"telegram"},{"titleHtml":"kotlin"},{"titleHtml":"spring"}]},"580086":{"id":"580086","timePublished":"2021-09-26T19:37:10+00:00","isCorporative":false,"lang":"ru","titleHtml":"Термо принтер и JavaScript","editorVersion":"2.0","postType":"article","postLabels":[{"type":"recovery","data":null}],"author":{"id":"1709955","alias":"IIIarp","fullname":"Сергей Шарпов","avatarUrl":"","speciality":"Веб разработчик"},"statistics":{"commentsCount":47,"favoritesCount":35,"readingCount":8825,"score":42,"votesCount":44},"hubs":[{"relatedData":null,"id":"84","alias":"crazydev","type":"collective","title":"Ненормальное программирование","titleHtml":"Ненормальное программирование","isProfiled":true},{"relatedData":null,"id":"357","alias":"javascript","type":"collective","title":"JavaScript","titleHtml":"JavaScript","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EПриобрел я на днях термопринтер (кассовый аппарат, если изволите) жене для магазина и решил что смогу его обуздать как истинный программист и сделать свою веб кассу, вместо того, что-бы использовать платные решения, ведь задача простая, печатать чеки, но это оказалось не так то и просто...\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4f3\u002F259\u002Fe4e\u002F4f3259e4e73b5bfae82890fd3db512a0.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4f3\u002F259\u002Fe4e\u002F4f3259e4e73b5bfae82890fd3db512a0.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"термопринтер"},{"titleHtml":"javascript"},{"titleHtml":"webusb"}]},"580088":{"id":"580088","timePublished":"2021-09-26T21:17:27+00:00","isCorporative":false,"lang":"ru","titleHtml":"Запуск X-приложения в chroot на примере POSE (или «QEMU не нужен»)","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"1481597","alias":"edo1h","fullname":null,"avatarUrl":"","speciality":"немного программист, немного админ"},"statistics":{"commentsCount":5,"favoritesCount":9,"readingCount":1037,"score":11,"votesCount":11},"hubs":[{"relatedData":null,"id":"221","alias":"sys_admin","type":"collective","title":"Системное администрирование","titleHtml":"Системное администрирование","isProfiled":true},{"relatedData":null,"id":"7289","alias":"nix","type":"collective","title":"*nix","titleHtml":"*nix","isProfiled":true}],"flows":[{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЭта мини-статья родилась как ответ на статью \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F579296\" rel=\"noopener noreferrer nofollow\"\u003EУпрощаем эмуляцию X86 с помощью Live CD\u003C\u002Fa\u003E, в которой для запуска старых 32-битных приложений на 64-битных дистрибутивах Linux предлагалось использовать QEMU + Live CD — по моему мнению «из пушки по воробьям». Опишу своё решение на \u003Ccode\u003Echroot\u003C\u002Fcode\u003E + \u003Ccode\u003Edebootstrap\u003C\u002Fcode\u003E. \u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"chroot"},{"titleHtml":"debootstrap"},{"titleHtml":"xwindow"}]},"580090":{"id":"580090","timePublished":"2021-09-26T21:19:11+00:00","isCorporative":false,"lang":"ru","titleHtml":"Сравнение подходов к реализации распределенных транзакций для микросервисов","editorVersion":"2.0","postType":"article","postLabels":[{"type":"sandbox","data":null},{"type":"translation","data":{"originalAuthorName":"Bilgin Ibryam","originalUrl":"https:\u002F\u002Fdevelopers.redhat.com\u002Farticles\u002F2021\u002F09\u002F21\u002Fdistributed-transaction-patterns-microservices-compared"}}],"author":{"id":"194270","alias":"sprosin","fullname":"Sergey Prosin","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd67\u002F5d8\u002F1d6\u002Fd675d81d6fe5bf69493735cef4910eb5.jpg","speciality":"Веду команды к релизам, пишу статьи, выступаю."},"statistics":{"commentsCount":6,"favoritesCount":83,"readingCount":4122,"score":14,"votesCount":14},"hubs":[{"relatedData":null,"id":"7504","alias":"refactoring","type":"collective","title":"Проектирование и рефакторинг","titleHtml":"Проектирование и рефакторинг","isProfiled":true},{"relatedData":null,"id":"21482","alias":"distributed_systems","type":"collective","title":"Распределённые системы","titleHtml":"Распределённые системы","isProfiled":true},{"relatedData":null,"id":"22115","alias":"microservices","type":"collective","title":"Микросервисы","titleHtml":"Микросервисы","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EКак архитектор-консультант в Red Hat, я имел возможность поработать над множеством проектов для наших клиентов. У каждого из них есть свои особенности, которые, однако, имеют некоторые общие черты. Большинство клиентов хотят знать, как скоординировать запись в несколько систем одновременно. Ответ на этот вопрос обычно включает подробное объяснение двойной записи, распределенных транзакций, современных альтернатив, а также возможных сценариев сбоев и недостатков каждого подхода. Как правило, именно в этот момент заказчик понимает, что разделение монолитного приложения на микросервисы - долгий и сложный путь, обычно требующий компромиссов.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbc4\u002F35d\u002Fff3\u002Fbc435dff35d09143dacf29bbc1e470a7.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbc4\u002F35d\u002Fff3\u002Fbc435dff35d09143dacf29bbc1e470a7.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"распределенные системы"},{"titleHtml":"микросервисы"},{"titleHtml":"транзакции"},{"titleHtml":"распределенные транзакции"},{"titleHtml":"оркестрация"},{"titleHtml":"оркестрация микросервисов"},{"titleHtml":"хореография"},{"titleHtml":"конвейеры"}]},"580092":{"id":"580092","timePublished":"2021-09-26T21:49:14+00:00","isCorporative":false,"lang":"ru","titleHtml":"30 сентября: Let's Encrypt и конец срока действия IdenTrust DST Root CA X3","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"805873","alias":"rantal","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":89,"favoritesCount":49,"readingCount":15772,"score":43,"votesCount":43},"hubs":[{"relatedData":null,"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true},{"relatedData":null,"id":"17350","alias":"s_admin","type":"collective","title":"Серверное администрирование","titleHtml":"Серверное администрирование","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003E30 сентября 2021 14:01:15  GMT оканчивается срок действия корневого сертификата IdenTrust DST Root CA X3.\u003C\u002Fp\u003E\u003Cp\u003EЭто событие достойно вашего внимания по той причине, что после наступления этого момента ряд устаревших систем перестанут доверять сертификатам,&nbsp;выпущенным центром сертификации Let’s Encrypt. С учётом того, что на текущий момент Let's Encrypt предоставляет бесплатные криптографические сертификаты примерно для \u003Ca href=\"https:\u002F\u002Fletsencrypt.org\u002Fstats\u002F\" rel=\"noopener noreferrer nofollow\"\u003E250 миллионов доменных имен\u003C\u002Fa\u003E, а \"устаревшие системы\" - это порой системы возрастом всего 5-6 лет, вряд ли окончание срока действия сертификата&nbsp;DST Root CA X3 пройдёт для всех гладко и незаметно. В чём причина, кого конкретно это затронет, и что можно сделать?\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"let's encrypt"},{"titleHtml":"DST Root CA X3"},{"titleHtml":"корневой сертификат"},{"titleHtml":"https"},{"titleHtml":"tls"},{"titleHtml":"openssl"}]},"580094":{"id":"580094","timePublished":"2021-09-26T22:35:26+00:00","isCorporative":false,"lang":"ru","titleHtml":"Блокчейн нас подвёл? Почему ДЭГ — это плохо и можем ли мы адекватно контролировать процесс подсчёта голосов?","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"206414","alias":"PoltoS","fullname":"Сергей Полторак","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F5cf\u002F03a\u002Fc7f\u002F5cf03ac7fe60ea8a6686bd4c57627ddc.png","speciality":""},"statistics":{"commentsCount":81,"favoritesCount":22,"readingCount":12389,"score":28,"votesCount":50},"hubs":[{"relatedData":null,"id":"118","alias":"crypto","type":"collective","title":"Криптография","titleHtml":"Криптография","isProfiled":true},{"relatedData":null,"id":"210","alias":"it_testing","type":"collective","title":"Тестирование IT-систем","titleHtml":"Тестирование IT-систем","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EИнтересно наблюдать, как дискредитируется термин блокчейна на выборах в госдуму. Вроде голосование было на блокчейне, но его якобы подделали. Т.е. блокчейн можно подделать или ЦИК и ДИТ нам подсунули какой-то лохчейн вместо блокчейна?!? И мало кто обсуждает происходящее по существу без эмоций, связанных с результатами партий и кандидатов.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6e5\u002F82b\u002F9d0\u002F6e582b9d062dd29fa41c7842a8b76495.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6e5\u002F82b\u002F9d0\u002F6e582b9d062dd29fa41c7842a8b76495.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Криптография"},{"titleHtml":"блокчейн"},{"titleHtml":"открытые данные"},{"titleHtml":"электронное голосование"},{"titleHtml":"выборы"},{"titleHtml":"выборы в госдуму"},{"titleHtml":"дэг"},{"titleHtml":"дэг 2021"}]},"580124":{"id":"580124","timePublished":"2021-09-27T13:03:14+00:00","isCorporative":true,"lang":"ru","titleHtml":"Электролюминесцентные индикаторы из прошлого","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"146371","alias":"radiolok","fullname":"Артем Кашканов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fa46\u002Fc6a\u002F151\u002Fa46c6a15193f7c0cac79d2736b107358.jpg","speciality":"Релейно-декатронный маньяк"},"statistics":{"commentsCount":3,"favoritesCount":9,"readingCount":1051,"score":19,"votesCount":19},"hubs":[{"relatedData":null,"id":"19791","alias":"ruvds","type":"corporative","title":"Блог компании RUVDS.com","titleHtml":"Блог компании RUVDS.com","isProfiled":false},{"relatedData":null,"id":"21484","alias":"electronics","type":"collective","title":"Производство и разработка электроники","titleHtml":"Производство и разработка электроники","isProfiled":true},{"relatedData":null,"id":"21906","alias":"history","type":"collective","title":"История IT","titleHtml":"История IT","isProfiled":false},{"relatedData":null,"id":"21930","alias":"antikvariat","type":"collective","title":"Старое железо","titleHtml":"Старое железо","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"Сегодня речь пойдёт об электролюминесцентных индикаторах. Но, не о тех, которые окружают вас повсюду и к которым вы привыкли, а о других — получивших огромную популярность в 60-е годы прошлого века, и так же стремительно канувших в небытие. Заодно запущу свою коллекцию индикаторов, как серийно выпускавшихся, так и уникальных опытных и даже — лабораторных образцов.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F523004\u002F\"\u003E\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F94e\u002F51f\u002F459\u002F94e51f459ae59c9d2fe6c448cb07bcca.gif\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fa\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Индикатор"},{"titleHtml":"электролюминесцентность"},{"titleHtml":"ruvds_статьи"}]},"580150":{"id":"580150","timePublished":"2021-09-27T10:50:03+00:00","isCorporative":true,"lang":"ru","titleHtml":"Топ-5 когнитивных искажений при планировании в IT","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2794469","alias":"KM_QA","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":1,"favoritesCount":22,"readingCount":2278,"score":15,"votesCount":15},"hubs":[{"relatedData":null,"id":"14332","alias":"oleg-bunin","type":"corporative","title":"Блог компании Конференции Олега Бунина (Онтико)","titleHtml":"Блог компании Конференции Олега Бунина (Онтико)","isProfiled":false},{"relatedData":null,"id":"19583","alias":"dev_management","type":"collective","title":"Управление разработкой","titleHtml":"Управление разработкой","isProfiled":true},{"relatedData":null,"id":"20736","alias":"hr_management","type":"collective","title":"Управление персоналом","titleHtml":"Управление персоналом","isProfiled":true},{"relatedData":null,"id":"20754","alias":"tech_events","type":"collective","title":"Конференции","titleHtml":"Конференции","isProfiled":false},{"relatedData":null,"id":"21990","alias":"brain","type":"collective","title":"Мозг","titleHtml":"Мозг","isProfiled":false}],"flows":[{"id":"3","alias":"management","title":"Менеджмент"},{"id":"4","alias":"marketing","title":"Маркетинг"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЭта статья подходит для тимлидов и их подопечных, а также для всех, кто оценивает проекты и задачи. Я расскажу, как и почему мы делаем ошибки из-за когнитивных искажений. Попадаем в них мы почти все, просто потому что мы живые люди. И на примере одного дня из жизни тимлида я хочу показать, в какие искажения чаще всего влетают в IT, и&nbsp; — самое полезное&nbsp; —&nbsp; как из них можно выходить.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EЗамечу, что искать когнитивные искажения стоит, в первую очередь, у себя, а не у коллег. \u003C\u002Fstrong\u003EИ что рассказывать про искажения намного проще, чем не влетать в их на практике, однако, если этому научиться, то в перспективе это изрядно окупается, потому что экономит и время, и деньги, помогая и нам, и команде.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb78\u002F76f\u002F001\u002Fb7876f0010e85c328462a735df0b76e8.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb78\u002F76f\u002F001\u002Fb7876f0010e85c328462a735df0b76e8.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"когнитивные искажения"},{"titleHtml":"нейрофизиология"},{"titleHtml":"мозг"},{"titleHtml":"психология"},{"titleHtml":"тимлидство"},{"titleHtml":"тимлид"},{"titleHtml":"управление людьми"},{"titleHtml":"управление проектами и командой"},{"titleHtml":"управление командой"},{"titleHtml":"управление персоналом"}]},"580172":{"id":"580172","timePublished":"2021-09-27T11:45:49+00:00","isCorporative":true,"lang":"ru","titleHtml":"Небинарный ngIf*","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"1050218","alias":"Waterplea","fullname":"Александр Инкин","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fa70\u002F569\u002Ff31\u002Fa70569f31346559ce2b8b875e7f97480.jpg","speciality":"Google Developer Expert | Angular"},"statistics":{"commentsCount":0,"favoritesCount":6,"readingCount":434,"score":7,"votesCount":7},"hubs":[{"relatedData":null,"id":"17420","alias":"tinkoff","type":"corporative","title":"Блог компании TINKOFF","titleHtml":"Блог компании TINKOFF","isProfiled":false},{"relatedData":null,"id":"91","alias":"webdev","type":"collective","title":"Разработка веб-сайтов","titleHtml":"Разработка веб-сайтов","isProfiled":true},{"relatedData":null,"id":"18109","alias":"angular","type":"collective","title":"Angular","titleHtml":"Angular","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EВам когда-нибудь хотелось отобразить состояние загрузки, пока \u003Ccode\u003EngIf\u003C\u002Fcode\u003E ждет ответа от \u003Ccode\u003Easync\u003C\u002Fcode\u003E-пайпа? Или, может, вы мечтали передать в \u003Ccode\u003EngFor\u003C\u002Fcode\u003E шаблон для пустого массива? Возможно, вы бросили это, потому что вам не хотелось реализовывать базовую логику этих директив самому. На самом деле в этом нет нужды! Один и тот же селектор может подцепить несколько директив, что позволяет расширить функциональность встроенных директив дополнительной логикой.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F846\u002F786\u002F3e2\u002F8467863e2df65db32cb31f4b16c822ef.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F846\u002F786\u002F3e2\u002F8467863e2df65db32cb31f4b16c822ef.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"template"},{"titleHtml":"directive"},{"titleHtml":"angular"},{"titleHtml":"structural"}]},"580196":{"id":"580196","timePublished":"2021-09-27T12:28:15+00:00","isCorporative":true,"lang":"ru","titleHtml":"Зачем нужен динамический анализ кода, на примере проекта PVS-Studio","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"2302295","alias":"MrROBUST","fullname":"Алексей Говоров","avatarUrl":"","speciality":"Пользователь"},"statistics":{"commentsCount":0,"favoritesCount":2,"readingCount":211,"score":8,"votesCount":8},"hubs":[{"relatedData":null,"id":"18095","alias":"pvs-studio","type":"corporative","title":"Блог компании PVS-Studio","titleHtml":"Блог компании PVS-Studio","isProfiled":false},{"relatedData":null,"id":"559","alias":"cpp","type":"collective","title":"C++","titleHtml":"C++","isProfiled":true},{"relatedData":null,"id":"11606","alias":"vs","type":"collective","title":"Visual Studio","titleHtml":"Visual Studio","isProfiled":true},{"relatedData":null,"id":"21456","alias":"win_dev","type":"collective","title":"Разработка под Windows","titleHtml":"Разработка под Windows","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EВ разговоре с Маршаллом Клоу на подкасте CppCast #300 ABI Stability была затронута достаточно давняя новость о поддержке компиляторами Visual Studio инструмента AddressSanitizer (ASan). Мы уже достаточно давно внедрили ASan в свою систему тестирования и хотим рассказать о паре интересных ошибок, которые он помог найти.\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F7ef\u002F2db\u002F210\u002F7ef2db210d677f9a8c07026d4361d3ba.png\" alt=\"0868_PVS-Studio_ASan_ru\u002Fimage2.png\"\u003E\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"pvs-studio"},{"titleHtml":"clang"},{"titleHtml":"asan"},{"titleHtml":"sanitizer"},{"titleHtml":"динамический анализ кода"}]},"580210":{"id":"580210","timePublished":"2021-09-27T12:53:02+00:00","isCorporative":false,"lang":"ru","titleHtml":"PHP Дайджест № 212 (13 – 27 сентября 2021)","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"100489","alias":"pronskiy","fullname":"Роман Пронский","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F27f\u002Fb99\u002Feb3\u002F27fb99eb3e30e3221c5839e88be02395.jpg","speciality":"PHP"},"statistics":{"commentsCount":0,"favoritesCount":4,"readingCount":1477,"score":18,"votesCount":18},"hubs":[{"relatedData":null,"id":"91","alias":"webdev","type":"collective","title":"Разработка веб-сайтов","titleHtml":"Разработка веб-сайтов","isProfiled":true},{"relatedData":null,"id":"260","alias":"php","type":"collective","title":"PHP","titleHtml":"PHP","isProfiled":true},{"relatedData":null,"id":"477","alias":"symfony","type":"collective","title":"Symfony","titleHtml":"Symfony","isProfiled":true},{"relatedData":null,"id":"9554","alias":"yii","type":"collective","title":"Yii","titleHtml":"Yii","isProfiled":true},{"relatedData":null,"id":"18812","alias":"laravel","type":"collective","title":"Laravel","titleHtml":"Laravel","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fek\u002F6r\u002Fr1\u002Fek6rr1odvyzb89tfv0lq4cmfxi4.jpeg\"\u003E\u003C\u002Fdiv\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nПодборка свежих новостей и материалов из мира PHP.\u003Cbr\u003E\r\nВышел PHP 8.1 RC2 и уже доступен первый пакет с использованием перечислений, будет сделан форк Magento, новый тип стандартов PER в дополнение к PSR, стартовала PhpStorm 2021.3 EAP, Symfony 6 будет полностью типизирован — как обновляться?\u003Cbr\u003E\r\nДля PHP 8.2 предложены новые оптимизированные структуры данных.\u003Cbr\u003E\r\nТакже в выпуске порция инструментов, полезные статьи, видео и анонсы двух митапов.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nПриятного чтения!\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"дайджест"},{"titleHtml":"php-дайджест"},{"titleHtml":"PHP"},{"titleHtml":"Symfony"},{"titleHtml":"Laravel"},{"titleHtml":"Magento"},{"titleHtml":"PHPUnit"},{"titleHtml":"PHP 8.1"},{"titleHtml":"PHP 8.2"}]}},"articlesIds":{"ARTICLES_LIST_TOP_PERIOD_DAILY":["580060","580092","580086","579542","580094","579854","578296","580124","580210","580080","580150","580090","580088","580008","579772","580196","580052","580048","580172","580084"]},"isLoading":false,"pagesCount":{"ARTICLES_LIST_TOP_PERIOD_DAILY":3},"route":{"name":"ARTICLES_LIST_TOP_PERIOD","params":{"period":"daily"},"query":{}},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":["576994","281134","48450"],"similarListRefs":{"48450":{"id":"48450","timePublished":"2009-01-06T19:46:26+00:00","isCorporative":false,"lang":"ru","titleHtml":"Microsoft Object Builder","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"46848","alias":"acerv","fullname":null,"avatarUrl":null,"speciality":null},"statistics":{"commentsCount":15,"favoritesCount":8,"readingCount":1669,"score":13,"votesCount":21},"hubs":[{"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"Всем привет! Это моя первая статья в Хабре. Столкнувшись сегодня в ленте на \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fblogs\u002Fjava\u002F48409\u002F\"\u003Eописание\u003C\u002Fa\u003E Java-фреймворков Spring и Tapestry, решил просмотреть Хабру и найти ценителей «конкурирующих» фреймворков от Microsoft – в частности Composite UI Application Block (CAB) и Unity. К моему удивлению, ничего не нашел. Увидев в коментах в статье про Java-фреймворки просьбу описать механизм инъекций зависимостей, решил начать свой цикл статей про .Net-фреймворки именно с разъяснения вопросов IoC. Итак, встречайте – краеугольный камень (в прошлом) замечательного движка CAB – Microsoft Object Builder.\u003Cbr\u002F\u003E\r\n","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"status":"published","plannedPublishTime":null,"checked":null},"281134":{"id":"281134","timePublished":"2016-04-07T08:15:37+00:00","isCorporative":true,"lang":"ru","titleHtml":"Как ONLYOFFICE помирил два поколения формул Microsoft","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"475074","alias":"xkorolx","fullname":"Олег","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F022\u002Fda1\u002F96c\u002F022da196c030523c88b4dc4e8945440a.png","speciality":"Пользователь"},"statistics":{"commentsCount":19,"favoritesCount":28,"readingCount":16682,"score":14,"votesCount":16},"hubs":[{"id":"16998","alias":"teamlab","type":"corporative","title":"Блог компании ONLYOFFICE","titleHtml":"Блог компании ONLYOFFICE","isProfiled":false},{"id":"91","alias":"webdev","type":"collective","title":"Разработка веб-сайтов","titleHtml":"Разработка веб-сайтов","isProfiled":true},{"id":"17187","alias":"canvas","type":"collective","title":"Canvas","titleHtml":"Canvas","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"Когда мы разрабатывали наши редакторы документов, мы хотели дать пользователю возможность удобно работать с любым объектом. Одним из препятствий, возникших на пути к редактированию всего и сразу и прямо в этом окне, стали формулы, а точнее — их двойственность. Студенты технических вузов сталкивались с этим явлением почти со стопроцентной вероятностью: речь идет о существовании «старых» (бинарный .doc) и «новых» (прогрессивный XML) формул в редакторах пакета MS Office.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ этой статье мы расскажем, как эта проблема решается в редакторах ONLYOFFICE. Ответ прост: К – «Конвертация». Мы конвертируем старые формулы в доступные для редактирования новые формулы и крайне довольны своей идеей. Почему мы пошли таким путем и как устроена конвертация, читайте далее.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Ffiles\u002F7b3\u002F33b\u002Fc99\u002F7b333bc99a344b7c97106a3850514367.jpg\"\u002F\u003E\u003Cbr\u002F\u003E\r\n","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null},"576994":{"id":"576994","timePublished":"2021-09-09T08:37:33+00:00","isCorporative":true,"lang":"ru","titleHtml":"Новый вид атаки нулевого дня. Теперь через документы Microsoft Office","editorVersion":"1.0","postType":"news","postLabels":[],"author":{"id":"2488151","alias":"Bright_Translate","fullname":"Дмитрий Брайт","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Ff9c\u002Fff9\u002F7d9\u002Ff9cff97d9c0677af28dab451897f88e4.jpg","speciality":"Переводчик"},"statistics":{"commentsCount":2,"favoritesCount":3,"readingCount":5778,"score":20,"votesCount":20},"hubs":[{"id":"19791","alias":"ruvds","type":"corporative","title":"Блог компании RUVDS.com","titleHtml":"Блог компании RUVDS.com","isProfiled":false},{"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true},{"id":"19681","alias":"office365dev","type":"collective","title":"Разработка для Office 365","titleHtml":"Разработка для Office 365","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fnews\u002Ft\u002F575586\u002F\"\u003E\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fz7\u002Fon\u002Fjx\u002Fz7onjxvwes1eqwnhmrrpvku2ovc.png\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fa\u003E\u003Cbr\u003E\r\nВо вторник (07.09) представители Microsoft предупредили пользователей об активно эксплуатируемой уязвимости нулевого дня, угрожающей Internet Explorer. Через эту дыру злоумышленники могут захватывать уязвимые системы Windows при помощи документов MS Office.","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null}}},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{"acerv":{"scoreStats":{"score":98,"votesCount":186},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"46848","alias":"acerv","fullname":null,"avatarUrl":null,"speciality":null}},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.670ab961.js" defer></script><script src="https://assets.habr.com/habr-web/js/chunk-f458c7c4.6e221df6.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.76acc47b.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
