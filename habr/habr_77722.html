<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Правильное приготовление и работа с ZFS под FreeBSD / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.0f7bdd8f.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.670ab961.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.01bb2993.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.76acc47b.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-f458c7c4.e48e8f79.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-f458c7c4.6e221df6.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.0f7bdd8f.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.01bb2993.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-f458c7c4.e48e8f79.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.4f7c12b4e1b1b4c0e44ef6f9f33b1f9f.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/77722\/"},"headline":"Правильное приготовление и работа с ZFS под FreeBSD","datePublished":"2009-12-09T18:55:02+03:00","dateModified":"2009-12-09T19:07:56+03:00","author":{"@type":"Person","name":"Человек с экрана телефона"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Некоторое время назад возникла задача построения достаточно вместительного массива для хранения оперативных инкрементальных бекапов. Причём тратить деньги особо...","url":"https:\/\/habr.com\/ru\/post\/77722\/#post-content-body","about":["h_nix","f_admin"],"image":["https:\/\/habrastorage.org\/getpro\/habr\/post_images\/440\/0c6\/308\/4400c63083547cb3e44ec7fdbb751624.jpg","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/cff\/19a\/9b6\/cff19a9b6d0354bbc4d1a45beda58acf.jpg"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.47.1">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Правильное приготовление и работа с ZFS под FreeBSD" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Правильное приготовление и работа с ZFS под FreeBSD" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Правильное приготовление и работа с ZFS под FreeBSD" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Некоторое время назад возникла задача построения достаточно вместительного массива для хранения оперативных инкрементальных бекапов. Причём тратить деньги особо не хотелось, а место было нужно...." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Некоторое время назад возникла задача построения достаточно вместительного массива для хранения оперативных инкрементальных бекапов. Причём тратить деньги особо не хотелось, а место было нужно...." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Некоторое время назад возникла задача построения достаточно вместительного массива для хранения оперативных инкрементальных бекапов. Причём тратить деньги особо не хотелось, а место было нужно...." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Некоторое время назад возникла задача построения достаточно вместительного массива для хранения оперативных инкрементальных бекапов. Причём тратить деньги особо не хотелось, а место было нужно...." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Некоторое время назад возникла задача построения достаточно вместительного массива для хранения оперативных инкрементальных бекапов. Причём тратить деньги особо не хотелось, а место было нужно...." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/77722/dac00e94866004a09bf7749000272029/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/77722/dac00e94866004a09bf7749000272029/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/77722/dac00e94866004a09bf7749000272029/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/77722/dac00e94866004a09bf7749000272029/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/77722/dac00e94866004a09bf7749000272029/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="77722" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2009-12-09T15:55:02.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/77722/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/77722/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/77722/dac00e94866004a09bf7749000272029/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.cee85629.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
              Как стать автором
            </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.cee85629.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.cee85629.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.cee85629.svg#pull-arrow"></use></svg></div></div> <!----> <div class="tm-page-article__body"><article class="tm-page-article__content tm-page-article__content_inner"><div class="tm-page-article__head-wrapper"><!----> <div class="tm-article-snippet tm-page-article__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/aborche/" title="aborche" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" loading="lazy" src="//habrastorage.org/r/w32/getpro/habr/avatars/a8c/cd0/1d0/a8ccd01d0d77b91ad66bd85ce8f583e5.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/aborche/" class="tm-user-info__username">
      aborche
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2009-12-09T15:55:02.000Z" title="2009-12-09, 18:55">9  декабря  2009 в 18:55</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Правильное приготовление и работа с ZFS под FreeBSD</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/nix/" class="tm-article-snippet__hubs-item-link"><span>*nix</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <!----> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml">Некоторое время назад возникла задача построения достаточно вместительного массива для хранения оперативных инкрементальных бекапов. Причём тратить деньги особо не хотелось, а место было нужно. Решение было простым и достаточно удобным. Далее много текста.<br/>
<br/>
<a name="habracut"></a><br/>
За основу было взято шасси <a href="http://supermicro.com/products/chassis/2U/825/SC825TQ-560LP.cfm">SuperChassis 825TQ-560LPB<img src="https://habrastorage.org/r/w780q1/getpro/habr/post_images/440/0c6/308/4400c63083547cb3e44ec7fdbb751624.jpg" data-src="https://habrastorage.org/getpro/habr/post_images/440/0c6/308/4400c63083547cb3e44ec7fdbb751624.jpg" data-blurred="true"/></a><br/>
<br/>
В которое было вставлено 8 дисков Hitachi 1TB и контроллер LSI Logic SAS HBA SAS3081E-R. Мы заранее планировали схему без аппаратного рейда опираясь только на возможности ZFS.<br/>
<br/>
Первая версия сервера на FreeBSD 7.2-STABLE прожила примерно около 3х месяцев, за это время отловились основные баги в виде ограничения используемой памяти vm.kmem_size и vfs.zfs.arc_max.<br/>
При недостатке выделяемой ядру памяти система падала в панику, при недостатке буферов arc_max очень сильно падала скорость работы. Для загрузки системы использовалась флешка размером 1GB, которая позволила спокойно менять версию системы простой заменой флешки с новой сборкой.<br/>
<br/>
Схема построенного массива была основана на адресации по имени диска(устройства).<br/>
Далее по тексту будут вставки из dmesg и консольных команд работы.<br/>
<blockquote><code>mpt0: &lt;LSILogic SAS/SATA Adapter> port 0x2000-0x20ff mem 0xdc210000-0xdc213fff,0xdc200000-0xdc20ffff irq 16 at device 0.0 on pci3<br/>
mpt0: [ITHREAD]<br/>
mpt0: MPI Version=1.5.20.0<br/>
mpt0: Capabilities: ( RAID-0 RAID-1E RAID-1 )<br/>
mpt0: 0 Active Volumes (2 Max)<br/>
mpt0: 0 Hidden Drive Members (14 Max)<br/>
<br/>
da0 at mpt0 bus 0 scbus0 target 0 lun 0<br/>
da0: &lt;ATA Hitachi HDT72101 A31B> Fixed Direct Access SCSI-5 device<br/>
da0: 300.000MB/s transfers<br/>
da0: Command Queueing enabled<br/>
da0: 953869MB (1953525168 512 byte sectors: 255H 63S/T 121601C)<br/>
da1 at mpt0 bus 0 scbus0 target 1 lun 0<br/>
da1: &lt;ATA Hitachi HDT72101 A31B> Fixed Direct Access SCSI-5 device<br/>
da1: 300.000MB/s transfers<br/>
da1: Command Queueing enabled<br/>
da1: 953869MB (1953525168 512 byte sectors: 255H 63S/T 121601C)<br/>
da2 at mpt0 bus 0 scbus0 target 2 lun 0<br/>
da2: &lt;ATA Hitachi HDT72101 A31B> Fixed Direct Access SCSI-5 device<br/>
da2: 300.000MB/s transfers<br/>
da2: Command Queueing enabled<br/>
da2: 953869MB (1953525168 512 byte sectors: 255H 63S/T 121601C)<br/>
da3 at mpt0 bus 0 scbus0 target 3 lun 0<br/>
da3: &lt;ATA Hitachi HDT72101 A31B> Fixed Direct Access SCSI-5 device<br/>
da3: 300.000MB/s transfers<br/>
da3: Command Queueing enabled<br/>
da3: 953869MB (1953525168 512 byte sectors: 255H 63S/T 121601C)<br/>
da4 at mpt0 bus 0 scbus0 target 4 lun 0<br/>
da4: &lt;ATA Hitachi HDT72101 A31B> Fixed Direct Access SCSI-5 device<br/>
da4: 300.000MB/s transfers<br/>
da4: Command Queueing enabled<br/>
da4: 953869MB (1953525168 512 byte sectors: 255H 63S/T 121601C)<br/>
da5 at mpt0 bus 0 scbus0 target 5 lun 0<br/>
da5: &lt;ATA Hitachi HDT72101 A31B> Fixed Direct Access SCSI-5 device<br/>
da5: 300.000MB/s transfers<br/>
da5: Command Queueing enabled<br/>
da5: 953869MB (1953525168 512 byte sectors: 255H 63S/T 121601C)<br/>
da6 at mpt0 bus 0 scbus0 target 7 lun 0<br/>
da6: &lt;ATA Hitachi HDT72101 A31B> Fixed Direct Access SCSI-5 device<br/>
da6: 300.000MB/s transfers<br/>
da6: Command Queueing enabled<br/>
da6: 953869MB (1953525168 512 byte sectors: 255H 63S/T 121601C)<br/>
da7 at mpt0 bus 0 scbus0 target 8 lun 0<br/>
da7: &lt;ATA Hitachi HDE72101 A31B> Fixed Direct Access SCSI-5 device<br/>
da7: 300.000MB/s transfers<br/>
da7: Command Queueing enabled<br/>
da7: 953869MB (1953525168 512 byte sectors: 255H 63S/T 121601C)<br/>
ugen3.2: &lt;JetFlash> at usbus3<br/>
umass0: &lt;JetFlash Mass Storage Device, class 0/0, rev 2.00/1.00, addr 2> on usbus3<br/>
umass0: SCSI over Bulk-Only; quirks = 0x0100<br/>
umass0:2:0:-1: Attached to scbus2<br/>
da8 at umass-sim0 bus 0 scbus2 target 0 lun 0<br/>
da8: &lt;JetFlash Transcend 1GB 8.07> Removable Direct Access SCSI-2 device<br/>
da8: 40.000MB/s transfers<br/>
da8: 963MB (1972224 512 byte sectors: 64H 32S/T 963C)<br/>
Trying to mount root from ufs:/dev/ufs/FBSDUSB<br/>
</code></blockquote><br/>
В принципе всё более менее понятно. Есть контроллер, есть луны, есть диски, есть имена подключенных устройств к контроллеру.<br/>
<blockquote><code><pre>
backupstorage# zpool create storage raidz da0 da1 da2 da3 da4 da5 da6 da7
backupstorage# zpool status -v
  pool: storage
 state: ONLINE
 scrub: none requested
config:

        NAME        STATE     READ WRITE CKSUM
        storage     ONLINE       0     0     0
          raidz1    ONLINE       0     0     0
            da0     ONLINE       0     0     0
            da1     ONLINE       0     0     0
            da2     ONLINE       0     0     0
            da3     ONLINE       0     0     0
            da4     ONLINE       0     0     0
            da5     ONLINE       0     0     0
            da6     ONLINE       0     0     0
            da7     ONLINE       0     0     0

errors: No known data errors
</pre></code></blockquote><br/>
<br/>
Всё работает до тех пор пока не умирает один из дисков. У меня начал осыпаться седьмой диск и контроллер по timeout выкидывал его из массива. Причём уверенности в том, что посыпался сам диск у меня не было, потому что диски были абсолютно новыми и никаким нагрузкам не подвергались.<br/>
DFT от Hitachi ошибок не находила и говорила что всё в норме, только иногда подтормаживала. MHDD нашёл много секторов с временем доступа около 500 мс, после 50 таких секторов я диск просто поменял по гарантии.<br/>
<br/>
Но диск это реально полбеды. Диск поборол, но вот проблемы пойманные при его сбоях заставили задуматься.<br/>
<br/>
<b>Проблема первая: Массив с нумерацией дисков не привязанной к лунам</b><br/>
ZFS в Solaris разрабатывалась с учётом привязки дисков к номерам контроллеров и лунам на этих контроллерах. В случае использования такой схемы учёта необходимо только заменить умерший диск и синхронизировать данные в массиве. В FreeBSD как и в Linux именование устройств обычно идёт прозрачное и не зависит от физического порта на контроллере. В этом на самом деле и заключается самая большая засада.<br/>
К примеру возьмём и вытащим из системы 5 диск, эмулируя аппаратный сбой на диске.<br/>
<blockquote><code><pre>
backupstorage# camcontrol rescan all
Re-scan of bus 0 was successful
Re-scan of bus 1 was successful
Re-scan of bus 2 was successful

mpt0: mpt_cam_event: 0x16
mpt0: mpt_cam_event: 0x12
mpt0: mpt_cam_event: 0x16
mpt0: mpt_cam_event: 0x16
mpt0: mpt_cam_event: 0x16
(da4:mpt0:0:4:0): lost device
(da4:mpt0:0:4:0): Synchronize cache failed, status == 0x4a, scsi status == 0x0
(da4:mpt0:0:4:0): removing device entry

backupstorage# zpool status -v
  pool: storage
 state: DEGRADED
 scrub: none requested
config:

        NAME        STATE     READ WRITE CKSUM
        storage     DEGRADED     0     0     0
          raidz1    DEGRADED     0     0     0
            da0     ONLINE       0     0     0
            da1     ONLINE       0     0     0
            da2     ONLINE       0     0     0
            da3     ONLINE       0     0     0
            da4     REMOVED      0     0     0
            da5     ONLINE       0     0     0
            da6     ONLINE       0     0     0
            da7     ONLINE       0     0     0
</pre></code></blockquote><br/>
Всё отлично. Контроллер увидел, что у него пропал диск и пометил его как отсутствующий.<br/>
Можно вставить новый диск и синхронизировать массив. НО если Вы перезагрузите сервер, то<br/>
вас ждёт очень интересная картина(я уберу лишнюю информацию из квотинга dmesg, чтобы не перегружать текстом экран)<br/>
<blockquote><code>da0 at mpt0 bus 0 scbus0 target 0 lun 0<br/>
da0: &lt;ATA Hitachi HDT72101 A31B> Fixed Direct Access SCSI-5 device<br/>
da0: 953869MB (1953525168 512 byte sectors: 255H 63S/T 121601C)<br/>
da1 at mpt0 bus 0 scbus0 target 1 lun 0<br/>
da1: &lt;ATA Hitachi HDT72101 A31B> Fixed Direct Access SCSI-5 device<br/>
da1: 953869MB (1953525168 512 byte sectors: 255H 63S/T 121601C)<br/>
da2 at mpt0 bus 0 scbus0 target 2 lun 0<br/>
da2: &lt;ATA Hitachi HDT72101 A31B> Fixed Direct Access SCSI-5 device<br/>
da2: 953869MB (1953525168 512 byte sectors: 255H 63S/T 121601C)<br/>
da3 at mpt0 bus 0 scbus0 target 3 lun 0<br/>
da3: &lt;ATA Hitachi HDT72101 A31B> Fixed Direct Access SCSI-5 device<br/>
da3: 953869MB (1953525168 512 byte sectors: 255H 63S/T 121601C)<br/>
da4 at mpt0 bus 0 scbus0 target 5 lun 0<br/>
da4: &lt;ATA Hitachi HDT72101 A31B> Fixed Direct Access SCSI-5 device<br/>
da4: 953869MB (1953525168 512 byte sectors: 255H 63S/T 121601C)<br/>
da5 at mpt0 bus 0 scbus0 target 7 lun 0<br/>
da5: &lt;ATA Hitachi HDT72101 A31B> Fixed Direct Access SCSI-5 device<br/>
da5: 953869MB (1953525168 512 byte sectors: 255H 63S/T 121601C)<br/>
da6 at mpt0 bus 0 scbus0 target 8 lun 0<br/>
da6: &lt;ATA Hitachi HDE72101 A31B> Fixed Direct Access SCSI-5 device<br/>
da6: 953869MB (1953525168 512 byte sectors: 255H 63S/T 121601C)<br/>
SMP: AP CPU #1 Launched!<br/>
GEOM: da0: the primary GPT table is corrupt or invalid.<br/>
GEOM: da0: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da1: the primary GPT table is corrupt or invalid.<br/>
GEOM: da1: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da2: the primary GPT table is corrupt or invalid.<br/>
GEOM: da2: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da3: the primary GPT table is corrupt or invalid.<br/>
GEOM: da3: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da4: the primary GPT table is corrupt or invalid.<br/>
GEOM: da4: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da5: the primary GPT table is corrupt or invalid.<br/>
GEOM: da5: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da6: the primary GPT table is corrupt or invalid.<br/>
GEOM: da6: using the secondary instead -- recovery strongly advised.<br/>
ugen3.2: &lt;JetFlash> at usbus3<br/>
umass0: &lt;JetFlash Mass Storage Device, class 0/0, rev 2.00/1.00, addr 2> on usbus3<br/>
umass0: SCSI over Bulk-Only; quirks = 0x0100<br/>
umass0:2:0:-1: Attached to scbus2<br/>
da7 at umass-sim0 bus 0 scbus2 target 0 lun 0<br/>
da7: &lt;JetFlash Transcend 1GB 8.07> Removable Direct Access SCSI-2 device<br/>
da7: 40.000MB/s transfers<br/>
da7: 963MB (1972224 512 byte sectors: 64H 32S/T 963C)<br/>
Trying to mount root from ufs:/dev/ufs/FBSDUSB<br/>
GEOM: da4: the primary GPT table is corrupt or invalid.<br/>
GEOM: da4: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da5: the primary GPT table is corrupt or invalid.<br/>
GEOM: da5: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da0: the primary GPT table is corrupt or invalid.<br/>
GEOM: da0: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da1: the primary GPT table is corrupt or invalid.<br/>
GEOM: da1: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da2: the primary GPT table is corrupt or invalid.<br/>
GEOM: da2: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da3: the primary GPT table is corrupt or invalid.<br/>
GEOM: da3: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da6: the primary GPT table is corrupt or invalid.<br/>
GEOM: da6: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da4: the primary GPT table is corrupt or invalid.<br/>
GEOM: da4: using the secondary instead -- recovery strongly advised.<br/>
</code></blockquote><br/>
Что мы видим?<br/>
Мы видим что по сравнению с первым дампом dmesg, устройств стало 8 вместо 9 и флешка стала da7 вместо da8. ZFS начинает материться о том, что есть проблемы с чтением GPT меток и что всё плохо.<br/>
Zpool тупо развалился на глазах, так как нумерация дисков уехала на 1 вверх, что в свою очередь вызвало потерю массивом ориентиров для работы и путанице в метках дисков.<br/>
<blockquote><code><pre>
backupstorage# zpool status -v
  pool: storage
 state: UNAVAIL
status: One or more devices could not be used because the label is missing
        or invalid.  There are insufficient replicas for the pool to continue
        functioning.
action: Destroy and re-create the pool from a backup source.
   see: http://www.sun.com/msg/ZFS-8000-5E
 scrub: none requested
config:

        NAME        STATE     READ WRITE CKSUM
        storage     UNAVAIL      0     0     0  insufficient replicas
          raidz1    UNAVAIL      0     0     0  insufficient replicas
            da0     ONLINE       0     0     0
            da1     ONLINE       0     0     0
            da2     ONLINE       0     0     0
            da3     ONLINE       0     0     0
            da4     FAULTED      0     0     0  corrupted data
            da5     FAULTED      0     0     0  corrupted data
            da6     FAULTED      0     0     0  corrupted data
            da6     ONLINE       0     0     0
</pre></code></blockquote><br/>
Обратите внимание, что у нас 2!!! диска da6. Всё это потому, что у нас есть физический диск определенный как da6 и присутствует GPT метка da6 на диске который раньше был da6. <br/>
<br/>
теперь попробуем воткнуть диск который вытащили.<br/>
<blockquote><code>backupstorage# camcontrol rescan all<br/>
Re-scan of bus 0 was successful<br/>
Re-scan of bus 1 was successful<br/>
Re-scan of bus 2 was successful<br/>
<br/>
da8 at mpt0 bus 0 scbus0 target 4 lun 0<br/>
da8: &lt;ATA Hitachi HDT72101 A31B> Fixed Direct Access SCSI-5 device<br/>
da8: 300.000MB/s transfers<br/>
da8: Command Queueing enabled<br/>
da8: 953869MB (1953525168 512 byte sectors: 255H 63S/T 121601C)<br/>
GEOM: da8: the primary GPT table is corrupt or invalid.<br/>
GEOM: da8: using the secondary instead -- recovery strongly advised.<br/>
</code></blockquote><br/>
Диск определился, но стал da8. Мы конечно же можем попробовать перестроить массив, но ни к чему хорошему это не приведёт. Поэтому просто перегружаемся.<br/>
<blockquote><code><pre>
backupstorage# zpool status -v
  pool: storage
 state: ONLINE
 scrub: none requested
config:

        NAME        STATE     READ WRITE CKSUM
        storage     ONLINE       0     0     0
          raidz1    ONLINE       0     0     0
            da0     ONLINE       0     0     0
            da1     ONLINE       0     0     0
            da2     ONLINE       0     0     0
            da3     ONLINE       0     0     0
            da4     ONLINE       0     0     0
            da5     ONLINE       0     0     0
            da6     ONLINE       0     0     0
            da7     ONLINE       0     0     0

errors: No known data errors
</pre></code></blockquote><br/>
<br/>
После перезагрузки zfs спокойно находит все диски, немного ругается в лог и продолжает работать.<br/>
<br/>
<blockquote><code>GEOM: da0: the primary GPT table is corrupt or invalid.<br/>
GEOM: da0: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da1: the primary GPT table is corrupt or invalid.<br/>
GEOM: da1: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da2: the primary GPT table is corrupt or invalid.<br/>
GEOM: da2: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da3: the primary GPT table is corrupt or invalid.<br/>
GEOM: da3: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da4: the primary GPT table is corrupt or invalid.<br/>
GEOM: da4: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da5: the primary GPT table is corrupt or invalid.<br/>
GEOM: da5: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da6: the primary GPT table is corrupt or invalid.<br/>
GEOM: da6: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da7: the primary GPT table is corrupt or invalid.<br/>
GEOM: da7: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da0: the primary GPT table is corrupt or invalid.<br/>
GEOM: da0: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da2: the primary GPT table is corrupt or invalid.<br/>
GEOM: da2: using the secondary instead -- recovery strongly advised.<br/>
GEOM: da7: the primary GPT table is corrupt or invalid.<br/>
GEOM: da7: using the secondary instead -- recovery strongly advised.<br/>
</code></blockquote><br/>
resilver проходит практически безболезненно, так как у нас не было работы с данными на сломанном массиве.<br/>
<blockquote><code><pre>
GEOM: da0: the primary GPT table is corrupt or invalid.
GEOM: da0: using the secondary instead -- recovery strongly advised.
GEOM: da3: the primary GPT table is corrupt or invalid.
GEOM: da3: using the secondary instead -- recovery strongly advised.
====================

backupstorage# zpool status -v
  pool: storage
 state: ONLINE
 scrub: resilver completed after 0h0m with 0 errors on Wed Nov 25 11:06:15 2009
config:

        NAME        STATE     READ WRITE CKSUM
        storage     ONLINE       0     0     0
          raidz1    ONLINE       0     0     0
            da0     ONLINE       0     0     0
            da1     ONLINE       0     0     0
            da2     ONLINE       0     0     0  512 resilvered
            da3     ONLINE       0     0     0  512 resilvered
            da4     ONLINE       0     0     0
            da5     ONLINE       0     0     0
            da6     ONLINE       0     0     0  512 resilvered
            da7     ONLINE       0     0     0  512 resilvered

errors: No known data errors
</pre></code></blockquote><br/>
В общем мы убедились, что такая схема не очень надёжна при автоматической нумерации дисков в контроллере. Хотя если количество дисков не меняется — их можно переставлять в произвольном порядке. Массив будет работать исправно.<br/>
<br/>
<b>Проблема вторая: geomlabel на дисках.</b><br/>
Дабы попытаться решить проблему с именованием дисков было решено попробовать пометить их метками и уже метки добавить в массив. При создании метки на диске — она пишется в конец диска, при инициализации диска система считывает метки и создаёт виртуальные устройства /dev/label/имяметки.<br/>
<blockquote><code><pre>
backupstorage# zpool create storage raidz label/disk0 label/disk1 label/disk2 label/disk3 label/disk4 label/disk5 label/disk6 label/disk7
backupstorage# zpool status -v
  pool: storage
 state: ONLINE
 scrub: none requested
config:

        NAME             STATE     READ WRITE CKSUM
        storage          ONLINE       0     0     0
          raidz1         ONLINE       0     0     0
            label/disk0  ONLINE       0     0     0
            label/disk1  ONLINE       0     0     0
            label/disk2  ONLINE       0     0     0
            label/disk3  ONLINE       0     0     0
            label/disk4  ONLINE       0     0     0
            label/disk5  ONLINE       0     0     0
            label/disk6  ONLINE       0     0     0
            label/disk7  ONLINE       0     0     0

errors: No known data errors
backupstorage# ls /dev/label/disk*
/dev/label/disk0        /dev/label/disk2        /dev/label/disk4        /dev/label/disk6
/dev/label/disk1        /dev/label/disk3        /dev/label/disk5        /dev/label/disk7
</pre></code></blockquote><br/>
Массив живёт нормально, теперь мы выдёргиваем disk1 и откладываем в сторону.<br/>
<br/>
Перегружаем сервер и смотрим в лог.<br/>
<blockquote><code><pre>
GEOM: da0: corrupt or invalid GPT detected.
GEOM: da0: GPT rejected -- may not be recoverable.
GEOM: da1: corrupt or invalid GPT detected.
GEOM: da1: GPT rejected -- may not be recoverable.
GEOM: da2: corrupt or invalid GPT detected.
GEOM: da2: GPT rejected -- may not be recoverable.
GEOM: da3: corrupt or invalid GPT detected.
GEOM: da3: GPT rejected -- may not be recoverable.
GEOM: da4: corrupt or invalid GPT detected.
GEOM: da4: GPT rejected -- may not be recoverable.
GEOM: da5: corrupt or invalid GPT detected.
GEOM: da5: GPT rejected -- may not be recoverable.
GEOM: da6: corrupt or invalid GPT detected.
GEOM: da6: GPT rejected -- may not be recoverable.
GEOM: label/disk0: corrupt or invalid GPT detected.
GEOM: label/disk0: GPT rejected -- may not be recoverable.
GEOM: label/disk2: corrupt or invalid GPT detected.
GEOM: label/disk2: GPT rejected -- may not be recoverable.
GEOM: label/disk3: corrupt or invalid GPT detected.
GEOM: label/disk3: GPT rejected -- may not be recoverable.
GEOM: label/disk4: corrupt or invalid GPT detected.
GEOM: label/disk4: GPT rejected -- may not be recoverable.
GEOM: label/disk5: corrupt or invalid GPT detected.
GEOM: label/disk5: GPT rejected -- may not be recoverable.
GEOM: label/disk6: corrupt or invalid GPT detected.
GEOM: label/disk6: GPT rejected -- may not be recoverable.
GEOM: label/disk7: corrupt or invalid GPT detected.
GEOM: label/disk7: GPT rejected -- may not be recoverable.
da7 at umass-sim0 bus 0 scbus2 target 0 lun 0
da7: &lt;JetFlash Transcend 1GB 8.07> Removable Direct Access SCSI-2 device
da7: 40.000MB/s transfers
da7: 963MB (1972224 512 byte sectors: 64H 32S/T 963C)
Trying to mount root from ufs:/dev/ufs/FBSDUSB
GEOM: da0: corrupt or invalid GPT detected.
GEOM: da0: GPT rejected -- may not be recoverable.
GEOM: da1: corrupt or invalid GPT detected.
GEOM: da1: GPT rejected -- may not be recoverable.
GEOM: label/disk2: corrupt or invalid GPT detected.
GEOM: label/disk2: GPT rejected -- may not be recoverable.
GEOM: da2: corrupt or invalid GPT detected.
GEOM: da2: GPT rejected -- may not be recoverable.
GEOM: label/disk3: corrupt or invalid GPT detected.
GEOM: label/disk3: GPT rejected -- may not be recoverable.
GEOM: da3: corrupt or invalid GPT detected.
GEOM: da3: GPT rejected -- may not be recoverable.
GEOM: label/disk4: corrupt or invalid GPT detected.
GEOM: label/disk4: GPT rejected -- may not be recoverable.
GEOM: da4: corrupt or invalid GPT detected.
GEOM: da4: GPT rejected -- may not be recoverable.
GEOM: label/disk5: corrupt or invalid GPT detected.
GEOM: label/disk5: GPT rejected -- may not be recoverable.
GEOM: da5: corrupt or invalid GPT detected.
GEOM: da5: GPT rejected -- may not be recoverable.
</pre></code></blockquote><br/>
Но при всей ругани массив на поверку оказывается живой. с живой структурой и статусом DEGRADED, что намного лучше чем в первом случае.<br/>
<blockquote><code><pre>
backupstorage# zpool status
  pool: storage
 state: DEGRADED
status: One or more devices has experienced an unrecoverable error.  An
        attempt was made to correct the error.  Applications are unaffected.
action: Determine if the device needs to be replaced, and clear the errors
        using 'zpool clear' or replace the device with 'zpool replace'.
   see: http://www.sun.com/msg/ZFS-8000-9P
 scrub: none requested
config:

        NAME             STATE     READ WRITE CKSUM
        storage          DEGRADED     0     0     0
          raidz1         DEGRADED     0     0     0
            label/disk0  ONLINE       0     0     0
            label/disk1  REMOVED      0    94     0
            label/disk2  ONLINE       0     0     0
            label/disk3  ONLINE       0     0     0
            label/disk4  ONLINE       0     0     0
            label/disk5  ONLINE       0     0     0
            label/disk6  ONLINE       0     0     0
            label/disk7  ONLINE       0     0     0

errors: No known data errors
====================
</pre></code></blockquote><br/>
Теперь мы зануляем диск который мы вытащили и вставим его обратно в систему.<br/>
Метка на диске записана в самом конце диска, поэтому штатное зануление начала диска нам ничем не поможет. придётся или нулить конец или просто диск целиком. Всё зависит от наличия у вас времени.<br/>
<blockquote><code><pre>
mpt0: mpt_cam_event: 0x16
mpt0: mpt_cam_event: 0x12
mpt0: mpt_cam_event: 0x16
da8 at mpt0 bus 0 scbus0 target 1 lun 0
da8: &lt;ATA Hitachi HDT72101 A31B> Fixed Direct Access SCSI-5 device
da8: 300.000MB/s transfers
da8: Command Queueing enabled
da8: 953869MB (1953525168 512 byte sectors: 255H 63S/T 121601C)
</pre></code></blockquote><br/>
Даём новому диску метку «disk8» и пытаемся заменить «умерший» диск новым.<br/>
<blockquote><code><pre>
backupstorage# ls /dev/label/
disk0   disk2   disk3   disk4   disk5   disk6   disk7   disk8

backupstorage# zpool replace storage label/disk1 label/disk8
cannot replace label/disk1 with label/disk8: label/disk8 is busy
backupstorage# zpool replace -f storage label/disk1 label/disk8
cannot replace label/disk1 with label/disk8: label/disk8 is busy
</pre></code></blockquote><br/>
Система отказывается менять нам диск ссылаясь на его занятость. Заменить «умерший» диск можно только прямым именем устройства. Почему так сделано, я до конца не понял. Отбрасываем затею замены меток на новом диске и пробуем просто дать метку «disk1» новому диску.<br/>
<blockquote><code><pre>
backupstorage# glabel label disk1 da8
</pre></code></blockquote><br/>
Теперь нам нужно сказать, что диск у нас вернулся в строй.<br/>
<blockquote><code><pre>
backupstorage# zpool online storage label/disk1
backupstorage# zpool status
  pool: storage
 state: ONLINE
status: One or more devices has experienced an unrecoverable error.  An
        attempt was made to correct the error.  Applications are unaffected.
action: Determine if the device needs to be replaced, and clear the errors
        using 'zpool clear' or replace the device with 'zpool replace'.
   see: http://www.sun.com/msg/ZFS-8000-9P
 scrub: resilver completed after 0h0m with 0 errors on Wed Nov 25 18:29:17 2009
config:

        NAME             STATE     READ WRITE CKSUM
        storage          ONLINE       0     0     0
          raidz1         ONLINE       0     0     0
            label/disk0  ONLINE       0     0     0  6.50K resilvered
            label/disk1  ONLINE       0    94     1  10.5K resilvered
            label/disk2  ONLINE       0     0     0  6K resilvered
            label/disk3  ONLINE       0     0     0  3.50K resilvered
            label/disk4  ONLINE       0     0     0  6.50K resilvered
            label/disk5  ONLINE       0     0     0  6.50K resilvered
            label/disk6  ONLINE       0     0     0  5.50K resilvered
            label/disk7  ONLINE       0     0     0  3K resilvered

errors: No known data errors
</pre></code></blockquote><br/>
Всё встаёт на свои места и после синхронизации можно сбросить статус пула на нормальный.<br/>
А вот тут начинается проблема. Так как метка диска сделанная glabel пишется в конец диска, то zfs в принципе не знает ничего о том, где она записана. И при полном заполнении диска перетирает эту метку. Диску в массиве присваивается физическое имя и мы возвращаемся к пункту 1 наших проблем.<br/>
<br/>
<b>Решение проблемы</b><br/>
Решение проблемы оказалось немного банальным и простым. Давным давно FreeBSD стала уметь делать GPT разделы на дисках больших объёмов. В FreeBSD 7.2 именование GPT разделов не работало и доступ к ним осуществлялся по прямому имени устройства /dev/da0p1(пример для первой партиции GPT)<br/>
В FreeBSD 8.0 в систему GPT меток было внесено изменение. И теперь GPT разделы можно именовать и обращаться к ним как к виртуальным устройствам через /dev/gpt/меткараздела.<br/>
<br/>
Всё что нам реально необходимо сделать — это проименовать разделы на дисках и собрать из них массив. Как это сделать написано в ZFS Boot Howto которое очень быстро гуглится.<br/>
<blockquote><code><pre>
backupstorage# gpart create -s GPT ad0
backupstorage# gpart add -b 34 -s 1953525101 -i 1 -t freebsd-zfs -l disk0 ad0
backupstorage# gpart show
=>        34  1953525101  da0  GPT  (932G)
          34  1953525101    1  freebsd-zfs  (932G)
backupstorage# gpart show -l
=>        34  1953525101  da0  GPT  (932G)
          34  1953525101    1  disk0  (932G)
backupstorage# ls /dev/gpt
disk0
</pre></code></blockquote><br/>
После создания GPT раздела по <b>gpart show</b> можно посмотреть где начинается и где заканчивается область данных на диске. Далее мы создаём этот раздел и даём ему метку «disk0».<br/>
Проделываем эту операцию для всех дисков в системе и собираем из полученных разделов массив.<br/>
<blockquote><code><pre>
backupstorage# zpool status -v
  pool: storage
 state: ONLINE
 scrub: none requested
config:

        NAME           STATE     READ WRITE CKSUM
        storage        ONLINE       0     0     0
          raidz1       ONLINE       0     0     0
            gpt/disk0  ONLINE       0     0     0
            gpt/disk1  ONLINE       0     0     0
            gpt/disk2  ONLINE       0     0     0
            gpt/disk3  ONLINE       0     0     0
            gpt/disk4  ONLINE       0     0     0
            gpt/disk5  ONLINE       0     0     0
            gpt/disk6  ONLINE       0     0     0
            gpt/disk7  ONLINE       0     0     0

errors: No known data errors
</pre></code></blockquote><br/>
Сервер спокойно переживает любые перезагрузки и перестановку дисков, а также их замену с той-же меткой. Скорость работы данного массива по сети достигает 70-80 мегабайт в секунду. Локальная скорость записи на массив в зависимости от заполняемости буферов доходит до 200 мегабайт в секунду.<br/>
<br/>
PS: при использовании gpt меток натолкнулся на странный глюк, что система не видела новую метку на диске, но потом это само собой прошло.<br/>
PPS: энтузиастам которые пробуют запустить FreeBSD 8.0 с флешки(если это еще не починили) — пригодится вот такой dirty hack. <br/>
<blockquote><code>Index: sys/kern/vfs_mount.c<br/>
===================================================================<br/>
RCS file: /home/ncvs/src/sys/kern/vfs_mount.c,v<br/>
retrieving revision 1.308<br/>
diff -u -r1.308 vfs_mount.c<br/>
--- sys/kern/vfs_mount.c 5 Jun 2009 14:55:22 -0000 1.308<br/>
+++ sys/kern/vfs_mount.c 29 Sep 2009 17:08:25 -0000<br/>
@@ -1645,6 +1645,9 @@<br/>
options = NULL;<br/>
+ /* NASTY HACK: wait for USB sticks to appear */<br/>
+ pause("usbhack", hz * 10);<br/>
+<br/>
root_mount_prepare();<br/>
mount_zone = uma_zcreate("Mountpoints", sizeof(struct mount),<br/>
</code></blockquote><br/>
В новом USB стеке при загрузке ядра USB устройства не всегда определяются вовремя и возникает ошибка при монтировании разделов системы.<br/>
Данный хак выставляет в системе таймаут в 10 секунд для ожидания готовности USB накопителя.<br/>
<br/>
PPPS: если будут вопросы — задавайте.<br/>
<br/>
Настройки loader.conf для машины с 2мя гигабайтами памяти.<br/>
<blockquote>vm.kmem_size=«1536M»<br/>
vm.kmem_size_max=«1536M»<br/>
vfs.zfs.arc_max=«384M»<br/>
</blockquote><br/>
<br/>
<font>© Aborche 2009</font><br/>
<img src="https://habrastorage.org/r/w780q1/getpro/habr/post_images/cff/19a/9b6/cff19a9b6d0354bbc4d1a45beda58acf.jpg" data-src="https://habrastorage.org/getpro/habr/post_images/cff/19a/9b6/cff19a9b6d0354bbc4d1a45beda58acf.jpg" data-blurred="true"/></div></div> <!----> <!----></div> <div class="tm-article-body__tags"><div class="tm-article-body__tags-links"><span class="tm-article-body__tags-title">Теги:</span> <span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BZFS%5D" class="tm-article-body__tags-item-link">ZFS</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BFreeBSD%5D" class="tm-article-body__tags-item-link">FreeBSD</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BRaid%5D" class="tm-article-body__tags-item-link">Raid</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BGPT%5D" class="tm-article-body__tags-item-link">GPT</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BGLABEL%5D" class="tm-article-body__tags-item-link">GLABEL</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BUSB%20Boot%5D" class="tm-article-body__tags-item-link">USB Boot</a></span></div> <div class="tm-article-body__tags-links"><span class="tm-article-body__tags-title">Хабы:</span> <span class="tm-article-body__tags-item"><a href="/ru/hub/nix/" class="tm-article-body__tags-item-link">
                  *nix
                </a></span></div></div></article> <div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 39: ↑36 и ↓3</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 39: ↑36 и ↓3" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+33</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <!----> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    104
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/77722/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      45
    </span></a> <!----></div> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div></div> <!----></div> <!----> <div class="tm-page-article__additional-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body"><div class="tm-article-author tm-page-article__author"><!----> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-two-column"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/aborche/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/a8c/cd0/1d0/a8ccd01d0d77b91ad66bd85ce8f583e5.jpg" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 160 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    117.2
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info"><div class="tm-user-card__title"><span class="tm-user-card__name">Человек с экрана телефона</span> <a href="/ru/users/aborche/" class="tm-user-card__nickname">
          @aborche
        </a> <!----></div> <p class="tm-user-card__short-info">IT волшебник</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-two-column"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div></div> <!----></section> <div class="tm-page-article__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/77722/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 45 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <section class="tm-block tm-block_spacing-around"><header class="tm-block__header"><h2 class="tm-block__title">Похожие публикации</h2> <!----></header> <div class="tm-block__body"><ul class="tm-article-list-block__list"><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2017-12-08T09:15:48.000Z" title="2017-12-08, 12:15">8  декабря  2017 в 12:15</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/344204/" class="tm-article-title__link"><span>Производительность mdadm raid 5,6,10 и ZFS zraid, zraid2, ZFS striped mirror</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 13: ↑9 и ↓4</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 13: ↑9 и ↓4" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+5</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">20K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    72
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/344204/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      65
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2016-01-23T14:47:25.000Z" title="2016-01-23, 17:47">23  января  2016 в 17:47</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/275751/" class="tm-article-title__link"><span>Centos 7.x USB Install Media (Добавляем Centos в Multiboot)</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 8: ↑7 и ↓1</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 8: ↑7 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+6</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">1</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    72
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/275751/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      5
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2011-07-15T21:09:57.000Z" title="2011-07-16, 01:09">16  июля  2011 в 01:09</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/124263/" class="tm-article-title__link"><span>Автоматическая установка FreeBSD 8.2-RELEASE на ZFS</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 59: ↑58 и ↓1</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 59: ↑58 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+57</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">6.3K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    82
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/124263/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      37
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li> <!----></ul></div> <!----></section> <!----> <!----> <section class="tm-block tm-block_spacing-around"><header class="tm-block__header"><h2 class="tm-block__title">Лучшие публикации за сутки</h2> <!----></header> <div class="tm-block__body"><ul class="tm-article-list-block__list"><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-27T09:00:04.000Z" title="2021-09-27, 12:00">вчера в 12:00</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/ruvds/blog/580060/" class="tm-article-title__link"><span>Арракис, который мы заслужили</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 144: ↑138 и ↓6</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 144: ↑138 и ↓6" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+132</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">22K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    39
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/ruvds/blog/580060/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      112
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-27T16:41:21.000Z" title="2021-09-27, 19:41">вчера в 19:41</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/lamptest/blog/580228/" class="tm-article-title__link"><span>Идеальная светодиодная лампа за 21 рубль</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 77: ↑75 и ↓2</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 77: ↑75 и ↓2" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+73</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">9.7K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    43
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/lamptest/blog/580228/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      25
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-27T13:03:14.000Z" title="2021-09-27, 16:03">вчера в 16:03</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/ruvds/blog/580124/" class="tm-article-title__link"><span>Электролюминесцентные индикаторы из прошлого</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 72: ↑72 и ↓0</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 72: ↑72 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+72</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">5K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    37
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/ruvds/blog/580124/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      13
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-27T12:53:02.000Z" title="2021-09-27, 15:53">вчера в 15:53</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/580210/" class="tm-article-title__link"><span>PHP Дайджест № 212 (13 – 27 сентября 2021)</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 39: ↑39 и ↓0</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 39: ↑39 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+39</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">3.5K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    14
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/580210/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      1
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-27T10:50:03.000Z" title="2021-09-27, 13:50">вчера в 13:50</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/oleg-bunin/blog/580150/" class="tm-article-title__link"><span>Топ-5 когнитивных искажений при планировании в IT</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 39: ↑38 и ↓1</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 39: ↑38 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+37</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">5.7K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    54
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/oleg-bunin/blog/580150/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      7
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li> <!----></ul></div> <!----></section> <!----> <!----></div></div></div> <div class="tm-page__sidebar"><div hl="ru" id="77722" class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/77722/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/77722/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"77722":{"id":"77722","timePublished":"2009-12-09T15:55:02+00:00","isCorporative":false,"lang":"ru","titleHtml":"Правильное приготовление и работа с ZFS под FreeBSD","leadData":{"textHtml":"Некоторое время назад возникла задача построения достаточно вместительного массива для хранения оперативных инкрементальных бекапов. Причём тратить деньги особо не хотелось, а место было нужно. Решение было простым и достаточно удобным. Далее много текста.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"editorVersion":"1.0","postType":"article","postLabels":[],"author":{"scoreStats":{"score":117.2,"votesCount":160},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"47615","alias":"aborche","fullname":"Человек с экрана телефона","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fa8c\u002Fcd0\u002F1d0\u002Fa8ccd01d0d77b91ad66bd85ce8f583e5.jpg","speciality":"IT волшебник"},"statistics":{"commentsCount":45,"favoritesCount":104,"readingCount":40842,"score":33,"votesCount":39},"hubs":[{"relatedData":null,"id":"7289","alias":"nix","type":"collective","title":"*nix","titleHtml":"*nix","isProfiled":true}],"flows":[{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EНекоторое время назад возникла задача построения достаточно вместительного массива для хранения оперативных инкрементальных бекапов. Причём тратить деньги особо не хотелось, а место было нужно. Решение было простым и достаточно удобным. Далее много текста.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\nЗа основу было взято шасси \u003Ca href=\"http:\u002F\u002Fsupermicro.com\u002Fproducts\u002Fchassis\u002F2U\u002F825\u002FSC825TQ-560LP.cfm\"\u003ESuperChassis 825TQ-560LPB\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F440\u002F0c6\u002F308\u002F4400c63083547cb3e44ec7fdbb751624.jpg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F440\u002F0c6\u002F308\u002F4400c63083547cb3e44ec7fdbb751624.jpg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ которое было вставлено 8 дисков Hitachi 1TB и контроллер LSI Logic SAS HBA SAS3081E-R. Мы заранее планировали схему без аппаратного рейда опираясь только на возможности ZFS.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПервая версия сервера на FreeBSD 7.2-STABLE прожила примерно около 3х месяцев, за это время отловились основные баги в виде ограничения используемой памяти vm.kmem_size и vfs.zfs.arc_max.\u003Cbr\u002F\u003E\r\nПри недостатке выделяемой ядру памяти система падала в панику, при недостатке буферов arc_max очень сильно падала скорость работы. Для загрузки системы использовалась флешка размером 1GB, которая позволила спокойно менять версию системы простой заменой флешки с новой сборкой.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСхема построенного массива была основана на адресации по имени диска(устройства).\u003Cbr\u002F\u003E\r\nДалее по тексту будут вставки из dmesg и консольных команд работы.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003Empt0: &lt;LSILogic SAS\u002FSATA Adapter\u003E port 0x2000-0x20ff mem 0xdc210000-0xdc213fff,0xdc200000-0xdc20ffff irq 16 at device 0.0 on pci3\u003Cbr\u002F\u003E\r\nmpt0: [ITHREAD]\u003Cbr\u002F\u003E\r\nmpt0: MPI Version=1.5.20.0\u003Cbr\u002F\u003E\r\nmpt0: Capabilities: ( RAID-0 RAID-1E RAID-1 )\u003Cbr\u002F\u003E\r\nmpt0: 0 Active Volumes (2 Max)\u003Cbr\u002F\u003E\r\nmpt0: 0 Hidden Drive Members (14 Max)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nda0 at mpt0 bus 0 scbus0 target 0 lun 0\u003Cbr\u002F\u003E\r\nda0: &lt;ATA Hitachi HDT72101 A31B\u003E Fixed Direct Access SCSI-5 device\u003Cbr\u002F\u003E\r\nda0: 300.000MB\u002Fs transfers\u003Cbr\u002F\u003E\r\nda0: Command Queueing enabled\u003Cbr\u002F\u003E\r\nda0: 953869MB (1953525168 512 byte sectors: 255H 63S\u002FT 121601C)\u003Cbr\u002F\u003E\r\nda1 at mpt0 bus 0 scbus0 target 1 lun 0\u003Cbr\u002F\u003E\r\nda1: &lt;ATA Hitachi HDT72101 A31B\u003E Fixed Direct Access SCSI-5 device\u003Cbr\u002F\u003E\r\nda1: 300.000MB\u002Fs transfers\u003Cbr\u002F\u003E\r\nda1: Command Queueing enabled\u003Cbr\u002F\u003E\r\nda1: 953869MB (1953525168 512 byte sectors: 255H 63S\u002FT 121601C)\u003Cbr\u002F\u003E\r\nda2 at mpt0 bus 0 scbus0 target 2 lun 0\u003Cbr\u002F\u003E\r\nda2: &lt;ATA Hitachi HDT72101 A31B\u003E Fixed Direct Access SCSI-5 device\u003Cbr\u002F\u003E\r\nda2: 300.000MB\u002Fs transfers\u003Cbr\u002F\u003E\r\nda2: Command Queueing enabled\u003Cbr\u002F\u003E\r\nda2: 953869MB (1953525168 512 byte sectors: 255H 63S\u002FT 121601C)\u003Cbr\u002F\u003E\r\nda3 at mpt0 bus 0 scbus0 target 3 lun 0\u003Cbr\u002F\u003E\r\nda3: &lt;ATA Hitachi HDT72101 A31B\u003E Fixed Direct Access SCSI-5 device\u003Cbr\u002F\u003E\r\nda3: 300.000MB\u002Fs transfers\u003Cbr\u002F\u003E\r\nda3: Command Queueing enabled\u003Cbr\u002F\u003E\r\nda3: 953869MB (1953525168 512 byte sectors: 255H 63S\u002FT 121601C)\u003Cbr\u002F\u003E\r\nda4 at mpt0 bus 0 scbus0 target 4 lun 0\u003Cbr\u002F\u003E\r\nda4: &lt;ATA Hitachi HDT72101 A31B\u003E Fixed Direct Access SCSI-5 device\u003Cbr\u002F\u003E\r\nda4: 300.000MB\u002Fs transfers\u003Cbr\u002F\u003E\r\nda4: Command Queueing enabled\u003Cbr\u002F\u003E\r\nda4: 953869MB (1953525168 512 byte sectors: 255H 63S\u002FT 121601C)\u003Cbr\u002F\u003E\r\nda5 at mpt0 bus 0 scbus0 target 5 lun 0\u003Cbr\u002F\u003E\r\nda5: &lt;ATA Hitachi HDT72101 A31B\u003E Fixed Direct Access SCSI-5 device\u003Cbr\u002F\u003E\r\nda5: 300.000MB\u002Fs transfers\u003Cbr\u002F\u003E\r\nda5: Command Queueing enabled\u003Cbr\u002F\u003E\r\nda5: 953869MB (1953525168 512 byte sectors: 255H 63S\u002FT 121601C)\u003Cbr\u002F\u003E\r\nda6 at mpt0 bus 0 scbus0 target 7 lun 0\u003Cbr\u002F\u003E\r\nda6: &lt;ATA Hitachi HDT72101 A31B\u003E Fixed Direct Access SCSI-5 device\u003Cbr\u002F\u003E\r\nda6: 300.000MB\u002Fs transfers\u003Cbr\u002F\u003E\r\nda6: Command Queueing enabled\u003Cbr\u002F\u003E\r\nda6: 953869MB (1953525168 512 byte sectors: 255H 63S\u002FT 121601C)\u003Cbr\u002F\u003E\r\nda7 at mpt0 bus 0 scbus0 target 8 lun 0\u003Cbr\u002F\u003E\r\nda7: &lt;ATA Hitachi HDE72101 A31B\u003E Fixed Direct Access SCSI-5 device\u003Cbr\u002F\u003E\r\nda7: 300.000MB\u002Fs transfers\u003Cbr\u002F\u003E\r\nda7: Command Queueing enabled\u003Cbr\u002F\u003E\r\nda7: 953869MB (1953525168 512 byte sectors: 255H 63S\u002FT 121601C)\u003Cbr\u002F\u003E\r\nugen3.2: &lt;JetFlash\u003E at usbus3\u003Cbr\u002F\u003E\r\numass0: &lt;JetFlash Mass Storage Device, class 0\u002F0, rev 2.00\u002F1.00, addr 2\u003E on usbus3\u003Cbr\u002F\u003E\r\numass0: SCSI over Bulk-Only; quirks = 0x0100\u003Cbr\u002F\u003E\r\numass0:2:0:-1: Attached to scbus2\u003Cbr\u002F\u003E\r\nda8 at umass-sim0 bus 0 scbus2 target 0 lun 0\u003Cbr\u002F\u003E\r\nda8: &lt;JetFlash Transcend 1GB 8.07\u003E Removable Direct Access SCSI-2 device\u003Cbr\u002F\u003E\r\nda8: 40.000MB\u002Fs transfers\u003Cbr\u002F\u003E\r\nda8: 963MB (1972224 512 byte sectors: 64H 32S\u002FT 963C)\u003Cbr\u002F\u003E\r\nTrying to mount root from ufs:\u002Fdev\u002Fufs\u002FFBSDUSB\u003Cbr\u002F\u003E\r\n\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nВ принципе всё более менее понятно. Есть контроллер, есть луны, есть диски, есть имена подключенных устройств к контроллеру.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cpre\u003E\r\nbackupstorage# zpool create storage raidz da0 da1 da2 da3 da4 da5 da6 da7\r\nbackupstorage# zpool status -v\r\n  pool: storage\r\n state: ONLINE\r\n scrub: none requested\r\nconfig:\r\n\r\n        NAME        STATE     READ WRITE CKSUM\r\n        storage     ONLINE       0     0     0\r\n          raidz1    ONLINE       0     0     0\r\n            da0     ONLINE       0     0     0\r\n            da1     ONLINE       0     0     0\r\n            da2     ONLINE       0     0     0\r\n            da3     ONLINE       0     0     0\r\n            da4     ONLINE       0     0     0\r\n            da5     ONLINE       0     0     0\r\n            da6     ONLINE       0     0     0\r\n            da7     ONLINE       0     0     0\r\n\r\nerrors: No known data errors\r\n\u003C\u002Fpre\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВсё работает до тех пор пока не умирает один из дисков. У меня начал осыпаться седьмой диск и контроллер по timeout выкидывал его из массива. Причём уверенности в том, что посыпался сам диск у меня не было, потому что диски были абсолютно новыми и никаким нагрузкам не подвергались.\u003Cbr\u002F\u003E\r\nDFT от Hitachi ошибок не находила и говорила что всё в норме, только иногда подтормаживала. MHDD нашёл много секторов с временем доступа около 500 мс, после 50 таких секторов я диск просто поменял по гарантии.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНо диск это реально полбеды. Диск поборол, но вот проблемы пойманные при его сбоях заставили задуматься.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EПроблема первая: Массив с нумерацией дисков не привязанной к лунам\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\nZFS в Solaris разрабатывалась с учётом привязки дисков к номерам контроллеров и лунам на этих контроллерах. В случае использования такой схемы учёта необходимо только заменить умерший диск и синхронизировать данные в массиве. В FreeBSD как и в Linux именование устройств обычно идёт прозрачное и не зависит от физического порта на контроллере. В этом на самом деле и заключается самая большая засада.\u003Cbr\u002F\u003E\r\nК примеру возьмём и вытащим из системы 5 диск, эмулируя аппаратный сбой на диске.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cpre\u003E\r\nbackupstorage# camcontrol rescan all\r\nRe-scan of bus 0 was successful\r\nRe-scan of bus 1 was successful\r\nRe-scan of bus 2 was successful\r\n\r\nmpt0: mpt_cam_event: 0x16\r\nmpt0: mpt_cam_event: 0x12\r\nmpt0: mpt_cam_event: 0x16\r\nmpt0: mpt_cam_event: 0x16\r\nmpt0: mpt_cam_event: 0x16\r\n(da4:mpt0:0:4:0): lost device\r\n(da4:mpt0:0:4:0): Synchronize cache failed, status == 0x4a, scsi status == 0x0\r\n(da4:mpt0:0:4:0): removing device entry\r\n\r\nbackupstorage# zpool status -v\r\n  pool: storage\r\n state: DEGRADED\r\n scrub: none requested\r\nconfig:\r\n\r\n        NAME        STATE     READ WRITE CKSUM\r\n        storage     DEGRADED     0     0     0\r\n          raidz1    DEGRADED     0     0     0\r\n            da0     ONLINE       0     0     0\r\n            da1     ONLINE       0     0     0\r\n            da2     ONLINE       0     0     0\r\n            da3     ONLINE       0     0     0\r\n            da4     REMOVED      0     0     0\r\n            da5     ONLINE       0     0     0\r\n            da6     ONLINE       0     0     0\r\n            da7     ONLINE       0     0     0\r\n\u003C\u002Fpre\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nВсё отлично. Контроллер увидел, что у него пропал диск и пометил его как отсутствующий.\u003Cbr\u002F\u003E\r\nМожно вставить новый диск и синхронизировать массив. НО если Вы перезагрузите сервер, то\u003Cbr\u002F\u003E\r\nвас ждёт очень интересная картина(я уберу лишнюю информацию из квотинга dmesg, чтобы не перегружать текстом экран)\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003Eda0 at mpt0 bus 0 scbus0 target 0 lun 0\u003Cbr\u002F\u003E\r\nda0: &lt;ATA Hitachi HDT72101 A31B\u003E Fixed Direct Access SCSI-5 device\u003Cbr\u002F\u003E\r\nda0: 953869MB (1953525168 512 byte sectors: 255H 63S\u002FT 121601C)\u003Cbr\u002F\u003E\r\nda1 at mpt0 bus 0 scbus0 target 1 lun 0\u003Cbr\u002F\u003E\r\nda1: &lt;ATA Hitachi HDT72101 A31B\u003E Fixed Direct Access SCSI-5 device\u003Cbr\u002F\u003E\r\nda1: 953869MB (1953525168 512 byte sectors: 255H 63S\u002FT 121601C)\u003Cbr\u002F\u003E\r\nda2 at mpt0 bus 0 scbus0 target 2 lun 0\u003Cbr\u002F\u003E\r\nda2: &lt;ATA Hitachi HDT72101 A31B\u003E Fixed Direct Access SCSI-5 device\u003Cbr\u002F\u003E\r\nda2: 953869MB (1953525168 512 byte sectors: 255H 63S\u002FT 121601C)\u003Cbr\u002F\u003E\r\nda3 at mpt0 bus 0 scbus0 target 3 lun 0\u003Cbr\u002F\u003E\r\nda3: &lt;ATA Hitachi HDT72101 A31B\u003E Fixed Direct Access SCSI-5 device\u003Cbr\u002F\u003E\r\nda3: 953869MB (1953525168 512 byte sectors: 255H 63S\u002FT 121601C)\u003Cbr\u002F\u003E\r\nda4 at mpt0 bus 0 scbus0 target 5 lun 0\u003Cbr\u002F\u003E\r\nda4: &lt;ATA Hitachi HDT72101 A31B\u003E Fixed Direct Access SCSI-5 device\u003Cbr\u002F\u003E\r\nda4: 953869MB (1953525168 512 byte sectors: 255H 63S\u002FT 121601C)\u003Cbr\u002F\u003E\r\nda5 at mpt0 bus 0 scbus0 target 7 lun 0\u003Cbr\u002F\u003E\r\nda5: &lt;ATA Hitachi HDT72101 A31B\u003E Fixed Direct Access SCSI-5 device\u003Cbr\u002F\u003E\r\nda5: 953869MB (1953525168 512 byte sectors: 255H 63S\u002FT 121601C)\u003Cbr\u002F\u003E\r\nda6 at mpt0 bus 0 scbus0 target 8 lun 0\u003Cbr\u002F\u003E\r\nda6: &lt;ATA Hitachi HDE72101 A31B\u003E Fixed Direct Access SCSI-5 device\u003Cbr\u002F\u003E\r\nda6: 953869MB (1953525168 512 byte sectors: 255H 63S\u002FT 121601C)\u003Cbr\u002F\u003E\r\nSMP: AP CPU #1 Launched!\u003Cbr\u002F\u003E\r\nGEOM: da0: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da0: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da1: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da1: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da2: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da2: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da3: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da3: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da4: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da4: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da5: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da5: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da6: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da6: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nugen3.2: &lt;JetFlash\u003E at usbus3\u003Cbr\u002F\u003E\r\numass0: &lt;JetFlash Mass Storage Device, class 0\u002F0, rev 2.00\u002F1.00, addr 2\u003E on usbus3\u003Cbr\u002F\u003E\r\numass0: SCSI over Bulk-Only; quirks = 0x0100\u003Cbr\u002F\u003E\r\numass0:2:0:-1: Attached to scbus2\u003Cbr\u002F\u003E\r\nda7 at umass-sim0 bus 0 scbus2 target 0 lun 0\u003Cbr\u002F\u003E\r\nda7: &lt;JetFlash Transcend 1GB 8.07\u003E Removable Direct Access SCSI-2 device\u003Cbr\u002F\u003E\r\nda7: 40.000MB\u002Fs transfers\u003Cbr\u002F\u003E\r\nda7: 963MB (1972224 512 byte sectors: 64H 32S\u002FT 963C)\u003Cbr\u002F\u003E\r\nTrying to mount root from ufs:\u002Fdev\u002Fufs\u002FFBSDUSB\u003Cbr\u002F\u003E\r\nGEOM: da4: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da4: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da5: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da5: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da0: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da0: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da1: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da1: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da2: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da2: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da3: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da3: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da6: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da6: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da4: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da4: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\n\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nЧто мы видим?\u003Cbr\u002F\u003E\r\nМы видим что по сравнению с первым дампом dmesg, устройств стало 8 вместо 9 и флешка стала da7 вместо da8. ZFS начинает материться о том, что есть проблемы с чтением GPT меток и что всё плохо.\u003Cbr\u002F\u003E\r\nZpool тупо развалился на глазах, так как нумерация дисков уехала на 1 вверх, что в свою очередь вызвало потерю массивом ориентиров для работы и путанице в метках дисков.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cpre\u003E\r\nbackupstorage# zpool status -v\r\n  pool: storage\r\n state: UNAVAIL\r\nstatus: One or more devices could not be used because the label is missing\r\n        or invalid.  There are insufficient replicas for the pool to continue\r\n        functioning.\r\naction: Destroy and re-create the pool from a backup source.\r\n   see: http:\u002F\u002Fwww.sun.com\u002Fmsg\u002FZFS-8000-5E\r\n scrub: none requested\r\nconfig:\r\n\r\n        NAME        STATE     READ WRITE CKSUM\r\n        storage     UNAVAIL      0     0     0  insufficient replicas\r\n          raidz1    UNAVAIL      0     0     0  insufficient replicas\r\n            da0     ONLINE       0     0     0\r\n            da1     ONLINE       0     0     0\r\n            da2     ONLINE       0     0     0\r\n            da3     ONLINE       0     0     0\r\n            da4     FAULTED      0     0     0  corrupted data\r\n            da5     FAULTED      0     0     0  corrupted data\r\n            da6     FAULTED      0     0     0  corrupted data\r\n            da6     ONLINE       0     0     0\r\n\u003C\u002Fpre\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nОбратите внимание, что у нас 2!!! диска da6. Всё это потому, что у нас есть физический диск определенный как da6 и присутствует GPT метка da6 на диске который раньше был da6. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nтеперь попробуем воткнуть диск который вытащили.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003Ebackupstorage# camcontrol rescan all\u003Cbr\u002F\u003E\r\nRe-scan of bus 0 was successful\u003Cbr\u002F\u003E\r\nRe-scan of bus 1 was successful\u003Cbr\u002F\u003E\r\nRe-scan of bus 2 was successful\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nda8 at mpt0 bus 0 scbus0 target 4 lun 0\u003Cbr\u002F\u003E\r\nda8: &lt;ATA Hitachi HDT72101 A31B\u003E Fixed Direct Access SCSI-5 device\u003Cbr\u002F\u003E\r\nda8: 300.000MB\u002Fs transfers\u003Cbr\u002F\u003E\r\nda8: Command Queueing enabled\u003Cbr\u002F\u003E\r\nda8: 953869MB (1953525168 512 byte sectors: 255H 63S\u002FT 121601C)\u003Cbr\u002F\u003E\r\nGEOM: da8: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da8: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\n\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nДиск определился, но стал da8. Мы конечно же можем попробовать перестроить массив, но ни к чему хорошему это не приведёт. Поэтому просто перегружаемся.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cpre\u003E\r\nbackupstorage# zpool status -v\r\n  pool: storage\r\n state: ONLINE\r\n scrub: none requested\r\nconfig:\r\n\r\n        NAME        STATE     READ WRITE CKSUM\r\n        storage     ONLINE       0     0     0\r\n          raidz1    ONLINE       0     0     0\r\n            da0     ONLINE       0     0     0\r\n            da1     ONLINE       0     0     0\r\n            da2     ONLINE       0     0     0\r\n            da3     ONLINE       0     0     0\r\n            da4     ONLINE       0     0     0\r\n            da5     ONLINE       0     0     0\r\n            da6     ONLINE       0     0     0\r\n            da7     ONLINE       0     0     0\r\n\r\nerrors: No known data errors\r\n\u003C\u002Fpre\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПосле перезагрузки zfs спокойно находит все диски, немного ругается в лог и продолжает работать.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003EGEOM: da0: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da0: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da1: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da1: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da2: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da2: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da3: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da3: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da4: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da4: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da5: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da5: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da6: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da6: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da7: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da7: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da0: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da0: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da2: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da2: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\nGEOM: da7: the primary GPT table is corrupt or invalid.\u003Cbr\u002F\u003E\r\nGEOM: da7: using the secondary instead -- recovery strongly advised.\u003Cbr\u002F\u003E\r\n\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nresilver проходит практически безболезненно, так как у нас не было работы с данными на сломанном массиве.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cpre\u003E\r\nGEOM: da0: the primary GPT table is corrupt or invalid.\r\nGEOM: da0: using the secondary instead -- recovery strongly advised.\r\nGEOM: da3: the primary GPT table is corrupt or invalid.\r\nGEOM: da3: using the secondary instead -- recovery strongly advised.\r\n====================\r\n\r\nbackupstorage# zpool status -v\r\n  pool: storage\r\n state: ONLINE\r\n scrub: resilver completed after 0h0m with 0 errors on Wed Nov 25 11:06:15 2009\r\nconfig:\r\n\r\n        NAME        STATE     READ WRITE CKSUM\r\n        storage     ONLINE       0     0     0\r\n          raidz1    ONLINE       0     0     0\r\n            da0     ONLINE       0     0     0\r\n            da1     ONLINE       0     0     0\r\n            da2     ONLINE       0     0     0  512 resilvered\r\n            da3     ONLINE       0     0     0  512 resilvered\r\n            da4     ONLINE       0     0     0\r\n            da5     ONLINE       0     0     0\r\n            da6     ONLINE       0     0     0  512 resilvered\r\n            da7     ONLINE       0     0     0  512 resilvered\r\n\r\nerrors: No known data errors\r\n\u003C\u002Fpre\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nВ общем мы убедились, что такая схема не очень надёжна при автоматической нумерации дисков в контроллере. Хотя если количество дисков не меняется — их можно переставлять в произвольном порядке. Массив будет работать исправно.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EПроблема вторая: geomlabel на дисках.\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\nДабы попытаться решить проблему с именованием дисков было решено попробовать пометить их метками и уже метки добавить в массив. При создании метки на диске — она пишется в конец диска, при инициализации диска система считывает метки и создаёт виртуальные устройства \u002Fdev\u002Flabel\u002Fимяметки.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cpre\u003E\r\nbackupstorage# zpool create storage raidz label\u002Fdisk0 label\u002Fdisk1 label\u002Fdisk2 label\u002Fdisk3 label\u002Fdisk4 label\u002Fdisk5 label\u002Fdisk6 label\u002Fdisk7\r\nbackupstorage# zpool status -v\r\n  pool: storage\r\n state: ONLINE\r\n scrub: none requested\r\nconfig:\r\n\r\n        NAME             STATE     READ WRITE CKSUM\r\n        storage          ONLINE       0     0     0\r\n          raidz1         ONLINE       0     0     0\r\n            label\u002Fdisk0  ONLINE       0     0     0\r\n            label\u002Fdisk1  ONLINE       0     0     0\r\n            label\u002Fdisk2  ONLINE       0     0     0\r\n            label\u002Fdisk3  ONLINE       0     0     0\r\n            label\u002Fdisk4  ONLINE       0     0     0\r\n            label\u002Fdisk5  ONLINE       0     0     0\r\n            label\u002Fdisk6  ONLINE       0     0     0\r\n            label\u002Fdisk7  ONLINE       0     0     0\r\n\r\nerrors: No known data errors\r\nbackupstorage# ls \u002Fdev\u002Flabel\u002Fdisk*\r\n\u002Fdev\u002Flabel\u002Fdisk0        \u002Fdev\u002Flabel\u002Fdisk2        \u002Fdev\u002Flabel\u002Fdisk4        \u002Fdev\u002Flabel\u002Fdisk6\r\n\u002Fdev\u002Flabel\u002Fdisk1        \u002Fdev\u002Flabel\u002Fdisk3        \u002Fdev\u002Flabel\u002Fdisk5        \u002Fdev\u002Flabel\u002Fdisk7\r\n\u003C\u002Fpre\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nМассив живёт нормально, теперь мы выдёргиваем disk1 и откладываем в сторону.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПерегружаем сервер и смотрим в лог.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cpre\u003E\r\nGEOM: da0: corrupt or invalid GPT detected.\r\nGEOM: da0: GPT rejected -- may not be recoverable.\r\nGEOM: da1: corrupt or invalid GPT detected.\r\nGEOM: da1: GPT rejected -- may not be recoverable.\r\nGEOM: da2: corrupt or invalid GPT detected.\r\nGEOM: da2: GPT rejected -- may not be recoverable.\r\nGEOM: da3: corrupt or invalid GPT detected.\r\nGEOM: da3: GPT rejected -- may not be recoverable.\r\nGEOM: da4: corrupt or invalid GPT detected.\r\nGEOM: da4: GPT rejected -- may not be recoverable.\r\nGEOM: da5: corrupt or invalid GPT detected.\r\nGEOM: da5: GPT rejected -- may not be recoverable.\r\nGEOM: da6: corrupt or invalid GPT detected.\r\nGEOM: da6: GPT rejected -- may not be recoverable.\r\nGEOM: label\u002Fdisk0: corrupt or invalid GPT detected.\r\nGEOM: label\u002Fdisk0: GPT rejected -- may not be recoverable.\r\nGEOM: label\u002Fdisk2: corrupt or invalid GPT detected.\r\nGEOM: label\u002Fdisk2: GPT rejected -- may not be recoverable.\r\nGEOM: label\u002Fdisk3: corrupt or invalid GPT detected.\r\nGEOM: label\u002Fdisk3: GPT rejected -- may not be recoverable.\r\nGEOM: label\u002Fdisk4: corrupt or invalid GPT detected.\r\nGEOM: label\u002Fdisk4: GPT rejected -- may not be recoverable.\r\nGEOM: label\u002Fdisk5: corrupt or invalid GPT detected.\r\nGEOM: label\u002Fdisk5: GPT rejected -- may not be recoverable.\r\nGEOM: label\u002Fdisk6: corrupt or invalid GPT detected.\r\nGEOM: label\u002Fdisk6: GPT rejected -- may not be recoverable.\r\nGEOM: label\u002Fdisk7: corrupt or invalid GPT detected.\r\nGEOM: label\u002Fdisk7: GPT rejected -- may not be recoverable.\r\nda7 at umass-sim0 bus 0 scbus2 target 0 lun 0\r\nda7: &lt;JetFlash Transcend 1GB 8.07\u003E Removable Direct Access SCSI-2 device\r\nda7: 40.000MB\u002Fs transfers\r\nda7: 963MB (1972224 512 byte sectors: 64H 32S\u002FT 963C)\r\nTrying to mount root from ufs:\u002Fdev\u002Fufs\u002FFBSDUSB\r\nGEOM: da0: corrupt or invalid GPT detected.\r\nGEOM: da0: GPT rejected -- may not be recoverable.\r\nGEOM: da1: corrupt or invalid GPT detected.\r\nGEOM: da1: GPT rejected -- may not be recoverable.\r\nGEOM: label\u002Fdisk2: corrupt or invalid GPT detected.\r\nGEOM: label\u002Fdisk2: GPT rejected -- may not be recoverable.\r\nGEOM: da2: corrupt or invalid GPT detected.\r\nGEOM: da2: GPT rejected -- may not be recoverable.\r\nGEOM: label\u002Fdisk3: corrupt or invalid GPT detected.\r\nGEOM: label\u002Fdisk3: GPT rejected -- may not be recoverable.\r\nGEOM: da3: corrupt or invalid GPT detected.\r\nGEOM: da3: GPT rejected -- may not be recoverable.\r\nGEOM: label\u002Fdisk4: corrupt or invalid GPT detected.\r\nGEOM: label\u002Fdisk4: GPT rejected -- may not be recoverable.\r\nGEOM: da4: corrupt or invalid GPT detected.\r\nGEOM: da4: GPT rejected -- may not be recoverable.\r\nGEOM: label\u002Fdisk5: corrupt or invalid GPT detected.\r\nGEOM: label\u002Fdisk5: GPT rejected -- may not be recoverable.\r\nGEOM: da5: corrupt or invalid GPT detected.\r\nGEOM: da5: GPT rejected -- may not be recoverable.\r\n\u003C\u002Fpre\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nНо при всей ругани массив на поверку оказывается живой. с живой структурой и статусом DEGRADED, что намного лучше чем в первом случае.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cpre\u003E\r\nbackupstorage# zpool status\r\n  pool: storage\r\n state: DEGRADED\r\nstatus: One or more devices has experienced an unrecoverable error.  An\r\n        attempt was made to correct the error.  Applications are unaffected.\r\naction: Determine if the device needs to be replaced, and clear the errors\r\n        using 'zpool clear' or replace the device with 'zpool replace'.\r\n   see: http:\u002F\u002Fwww.sun.com\u002Fmsg\u002FZFS-8000-9P\r\n scrub: none requested\r\nconfig:\r\n\r\n        NAME             STATE     READ WRITE CKSUM\r\n        storage          DEGRADED     0     0     0\r\n          raidz1         DEGRADED     0     0     0\r\n            label\u002Fdisk0  ONLINE       0     0     0\r\n            label\u002Fdisk1  REMOVED      0    94     0\r\n            label\u002Fdisk2  ONLINE       0     0     0\r\n            label\u002Fdisk3  ONLINE       0     0     0\r\n            label\u002Fdisk4  ONLINE       0     0     0\r\n            label\u002Fdisk5  ONLINE       0     0     0\r\n            label\u002Fdisk6  ONLINE       0     0     0\r\n            label\u002Fdisk7  ONLINE       0     0     0\r\n\r\nerrors: No known data errors\r\n====================\r\n\u003C\u002Fpre\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nТеперь мы зануляем диск который мы вытащили и вставим его обратно в систему.\u003Cbr\u002F\u003E\r\nМетка на диске записана в самом конце диска, поэтому штатное зануление начала диска нам ничем не поможет. придётся или нулить конец или просто диск целиком. Всё зависит от наличия у вас времени.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cpre\u003E\r\nmpt0: mpt_cam_event: 0x16\r\nmpt0: mpt_cam_event: 0x12\r\nmpt0: mpt_cam_event: 0x16\r\nda8 at mpt0 bus 0 scbus0 target 1 lun 0\r\nda8: &lt;ATA Hitachi HDT72101 A31B\u003E Fixed Direct Access SCSI-5 device\r\nda8: 300.000MB\u002Fs transfers\r\nda8: Command Queueing enabled\r\nda8: 953869MB (1953525168 512 byte sectors: 255H 63S\u002FT 121601C)\r\n\u003C\u002Fpre\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nДаём новому диску метку «disk8» и пытаемся заменить «умерший» диск новым.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cpre\u003E\r\nbackupstorage# ls \u002Fdev\u002Flabel\u002F\r\ndisk0   disk2   disk3   disk4   disk5   disk6   disk7   disk8\r\n\r\nbackupstorage# zpool replace storage label\u002Fdisk1 label\u002Fdisk8\r\ncannot replace label\u002Fdisk1 with label\u002Fdisk8: label\u002Fdisk8 is busy\r\nbackupstorage# zpool replace -f storage label\u002Fdisk1 label\u002Fdisk8\r\ncannot replace label\u002Fdisk1 with label\u002Fdisk8: label\u002Fdisk8 is busy\r\n\u003C\u002Fpre\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nСистема отказывается менять нам диск ссылаясь на его занятость. Заменить «умерший» диск можно только прямым именем устройства. Почему так сделано, я до конца не понял. Отбрасываем затею замены меток на новом диске и пробуем просто дать метку «disk1» новому диску.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cpre\u003E\r\nbackupstorage# glabel label disk1 da8\r\n\u003C\u002Fpre\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nТеперь нам нужно сказать, что диск у нас вернулся в строй.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cpre\u003E\r\nbackupstorage# zpool online storage label\u002Fdisk1\r\nbackupstorage# zpool status\r\n  pool: storage\r\n state: ONLINE\r\nstatus: One or more devices has experienced an unrecoverable error.  An\r\n        attempt was made to correct the error.  Applications are unaffected.\r\naction: Determine if the device needs to be replaced, and clear the errors\r\n        using 'zpool clear' or replace the device with 'zpool replace'.\r\n   see: http:\u002F\u002Fwww.sun.com\u002Fmsg\u002FZFS-8000-9P\r\n scrub: resilver completed after 0h0m with 0 errors on Wed Nov 25 18:29:17 2009\r\nconfig:\r\n\r\n        NAME             STATE     READ WRITE CKSUM\r\n        storage          ONLINE       0     0     0\r\n          raidz1         ONLINE       0     0     0\r\n            label\u002Fdisk0  ONLINE       0     0     0  6.50K resilvered\r\n            label\u002Fdisk1  ONLINE       0    94     1  10.5K resilvered\r\n            label\u002Fdisk2  ONLINE       0     0     0  6K resilvered\r\n            label\u002Fdisk3  ONLINE       0     0     0  3.50K resilvered\r\n            label\u002Fdisk4  ONLINE       0     0     0  6.50K resilvered\r\n            label\u002Fdisk5  ONLINE       0     0     0  6.50K resilvered\r\n            label\u002Fdisk6  ONLINE       0     0     0  5.50K resilvered\r\n            label\u002Fdisk7  ONLINE       0     0     0  3K resilvered\r\n\r\nerrors: No known data errors\r\n\u003C\u002Fpre\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nВсё встаёт на свои места и после синхронизации можно сбросить статус пула на нормальный.\u003Cbr\u002F\u003E\r\nА вот тут начинается проблема. Так как метка диска сделанная glabel пишется в конец диска, то zfs в принципе не знает ничего о том, где она записана. И при полном заполнении диска перетирает эту метку. Диску в массиве присваивается физическое имя и мы возвращаемся к пункту 1 наших проблем.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EРешение проблемы\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\nРешение проблемы оказалось немного банальным и простым. Давным давно FreeBSD стала уметь делать GPT разделы на дисках больших объёмов. В FreeBSD 7.2 именование GPT разделов не работало и доступ к ним осуществлялся по прямому имени устройства \u002Fdev\u002Fda0p1(пример для первой партиции GPT)\u003Cbr\u002F\u003E\r\nВ FreeBSD 8.0 в систему GPT меток было внесено изменение. И теперь GPT разделы можно именовать и обращаться к ним как к виртуальным устройствам через \u002Fdev\u002Fgpt\u002Fметкараздела.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВсё что нам реально необходимо сделать — это проименовать разделы на дисках и собрать из них массив. Как это сделать написано в ZFS Boot Howto которое очень быстро гуглится.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cpre\u003E\r\nbackupstorage# gpart create -s GPT ad0\r\nbackupstorage# gpart add -b 34 -s 1953525101 -i 1 -t freebsd-zfs -l disk0 ad0\r\nbackupstorage# gpart show\r\n=\u003E        34  1953525101  da0  GPT  (932G)\r\n          34  1953525101    1  freebsd-zfs  (932G)\r\nbackupstorage# gpart show -l\r\n=\u003E        34  1953525101  da0  GPT  (932G)\r\n          34  1953525101    1  disk0  (932G)\r\nbackupstorage# ls \u002Fdev\u002Fgpt\r\ndisk0\r\n\u003C\u002Fpre\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nПосле создания GPT раздела по \u003Cb\u003Egpart show\u003C\u002Fb\u003E можно посмотреть где начинается и где заканчивается область данных на диске. Далее мы создаём этот раздел и даём ему метку «disk0».\u003Cbr\u002F\u003E\r\nПроделываем эту операцию для всех дисков в системе и собираем из полученных разделов массив.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cpre\u003E\r\nbackupstorage# zpool status -v\r\n  pool: storage\r\n state: ONLINE\r\n scrub: none requested\r\nconfig:\r\n\r\n        NAME           STATE     READ WRITE CKSUM\r\n        storage        ONLINE       0     0     0\r\n          raidz1       ONLINE       0     0     0\r\n            gpt\u002Fdisk0  ONLINE       0     0     0\r\n            gpt\u002Fdisk1  ONLINE       0     0     0\r\n            gpt\u002Fdisk2  ONLINE       0     0     0\r\n            gpt\u002Fdisk3  ONLINE       0     0     0\r\n            gpt\u002Fdisk4  ONLINE       0     0     0\r\n            gpt\u002Fdisk5  ONLINE       0     0     0\r\n            gpt\u002Fdisk6  ONLINE       0     0     0\r\n            gpt\u002Fdisk7  ONLINE       0     0     0\r\n\r\nerrors: No known data errors\r\n\u003C\u002Fpre\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nСервер спокойно переживает любые перезагрузки и перестановку дисков, а также их замену с той-же меткой. Скорость работы данного массива по сети достигает 70-80 мегабайт в секунду. Локальная скорость записи на массив в зависимости от заполняемости буферов доходит до 200 мегабайт в секунду.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nPS: при использовании gpt меток натолкнулся на странный глюк, что система не видела новую метку на диске, но потом это само собой прошло.\u003Cbr\u002F\u003E\r\nPPS: энтузиастам которые пробуют запустить FreeBSD 8.0 с флешки(если это еще не починили) — пригодится вот такой dirty hack. \u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003EIndex: sys\u002Fkern\u002Fvfs_mount.c\u003Cbr\u002F\u003E\r\n===================================================================\u003Cbr\u002F\u003E\r\nRCS file: \u002Fhome\u002Fncvs\u002Fsrc\u002Fsys\u002Fkern\u002Fvfs_mount.c,v\u003Cbr\u002F\u003E\r\nretrieving revision 1.308\u003Cbr\u002F\u003E\r\ndiff -u -r1.308 vfs_mount.c\u003Cbr\u002F\u003E\r\n--- sys\u002Fkern\u002Fvfs_mount.c 5 Jun 2009 14:55:22 -0000 1.308\u003Cbr\u002F\u003E\r\n+++ sys\u002Fkern\u002Fvfs_mount.c 29 Sep 2009 17:08:25 -0000\u003Cbr\u002F\u003E\r\n@@ -1645,6 +1645,9 @@\u003Cbr\u002F\u003E\r\noptions = NULL;\u003Cbr\u002F\u003E\r\n+ \u002F* NASTY HACK: wait for USB sticks to appear *\u002F\u003Cbr\u002F\u003E\r\n+ pause(\"usbhack\", hz * 10);\u003Cbr\u002F\u003E\r\n+\u003Cbr\u002F\u003E\r\nroot_mount_prepare();\u003Cbr\u002F\u003E\r\nmount_zone = uma_zcreate(\"Mountpoints\", sizeof(struct mount),\u003Cbr\u002F\u003E\r\n\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nВ новом USB стеке при загрузке ядра USB устройства не всегда определяются вовремя и возникает ошибка при монтировании разделов системы.\u003Cbr\u002F\u003E\r\nДанный хак выставляет в системе таймаут в 10 секунд для ожидания готовности USB накопителя.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nPPPS: если будут вопросы — задавайте.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНастройки loader.conf для машины с 2мя гигабайтами памяти.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003Evm.kmem_size=«1536M»\u003Cbr\u002F\u003E\r\nvm.kmem_size_max=«1536M»\u003Cbr\u002F\u003E\r\nvfs.zfs.arc_max=«384M»\u003Cbr\u002F\u003E\r\n\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont\u003E© Aborche 2009\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fcff\u002F19a\u002F9b6\u002Fcff19a9b6d0354bbc4d1a45beda58acf.jpg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fcff\u002F19a\u002F9b6\u002Fcff19a9b6d0354bbc4d1a45beda58acf.jpg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"ZFS"},{"titleHtml":"FreeBSD"},{"titleHtml":"Raid"},{"titleHtml":"GPT"},{"titleHtml":"GLABEL"},{"titleHtml":"USB Boot"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F77722\u002Fdac00e94866004a09bf7749000272029\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F77722\u002Fdac00e94866004a09bf7749000272029\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F77722\\\u002F\"},\"headline\":\"Правильное приготовление и работа с ZFS под FreeBSD\",\"datePublished\":\"2009-12-09T18:55:02+03:00\",\"dateModified\":\"2009-12-09T19:07:56+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Человек с экрана телефона\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Некоторое время назад возникла задача построения достаточно вместительного массива для хранения оперативных инкрементальных бекапов. Причём тратить деньги особо...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F77722\\\u002F#post-content-body\",\"about\":[\"h_nix\",\"f_admin\"],\"image\":[\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F440\\\u002F0c6\\\u002F308\\\u002F4400c63083547cb3e44ec7fdbb751624.jpg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fcff\\\u002F19a\\\u002F9b6\\\u002Fcff19a9b6d0354bbc4d1a45beda58acf.jpg\"]}","metaDescription":"Некоторое время назад возникла задача построения достаточно вместительного массива для хранения оперативных инкрементальных бекапов. Причём тратить деньги особо не хотелось, а место было нужно....","mainImageUrl":null,"amp":false},"polls":[],"commentsEnabled":true,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false},"572164":{"id":"572164","timePublished":"2021-09-27T11:37:23+00:00","isCorporative":false,"lang":"ru","titleHtml":"Первые шаги в ОТО: прецессия орбиты Меркурия","editorVersion":"2.0","postType":"article","postLabels":[{"type":"tutorial","data":null}],"author":{"id":"1832999","alias":"Yermack","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F690\u002F140\u002F823\u002F690140823f555d03574a59d46f648d24.jpg","speciality":"Пользователь"},"statistics":{"commentsCount":2,"favoritesCount":24,"readingCount":3079,"score":18,"votesCount":18},"hubs":[{"relatedData":null,"id":"18840","alias":"julia","type":"collective","title":"Julia","titleHtml":"Julia","isProfiled":true},{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"21968","alias":"physics","type":"collective","title":"Физика","titleHtml":"Физика","isProfiled":false},{"relatedData":null,"id":"22022","alias":"astronomy","type":"collective","title":"Астрономия","titleHtml":"Астрономия","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EКогда речь заходит о теории относительности, частенько на ровном месте разрастаются споры, которые были занесены в почву непонимания и обильно удобрены мифами, недосказанностью и недостаточной математической подготовкой. Даже на лекциях от некоторых профессоров можно услышать, что детище гения Эйнштейна не имеет практической пользы, а на робкие попытки пролепетать что-то про спутниковые системы навигации они пренебрежительно отмахиваются, дескать, там все сложно и двояко. \u003C\u002Fp\u003E\u003Cp\u003EТак что совершенно естественно желание попробовать провести некоторые расчеты самолично, потрогать формулы, покрутить параметры, чтобы постепенно заложить интуицию в столь горячей теме.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa9f\u002Ff59\u002Fb65\u002Fa9ff59b65da6e8b1e6f59314aadb8e3d.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa9f\u002Ff59\u002Fb65\u002Fa9ff59b65da6e8b1e6f59314aadb8e3d.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"прецессия"},{"titleHtml":"меркурий"},{"titleHtml":"теория относительности"},{"titleHtml":"уравнения эйнштейна"},{"titleHtml":"метрики"},{"titleHtml":"спасибо scihub"},{"titleHtml":"спасибо mathpix"},{"titleHtml":"астрология_точная_наука"}]},"579772":{"id":"579772","timePublished":"2021-09-27T05:32:01+00:00","isCorporative":true,"lang":"ru","titleHtml":"Сливы процветают. Эксперт-«параноик» Майкл Баззель о защите личных данных","editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Michael Bazzell","originalUrl":"https:\u002F\u002Finteltechniques.com\u002Fblog\u002F2021\u002F07\u002F23\u002Fpersonal-ransomware-exposure\u002F"}}],"author":{"id":"2297567","alias":"SearchInform_team","fullname":null,"avatarUrl":"","speciality":"Пользователь"},"statistics":{"commentsCount":0,"favoritesCount":8,"readingCount":2406,"score":9,"votesCount":9},"hubs":[{"relatedData":null,"id":"22418","alias":"searchinform","type":"corporative","title":"Блог компании SearchInform","titleHtml":"Блог компании SearchInform","isProfiled":false},{"relatedData":null,"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EНаш очередной пост из серии «интересное на иностранном языке» – рассказ Майкла Баззеля о том, как сберечь свои персональные данные от утечек. Майкл – знаковая фигура в сфере OSINT, работал в правительстве США и ФБР, его приглашали в качестве технического эксперта в сериал «Мистер Робот», который считают достойным с точки зрения достоверности. В личной жизни эксперт придерживается настолько жестких правил в отношении информационной гигиены, что некоторые считают его «неадекватом». Так ли это – может быть несколько мнений. \u003C\u002Fp\u003E\u003Cp\u003EОдин из факторов, который убеждает в правильном подходе Майкла, – что риски обнаружить свои данные в интернете стали существенно выше, потому что шифровальщики без разбору сливают в сеть все, до чего дотягиваются при атаках на бизнес. Приводим перевод \u003Ca href=\"https:\u002F\u002Finteltechniques.com\u002Fblog\u002F2021\u002F07\u002F23\u002Fpersonal-ransomware-exposure\u002F\"\u003Eпоста Майкла Баззеля\u003C\u002Fa\u003E. \u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EАтакуют корпорации, а страдают люди\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003EБольшинство людей не задумываются о том, как их касается проблема распространения вирусов-шифровальщиков. Логика такова: речь идет о проблемах компаний, это они вынуждены платить выкуп. При чем тут, казалось бы, обычные люди?! \u003C\u002Fp\u003E\u003Cp\u003EА при том, что преступники сменили тактику: сейчас они не просто шифруют данные, но и скачивают их, выкладывают в открытый доступ, если компании не платят им выкуп. Теперь давайте подумаем, что в этих слитых базах? Множество данных о сотрудниках, клиентах, контрагентах, с которыми компания-жертва работает.\u003C\u002Fp\u003E\u003Cp\u003EХочу сразу уточнить: я это пишу не потому что выступаю за уплату выкупа. Я за то, чтобы сопротивляться избыточному сбору данных там, где это не обязательно. Мы халатно относимся к своим ПДн, раздавая их по первому требованию.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe3b\u002F3e1\u002F2c2\u002Fe3b3e12c2036d90018b804276e31ebea.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe3b\u002F3e1\u002F2c2\u002Fe3b3e12c2036d90018b804276e31ebea.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"персональные данные"},{"titleHtml":"пдн"},{"titleHtml":"сёрчинформ"},{"titleHtml":"Майкл Баззел"},{"titleHtml":"утечки информации"}]},"579854":{"id":"579854","timePublished":"2021-09-27T06:03:01+00:00","isCorporative":true,"lang":"ru","titleHtml":"Видишь уязвимости? А они есть! Наше исследование популярных CMS-систем","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2684283","alias":"Solar_Pentest","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":8,"favoritesCount":25,"readingCount":4005,"score":27,"votesCount":29},"hubs":[{"relatedData":null,"id":"20826","alias":"solarsecurity","type":"corporative","title":"Блог компании Ростелеком-Солар","titleHtml":"Блог компании Ростелеком-Солар","isProfiled":false},{"relatedData":null,"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true},{"relatedData":null,"id":"260","alias":"php","type":"collective","title":"PHP","titleHtml":"PHP","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЛьвиная доля всех работ по анализу защищенности внешнего периметра – это тестирование веб-приложений. Здесь могут быть как корпоративные решения, так и «домашние» разработки на базе различных публичных систем управления контентом (CMS). Мы всегда проводим глубокий анализ подобных решений на тестовых стендах и зачастую находим уязвимости нулевого дня. Собственно, из опыта таких проектов и родилась идея собрать исследовательскую команду и провести глубокий анализ популярных CMS-систем и различных плагинов для них. В этом посте мы поделимся результатами нашего исследования, а также продемонстрируем примеры уязвимого кода наиболее интересных, на наш взгляд, уязвимостей и примеры их эксплуатации. Конечно все эти уязвимости уже исправлены и описываются здесь с разрешения владельцев систем.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6df\u002F317\u002F4e6\u002F6df3174e60bbe263a70bcafdf9e51e6b.jpg","buttonTextHtml":"Не всё то в безопасности, что с Bug Bounty","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6df\u002F317\u002F4e6\u002F6df3174e60bbe263a70bcafdf9e51e6b.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"cms"},{"titleHtml":"уязвимости"},{"titleHtml":"уязвимости и их эксплуатация"},{"titleHtml":"уязвимость нулевого дня"}]},"579984":{"id":"579984","timePublished":"2021-09-27T15:37:51+00:00","isCorporative":true,"lang":"ru","titleHtml":"Добро пожаловать на хабрадегустацию","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2424555","alias":"anya_plotkina","fullname":"Аня Плоткина","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd4c\u002Ffcb\u002Fa37\u002Fd4cfcba3704ace3b85715c75b0db0d73.jpg","speciality":"DevRel"},"statistics":{"commentsCount":23,"favoritesCount":4,"readingCount":751,"score":7,"votesCount":21},"hubs":[{"relatedData":null,"id":"17931","alias":"skillfactory","type":"corporative","title":"Блог компании SkillFactory","titleHtml":"Блог компании SkillFactory","isProfiled":false},{"relatedData":null,"id":"161","alias":"habr","type":"collective","title":"Habr","titleHtml":"Habr","isProfiled":false}],"flows":[{"id":"4","alias":"marketing","title":"Маркетинг"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EПривет, Хабр! Меня зовут Аня Плоткина, я занимаюсь Developer Relations в команде SkillFactory, развивая сообщество авторов и менторов, которые создают наш образовательный продукт. Это будет не совсем обычный пост, а скорее воззвание к хабрасообществу, так как я верю, что на Хабре собрались самые знающие люди в IT. Если коротко: мы хотим предоставить любому члену сообщества, который обладает экспертизой, продегустировать наше обучение. \u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff28\u002F73d\u002F875\u002Ff2873d87531005948f40169432f05ebb.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff28\u002F73d\u002F875\u002Ff2873d87531005948f40169432f05ebb.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"курсы"},{"titleHtml":"edtech"},{"titleHtml":"образование"},{"titleHtml":"образование онлайн"},{"titleHtml":"образовательные ресурсы"}]},"580008":{"id":"580008","timePublished":"2021-09-27T06:30:02+00:00","isCorporative":false,"lang":"ru","titleHtml":"Летний Магнитогорск","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2614609","alias":"city_scraper","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F8f8\u002Fd6c\u002F328\u002F8f8d6c328ec3a513103b6757c2c21610.png","speciality":"Пользователь"},"statistics":{"commentsCount":6,"favoritesCount":3,"readingCount":3768,"score":14,"votesCount":20},"hubs":[{"relatedData":null,"id":"22012","alias":"Ecology","type":"collective","title":"Экология","titleHtml":"Экология","isProfiled":false},{"relatedData":null,"id":"22024","alias":"urban","type":"collective","title":"Урбанизм","titleHtml":"Урбанизм","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EМагнитогорск Челябинской области – один из крупнейших мировых центров чёрной металлургии. В России это шестой из крупнейших городов, которые не являются центрами субъектов страны. \u003C\u002Fp\u003E\u003Cp\u003EСовсем недавно город был одним из наиболее неблагополучных с точки зрения загрязнения атмосферного воздуха, но в 2021 году был зафиксирован «повышенный» уровень – то есть не «высокий» или «очень высокий», как раньше. \u003C\u002Fp\u003E\u003Cp\u003EКак этот город выглядит летом? Где и как его жители могут проводить время?\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F030\u002F0d1\u002Fcff\u002F0300d1cff2029948d33d803000331724.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F030\u002F0d1\u002Fcff\u002F0300d1cff2029948d33d803000331724.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Магнитогорск"},{"titleHtml":"промышленность"},{"titleHtml":"промышленные города"},{"titleHtml":"урбанизм\u002Fурбания"},{"titleHtml":"урбанистика"},{"titleHtml":"города России"},{"titleHtml":"города"}]},"580050":{"id":"580050","timePublished":"2021-09-27T10:23:25+00:00","isCorporative":false,"lang":"ru","titleHtml":"Один человек ответил на 85+ тысяч вопросов на Stack Overflow (24,1 ответа в день)","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"1585037","alias":"sahsAGU","fullname":"Александр Гуреев","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F43c\u002F6c7\u002F0ab\u002F43c6c70ab024d45474e6abe8db797573.jpg","speciality":"Автор"},"statistics":{"commentsCount":36,"favoritesCount":10,"readingCount":10995,"score":12,"votesCount":20},"hubs":[{"relatedData":null,"id":"260","alias":"php","type":"collective","title":"PHP","titleHtml":"PHP","isProfiled":true},{"relatedData":null,"id":"306","alias":"mysql","type":"collective","title":"MySQL","titleHtml":"MySQL","isProfiled":true},{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"594","alias":"sql","type":"collective","title":"SQL","titleHtml":"SQL","isProfiled":true},{"relatedData":null,"id":"7152","alias":"data_mining","type":"collective","title":"Data Mining","titleHtml":"Data Mining","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003E\u003Cstrong\u003EВ среднем 24,1 ответа в день (если все 365 дней в году считать рабочими) на протяжении почти 10 лет.\u003C\u002Fstrong\u003E \u003C\u002Fp\u003E\u003Cp\u003EНесколько дней назад на некоторых англоязычных ресурсах началось обсуждение одного очень необычного пользователя Stack Overflow. Его зовут Гордон Линофф (Gordon Linoff), он из Нью-Йорка, и за 9 лет и 8 месяцев своего присутствия на платформе он дал 85,201 ответов на различные вопросы, в основном связанные с SQL и дата-майнингом (цифра актуальна на 27.09.2021). \u003C\u002Fp\u003E\u003Cp\u003EЧто это за маг?\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F396\u002F5ac\u002Fef4\u002F3965acef48ae14917c514fa091f60d1a.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F396\u002F5ac\u002Fef4\u002F3965acef48ae14917c514fa091f60d1a.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"sql"},{"titleHtml":"mysql"},{"titleHtml":"stackoverflow"},{"titleHtml":"базы данных"},{"titleHtml":"дата майнинг"},{"titleHtml":"data mining"}]},"580060":{"id":"580060","timePublished":"2021-09-27T09:00:04+00:00","isCorporative":true,"lang":"ru","titleHtml":"Арракис, который мы заслужили","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"238277","alias":"Zelenyikot","fullname":"Виталий Егоров","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F22b\u002F2d7\u002F7a5\u002F22b2d77a57b687aae24784a3e53089c9.jpg","speciality":"Популяризатор космонавтики"},"statistics":{"commentsCount":112,"favoritesCount":39,"readingCount":21664,"score":132,"votesCount":144},"hubs":[{"relatedData":null,"id":"19791","alias":"ruvds","type":"corporative","title":"Блог компании RUVDS.com","titleHtml":"Блог компании RUVDS.com","isProfiled":false},{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"21962","alias":"space","type":"collective","title":"Космонавтика","titleHtml":"Космонавтика","isProfiled":false},{"relatedData":null,"id":"21984","alias":"sci-fi","type":"collective","title":"Научная фантастика","titleHtml":"Научная фантастика","isProfiled":false},{"relatedData":null,"id":"22014","alias":"futurenow","type":"collective","title":"Будущее здесь","titleHtml":"Будущее здесь","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F580060\u002F\"\u003E\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fk0\u002Fds\u002Fy5\u002Fk0dsy5npxclyjdytiroqga7-leu.jpeg\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fa\u003E\u003Cbr\u003E\r\nВо вселенной писателя-фантаста Фрэнка Герберта, Дюна, она же Арракис &mdash; это пустынная и маловодная планета с двумя лунами. По сюжету, она находится за пределами Солнечной системы, но если мы захотим поискать ближайшую схожую параллель,&nbsp;то больше всего подходит планета Марс. Предлагаю воспользоваться возможностями, которые даёт современная космонавтика, и совершить воображаемую прогулку на нашу Дюну.\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Марс"},{"titleHtml":"Дюна"},{"titleHtml":"MRO"},{"titleHtml":"Curiosity"},{"titleHtml":"марсоход"},{"titleHtml":"ruvds_статьи"}]},"580124":{"id":"580124","timePublished":"2021-09-27T13:03:14+00:00","isCorporative":true,"lang":"ru","titleHtml":"Электролюминесцентные индикаторы из прошлого","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"146371","alias":"radiolok","fullname":"Артем Кашканов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fa46\u002Fc6a\u002F151\u002Fa46c6a15193f7c0cac79d2736b107358.jpg","speciality":"Релейно-декатронный маньяк"},"statistics":{"commentsCount":13,"favoritesCount":37,"readingCount":4951,"score":72,"votesCount":72},"hubs":[{"relatedData":null,"id":"19791","alias":"ruvds","type":"corporative","title":"Блог компании RUVDS.com","titleHtml":"Блог компании RUVDS.com","isProfiled":false},{"relatedData":null,"id":"21484","alias":"electronics","type":"collective","title":"Производство и разработка электроники","titleHtml":"Производство и разработка электроники","isProfiled":true},{"relatedData":null,"id":"21906","alias":"history","type":"collective","title":"История IT","titleHtml":"История IT","isProfiled":false},{"relatedData":null,"id":"21930","alias":"antikvariat","type":"collective","title":"Старое железо","titleHtml":"Старое железо","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"Сегодня речь пойдёт об электролюминесцентных индикаторах. Но, не о тех, которые окружают вас повсюду и к которым вы привыкли, а о других — получивших огромную популярность в 60-е годы прошлого века, и так же стремительно канувших в небытие. Заодно запущу свою коллекцию индикаторов, как серийно выпускавшихся, так и уникальных опытных и даже — лабораторных образцов.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F523004\u002F\"\u003E\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F94e\u002F51f\u002F459\u002F94e51f459ae59c9d2fe6c448cb07bcca.gif\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fa\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Индикатор"},{"titleHtml":"электролюминесцентность"},{"titleHtml":"ruvds_статьи"}]},"580150":{"id":"580150","timePublished":"2021-09-27T10:50:03+00:00","isCorporative":true,"lang":"ru","titleHtml":"Топ-5 когнитивных искажений при планировании в IT","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2794469","alias":"KM_QA","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":7,"favoritesCount":54,"readingCount":5726,"score":37,"votesCount":39},"hubs":[{"relatedData":null,"id":"14332","alias":"oleg-bunin","type":"corporative","title":"Блог компании Конференции Олега Бунина (Онтико)","titleHtml":"Блог компании Конференции Олега Бунина (Онтико)","isProfiled":false},{"relatedData":null,"id":"19583","alias":"dev_management","type":"collective","title":"Управление разработкой","titleHtml":"Управление разработкой","isProfiled":true},{"relatedData":null,"id":"20736","alias":"hr_management","type":"collective","title":"Управление персоналом","titleHtml":"Управление персоналом","isProfiled":true},{"relatedData":null,"id":"20754","alias":"tech_events","type":"collective","title":"Конференции","titleHtml":"Конференции","isProfiled":false},{"relatedData":null,"id":"21990","alias":"brain","type":"collective","title":"Мозг","titleHtml":"Мозг","isProfiled":false}],"flows":[{"id":"3","alias":"management","title":"Менеджмент"},{"id":"4","alias":"marketing","title":"Маркетинг"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЭта статья подходит для тимлидов и их подопечных, а также для всех, кто оценивает проекты и задачи. Я расскажу, как и почему мы делаем ошибки из-за когнитивных искажений. Попадаем в них мы почти все, просто потому что мы живые люди. И на примере одного дня из жизни тимлида я хочу показать, в какие искажения чаще всего влетают в IT, и&nbsp; — самое полезное&nbsp; —&nbsp; как из них можно выходить.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EЗамечу, что искать когнитивные искажения стоит, в первую очередь, у себя, а не у коллег. \u003C\u002Fstrong\u003EИ что рассказывать про искажения намного проще, чем не влетать в их на практике, однако, если этому научиться, то в перспективе это изрядно окупается, потому что экономит и время, и деньги, помогая и нам, и команде.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb78\u002F76f\u002F001\u002Fb7876f0010e85c328462a735df0b76e8.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb78\u002F76f\u002F001\u002Fb7876f0010e85c328462a735df0b76e8.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"когнитивные искажения"},{"titleHtml":"нейрофизиология"},{"titleHtml":"мозг"},{"titleHtml":"психология"},{"titleHtml":"тимлидство"},{"titleHtml":"тимлид"},{"titleHtml":"управление людьми"},{"titleHtml":"управление проектами и командой"},{"titleHtml":"управление командой"},{"titleHtml":"управление персоналом"}]},"580164":{"id":"580164","timePublished":"2021-09-27T11:17:58+00:00","isCorporative":true,"lang":"ru","titleHtml":"Измеряем производительность String.format() в Java","editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"@cowtowncoder","originalUrl":"https:\u002F\u002Fcowtowncoder.medium.com\u002Fmeasuring-performance-of-java-string-format-or-lack-thereof-2e1c6a13362c"}}],"author":{"id":"2571061","alias":"GolovinDS","fullname":"Дмитрий Головин","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd27\u002Fccd\u002F743\u002Fd27ccd743d8bccbf1a885e5dadaa7ffe.jpg","speciality":"Контент-маркетолог"},"statistics":{"commentsCount":0,"favoritesCount":16,"readingCount":1701,"score":9,"votesCount":11},"hubs":[{"relatedData":null,"id":"21052","alias":"otus","type":"corporative","title":"Блог компании OTUS","titleHtml":"Блог компании OTUS","isProfiled":false},{"relatedData":null,"id":"4","alias":"hi","type":"collective","title":"Высокая производительность","titleHtml":"Высокая производительность","isProfiled":true},{"relatedData":null,"id":"375","alias":"java","type":"collective","title":"Java","titleHtml":"Java","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЯ раньше считал, что JDK в целом хорошо оптимизирована, и если в JDK есть простой способ решения какой-то задачи, то он вполне подойдет для большинства ситуаций и будет работать хорошо.\u003C\u002Fp\u003E\u003Cp\u003EНо я обнаружил, что иногда некоторые классы или методы работают на удивление плохо. Знание таких аномалий полезно при работе с требовательным к производительности кодом.\u003C\u002Fp\u003E\u003Cp\u003EВ этом посте рассмотрим один из подобных кейсов: поразительно низкая производительность \u003Ccode\u003EString.format()\u003C\u002Fcode\u003E при простой конкатенации строк.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fed4\u002F612\u002F7ef\u002Fed46127ef6d1b8f8d650482dfd335220.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fed4\u002F612\u002F7ef\u002Fed46127ef6d1b8f8d650482dfd335220.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"java"},{"titleHtml":"performance"},{"titleHtml":"jdk"}]},"580166":{"id":"580166","timePublished":"2021-09-27T11:22:03+00:00","isCorporative":false,"lang":"ru","titleHtml":"Новости из жизни Haiku за август-сентябрь 2021","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"375413","alias":"petr97","fullname":"Ахламов Петр","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fadf\u002F830\u002F79c\u002Fadf83079c33fd56935b929935559572a.jpg","speciality":"Пользователь"},"statistics":{"commentsCount":2,"favoritesCount":3,"readingCount":1700,"score":8,"votesCount":8},"hubs":[{"relatedData":null,"id":"144","alias":"open_source","type":"collective","title":"Open source","titleHtml":"Open source","isProfiled":true},{"relatedData":null,"id":"559","alias":"cpp","type":"collective","title":"C++","titleHtml":"C++","isProfiled":true},{"relatedData":null,"id":"7330","alias":"qt_software","type":"collective","title":"Qt","titleHtml":"Qt","isProfiled":true},{"relatedData":null,"id":"21918","alias":"soft","type":"collective","title":"Софт","titleHtml":"Софт","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЗдравствуйте, дорогие друзья. Продолжаю Вас знакомить на Хабре с новостями проекта Haiku.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F877\u002Fa0f\u002Fc9c\u002F877a0fc9c92663d8cd2acc965493dacc.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F877\u002Fa0f\u002Fc9c\u002F877a0fc9c92663d8cd2acc965493dacc.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Haiku"},{"titleHtml":"Intel"},{"titleHtml":"VESA"},{"titleHtml":"RISC-V"},{"titleHtml":"Веб-камера"},{"titleHtml":"Превью"},{"titleHtml":"Куба"},{"titleHtml":"Wine"},{"titleHtml":"Менеджер окон"}]},"580172":{"id":"580172","timePublished":"2021-09-27T11:45:49+00:00","isCorporative":true,"lang":"ru","titleHtml":"Небинарный ngIf*","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"1050218","alias":"Waterplea","fullname":"Александр Инкин","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fa70\u002F569\u002Ff31\u002Fa70569f31346559ce2b8b875e7f97480.jpg","speciality":"Google Developer Expert | Angular"},"statistics":{"commentsCount":1,"favoritesCount":12,"readingCount":920,"score":15,"votesCount":15},"hubs":[{"relatedData":null,"id":"17420","alias":"tinkoff","type":"corporative","title":"Блог компании TINKOFF","titleHtml":"Блог компании TINKOFF","isProfiled":false},{"relatedData":null,"id":"91","alias":"webdev","type":"collective","title":"Разработка веб-сайтов","titleHtml":"Разработка веб-сайтов","isProfiled":true},{"relatedData":null,"id":"18109","alias":"angular","type":"collective","title":"Angular","titleHtml":"Angular","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EВам когда-нибудь хотелось отобразить состояние загрузки, пока \u003Ccode\u003EngIf\u003C\u002Fcode\u003E ждет ответа от \u003Ccode\u003Easync\u003C\u002Fcode\u003E-пайпа? Или, может, вы мечтали передать в \u003Ccode\u003EngFor\u003C\u002Fcode\u003E шаблон для пустого массива? Возможно, вы бросили это, потому что вам не хотелось реализовывать базовую логику этих директив самому. На самом деле в этом нет нужды! Один и тот же селектор может подцепить несколько директив, что позволяет расширить функциональность встроенных директив дополнительной логикой.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F846\u002F786\u002F3e2\u002F8467863e2df65db32cb31f4b16c822ef.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F846\u002F786\u002F3e2\u002F8467863e2df65db32cb31f4b16c822ef.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"template"},{"titleHtml":"directive"},{"titleHtml":"angular"},{"titleHtml":"structural"}]},"580194":{"id":"580194","timePublished":"2021-09-27T12:36:12+00:00","isCorporative":true,"lang":"ru","titleHtml":"Сотрудники на карте: отвечаем на 10 важных вопросов о трекинге","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"1254716","alias":"Axelus","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F118\u002Fc4f\u002F08f\u002F118c4f08ffa66438ad6be22e205d563d.png","speciality":"Разработчик"},"statistics":{"commentsCount":0,"favoritesCount":7,"readingCount":1064,"score":13,"votesCount":15},"hubs":[{"relatedData":null,"id":"20758","alias":"regionsoft","type":"corporative","title":"Блог компании RegionSoft","titleHtml":"Блог компании RegionSoft","isProfiled":false},{"relatedData":null,"id":"6398","alias":"it-infrastructure","type":"collective","title":"IT-инфраструктура","titleHtml":"IT-инфраструктура","isProfiled":true},{"relatedData":null,"id":"12365","alias":"saas","type":"collective","title":"SaaS \u002F S+S","titleHtml":"SaaS \u002F S+S","isProfiled":true},{"relatedData":null,"id":"17783","alias":"geo","type":"collective","title":"Геоинформационные сервисы","titleHtml":"Геоинформационные сервисы","isProfiled":true},{"relatedData":null,"id":"20736","alias":"hr_management","type":"collective","title":"Управление персоналом","titleHtml":"Управление персоналом","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"3","alias":"management","title":"Менеджмент"},{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЛюбой контроль сотрудников — опасный и болезненный вопрос, особенно в небольших компаниях. Часто в дружеские и открытые отношения компании не вписывается ни одна из форм контроля, рассчитывать можно только на доверие. Но пресловутый ковид и здесь внёс свои коррективы: расширение удалённой работы, увеличение штата мобильных сотрудников, частичная занятость пополнили ряды полевых сисадминов, аутсорсеров поддержки и остальных «разъездных» работников. Увы, люди разные и вслед за приятными плодами и бонусами удалёнки пришли негативные истории про поведение курьеров, опоздания и откровенные нарушения сотрудников на территории клиентов, неявки на работу или к заказчику и т.д. С этим столкнулись и ритейл, и ИТ, и любая сфера с мобильными сотрудниками. Очень хочется верить в лучшее, но без минимального контроля можно просто потерять бизнес — и тогда пострадают коллеги нерадивых сотрудников.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe4a\u002F5b9\u002Fa9d\u002Fe4a5b9a9d62c342fa897f4531ec9301b.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe4a\u002F5b9\u002Fa9d\u002Fe4a5b9a9d62c342fa897f4531ec9301b.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"geomonitor"},{"titleHtml":"геолокация"},{"titleHtml":"геозона"},{"titleHtml":"трекинг"}]},"580196":{"id":"580196","timePublished":"2021-09-27T12:28:15+00:00","isCorporative":true,"lang":"ru","titleHtml":"Зачем нужен динамический анализ кода, на примере проекта PVS-Studio","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"2302295","alias":"MrROBUST","fullname":"Алексей Говоров","avatarUrl":"","speciality":"Пользователь"},"statistics":{"commentsCount":0,"favoritesCount":3,"readingCount":681,"score":9,"votesCount":9},"hubs":[{"relatedData":null,"id":"18095","alias":"pvs-studio","type":"corporative","title":"Блог компании PVS-Studio","titleHtml":"Блог компании PVS-Studio","isProfiled":false},{"relatedData":null,"id":"559","alias":"cpp","type":"collective","title":"C++","titleHtml":"C++","isProfiled":true},{"relatedData":null,"id":"11606","alias":"vs","type":"collective","title":"Visual Studio","titleHtml":"Visual Studio","isProfiled":true},{"relatedData":null,"id":"21456","alias":"win_dev","type":"collective","title":"Разработка под Windows","titleHtml":"Разработка под Windows","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EВ разговоре с Маршаллом Клоу на подкасте CppCast #300 ABI Stability была затронута достаточно давняя новость о поддержке компиляторами Visual Studio инструмента AddressSanitizer (ASan). Мы уже достаточно давно внедрили ASan в свою систему тестирования и хотим рассказать о паре интересных ошибок, которые он помог найти.\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F7ef\u002F2db\u002F210\u002F7ef2db210d677f9a8c07026d4361d3ba.png\" alt=\"0868_PVS-Studio_ASan_ru\u002Fimage2.png\"\u003E\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"pvs-studio"},{"titleHtml":"clang"},{"titleHtml":"asan"},{"titleHtml":"sanitizer"},{"titleHtml":"динамический анализ кода"}]},"580204":{"id":"580204","timePublished":"2021-09-27T12:31:54+00:00","isCorporative":false,"lang":"ru","titleHtml":"Почему using namespace std; это плохо","editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"sbi, Greg Hewgill","originalUrl":"https:\u002F\u002Fstackoverflow.com\u002Fquestions\u002F1452721\u002Fwhy-is-using-namespace-std-considered-bad-practice"}}],"author":{"id":"936030","alias":"F0iL","fullname":"K. just K.","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fbcd\u002F9c7\u002F270\u002Fbcd9c7270c0727e164ac404a7f929971.jpg","speciality":"Разработчик"},"statistics":{"commentsCount":12,"favoritesCount":10,"readingCount":4542,"score":12,"votesCount":20},"hubs":[{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"524","alias":"complete_code","type":"collective","title":"Совершенный код","titleHtml":"Совершенный код","isProfiled":true},{"relatedData":null,"id":"559","alias":"cpp","type":"collective","title":"C++","titleHtml":"C++","isProfiled":true},{"relatedData":null,"id":"17188","alias":"compilers","type":"collective","title":"Компиляторы","titleHtml":"Компиляторы","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EТо, что написано ниже, для многих квалифицированных C++ разработчиков будет прекрасно известной и очевидной вещью, но тем не менее, я периодически встречаю using namespace std; в коде различных проектов, а недавно в \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F579998\" rel=\"noopener noreferrer nofollow\"\u003Eнашумевшей статье про впечатления от высшего образования\u003C\u002Fa\u003E было упомянуто, что студентов так учат писать код в вузах, поэтому давайте повторим очевидное еще раз.\u003C\u002Fp\u003E\u003Cp\u003EИтак... многие слышали, что \u003Cstrong\u003Eusing namespace std;\u003C\u002Fstrong\u003E в C++ считается плохой практикой. Касательно недопустимости использования using namespace в header-файлах вопросов обычно не возникает, если мы хоть немного понимаем, как работает препроцессор компилятора: .hpp-файлы при использовании директивы #include вставляются в код \"как есть\", и соответственно using автоматически распространится на все затронутые  .hpp- и .cpp-файлы, если файл с ним был заинклюден хоть в одном звене цепочки (на одном из сайтов это метко обозвали как \"заболевание, передающеемя половым путем\"). Но вот про .cpp-файлы все не так очевидно, так что давайте еще раз разберем, что же именно здесь не так.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F662\u002F8a9\u002Fe33\u002F6628a9e3322ab1dbca4e4976098da83d.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F662\u002F8a9\u002Fe33\u002F6628a9e3322ab1dbca4e4976098da83d.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"с++"},{"titleHtml":"namespace"},{"titleHtml":"namespaces"},{"titleHtml":"best practices"},{"titleHtml":"антипаттерны"}]},"580206":{"id":"580206","timePublished":"2021-09-27T12:51:03+00:00","isCorporative":false,"lang":"ru","titleHtml":"МТС отказался от скрытых мобильных подписок?","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2467147","alias":"Plusodin","fullname":"Владимир","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F343\u002Fb77\u002Fd12\u002F343b77d12f047368849a9880276f936e.jpg","speciality":"Пользователь"},"statistics":{"commentsCount":11,"favoritesCount":4,"readingCount":4884,"score":14,"votesCount":14},"hubs":[{"relatedData":null,"id":"22008","alias":"cellular","type":"collective","title":"Сотовая связь","titleHtml":"Сотовая связь","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EПривет, Хабр!\u003C\u002Fp\u003E\u003Cp\u003EНу что, подходит к концу первый сезон сериала «О скрытых мобильных подписках и операторах связи». Предыдущие три серии: \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F550448\u002F\" rel=\"noopener noreferrer nofollow\"\u003EМегафон\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F563260\u002F\" rel=\"noopener noreferrer nofollow\"\u003EБилайн\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F571256\u002F\" rel=\"noopener noreferrer nofollow\"\u003ETele2\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cp\u003EНу и вишенка на этом торте – МТС.\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"мтс"},{"titleHtml":"мобильные подписки"},{"titleHtml":"подписки"},{"titleHtml":"оператор связи"},{"titleHtml":"теле2"},{"titleHtml":"мегафон"},{"titleHtml":"билайн"}]},"580208":{"id":"580208","timePublished":"2021-09-27T12:52:27+00:00","isCorporative":false,"lang":"ru","titleHtml":"Основная проблема образования","editorVersion":"2.0","postType":"article","postLabels":[{"type":"recovery","data":null}],"author":{"id":"2270142","alias":"Chronicler","fullname":"Пушиз де Хрониклер","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Faa3\u002F149\u002Fdb0\u002Faa3149db0de5f6c071dfade7285fcb99.jpg","speciality":"Исследователь ближнего заполярья, почетный манул"},"statistics":{"commentsCount":14,"favoritesCount":14,"readingCount":2416,"score":8,"votesCount":20},"hubs":[{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"17189","alias":"itstandarts","type":"collective","title":"IT-стандарты","titleHtml":"IT-стандарты","isProfiled":true},{"relatedData":null,"id":"20682","alias":"pm","type":"collective","title":"Управление проектами","titleHtml":"Управление проектами","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"3","alias":"management","title":"Менеджмент"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EНа днях на Хабре появилась \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F579998\u002F\" rel=\"noopener noreferrer nofollow\"\u003Eкритическая статья\u003C\u002Fa\u003E о бакалавриате, что называется \"из первых уст\", от очередного первохода. Статья далеко не лишена смысла, однако главная проблема не была в ней затронута. А заключается она вовсе не в обилии посторонних дисциплин и даже не в том, что в учебных заведениях так мало разъясняют суровую конкретику жизни \"научиться штамповать JavaScript сайты за месяц\".  Да, эти проблемы присутствуют, наряду с плохой подготовкой педагогов и отношением к студентам, но не они на корню обесценивают нынешнее образование.\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Что же на самом деле не так?","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"программирование"},{"titleHtml":"образование"},{"titleHtml":"курсы не нужны"},{"titleHtml":"вуз"}]},"580210":{"id":"580210","timePublished":"2021-09-27T12:53:02+00:00","isCorporative":false,"lang":"ru","titleHtml":"PHP Дайджест № 212 (13 – 27 сентября 2021)","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"100489","alias":"pronskiy","fullname":"Роман Пронский","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F27f\u002Fb99\u002Feb3\u002F27fb99eb3e30e3221c5839e88be02395.jpg","speciality":"PHP"},"statistics":{"commentsCount":1,"favoritesCount":14,"readingCount":3546,"score":39,"votesCount":39},"hubs":[{"relatedData":null,"id":"91","alias":"webdev","type":"collective","title":"Разработка веб-сайтов","titleHtml":"Разработка веб-сайтов","isProfiled":true},{"relatedData":null,"id":"260","alias":"php","type":"collective","title":"PHP","titleHtml":"PHP","isProfiled":true},{"relatedData":null,"id":"477","alias":"symfony","type":"collective","title":"Symfony","titleHtml":"Symfony","isProfiled":true},{"relatedData":null,"id":"9554","alias":"yii","type":"collective","title":"Yii","titleHtml":"Yii","isProfiled":true},{"relatedData":null,"id":"18812","alias":"laravel","type":"collective","title":"Laravel","titleHtml":"Laravel","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fek\u002F6r\u002Fr1\u002Fek6rr1odvyzb89tfv0lq4cmfxi4.jpeg\"\u003E\u003C\u002Fdiv\u003E\u003Cbr\u003E\r\nПодборка свежих новостей и материалов из мира PHP.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nВышел PHP 8.1 RC2 и уже доступен первый пакет с использованием перечислений, будет сделан форк Magento, новый тип стандартов PER в дополнение к PSR, стартовала PhpStorm 2021.3 EAP, Symfony 6 будет полностью типизирован — как обновляться?\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nДля PHP 8.2 предложены новые оптимизированные структуры данных.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nТакже в выпуске порция инструментов, полезные статьи, видео и анонсы двух митапов.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nПриятного чтения!\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"дайджест"},{"titleHtml":"php-дайджест"},{"titleHtml":"PHP"},{"titleHtml":"Symfony"},{"titleHtml":"Laravel"},{"titleHtml":"Magento"},{"titleHtml":"PHPUnit"},{"titleHtml":"PHP 8.1"},{"titleHtml":"PHP 8.2"}]},"580228":{"id":"580228","timePublished":"2021-09-27T16:41:21+00:00","isCorporative":true,"lang":"ru","titleHtml":"Идеальная светодиодная лампа за 21 рубль","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"108988","alias":"AlexeyNadezhin","fullname":"Алексей Надежин","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Ffdc\u002F3ac\u002F9a2\u002Ffdc3ac9a2dc0107cc956f1bd0cf5fc2b.jpg","speciality":"Блогер"},"statistics":{"commentsCount":25,"favoritesCount":43,"readingCount":9738,"score":73,"votesCount":77},"hubs":[{"relatedData":null,"id":"21646","alias":"lamptest","type":"corporative","title":"Блог компании LampTest","titleHtml":"Блог компании LampTest","isProfiled":false},{"relatedData":null,"id":"21894","alias":"gadgets","type":"collective","title":"Гаджеты","titleHtml":"Гаджеты","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"Удивительно осознавать, что достаточно сложное электронное устройство, которым является светодиодная лампочка, может стоить 21 рубль. \u003Cbr\u003E\r\n\u003Cbr\u003E\r\nЕщё сложнее поверить, что эта лампочка безукоризненна по всем параметрам.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F20f\u002F849\u002Ffcd\u002F20f849fcd6a3891f506676fc87223bdf.jpg\"\u003E\u003C\u002Fdiv\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"led"},{"titleHtml":"светодиодные лампы"},{"titleHtml":"тест"}]},"580304":{"id":"580304","timePublished":"2021-09-27T18:31:25+00:00","isCorporative":true,"lang":"ru","titleHtml":"Как сделать 248MP фотографию Солнца","editorVersion":"1.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Simon Tang","originalUrl":"https:\u002F\u002Fpetapixel.com\u002F2021\u002F09\u002F15\u002Fa-closer-look-how-i-created-a-248mp-photo-of-the-sun\u002F"}}],"author":{"id":"2192534","alias":"Itelma","fullname":"T-800","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fc3a\u002Fd1e\u002F43d\u002Fc3ad1e43d500046c3228c9494b510912.jpg","speciality":"Пользователь"},"statistics":{"commentsCount":4,"favoritesCount":4,"readingCount":1274,"score":13,"votesCount":13},"hubs":[{"relatedData":null,"id":"22356","alias":"itelma","type":"corporative","title":"Блог компании НПП ИТЭЛМА","titleHtml":"Блог компании НПП ИТЭЛМА","isProfiled":false},{"relatedData":null,"id":"17175","alias":"image_processing","type":"collective","title":"Обработка изображений","titleHtml":"Обработка изображений","isProfiled":true},{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"21932","alias":"photo","type":"collective","title":"Фототехника","titleHtml":"Фототехника","isProfiled":false},{"relatedData":null,"id":"22022","alias":"astronomy","type":"collective","title":"Астрономия","titleHtml":"Астрономия","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fe02\u002F643\u002Fa55\u002Fe02643a550e20aa10c366e20956e4b40.jpg\" alt=\"image\"\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Ci\u003EЭто изображение диска нашего Солнца создано с помощью большого рефракторного (линзового) телескопа и высокоскоростной монохромной CMOS-камеры.\u003C\u002Fi\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nКаждый день над нашими головами висит большой шар света. Он там всегда, и никто не обращает на него внимания. Разумеется, мы не советуем вам долго смотреть на него и при этом ослепнуть, тем не менее, наука дала нам возможность смотреть прямо на солнце совершенно безопасно.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nПоскольку техника стала более доступной, обычный человек может заглянуть в многочисленные слои Солнца с помощью специального оборудования, которое может купить в любом хорошем магазине телескопов.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nВ этой статье мы подробно рассмотрим слой, известный как хромосфера: область Солнца, видимая в оранжево-красном спектре. При помощи специального фильтра это устройство блокирует весь нежелательный свет, пропуская при этом определенный диапазон частот, который нас интересует.\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"обработка изображений"},{"titleHtml":"фототехника"}]}},"articlesIds":{"ARTICLES_LIST_TOP_PERIOD_DAILY":["580060","580228","580124","580210","580150","579854","572164","580172","580206","580008","580304","580194","580204","580050","580196","580164","579772","580208","580166","579984"]},"isLoading":false,"pagesCount":{"ARTICLES_LIST_TOP_PERIOD_DAILY":3},"route":{"name":"ARTICLES_LIST_TOP_PERIOD","params":{"period":"daily"},"query":{}},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":["344204","275751","124263"],"similarListRefs":{"124263":{"id":"124263","timePublished":"2011-07-15T21:09:57+00:00","isCorporative":false,"lang":"ru","titleHtml":"Автоматическая установка FreeBSD 8.2-RELEASE на ZFS","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"54678","alias":"pharao","fullname":"Otto Schnider","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F3a7\u002Fbd5\u002F854\u002F3a7bd5854644caac31530d3900c9e37f.png","speciality":"Администратор"},"statistics":{"commentsCount":37,"favoritesCount":82,"readingCount":6332,"score":57,"votesCount":59},"hubs":[{"id":"7289","alias":"nix","type":"collective","title":"*nix","titleHtml":"*nix","isProfiled":true}],"flows":[{"id":"6","alias":"admin","title":"Администрирование","titleHtml":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fstorage1\u002F9fc287c3\u002F02d09299\u002Fc2e23346\u002Ffc0a145a.png\" align=\"left\"\u002F\u003E Все мы знаем что \u003Cs\u003Eвремя от времени\u003C\u002Fs\u003E очень редко, практически никогда, но возникает ситуация, при которой внеплановый reset или сбой питания сервера FreeBSD приводит к остановке загрузки с настойчивым требованием запустить fsck от руки. Бывает, сервер соскучился, админ давно его не навещал, а может полнолуние какое, но данное явление в природе встречается. Пришла пора, думаю, переезжать на ZFS — народ рекомендует, стадию бета теста давно прошла, дисковое пространство зря не пропадает, и… в ZFS отсутствует потребность в утилите fsck для проверки целостности файловой системы(!). Проштудировав маны, wiki, лиссяру, пришел к выводу что надо кое-где рашпилем проточить, причесать, лакирнуть и пойдет в массы. Действительно, процесс, по сравнению со стандартным sysinstall, несколько затруднен, но зато быстр как никогда — 2 минуты и сервер с корневым разделом на ZFS готов.\u003Cbr\u002F\u003E\r\n","imageUrl":null,"buttonTextHtml":"Ну и как это сделать?","image":null},"status":"published","plannedPublishTime":null,"checked":null},"275751":{"id":"275751","timePublished":"2016-01-23T14:47:25+00:00","isCorporative":false,"lang":"ru","titleHtml":"Centos 7.x USB Install Media (Добавляем Centos в Multiboot)","editorVersion":"1.0","postType":"article","postLabels":[{"type":"tutorial","data":null}],"author":{"id":"321873","alias":"MagicGTS","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F2a7\u002Fbff\u002Fc96\u002F2a7bffc96d6ae54b4060163315005715.jpg","speciality":"Сисадмин Linux (RHCE), Windows (MCSE), Mikrotik"},"statistics":{"commentsCount":5,"favoritesCount":72,"readingCount":1,"score":6,"votesCount":8},"hubs":[{"id":"36","alias":"linux","type":"collective","title":"Настройка Linux","titleHtml":"Настройка Linux","isProfiled":true},{"id":"221","alias":"sys_admin","type":"collective","title":"Системное администрирование","titleHtml":"Системное администрирование","isProfiled":true}],"flows":[{"id":"6","alias":"admin","title":"Администрирование","titleHtml":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"Как бывало здорово, берешь образ CentOS 6.x, выдергиваешь из него куски, и пихаешь все это на USB флешку, по соседству с другими системами.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНо, начиная с Centos 7, сделать это стало немного сложнее, и единственным официальным способом стала запись образа на прямую на носитель (с потерей всего что на нем уже есть).\u003Cbr\u002F\u003E\r\nНо, применив немножко смекалки, я смог решить эту проблему, прошу под кат:\u003Cbr\u002F\u003E\r\n","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null},"344204":{"id":"344204","timePublished":"2017-12-08T09:15:48+00:00","isCorporative":false,"lang":"ru","titleHtml":"Производительность mdadm raid 5,6,10 и ZFS zraid, zraid2, ZFS striped mirror","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"62081","alias":"SyCraft","fullname":"Aleksey Zhadan","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F99f\u002F85b\u002Fdab\u002F99f85bdab402c47fa78cf610a363be96.jpg","speciality":"Хостинг и системная инженерия"},"statistics":{"commentsCount":65,"favoritesCount":72,"readingCount":20369,"score":5,"votesCount":13},"hubs":[{"id":"4","alias":"hi","type":"collective","title":"Высокая производительность","titleHtml":"Высокая производительность","isProfiled":true},{"id":"36","alias":"linux","type":"collective","title":"Настройка Linux","titleHtml":"Настройка Linux","isProfiled":true},{"id":"221","alias":"sys_admin","type":"collective","title":"Системное администрирование","titleHtml":"Системное администрирование","isProfiled":true},{"id":"6398","alias":"it-infrastructure","type":"collective","title":"IT-инфраструктура","titleHtml":"IT-инфраструктура","isProfiled":true},{"id":"7289","alias":"nix","type":"collective","title":"*nix","titleHtml":"*nix","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"},{"id":"6","alias":"admin","title":"Администрирование","titleHtml":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"\u003Cb\u003EТестируем производительность ZFS и mdadm+ext4 на SSD Sandisk CloudSpeed\u003Cbr\u003E\r\nдля выбора технологии создания локального дискового массива.\u003C\u002Fb\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cb\u003EЦель данного тестирования\u003C\u002Fb\u003E — выяснить, с какой реальной скоростью смогут работать виртуальные машины в raw файловых образах, если разместить их на 4-х производительных SSD-дисках. Тестирование будет производится в 32 потока, чтобы приблизительно создать условия работы реального гипервизора. \u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fdfd\u002F5ff\u002F72a\u002Fdfd5ff72ad78b1644ebc8e22bab21a67.jpg\" alt=\"image\"\u003E\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше →","image":null},"status":"published","plannedPublishTime":null,"checked":null}}},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{"aborche":{"scoreStats":{"score":117.2,"votesCount":160},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"47615","alias":"aborche","fullname":"Человек с экрана телефона","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fa8c\u002Fcd0\u002F1d0\u002Fa8ccd01d0d77b91ad66bd85ce8f583e5.jpg","speciality":"IT волшебник"}},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.670ab961.js" defer></script><script src="https://assets.habr.com/habr-web/js/chunk-f458c7c4.6e221df6.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.76acc47b.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
