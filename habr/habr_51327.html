<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Система разделения прав доступа в веб-приложении / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.0f7bdd8f.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.670ab961.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.01bb2993.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.76acc47b.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-f458c7c4.e48e8f79.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-f458c7c4.6e221df6.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.0f7bdd8f.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.01bb2993.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-f458c7c4.e48e8f79.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.4f7c12b4e1b1b4c0e44ef6f9f33b1f9f.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/51327\/"},"headline":"Система разделения прав доступа в веб-приложении","datePublished":"2009-02-07T15:27:06+03:00","dateModified":"2009-02-12T15:31:27+03:00","author":{"@type":"Person","name":"l2k"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"В этой статье мы пройдём с вами полный цикл от идеи, проектирования БД, написания PHP-Кода, и завершающей оптимизации. Постараюсь рассказать обо всем, как можно...","url":"https:\/\/habr.com\/ru\/post\/51327\/#post-content-body","about":["h_webdev","f_develop"],"image":["https:\/\/habr.com\/share\/publication\/51327\/7a73189dda8c11917e453be8eeb8192f\/"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.47.1">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Система разделения прав доступа в веб-приложении" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Система разделения прав доступа в веб-приложении" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Система разделения прав доступа в веб-приложении" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="В этой статье мы пройдём с вами полный цикл от идеи, проектирования БД, написания PHP-Кода, и завершающей оптимизации. Постараюсь рассказать обо всем, как можно проще. Использовать для примеров буду..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="В этой статье мы пройдём с вами полный цикл от идеи, проектирования БД, написания PHP-Кода, и завершающей оптимизации. Постараюсь рассказать обо всем, как можно проще. Использовать для примеров буду..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="В этой статье мы пройдём с вами полный цикл от идеи, проектирования БД, написания PHP-Кода, и завершающей оптимизации. Постараюсь рассказать обо всем, как можно проще. Использовать для примеров буду..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="В этой статье мы пройдём с вами полный цикл от идеи, проектирования БД, написания PHP-Кода, и завершающей оптимизации. Постараюсь рассказать обо всем, как можно проще. Использовать для примеров буду..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="В этой статье мы пройдём с вами полный цикл от идеи, проектирования БД, написания PHP-Кода, и завершающей оптимизации. Постараюсь рассказать обо всем, как можно проще. Использовать для примеров буду..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/51327/7a73189dda8c11917e453be8eeb8192f/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/51327/7a73189dda8c11917e453be8eeb8192f/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/51327/7a73189dda8c11917e453be8eeb8192f/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/51327/7a73189dda8c11917e453be8eeb8192f/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/51327/7a73189dda8c11917e453be8eeb8192f/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="51327" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2009-02-07T12:27:06.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/51327/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/51327/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/51327/7a73189dda8c11917e453be8eeb8192f/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.cee85629.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
              Как стать автором
            </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.cee85629.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.cee85629.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.cee85629.svg#pull-arrow"></use></svg></div></div> <!----> <div class="tm-page-article__body"><article class="tm-page-article__content tm-page-article__content_inner"><div class="tm-page-article__head-wrapper"><!----> <div class="tm-article-snippet tm-page-article__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/l2k/" title="l2k" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" loading="lazy" src="//habrastorage.org/r/w32/getpro/habr/avatars/bf6/784/f3c/bf6784f3c323091e91f5deba0ae6641d.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/l2k/" class="tm-user-info__username">
      l2k
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2009-02-07T12:27:06.000Z" title="2009-02-07, 15:27">7  февраля  2009 в 15:27</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Система разделения прав доступа в веб-приложении</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/webdev/" class="tm-article-snippet__hubs-item-link"><span>Разработка веб-сайтов</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <!----> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml">В этой статье мы пройдём с вами полный цикл от идеи, проектирования БД, написания PHP-Кода, и завершающей оптимизации. Постараюсь рассказать обо всем, как можно проще. Использовать для примеров буду PHP и Mysql. Заодно потренирую новичков :).<br/>
<br/>
В этой статье я коснусь вопросов:<br/>
  1. Идея ACL<br/>
  2. Проектирование БД<br/>
  3. Нормализация БД<br/>
  4. Рефакторинг кода<br/>
  5. Оптимизация рабочего кода<br/>
<br/>
Статья является ответом на <a href="http://habrahabr.ru/blogs/about_cms/51231/">Бинарное распределение прав доступа в CMS</a>. Пока автором пишется практическая часть, я хочу предоставить мой вариант, который я использую довольно давно.<br/>
То, что я сейчас расскажу, похоже на <a href="http://ru.wikipedia.org/wiki/ACL">ACL</a>.<br/>
<br/>
<a name="habracut"></a><h3>Упрощенное описание идеи</h3><br/>
Права доступа принадлежат ко всем объектам, к которым необходимо их применять.<br/>
Если рассматривать пример простой страницы новостей (которую мы с вами здесь напишем), то права доступа должны иметь:<br/>
  1) Основная страница новостей — глобальные права доступа, означающие «создание новой новости», «модерирование новостей», «просмотр самой страницы».<br/>
  2) Каждая новость — возможности «редактировать автором новости» или «не оставлять комментарии».<br/>
<br/>
Система прав доступа состоит из:<br/>
<strong>{Group}+{Actions}</strong> или <strong>{Group}-{Actions}</strong><br/>
<br/>
<strong>Group</strong> — это набор имен, которые из себя представляют:<br/>
  1) Права конкретного пользователя (например 'User1', 'User2'...). Например используется для личных сообщений, к которым этот пользователь имеет доступ или для допуска редактирования только его сообщений на сайте.<br/>
  2) Группы приватных страниц (или групп пользователей), к которым необходимо дать права на определенные действия. (например, администраторами, супермодераторами и др.)<br/>
  3) Дополнительные свойства. (Например, флаг — переключатель режимов)<br/>
<br/>
<strong>Action</strong> — набор действий, которые пользователи с имеющимся {Group} могут делать. В нашей системе новостей можно использовать:<br/>
  N — добавлять новую тему<br/>
  D — удалять тему<br/>
  E — редактировать тему<br/>
  V — видеть тему<br/>
  C — оставлять комментарий<br/>
  B — удалять комментарий<br/>
<br/>
<strong>±</strong> означает давать пользователю с такими правами или не давать (приоритетно) доступ к действию. Например: Users+VC, Users-C = Users+V.<br/>
<br/>
Теперь рассмотрим пример прав доступа, для простого сайта новостей:<br/>
Объект MainNewsPage:<br/>
  Users+VC, Moderator+NEDB, Admin+NEDB<br/>
 Объект NewsMessage:<br/>
   User1+ED (в принципе не нужно, если добавлять могут только модераторы)<br/>
   Users-C (можно использовать, если нет желания оставлять комментарии)<br/>
  Объект NewsComment:<br/>
    User2+B (а здесь необходимо, так как комментарий может оставлять любой пользователь, но не все могут удалять их)<br/>
<br/>
<h3>Упростим систему, для понимания идеи компьютером</h3><br/>
Для начала, определим Базы данных, для работы с правами объектов.<br/>
<br/>
Так как у нас получается список нескольких прав, то можно начать с такой БД:<br/>
  <strong>RightsID</strong> — идентификатор списка прав.<br/>
  <strong>Group</strong> — название группы.<br/>
  <strong>Sign</strong> — знак группы.<br/>
  <strong>Action</strong> — название действия.<br/>
<br/>
Пример1 (права для MainNewsPage):<br/>
<table>
<tr>
<th>ID</th>
<th>RightsID</th>
<th>Group</th>
<th>Sign</th>
<th>Action</th>
</tr>
<tr>
<td>1</td>
<td>100</td>
<td>Users</td>
<td>+</td>
<td>V</td>
</tr>
<tr>
<td>2</td>
<td>100</td>
<td>Users</td>
<td>+</td>
<td>C</td>
</tr>
<tr>
<td>3</td>
<td>100</td>
<td>Moderator</td>
<td>+</td>
<td>N</td>
</tr>
<tr>
<td>4</td>
<td>100</td>
<td>Moderator</td>
<td>+</td>
<td>E</td>
</tr>
<tr>
<td>5</td>
<td>100</td>
<td>Moderator</td>
<td>+</td>
<td>D</td>
</tr>
<tr>
<td>6</td>
<td>100</td>
<td>Moderator</td>
<td>+</td>
<td>B</td>
</tr>
<tr>
<td>7</td>
<td>100</td>
<td>Admin</td>
<td>+</td>
<td>N</td>
</tr>
<tr>
<td>8</td>
<td>100</td>
<td>Admin</td>
<td>+</td>
<td>E</td>
</tr>
<tr>
<td>9</td>
<td>100</td>
<td>Admin</td>
<td>+</td>
<td>D</td>
</tr>
<tr>
<td>10</td>
<td>100</td>
<td>Admin</td>
<td>+</td>
<td>B</td>
</tr>
</table><br/>
Пример2 (права для NewsMessage):<br/>
<table>
<tr>
<th>ID</th>
<th>RightsID</th>
<th>Group</th>
<th>Sign</th>
<th>Action</th>
</tr>
<tr>
<td>11</td>
<td>101</td>
<td>User1</td>
<td>+</td>
<td>D</td>
</tr>
<tr>
<td>12</td>
<td>101</td>
<td>User1</td>
<td>+</td>
<td>E</td>
</tr>
<tr>
<td>13</td>
<td>101</td>
<td>Users</td>
<td>-</td>
<td>C</td>
</tr>
</table><br/>
Теперь, если мы запросим <font color="black"><font color="#0000ff">SELECT</font> * <font color="#0000ff">FROM</font> `rights_action` <font color="#0000ff">WHERE</font> `RightsID`=100</font>, то получим все права, которые принадлежат необходимому нам объекту.<br/>
<br/>
<h3>Нормализация таблиц. Добавляем права пользователя.</h3><br/>
У пользователя, который будет просматривать нашу страницу, должны иметься права, которыми он владеет. Исходя из них, мы сможем знать, имеет ли пользователь право на действие.<br/>
Например: User2, Users, Moderator.<br/>
<br/>
Для этого определим таблицу прав:<br/>
  <strong>RightsID</strong> — идентификатор списка прав пользователя.<br/>
  <strong>Group</strong> — название группы, в которой пользователь состоит.<br/>
<br/>
Пример:<br/>
<table>
<tr>
<th>ID</th>
<th>RightsID</th>
<th>Group</th>
</tr>
<tr>
<td>1</td>
<td>10</td>
<td>User1</td>
</tr>
<tr>
<td>2</td>
<td>10</td>
<td>Users</td>
</tr>
<tr>
<td>3</td>
<td>10</td>
<td>Moderator</td>
</tr>
</table>Теперь приведем обе наши таблицы к <a href="http://habrahabr.ru/blogs/development/45707/">нормальной форме</a>. (<a href="http://ru.wikipedia.org/wiki/Нормальная_форма">wiki</a>)<br/>
<br/>
В результате ID ключи отсеются, и мы получим 3 таблицы:<br/>
<strong><i>rights_action</i></strong> — права объекта<br/>
  <strong>RightsID: integer (pk)</strong> — идентификатор списка прав.<br/>
  <strong>GroupID: integer (pk)</strong> — название группы.<br/>
  <strong>Sign: tinyint (1)</strong> — знак группы.<br/>
  <strong>Action: enum (pk)</strong> — название действия.<br/>
<strong><i>rights_group</i></strong> — права пользователя<br/>
  <strong>RightsID: integer (pk)</strong> — идентификатор списка прав пользователя.<br/>
  <strong>GroupID: integer (pk)</strong> — идентификатор группы, в которой пользователь состоит.<br/>
<strong><i>rights_names</i></strong> — названия групп<br/>
  <strong>GroupID: integer (pk)</strong> — идентификатор группы.<br/>
  <strong>name</strong> — название группы.<br/>
<br/>
Primary key 'ID' мы заменили на другие ключи, состоящие в некоторых случаях из нескольких полей таблицы.<br/>
Знак группы теперь 0 (+) или 1 (-), потому что так нам будет проще к ним обращаться.<br/>
Идентификатор GroupID прямиком указывает на название в rights_names.<br/>
На самом деле таблица <strong><i>rights_names</i></strong> является в нашем случае аппендиксом, который не будет использоваться для выявления прав на необходимое действие. Эта таблица теперь служит лишь для «Очеловечивания» результатов.<br/>
<br/>
Пример, что у нас получилось:<br/>
<table>
<tr>
<th colspan="4">rights_name</th>
</tr>
<tr>
<th>GroupID</th>
<th>name</th>
</tr>
<tr>
<td>10</td>
<td>Users</td>
</tr>
<tr>
<td>11</td>
<td>Moderator</td>
</tr>
<tr>
<td>12</td>
<td>Admin</td>
</tr>
<tr>
<td>1001</td>
<td>User1</td>
</tr>
<tr>
<td>1002</td>
<td>User2</td>
</tr>
<tr>
<td>1003</td>
<td>User3</td>
</tr>
<tr>
<th colspan="4">rights_group</th>
</tr>
<tr>
<th>RightsID</th>
<th>GroupID</th>
</tr>
<tr>
<td>1</td>
<td>1001</td>
</tr>
<tr>
<td>1</td>
<td>10</td>
</tr>
<tr>
<td>1</td>
<td>11</td>
</tr>
<tr>
<th colspan="4">rights_action</th>
</tr>
<tr>
<th>RightsID</th>
<th>GroupID</th>
<th>Sign</th>
<th>Action</th>
</tr>
<tr>
<td>100</td>
<td>10</td>
<td> 0</td>
<td>message_view</td>
</tr>
<tr>
<td>100</td>
<td>10</td>
<td> 0</td>
<td>comment_create</td>
</tr>
<tr>
<td>100</td>
<td>11</td>
<td> 0</td>
<td>message_create</td>
</tr>
<tr>
<td>100</td>
<td>11</td>
<td> 0</td>
<td>message_edit</td>
</tr>
<tr>
<td>100</td>
<td>11</td>
<td> 0</td>
<td>message_delete</td>
</tr>
<tr>
<td>100</td>
<td>11</td>
<td> 0</td>
<td>comment_delete</td>
</tr>
<tr>
<td>100</td>
<td>12</td>
<td> 0</td>
<td>message_create</td>
</tr>
<tr>
<td>100</td>
<td>12</td>
<td> 0</td>
<td>message_edit</td>
</tr>
<tr>
<td>100</td>
<td>12</td>
<td> 0</td>
<td>message_delete</td>
</tr>
<tr>
<td>100</td>
<td>12</td>
<td> 0</td>
<td>comment_delete</td>
</tr>
<tr>
<td>101</td>
<td>1001</td>
<td> 0</td>
<td>message_edit</td>
</tr>
<tr>
<td>101</td>
<td>1001</td>
<td> 0</td>
<td>message_delete</td>
</tr>
<tr>
<td>101</td>
<td>10</td>
<td> 1</td>
<td>comment_create</td>
</tr>
</table>Стало менее наглядно — для человека. Компьютеру, который оперирует числами, стало намного проще обращаться с таблицами.<br/>
Теперь мы можем добавить права любому объекту в таблице на любое действие. Действия теперь записываются в таблицу в виде ENUM (поле 'action'), что упрощает понимание и разработку проектов. Само действие как string и может называться, как угодно.<br/>
<br/>
`rights_group` должна быть привязана к пользователям и говорит о тех правах, которыми пользователь обладает.<br/>
`rights_action` должна быть привязана к объектам и говорит, с каким правами, какие действия пользователь может выполнять.<br/>
<br/>
Например (для нашего сайта новостей):<br/>
<table>
<tr>
<th colspan="5">news_page (параметры основной страница с новостями)</th>
</tr>
<tr>
<th>PageID</th>
<th>RightsID</th>
<th>Name</th>
</tr>
<tr>
<td>1</td>
<td>100</td>
<td>Страница новостей</td>
</tr>
<tr>
<th colspan="5">news_message (сообщения на странице новостей)</th>
</tr>
<tr>
<th>MsgID</th>
<th>PageID</th>
<th>RightsID</th>
<th>Header</th>
<th>Message</th>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>101</td>
<td>Ура, мы на главной!!!</td>
<td>Но это только начало, дальше, когда мы ближе подберемся к администрации хабра...</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
<td>101</td>
<td>Новости последней недели</td>
<td>Не смотря на наше стройное шествие по главной, похоже планы обломались...</td>
</tr>
</table><br/>
<h3>Разработка библиотеки работы с правами доступа</h3><br/>
А сейчас мы посмотрим, что необходимо, чтобы эти таблицы собрать воедино и произвести необходимую нам выборку результатов.<br/>
<br/>
Алгоритм наших действий при проверке возможности действия:<br/>
  1) Берем из БД выборку прав по необходимому объекту (объектам). (100: Users+VC, Moderator+NEDB, Admin+NEDB)<br/>
  2) Выбираем необходимые нам действия (action). (V: Users+V)<br/>
  3) Сравниваем права доступа пользователя и нашей выборки. (Users, User1 &lt;=> Users+)<br/>
  4) Если результатов нет, тогда возвращаем false.<br/>
  5) Если результаты есть, но состоят из минусов, возвращаем false. Иначе возвращаем true.<br/>
<br/>
Ещё один момент, который стоит заметить: права доступа от parent (страницы новостей) переходят к child (в данном случае, к сообщению). То есть, если указать на странице +'message_view', то все сообщения автоматически будут с такими правами (чтения). Это обстоятельство мы будем использовать и проверять в пункте 1 нашего алгоритма.<br/>
<br/>
Перейдем к реализации:<br/>
На самом деле нам сейчас не требуется PHP для того, чтобы сделать правильную выборку. Всё сделаем на mysql.<br/>
<strong>Пункт 1.</strong><br/>
В нашем случае необходимо считать данные `rightsID` из нескольких объектов и затем выбрать их из нашей таблицы. <br/>
Несколько объектов, потому что у нас будут права на страницу и права на отдельных сообщений на странице. Права обоих будут дополнять друг друга. (child дополнять parent)<br/>
Например, права сообщения на странице:<br/>
<font color="black"><font color="#0000ff">SELECT</font> * <font color="#0000ff">FROM</font> `rights_action` <font color="#0000ff">WHERE</font> `RightsID`=100 <font color="#0000ff">or</font> `RightsID`=101 </font>, где <br/>
100 — ID прав страницы<br/>
101 — ID прав сообщения на странице<br/>
Для того, чтобы было проще общаться на PHP, немного оптимизируем синтаксис:<br/>
<font color="black"><font color="#0000ff">SELECT</font> * <font color="#0000ff">FROM</font> `rights_action` <font color="#0000ff">WHERE</font> `RightsID` <font color="#0000ff">IN</font> (100, 101)</font><br/>
<br/>
<strong>Пункт 2.</strong><br/>
С выбором необходимого нам действия, тоже всё просто:<br/>
<font color="black"><font color="#0000ff">SELECT</font> * <font color="#0000ff">FROM</font> `rights_action` <font color="#0000ff">WHERE</font> `action`= <font color="#008000">'message_view'</font><br/>
<br/>
<strong>Пункт 3.</strong><br/>
А вот здесь придется объединить несколько SELECTов. Сначала выбираем права доступа пользователя, а затем сравниваем их с необходимыми нам. Если объединить эти действия в одно, получится:<br/>
<font color="black"><font color="#0000ff">SELECT</font> * <font color="#0000ff">FROM</font> `rights_action` <font color="#0000ff">WHERE</font> `GroupID` <font color="#0000ff">IN</font> (<font color="#0000ff">SELECT</font> `GroupID` <font color="#0000ff">FROM</font> `rights_group` <font color="#0000ff">WHERE</font> `RightsID` = 1)</font><br/>
<br/>
<strong>Пункт 1-3.</strong><br/>
Теперь всё вместе одним сложным запросом:<br/>
<blockquote><font color="black"><font color="#0000ff">SELECT</font> * <font color="#0000ff">FROM</font> `rights_action` <font color="#0000ff">WHERE</font> `RightsID` <font color="#0000ff">IN</font> (100, 101) <font color="#0000ff">AND</font> `action`= <font color="#008000">'message_view'</font> <font color="#0000ff">AND</font> `GroupID` <font color="#0000ff">IN</font> (<font color="#0000ff">SELECT</font> `GroupID` <font color="#0000ff">FROM</font> `rights_group` <font color="#0000ff">WHERE</font> `RightsID` = 1)</font></blockquote>этот пример, берет права пользователя №1, права объектов №100 и №101, действие 'просмотр сообщений' (message_view) и выдаёт результат (знаки + и -).<br/>
<br/>
<strong>Пункт 1-5.</strong><br/>
Вставим это в PHP реализацию и заодно добавим проверку:<br/>
<blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a><font color="black">  <font color="#0000ff">function</font> check(<font color="#008000">/*array(int,int,...)*/</font> $obj_rights, <font color="#008000">/*integer*/</font> $user_rightsID, <font color="#008000">/*string*/</font> $action){<br/>
    $result = mysql_query(<font color="#A31515">"SELECT * FROM `rights_action` WHERE `RightsID` IN ("</font>. implode(<font color="#A31515">","</font>,$obj_rights) .<font color="#A31515">") AND `action`= '$action' AND `GroupID` IN (SELECT `GroupID` FROM `rights_group` WHERE `RightsID` = $user_rightsID)"</font>);<br/>
<br/>
    <font color="#0000ff">if</font> (!$result)<br/>
      <font color="#0000ff">return</font> <font color="#0000ff">false</font>;<br/>
<br/>
    $tmp=array();<br/>
    <font color="#0000ff">while</font> ($t = mysql_fetch_assoc($result)){<br/>
      <font color="#008000">//В каждую из найденных групп (Users, User1, Moderator) пользователей </font><br/>
      <font color="#008000">//заполняем + (0) или - (1) (с приоритетом).</font><br/>
      <font color="#0000ff">if</font> (!isset($tmp[$t[<font color="#A31515">'groupID'</font>]]))<br/>
        $tmp[$t[<font color="#A31515">'groupID'</font>]] = $t[<font color="#A31515">'sign'</font>];<br/>
      <font color="#0000ff">else</font><br/>
        $tmp[$t[<font color="#A31515">'groupID'</font>]] |= $t[<font color="#A31515">'sign'</font>];<br/>
    }<br/>
    mysql_free_result($result);<br/>
    <br/>
    <font color="#0000ff">if</font> ($tmp)<br/>
      <font color="#008000">//Если нашли + в любой из групп, возвращаем true. Иначе false.</font><br/>
      <font color="#0000ff">return</font> (array_search(0, $tmp) !== FALSE);<br/>
<br/>
    <font color="#008000">//Не нашли ни одного результата $tmp == false </font><br/>
    <font color="#0000ff">return</font> <font color="#0000ff">false</font>;<br/>
  }<br/>
</font><br/>
<font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font>.</font></code></blockquote>Это лишь начало, первый шаг.<br/>
<br/>
<h3>Создаём класс работы с правами доступа</h3><br/>
Что нам необходимо?<br/>
Разработаем пример работы с нашим классом. <br/>
  1) Во-первых, необходимо указать права пользователя, с правами которого нам надо работать. А сам класс необходимо привязать к конкретному пользователю.<br/>
  2) Добавление в класс child-прав объектов с дополнением свойств.<br/>
  3) Проверка доступа по различным действиям (action).<br/>
<br/>
Замечания и мысли:<br/>
Права пользователя можно указать при создании класса в __construct.<br/>
При добавлении новых свойств, чтобы не терялись свойства в классе, необходимо будет делать новый класс (клонировать старый с добавлением свойств).<br/>
<br/>
Давайте попробуем это всё реализовать:<br/>
<blockquote><code><font color="black"><font color="#0000ff">class</font> Rights{<br/>
  <font color="#0000ff">private</font> $usrID;<font color="#008000">//User rights ID</font><br/>
<br/>
  <font color="#0000ff">function</font> __construct($user_rightsID){<br/>
    $<font color="#0000ff">this</font>->usrID=$user_rightsID;<br/>
  }  <br/>
}</font></code></blockquote>Теперь можно использовать конструкцию: <blockquote><code><font color="black">$UserRights = <font color="#0000ff">new</font> Rights($CurrentUser->rightsID);</font></code></blockquote>и использовать $UserRights в дальнейшей программе.<br/>
<br/>
Рассмотрим добавление права объекта для проверки:<blockquote><code><font color="black"><font color="#0000ff">class</font> Rights{<br/>
  <font color="#0000ff">private</font> $group=array();<font color="#008000">//Сначала нет никаких объектов сравнения</font><br/>
  <br/>
  <font color="#0000ff">function</font> include_right($grp){<br/>
    $clone=clone $<font color="#0000ff">this</font>;<font color="#008000">//Чтобы не запортить объект, клонируем его</font><br/>
    $clone->group[]=$grp;<font color="#008000">//Добавляем права клону</font><br/>
    <font color="#0000ff">return</font> $clone;<br/>
  }<br/>
<br/>
  <font color="#008000">//... constructor</font><br/>
}</font></code></blockquote>Напомню, что портить объект нам не нужно, потому что мы будем к нему (parent) добавлять права от разных сообщений (child).<br/>
<br/>
Теперь перепишем нашу функцию <strong>check</strong>, введя её в класс, и посмотрим что получилось:<br/>
<blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a><font color="black"><font color="#0000ff">class</font> Rights{<br/>
  <font color="#0000ff">private</font> $usrID;<font color="#008000">//User rights ID</font><br/>
  <font color="#0000ff">private</font> $group=array();<font color="#008000">//Сначала нет никаких объектов сравнения</font><br/>
<br/>
  <font color="#0000ff">function</font> __construct($user_rightsID){<br/>
    $<font color="#0000ff">this</font>->usrID=$user_rightsID;<br/>
  } <br/>
  <br/>
  <font color="#0000ff">function</font> include_right($grp){<br/>
    $clone=clone $<font color="#0000ff">this</font>;<font color="#008000">//Чтобы не запортить объект, клонируем его</font><br/>
    $clone->group[]=$grp;<font color="#008000">//Добавляем права клону</font><br/>
    <font color="#0000ff">return</font> $clone;<br/>
  }<br/>
<br/>
  <font color="#0000ff">function</font> check($action){<br/>
    $result = mysql_query(<font color="#A31515">"SELECT * FROM `rights_action` WHERE `RightsID` IN ("</font>. implode(<font color="#A31515">","</font>,$<font color="#0000ff">this</font>->group) .<font color="#A31515">") AND `action`= '$action' AND `GroupID` IN (SELECT `GroupID` FROM `rights_group` WHERE `RightsID` = "</font>. $<font color="#0000ff">this</font>->usrID .<font color="#A31515">")"</font>);<br/>
<br/>
    <font color="#0000ff">if</font> (!$result)<br/>
      <font color="#0000ff">return</font> <font color="#0000ff">false</font>;<br/>
<br/>
    $tmp=array();<br/>
    <font color="#0000ff">while</font> ($t = mysql_fetch_assoc($result)){<br/>
      <font color="#008000">//В каждую из найденных групп (Users, User1, Moderator) пользователей </font><br/>
      <font color="#008000">//заполняем + (0) или - (1) (с приоритетом).</font><br/>
      <font color="#0000ff">if</font> (!isset($tmp[$t[<font color="#A31515">'groupID'</font>]]))<br/>
        $tmp[$t[<font color="#A31515">'groupID'</font>]] = $t[<font color="#A31515">'sign'</font>];<br/>
      <font color="#0000ff">else</font><br/>
        $tmp[$t[<font color="#A31515">'groupID'</font>]] |= $t[<font color="#A31515">'sign'</font>];<br/>
    }<br/>
    mysql_free_result($result);<br/>
  <br/>
    <font color="#0000ff">if</font> ($tmp)<br/>
      <font color="#008000">//Если нашли + в любой из групп, возвращаем true. Иначе false.</font><br/>
      <font color="#0000ff">return</font> (array_search(0, $tmp) !== FALSE);<br/>
<br/>
    <font color="#008000">//Не нашли ни одного результата $tmp == false </font><br/>
    <font color="#0000ff">return</font> <font color="#0000ff">false</font>;<br/>
  }<br/>
}</font><br/>
<br/>
<font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font>.</font></code></blockquote>То, что мы сейчас с вами проделали (переделали функцию в класс, сделав её удобнее в использовании и универсальнее) называется <a href="http://habrahabr.ru/blogs/refactoring/45589/">Рефакторинг</a>. (<a href="http://ru.wikipedia.org/wiki/Рефакторинг">wiki</a>)<br/>
<br/>
Сейчас этот класс можно использовать вот так:<blockquote><code><font color="black"><font color="#008000">//Создаём права пользователя</font><br/>
$UserRights = <font color="#0000ff">new</font> Rights($CurrentUser->rightsID);<br/>
<br/>
<font color="#008000">//Добавляем права объекта, с которыми должен иметь дело пользователь.</font><br/>
$PageRights = $UserRights->include_right($MainPage->rightsID);<br/>
<br/>
<font color="#008000">//Проверяем, может ли пользователь просматривать страницу?</font><br/>
<font color="#0000ff">if</font> ($PageRights->check(<font color="#A31515">'messages_view'</font>)){<br/>
  <font color="#008000">//Да, может. Но что делать с сообщениями?</font><br/>
<br/>
  <font color="#008000">//Пройдемся по каждому из них</font><br/>
  <font color="#0000ff">foreach</font>($MainPage->Messages <font color="#0000ff">as</font> $msg){<br/>
    <font color="#008000">//Добавляем к правам страницы (parent), личные права сообщения (child)</font><br/>
    $MsgRights = $PageRights->include_right($msg->rightsID);<br/>
<br/>
    <font color="#008000">//И проверяем на читаемость</font><br/>
    <font color="#0000ff">if</font> ($MsgRights->check(<font color="#A31515">'messages_view'</font>)){<br/>
      <font color="#008000">//И если оно читается, проверяем можем ли мы редактировать сообщения?</font><br/>
      <font color="#0000ff">if</font> ($MsgRights->check(<font color="#A31515">'messages_edit'</font>))<br/>
        $msg->editable_flag = 1;<br/>
      <font color="#008000">//А удалять сообщения?</font><br/>
      <font color="#0000ff">if</font> ($MsgRights->check(<font color="#A31515">'messages_delete'</font>))<br/>
        $msg->delete_flag = 1;<br/>
    <br/>
      DrawMessage($msg);<br/>
    }<br/>
  }<br/>
}</font></code></blockquote>где <strong>$CurrentUser</strong> — структура пользователя, который смотрит страницу.<br/>
<strong>$MainPage</strong> — структура страницы, который смотрит пользователь.<br/>
<strong>$MainPage->Messages</strong> — массив сообщений, которые выводятся на странице.<br/>
Структуры, предварительно, были считаны из БД.<br/>
<br/>
<h3>Оптимизация</h3><br/>
Качеством и функциональностью библиотеки мы с вами довольны, но возникает вопрос производительности.<br/>
<br/>
Первое, что бросается в глаза — это при каждой проверке с новым 'action', происходит не хилый SQL запрос. Давайте попробуем это исправить.<br/>
<br/>
Для начала посмотрим, что от запроса к запросу не меняется и оптимизируем это.<br/>
<blockquote><font color="black"><font color="#0000ff">SELECT</font> * <font color="#0000ff">FROM</font> `rights_action` <font color="#0000ff">WHERE</font> `RightsID` <font color="#0000ff">IN</font> ( .implode(",",$this-><font color="#0000ff">group</font>). ) <font color="#0000ff">AND</font> `<font color="#0000ff">action</font>`= <font color="#A31515">'$action'</font> <font color="#0000ff">AND</font> `GroupID` <font color="#0000ff">IN</font> (<font color="#0000ff">SELECT</font> `GroupID` <font color="#0000ff">FROM</font> `rights_group` <font color="#0000ff">WHERE</font> `RightsID` = .$this->usrID. )</font></blockquote><br/>
Во-первых, каждый раз происходит запрос <font color="black"><font color="#0000ff">SELECT</font> `GroupID` <font color="#0000ff">FROM</font> `rights_group` <font color="#0000ff">WHERE</font> `RightsID` = ...</font>. Давайте с него и начнем.<br/>
При объявлении UserRights проведем этот запрос один раз, а результат уже будем вставлять в наш SQL-запрос.<br/>
<blockquote><code><font color="black">  <font color="#0000ff">function</font> __construct($grp){<br/>
    $result=mysql_query(<font color="#A31515">"SELECT `group_rights`.groupID FROM `group_rights` WHERE `group_rights`.rightsID=$grp"</font>);<br/>
<br/>
    $<font color="#0000ff">this</font>->usrID=array();<br/>
    <font color="#0000ff">while</font> ($t=mysql_fetch_assoc($result)){<br/>
      $<font color="#0000ff">this</font>->usrID[]=$t[<font color="#A31515">'groupID'</font>];<br/>
    }<br/>
    mysql_free_result($result);<br/>
    <br/>
    $<font color="#0000ff">this</font>->usrID=implode(<font color="#A31515">","</font>,$<font color="#0000ff">this</font>->usrID);    <br/>
  }  <br/>
</font></code></blockquote>Теперь в $this->usrID лежит готовая строка, которую можно пряма вставлять в запрос вместо целого SELECTa.<br/>
<br/>
Уже стало легче, но все равно происходит поиск по всей БД каждый запрос. Как нам от этого можно избавиться? Вероятнее всего, создать предварительный результат, зависящий только от action — потому что выборка `RightsID` и `GroupID` остается неизменной.<br/>
<br/>
Когда добавляется группа объектов, считываем все результаты из БД в массив, который будет зависеть лишь от значений 'action'.<br/>
<blockquote><code><font color="black"><font color="#0000ff">SELECT</font> * <font color="#0000ff">FROM</font> `rights_action` <font color="#0000ff">WHERE</font> `RightsID` <font color="#0000ff">IN</font> (...) <font color="#0000ff">AND</font> `GroupID` <font color="#0000ff">IN</font> (...)</font></code></blockquote><br/>
Далее, уже перебором по каждому 'action' в массиве, ищем необходимый элемент. При этом запросов в БД больше нет — до следующего объекта с новыми правами.<br/>
<br/>
В результате оптимизации, наш класс будет выглядеть вот так:<br/>
<blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a><font color="black"><font color="#0000ff">class</font> Rights{<br/>
  <font color="#0000ff">private</font> $group=<font color="#A31515">""</font>;<br/>
  <font color="#0000ff">private</font> $usrID=array();<br/>
  <font color="#0000ff">private</font> $temptable=<font color="#A31515">""</font>;<br/>
  <br/>
  <font color="#0000ff">function</font> include_right($grp){<br/>
    $clone=clone $<font color="#0000ff">this</font>;<br/>
    $clone->group[]=$grp;<br/>
<br/>
    $result=mysql_query(<font color="#A31515">"SELECT * FROM `action_rights` WHERE `action_rights`.groupID IN ({$this->usrID}) AND `action_rights`.rightsID IN ("</font>.implode(<font color="#A31515">","</font>,$clone->group).<font color="#A31515">")"</font>);<br/>
    $tmp=array();<br/>
    <font color="#0000ff">while</font> ($t=mysql_fetch_assoc($result)){<br/>
      $tmp[]=$t;<br/>
    }<br/>
    mysql_free_result($result);<br/>
    <br/>
    $clone->temptable=$tmp;<br/>
    <br/>
    <font color="#0000ff">return</font> $clone;<br/>
  }<br/>
  <br/>
  <font color="#0000ff">function</font> check($action){<br/>
    $tmp=array();<br/>
    <font color="#0000ff">foreach</font> ($<font color="#0000ff">this</font>->temptable <font color="#0000ff">as</font> $t){<br/>
      <font color="#0000ff">if</font> ($t[<font color="#A31515">'action'</font>]==$action){<br/>
        <font color="#0000ff">if</font> (!isset($tmp[$t[<font color="#A31515">'groupID'</font>]]))<br/>
          $tmp[$t[<font color="#A31515">'groupID'</font>]]=$t[<font color="#A31515">'sign'</font>];<br/>
        <font color="#0000ff">else</font><br/>
          $tmp[$t[<font color="#A31515">'groupID'</font>]]|=$t[<font color="#A31515">'sign'</font>];<br/>
      }<br/>
    }<br/>
<br/>
    <font color="#0000ff">if</font> ($tmp){<br/>
      <font color="#0000ff">return</font> (array_search(0,$tmp)!==FALSE);<br/>
    }<br/>
    <font color="#0000ff">return</font> <font color="#0000ff">false</font>;<br/>
  }<br/>
  <br/>
  <font color="#0000ff">function</font> __construct($grp){<br/>
    $result=mysql_query(<font color="#A31515">"SELECT `group_rights`.groupID FROM `group_rights` WHERE `group_rights`.rightsID=$grp"</font>);<br/>
<br/>
    $<font color="#0000ff">this</font>->usrID=array();<br/>
    <font color="#0000ff">while</font> ($t=mysql_fetch_assoc($result)){<br/>
      $<font color="#0000ff">this</font>->usrID[]=$t[<font color="#A31515">'groupID'</font>];<br/>
    }<br/>
    mysql_free_result($result);<br/>
    <br/>
    $<font color="#0000ff">this</font>->usrID=implode(<font color="#A31515">","</font>,$<font color="#0000ff">this</font>->usrID);    <br/>
  }  <br/>
}</font><br/>
<br/>
<font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font>.</font></code></blockquote><br/>
<h4>Можно ли ещё быстрее?</h4><br/>
Да, можно. <br/>
1) Если учитывать, например пустые группы прав у сообщений (child), которые не поменяют нашу уже используемую временную таблицу. В этом случае мы можем использовать её, не создавая заново. А для проверки, нам необходимо добавить лишь ещё один SELECT count(*) FROM `action_rights` WHERE `GroupID` =…, который пройдётся по индексу и вернет результат.<br/>
<br/>
2) Правильно расставить индексы в таблицах `action_rights` и `group_rights`.<br/>
<i>Тут я не уверен. Эксперты меня надеюсь, поправят. Лично сделал PK — 'rightsID', 'action', 'groupID', INDEX — 'groupID', 'rightsID'</i><br/>
<br/>
3) После создания Temporary Table, добавлять в неё индекс по 'action': <font color="black"><font color="#0000ff">ALTER</font> <font color="#0000ff">TABLE</font> `{$this->temptable}` <font color="#0000ff">ADD</font> <font color="#0000ff">INDEX</font> ( `action` )</font>.<br/>
<i>Правда я не уверен, что этот способ тоже действенен. Эксперты, посвятите пожалуйста.</i> :)<br/>
<br/>
4) Использовать кеш. Но это уже другая история :)<br/>
<br/>
<h3>Работающий пример</h3><br/>
Я думаю, что уже достаточно на сегодня кода. Вот как это работает:<br/>
<a href="http://zcn.ru/examples/rights/test.php">работающий пример</a> — извиняюсь за не наглядность.<br/>
<a href="http://zcn.ru/examples/rights/#test.php">test.php (рабочий пример)</a> — здесь используются мои библиотеки, которые работают с SQL БД, не удивляйтесь. Уверен, что разберетесь.<br/>
<a href="http://zcn.ru/examples/rights/#rights.php">rights.php</a> — наша библиотека.<br/>
<br/>
<h3>Расширяемость</h3><br/>
Любые новые действия, которые вы будете использовать в вашем проекте добавляются в 'action' ENUM.<br/>
<br/>
Если вы не хотите быть привязанным к конкретным действиям и добавлять их в реальном времени, то стоит заменить 'action' ENUM на integer и создать ещё одну таблицу соответствий actionID с action_name. (как мы сделали это с названиями Групп)<br/>
<br/>
<strong>Update:</strong> Появилось продолжение: <a href="http://habrahabr.ru/blogs/webdev/51690/">Оптимизации системы разделения прав доступа в веб-приложении</a></font></div></div> <!----> <!----></div> <div class="tm-article-body__tags"><div class="tm-article-body__tags-links"><span class="tm-article-body__tags-title">Теги:</span> <span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bphp%5D" class="tm-article-body__tags-item-link">php</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BE%D1%81%D0%BD%D0%BE%D0%B2%D1%8B%5D" class="tm-article-body__tags-item-link">основы</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Brights%5D" class="tm-article-body__tags-item-link">rights</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BF%D1%80%D0%B0%D0%B2%D0%B0%20%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0%5D" class="tm-article-body__tags-item-link">права доступа</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BACL%5D" class="tm-article-body__tags-item-link">ACL</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%5D" class="tm-article-body__tags-item-link">проектирование</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%80%D0%B5%D1%84%D0%B0%D0%BA%D1%82%D0%BE%D1%80%D0%B8%D0%BD%D0%B3%5D" class="tm-article-body__tags-item-link">рефакторинг</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BE%D0%BF%D1%82%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%5D" class="tm-article-body__tags-item-link">оптимизация</a></span></div> <div class="tm-article-body__tags-links"><span class="tm-article-body__tags-title">Хабы:</span> <span class="tm-article-body__tags-item"><a href="/ru/hub/webdev/" class="tm-article-body__tags-item-link">
                  Разработка веб-сайтов
                </a></span></div></div></article> <div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 94: ↑71 и ↓23</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 94: ↑71 и ↓23" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+48</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <!----> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    225
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/51327/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      103
    </span></a> <!----></div> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div></div> <!----></div> <!----> <div class="tm-page-article__additional-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body"><div class="tm-article-author tm-page-article__author"><!----> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-two-column"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/l2k/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/bf6/784/f3c/bf6784f3c323091e91f5deba0ae6641d.jpg" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 278 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    28.3
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info"><div class="tm-user-card__title"><span class="tm-user-card__name">l2k</span> <a href="/ru/users/l2k/" class="tm-user-card__nickname">
          @l2k
        </a> <!----></div> <p class="tm-user-card__short-info">Пользователь</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-two-column"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div></div> <!----></section> <div class="tm-page-article__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/51327/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 103 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <section class="tm-block tm-block_spacing-around"><header class="tm-block__header"><h2 class="tm-block__title">Похожие публикации</h2> <!----></header> <div class="tm-block__body"><ul class="tm-article-list-block__list"><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-14T07:38:11.000Z" title="2021-09-14, 10:38">14  сентября   в 10:38</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/577750/" class="tm-article-title__link"><span>PHP Generics. Right here. Right now</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 29: ↑29 и ↓0</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 29: ↑29 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+29</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">5.2K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    18
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/577750/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      15
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-05-05T08:14:01.000Z" title="2021-05-05, 11:14">5  мая   в 11:14</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/cloud4y/blog/553112/" class="tm-article-title__link"><span>Как «озадачить» всех инженеров и не перемудрить с правами доступа. Опыт Cloud4Y</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 14: ↑13 и ↓1</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 14: ↑13 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+12</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">1.3K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    8
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/cloud4y/blog/553112/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      13
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2008-08-21T15:27:55.000Z" title="2008-08-21, 19:27">21  августа  2008 в 19:27</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/37686/" class="tm-article-title__link"><span>Использование Nginx и php для проверки прав доступа перед отдачей файлов</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 27: ↑23.5 и ↓3.5</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 27: ↑23.5 и ↓3.5" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+20</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">11K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    89
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/37686/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      12
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li> <!----></ul></div> <!----></section> <!----> <!----> <section class="tm-block tm-block_spacing-around"><header class="tm-block__header"><h2 class="tm-block__title">Лучшие публикации за сутки</h2> <!----></header> <div class="tm-block__body"><ul class="tm-article-list-block__list"><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-27T09:00:04.000Z" title="2021-09-27, 12:00">сегодня в 12:00</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/ruvds/blog/580060/" class="tm-article-title__link"><span>Арракис, который мы заслужили</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 70: ↑67 и ↓3</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 70: ↑67 и ↓3" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+64</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">6.6K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    21
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/ruvds/blog/580060/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      11
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-26T21:49:14.000Z" title="2021-09-27, 00:49">сегодня в 00:49</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/580092/" class="tm-article-title__link"><span>30 сентября: Let's Encrypt и конец срока действия IdenTrust DST Root CA X3</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 41: ↑41 и ↓0</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 41: ↑41 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+41</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">14K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    44
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/580092/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      79
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-26T19:37:10.000Z" title="2021-09-26, 22:37">вчера в 22:37</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/580086/" class="tm-article-title__link"><span>Термо принтер и JavaScript</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 40: ↑39 и ↓1</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 40: ↑39 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+38</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">8K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    33
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/580086/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      46
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-26T19:00:02.000Z" title="2021-09-26, 22:00">вчера в 22:00</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/funcorp/blog/579542/" class="tm-article-title__link"><span>Jetpack Compose — как легко построить UI на Android</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 39: ↑35 и ↓4</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 39: ↑35 и ↓4" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+31</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">3.4K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    49
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/funcorp/blog/579542/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      8
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-26T22:35:26.000Z" title="2021-09-27, 01:35">сегодня в 01:35</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/580094/" class="tm-article-title__link"><span>Блокчейн нас подвёл? Почему ДЭГ — это плохо и можем ли мы адекватно контролировать процесс подсчёта голосов?</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 45: ↑35 и ↓10</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 45: ↑35 и ↓10" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+25</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">11K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    19
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/580094/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      78
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li> <!----></ul></div> <!----></section> <!----> <!----></div></div></div> <div class="tm-page__sidebar"><div hl="ru" id="51327" class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/51327/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/51327/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"51327":{"id":"51327","timePublished":"2009-02-07T12:27:06+00:00","isCorporative":false,"lang":"ru","titleHtml":"Система разделения прав доступа в веб-приложении","leadData":{"textHtml":"В этой статье мы пройдём с вами полный цикл от идеи, проектирования БД, написания PHP-Кода, и завершающей оптимизации. Постараюсь рассказать обо всем, как можно проще. Использовать для примеров буду PHP и Mysql. Заодно потренирую новичков :).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ этой статье я коснусь вопросов:\u003Cbr\u002F\u003E\r\n&nbsp;&nbsp;1. Идея ACL\u003Cbr\u002F\u003E\r\n&nbsp;&nbsp;2. Проектирование БД\u003Cbr\u002F\u003E\r\n&nbsp;&nbsp;3. Нормализация БД\u003Cbr\u002F\u003E\r\n&nbsp;&nbsp;4. Рефакторинг кода\u003Cbr\u002F\u003E\r\n&nbsp;&nbsp;5. Оптимизация рабочего кода\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСтатья является ответом на \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fblogs\u002Fabout_cms\u002F51231\u002F\"\u003EБинарное распределение прав доступа в CMS\u003C\u002Fa\u003E. Пока автором пишется практическая часть, я хочу предоставить мой вариант, который я использую довольно давно.\u003Cbr\u002F\u003E\r\nТо, что я сейчас расскажу, похоже на \u003Ca href=\"http:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002FACL\"\u003EACL\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"editorVersion":"1.0","postType":"article","postLabels":[],"author":{"scoreStats":{"score":28.3,"votesCount":278},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"40128","alias":"l2k","fullname":"l2k","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fbf6\u002F784\u002Ff3c\u002Fbf6784f3c323091e91f5deba0ae6641d.jpg","speciality":null},"statistics":{"commentsCount":103,"favoritesCount":225,"readingCount":55053,"score":48,"votesCount":94},"hubs":[{"relatedData":null,"id":"91","alias":"webdev","type":"collective","title":"Разработка веб-сайтов","titleHtml":"Разработка веб-сайтов","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EВ этой статье мы пройдём с вами полный цикл от идеи, проектирования БД, написания PHP-Кода, и завершающей оптимизации. Постараюсь рассказать обо всем, как можно проще. Использовать для примеров буду PHP и Mysql. Заодно потренирую новичков :).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ этой статье я коснусь вопросов:\u003Cbr\u002F\u003E\r\n  1. Идея ACL\u003Cbr\u002F\u003E\r\n  2. Проектирование БД\u003Cbr\u002F\u003E\r\n  3. Нормализация БД\u003Cbr\u002F\u003E\r\n  4. Рефакторинг кода\u003Cbr\u002F\u003E\r\n  5. Оптимизация рабочего кода\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСтатья является ответом на \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fblogs\u002Fabout_cms\u002F51231\u002F\"\u003EБинарное распределение прав доступа в CMS\u003C\u002Fa\u003E. Пока автором пишется практическая часть, я хочу предоставить мой вариант, который я использую довольно давно.\u003Cbr\u002F\u003E\r\nТо, что я сейчас расскажу, похоже на \u003Ca href=\"http:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002FACL\"\u003EACL\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Ch3\u003EУпрощенное описание идеи\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nПрава доступа принадлежат ко всем объектам, к которым необходимо их применять.\u003Cbr\u002F\u003E\r\nЕсли рассматривать пример простой страницы новостей (которую мы с вами здесь напишем), то права доступа должны иметь:\u003Cbr\u002F\u003E\r\n  1) Основная страница новостей — глобальные права доступа, означающие «создание новой новости», «модерирование новостей», «просмотр самой страницы».\u003Cbr\u002F\u003E\r\n  2) Каждая новость — возможности «редактировать автором новости» или «не оставлять комментарии».\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСистема прав доступа состоит из:\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E{Group}+{Actions}\u003C\u002Fstrong\u003E или \u003Cstrong\u003E{Group}-{Actions}\u003C\u002Fstrong\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003EGroup\u003C\u002Fstrong\u003E — это набор имен, которые из себя представляют:\u003Cbr\u002F\u003E\r\n  1) Права конкретного пользователя (например 'User1', 'User2'...). Например используется для личных сообщений, к которым этот пользователь имеет доступ или для допуска редактирования только его сообщений на сайте.\u003Cbr\u002F\u003E\r\n  2) Группы приватных страниц (или групп пользователей), к которым необходимо дать права на определенные действия. (например, администраторами, супермодераторами и др.)\u003Cbr\u002F\u003E\r\n  3) Дополнительные свойства. (Например, флаг — переключатель режимов)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003EAction\u003C\u002Fstrong\u003E — набор действий, которые пользователи с имеющимся {Group} могут делать. В нашей системе новостей можно использовать:\u003Cbr\u002F\u003E\r\n  N — добавлять новую тему\u003Cbr\u002F\u003E\r\n  D — удалять тему\u003Cbr\u002F\u003E\r\n  E — редактировать тему\u003Cbr\u002F\u003E\r\n  V — видеть тему\u003Cbr\u002F\u003E\r\n  C — оставлять комментарий\u003Cbr\u002F\u003E\r\n  B — удалять комментарий\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E±\u003C\u002Fstrong\u003E означает давать пользователю с такими правами или не давать (приоритетно) доступ к действию. Например: Users+VC, Users-C = Users+V.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТеперь рассмотрим пример прав доступа, для простого сайта новостей:\u003Cbr\u002F\u003E\r\nОбъект MainNewsPage:\u003Cbr\u002F\u003E\r\n  Users+VC, Moderator+NEDB, Admin+NEDB\u003Cbr\u002F\u003E\r\n Объект NewsMessage:\u003Cbr\u002F\u003E\r\n   User1+ED (в принципе не нужно, если добавлять могут только модераторы)\u003Cbr\u002F\u003E\r\n   Users-C (можно использовать, если нет желания оставлять комментарии)\u003Cbr\u002F\u003E\r\n  Объект NewsComment:\u003Cbr\u002F\u003E\r\n    User2+B (а здесь необходимо, так как комментарий может оставлять любой пользователь, но не все могут удалять их)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EУпростим систему, для понимания идеи компьютером\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nДля начала, определим Базы данных, для работы с правами объектов.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТак как у нас получается список нескольких прав, то можно начать с такой БД:\u003Cbr\u002F\u003E\r\n  \u003Cstrong\u003ERightsID\u003C\u002Fstrong\u003E — идентификатор списка прав.\u003Cbr\u002F\u003E\r\n  \u003Cstrong\u003EGroup\u003C\u002Fstrong\u003E — название группы.\u003Cbr\u002F\u003E\r\n  \u003Cstrong\u003ESign\u003C\u002Fstrong\u003E — знак группы.\u003Cbr\u002F\u003E\r\n  \u003Cstrong\u003EAction\u003C\u002Fstrong\u003E — название действия.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПример1 (права для MainNewsPage):\u003Cbr\u002F\u003E\r\n\u003Ctable\u003E\r\n\u003Ctr\u003E\r\n\u003Cth\u003EID\u003C\u002Fth\u003E\r\n\u003Cth\u003ERightsID\u003C\u002Fth\u003E\r\n\u003Cth\u003EGroup\u003C\u002Fth\u003E\r\n\u003Cth\u003ESign\u003C\u002Fth\u003E\r\n\u003Cth\u003EAction\u003C\u002Fth\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E1\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E100\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EUsers\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E+\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EV\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E2\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E100\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EUsers\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E+\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EC\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E3\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E100\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EModerator\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E+\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EN\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E4\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E100\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EModerator\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E+\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EE\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E5\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E100\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EModerator\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E+\u003C\u002Ftd\u003E\r\n\u003Ctd\u003ED\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E6\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E100\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EModerator\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E+\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EB\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E7\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E100\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EAdmin\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E+\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EN\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E8\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E100\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EAdmin\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E+\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EE\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E9\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E100\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EAdmin\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E+\u003C\u002Ftd\u003E\r\n\u003Ctd\u003ED\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E10\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E100\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EAdmin\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E+\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EB\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003C\u002Ftable\u003E\u003Cbr\u002F\u003E\r\nПример2 (права для NewsMessage):\u003Cbr\u002F\u003E\r\n\u003Ctable\u003E\r\n\u003Ctr\u003E\r\n\u003Cth\u003EID\u003C\u002Fth\u003E\r\n\u003Cth\u003ERightsID\u003C\u002Fth\u003E\r\n\u003Cth\u003EGroup\u003C\u002Fth\u003E\r\n\u003Cth\u003ESign\u003C\u002Fth\u003E\r\n\u003Cth\u003EAction\u003C\u002Fth\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E11\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E101\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EUser1\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E+\u003C\u002Ftd\u003E\r\n\u003Ctd\u003ED\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E12\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E101\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EUser1\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E+\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EE\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E13\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E101\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EUsers\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E-\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EC\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003C\u002Ftable\u003E\u003Cbr\u002F\u003E\r\nТеперь, если мы запросим \u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003ESELECT\u003C\u002Ffont\u003E * \u003Cfont color=\"#0000ff\"\u003EFROM\u003C\u002Ffont\u003E `rights_action` \u003Cfont color=\"#0000ff\"\u003EWHERE\u003C\u002Ffont\u003E `RightsID`=100\u003C\u002Ffont\u003E, то получим все права, которые принадлежат необходимому нам объекту.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EНормализация таблиц. Добавляем права пользователя.\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nУ пользователя, который будет просматривать нашу страницу, должны иметься права, которыми он владеет. Исходя из них, мы сможем знать, имеет ли пользователь право на действие.\u003Cbr\u002F\u003E\r\nНапример: User2, Users, Moderator.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля этого определим таблицу прав:\u003Cbr\u002F\u003E\r\n  \u003Cstrong\u003ERightsID\u003C\u002Fstrong\u003E — идентификатор списка прав пользователя.\u003Cbr\u002F\u003E\r\n  \u003Cstrong\u003EGroup\u003C\u002Fstrong\u003E — название группы, в которой пользователь состоит.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПример:\u003Cbr\u002F\u003E\r\n\u003Ctable\u003E\r\n\u003Ctr\u003E\r\n\u003Cth\u003EID\u003C\u002Fth\u003E\r\n\u003Cth\u003ERightsID\u003C\u002Fth\u003E\r\n\u003Cth\u003EGroup\u003C\u002Fth\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E1\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E10\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EUser1\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E2\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E10\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EUsers\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E3\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E10\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EModerator\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003C\u002Ftable\u003EТеперь приведем обе наши таблицы к \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fblogs\u002Fdevelopment\u002F45707\u002F\"\u003Eнормальной форме\u003C\u002Fa\u003E. (\u003Ca href=\"http:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002FНормальная_форма\"\u003Ewiki\u003C\u002Fa\u003E)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ результате ID ключи отсеются, и мы получим 3 таблицы:\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E\u003Ci\u003Erights_action\u003C\u002Fi\u003E\u003C\u002Fstrong\u003E — права объекта\u003Cbr\u002F\u003E\r\n  \u003Cstrong\u003ERightsID: integer (pk)\u003C\u002Fstrong\u003E — идентификатор списка прав.\u003Cbr\u002F\u003E\r\n  \u003Cstrong\u003EGroupID: integer (pk)\u003C\u002Fstrong\u003E — название группы.\u003Cbr\u002F\u003E\r\n  \u003Cstrong\u003ESign: tinyint (1)\u003C\u002Fstrong\u003E — знак группы.\u003Cbr\u002F\u003E\r\n  \u003Cstrong\u003EAction: enum (pk)\u003C\u002Fstrong\u003E — название действия.\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E\u003Ci\u003Erights_group\u003C\u002Fi\u003E\u003C\u002Fstrong\u003E — права пользователя\u003Cbr\u002F\u003E\r\n  \u003Cstrong\u003ERightsID: integer (pk)\u003C\u002Fstrong\u003E — идентификатор списка прав пользователя.\u003Cbr\u002F\u003E\r\n  \u003Cstrong\u003EGroupID: integer (pk)\u003C\u002Fstrong\u003E — идентификатор группы, в которой пользователь состоит.\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E\u003Ci\u003Erights_names\u003C\u002Fi\u003E\u003C\u002Fstrong\u003E — названия групп\u003Cbr\u002F\u003E\r\n  \u003Cstrong\u003EGroupID: integer (pk)\u003C\u002Fstrong\u003E — идентификатор группы.\u003Cbr\u002F\u003E\r\n  \u003Cstrong\u003Ename\u003C\u002Fstrong\u003E — название группы.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nPrimary key 'ID' мы заменили на другие ключи, состоящие в некоторых случаях из нескольких полей таблицы.\u003Cbr\u002F\u003E\r\nЗнак группы теперь 0 (+) или 1 (-), потому что так нам будет проще к ним обращаться.\u003Cbr\u002F\u003E\r\nИдентификатор GroupID прямиком указывает на название в rights_names.\u003Cbr\u002F\u003E\r\nНа самом деле таблица \u003Cstrong\u003E\u003Ci\u003Erights_names\u003C\u002Fi\u003E\u003C\u002Fstrong\u003E является в нашем случае аппендиксом, который не будет использоваться для выявления прав на необходимое действие. Эта таблица теперь служит лишь для «Очеловечивания» результатов.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПример, что у нас получилось:\u003Cbr\u002F\u003E\r\n\u003Ctable\u003E\r\n\u003Ctr\u003E\r\n\u003Cth colspan=\"4\"\u003Erights_name\u003C\u002Fth\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Cth\u003EGroupID\u003C\u002Fth\u003E\r\n\u003Cth\u003Ename\u003C\u002Fth\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E10\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EUsers\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E11\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EModerator\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E12\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EAdmin\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E1001\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EUser1\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E1002\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EUser2\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E1003\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EUser3\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Cth colspan=\"4\"\u003Erights_group\u003C\u002Fth\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Cth\u003ERightsID\u003C\u002Fth\u003E\r\n\u003Cth\u003EGroupID\u003C\u002Fth\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E1\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E1001\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E1\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E10\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E1\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E11\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Cth colspan=\"4\"\u003Erights_action\u003C\u002Fth\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Cth\u003ERightsID\u003C\u002Fth\u003E\r\n\u003Cth\u003EGroupID\u003C\u002Fth\u003E\r\n\u003Cth\u003ESign\u003C\u002Fth\u003E\r\n\u003Cth\u003EAction\u003C\u002Fth\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E100\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E10\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E 0\u003C\u002Ftd\u003E\r\n\u003Ctd\u003Emessage_view\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E100\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E10\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E 0\u003C\u002Ftd\u003E\r\n\u003Ctd\u003Ecomment_create\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E100\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E11\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E 0\u003C\u002Ftd\u003E\r\n\u003Ctd\u003Emessage_create\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E100\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E11\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E 0\u003C\u002Ftd\u003E\r\n\u003Ctd\u003Emessage_edit\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E100\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E11\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E 0\u003C\u002Ftd\u003E\r\n\u003Ctd\u003Emessage_delete\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E100\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E11\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E 0\u003C\u002Ftd\u003E\r\n\u003Ctd\u003Ecomment_delete\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E100\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E12\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E 0\u003C\u002Ftd\u003E\r\n\u003Ctd\u003Emessage_create\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E100\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E12\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E 0\u003C\u002Ftd\u003E\r\n\u003Ctd\u003Emessage_edit\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E100\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E12\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E 0\u003C\u002Ftd\u003E\r\n\u003Ctd\u003Emessage_delete\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E100\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E12\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E 0\u003C\u002Ftd\u003E\r\n\u003Ctd\u003Ecomment_delete\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E101\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E1001\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E 0\u003C\u002Ftd\u003E\r\n\u003Ctd\u003Emessage_edit\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E101\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E1001\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E 0\u003C\u002Ftd\u003E\r\n\u003Ctd\u003Emessage_delete\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E101\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E10\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E 1\u003C\u002Ftd\u003E\r\n\u003Ctd\u003Ecomment_create\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003C\u002Ftable\u003EСтало менее наглядно — для человека. Компьютеру, который оперирует числами, стало намного проще обращаться с таблицами.\u003Cbr\u002F\u003E\r\nТеперь мы можем добавить права любому объекту в таблице на любое действие. Действия теперь записываются в таблицу в виде ENUM (поле 'action'), что упрощает понимание и разработку проектов. Само действие как string и может называться, как угодно.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n`rights_group` должна быть привязана к пользователям и говорит о тех правах, которыми пользователь обладает.\u003Cbr\u002F\u003E\r\n`rights_action` должна быть привязана к объектам и говорит, с каким правами, какие действия пользователь может выполнять.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНапример (для нашего сайта новостей):\u003Cbr\u002F\u003E\r\n\u003Ctable\u003E\r\n\u003Ctr\u003E\r\n\u003Cth colspan=\"5\"\u003Enews_page (параметры основной страница с новостями)\u003C\u002Fth\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Cth\u003EPageID\u003C\u002Fth\u003E\r\n\u003Cth\u003ERightsID\u003C\u002Fth\u003E\r\n\u003Cth\u003EName\u003C\u002Fth\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E1\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E100\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EСтраница новостей\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Cth colspan=\"5\"\u003Enews_message (сообщения на странице новостей)\u003C\u002Fth\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Cth\u003EMsgID\u003C\u002Fth\u003E\r\n\u003Cth\u003EPageID\u003C\u002Fth\u003E\r\n\u003Cth\u003ERightsID\u003C\u002Fth\u003E\r\n\u003Cth\u003EHeader\u003C\u002Fth\u003E\r\n\u003Cth\u003EMessage\u003C\u002Fth\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E1\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E1\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E101\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EУра, мы на главной!!!\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EНо это только начало, дальше, когда мы ближе подберемся к администрации хабра...\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E2\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E1\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E101\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EНовости последней недели\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EНе смотря на наше стройное шествие по главной, похоже планы обломались...\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003C\u002Ftable\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EРазработка библиотеки работы с правами доступа\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nА сейчас мы посмотрим, что необходимо, чтобы эти таблицы собрать воедино и произвести необходимую нам выборку результатов.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nАлгоритм наших действий при проверке возможности действия:\u003Cbr\u002F\u003E\r\n  1) Берем из БД выборку прав по необходимому объекту (объектам). (100: Users+VC, Moderator+NEDB, Admin+NEDB)\u003Cbr\u002F\u003E\r\n  2) Выбираем необходимые нам действия (action). (V: Users+V)\u003Cbr\u002F\u003E\r\n  3) Сравниваем права доступа пользователя и нашей выборки. (Users, User1 &lt;=\u003E Users+)\u003Cbr\u002F\u003E\r\n  4) Если результатов нет, тогда возвращаем false.\u003Cbr\u002F\u003E\r\n  5) Если результаты есть, но состоят из минусов, возвращаем false. Иначе возвращаем true.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕщё один момент, который стоит заметить: права доступа от parent (страницы новостей) переходят к child (в данном случае, к сообщению). То есть, если указать на странице +'message_view', то все сообщения автоматически будут с такими правами (чтения). Это обстоятельство мы будем использовать и проверять в пункте 1 нашего алгоритма.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПерейдем к реализации:\u003Cbr\u002F\u003E\r\nНа самом деле нам сейчас не требуется PHP для того, чтобы сделать правильную выборку. Всё сделаем на mysql.\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003EПункт 1.\u003C\u002Fstrong\u003E\u003Cbr\u002F\u003E\r\nВ нашем случае необходимо считать данные `rightsID` из нескольких объектов и затем выбрать их из нашей таблицы. \u003Cbr\u002F\u003E\r\nНесколько объектов, потому что у нас будут права на страницу и права на отдельных сообщений на странице. Права обоих будут дополнять друг друга. (child дополнять parent)\u003Cbr\u002F\u003E\r\nНапример, права сообщения на странице:\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003ESELECT\u003C\u002Ffont\u003E * \u003Cfont color=\"#0000ff\"\u003EFROM\u003C\u002Ffont\u003E `rights_action` \u003Cfont color=\"#0000ff\"\u003EWHERE\u003C\u002Ffont\u003E `RightsID`=100 \u003Cfont color=\"#0000ff\"\u003Eor\u003C\u002Ffont\u003E `RightsID`=101 \u003C\u002Ffont\u003E, где \u003Cbr\u002F\u003E\r\n100 — ID прав страницы\u003Cbr\u002F\u003E\r\n101 — ID прав сообщения на странице\u003Cbr\u002F\u003E\r\nДля того, чтобы было проще общаться на PHP, немного оптимизируем синтаксис:\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003ESELECT\u003C\u002Ffont\u003E * \u003Cfont color=\"#0000ff\"\u003EFROM\u003C\u002Ffont\u003E `rights_action` \u003Cfont color=\"#0000ff\"\u003EWHERE\u003C\u002Ffont\u003E `RightsID` \u003Cfont color=\"#0000ff\"\u003EIN\u003C\u002Ffont\u003E (100, 101)\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003EПункт 2.\u003C\u002Fstrong\u003E\u003Cbr\u002F\u003E\r\nС выбором необходимого нам действия, тоже всё просто:\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003ESELECT\u003C\u002Ffont\u003E * \u003Cfont color=\"#0000ff\"\u003EFROM\u003C\u002Ffont\u003E `rights_action` \u003Cfont color=\"#0000ff\"\u003EWHERE\u003C\u002Ffont\u003E `action`= \u003Cfont color=\"#008000\"\u003E'message_view'\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003EПункт 3.\u003C\u002Fstrong\u003E\u003Cbr\u002F\u003E\r\nА вот здесь придется объединить несколько SELECTов. Сначала выбираем права доступа пользователя, а затем сравниваем их с необходимыми нам. Если объединить эти действия в одно, получится:\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003ESELECT\u003C\u002Ffont\u003E * \u003Cfont color=\"#0000ff\"\u003EFROM\u003C\u002Ffont\u003E `rights_action` \u003Cfont color=\"#0000ff\"\u003EWHERE\u003C\u002Ffont\u003E `GroupID` \u003Cfont color=\"#0000ff\"\u003EIN\u003C\u002Ffont\u003E (\u003Cfont color=\"#0000ff\"\u003ESELECT\u003C\u002Ffont\u003E `GroupID` \u003Cfont color=\"#0000ff\"\u003EFROM\u003C\u002Ffont\u003E `rights_group` \u003Cfont color=\"#0000ff\"\u003EWHERE\u003C\u002Ffont\u003E `RightsID` = 1)\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003EПункт 1-3.\u003C\u002Fstrong\u003E\u003Cbr\u002F\u003E\r\nТеперь всё вместе одним сложным запросом:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003ESELECT\u003C\u002Ffont\u003E * \u003Cfont color=\"#0000ff\"\u003EFROM\u003C\u002Ffont\u003E `rights_action` \u003Cfont color=\"#0000ff\"\u003EWHERE\u003C\u002Ffont\u003E `RightsID` \u003Cfont color=\"#0000ff\"\u003EIN\u003C\u002Ffont\u003E (100, 101) \u003Cfont color=\"#0000ff\"\u003EAND\u003C\u002Ffont\u003E `action`= \u003Cfont color=\"#008000\"\u003E'message_view'\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003EAND\u003C\u002Ffont\u003E `GroupID` \u003Cfont color=\"#0000ff\"\u003EIN\u003C\u002Ffont\u003E (\u003Cfont color=\"#0000ff\"\u003ESELECT\u003C\u002Ffont\u003E `GroupID` \u003Cfont color=\"#0000ff\"\u003EFROM\u003C\u002Ffont\u003E `rights_group` \u003Cfont color=\"#0000ff\"\u003EWHERE\u003C\u002Ffont\u003E `RightsID` = 1)\u003C\u002Ffont\u003E\u003C\u002Fblockquote\u003Eэтот пример, берет права пользователя №1, права объектов №100 и №101, действие 'просмотр сообщений' (message_view) и выдаёт результат (знаки + и -).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003EПункт 1-5.\u003C\u002Fstrong\u003E\u003Cbr\u002F\u003E\r\nВставим это в PHP реализацию и заодно добавим проверку:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Ca href=\"http:\u002F\u002Fvirtser.net\u002Fblog\u002Fpost\u002Fsource-code-highlighter.aspx\"\u003E\u003C\u002Fa\u003E\u003Cfont color=\"black\"\u003E  \u003Cfont color=\"#0000ff\"\u003Efunction\u003C\u002Ffont\u003E check(\u003Cfont color=\"#008000\"\u003E\u002F*array(int,int,...)*\u002F\u003C\u002Ffont\u003E $obj_rights, \u003Cfont color=\"#008000\"\u003E\u002F*integer*\u002F\u003C\u002Ffont\u003E $user_rightsID, \u003Cfont color=\"#008000\"\u003E\u002F*string*\u002F\u003C\u002Ffont\u003E $action){\u003Cbr\u002F\u003E\r\n    $result = mysql_query(\u003Cfont color=\"#A31515\"\u003E\"SELECT * FROM `rights_action` WHERE `RightsID` IN (\"\u003C\u002Ffont\u003E. implode(\u003Cfont color=\"#A31515\"\u003E\",\"\u003C\u002Ffont\u003E,$obj_rights) .\u003Cfont color=\"#A31515\"\u003E\") AND `action`= '$action' AND `GroupID` IN (SELECT `GroupID` FROM `rights_group` WHERE `RightsID` = $user_rightsID)\"\u003C\u002Ffont\u003E);\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E (!$result)\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Efalse\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    $tmp=array();\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Ewhile\u003C\u002Ffont\u003E ($t = mysql_fetch_assoc($result)){\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#008000\"\u003E\u002F\u002FВ каждую из найденных групп (Users, User1, Moderator) пользователей \u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#008000\"\u003E\u002F\u002Fзаполняем + (0) или - (1) (с приоритетом).\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E (!isset($tmp[$t[\u003Cfont color=\"#A31515\"\u003E'groupID'\u003C\u002Ffont\u003E]]))\u003Cbr\u002F\u003E\r\n        $tmp[$t[\u003Cfont color=\"#A31515\"\u003E'groupID'\u003C\u002Ffont\u003E]] = $t[\u003Cfont color=\"#A31515\"\u003E'sign'\u003C\u002Ffont\u003E];\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Eelse\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n        $tmp[$t[\u003Cfont color=\"#A31515\"\u003E'groupID'\u003C\u002Ffont\u003E]] |= $t[\u003Cfont color=\"#A31515\"\u003E'sign'\u003C\u002Ffont\u003E];\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n    mysql_free_result($result);\u003Cbr\u002F\u003E\r\n    \u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E ($tmp)\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#008000\"\u003E\u002F\u002FЕсли нашли + в любой из групп, возвращаем true. Иначе false.\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E (array_search(0, $tmp) !== FALSE);\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#008000\"\u003E\u002F\u002FНе нашли ни одного результата $tmp == false \u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Efalse\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"gray\"\u003E* This source code was highlighted with \u003Cfont color=\"gray\"\u003ESource Code Highlighter\u003C\u002Ffont\u003E.\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EЭто лишь начало, первый шаг.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EСоздаём класс работы с правами доступа\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nЧто нам необходимо?\u003Cbr\u002F\u003E\r\nРазработаем пример работы с нашим классом. \u003Cbr\u002F\u003E\r\n  1) Во-первых, необходимо указать права пользователя, с правами которого нам надо работать. А сам класс необходимо привязать к конкретному пользователю.\u003Cbr\u002F\u003E\r\n  2) Добавление в класс child-прав объектов с дополнением свойств.\u003Cbr\u002F\u003E\r\n  3) Проверка доступа по различным действиям (action).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЗамечания и мысли:\u003Cbr\u002F\u003E\r\nПрава пользователя можно указать при создании класса в __construct.\u003Cbr\u002F\u003E\r\nПри добавлении новых свойств, чтобы не терялись свойства в классе, необходимо будет делать новый класс (клонировать старый с добавлением свойств).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДавайте попробуем это всё реализовать:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003Eclass\u003C\u002Ffont\u003E Rights{\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E $usrID;\u003Cfont color=\"#008000\"\u003E\u002F\u002FUser rights ID\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Efunction\u003C\u002Ffont\u003E __construct($user_rightsID){\u003Cbr\u002F\u003E\r\n    $\u003Cfont color=\"#0000ff\"\u003Ethis\u003C\u002Ffont\u003E-\u003EusrID=$user_rightsID;\u003Cbr\u002F\u003E\r\n  }  \u003Cbr\u002F\u003E\r\n}\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EТеперь можно использовать конструкцию: \u003Cblockquote\u003E\u003Ccode\u003E\u003Cfont color=\"black\"\u003E$UserRights = \u003Cfont color=\"#0000ff\"\u003Enew\u003C\u002Ffont\u003E Rights($CurrentUser-\u003ErightsID);\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003Eи использовать $UserRights в дальнейшей программе.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nРассмотрим добавление права объекта для проверки:\u003Cblockquote\u003E\u003Ccode\u003E\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003Eclass\u003C\u002Ffont\u003E Rights{\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E $group=array();\u003Cfont color=\"#008000\"\u003E\u002F\u002FСначала нет никаких объектов сравнения\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n  \u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Efunction\u003C\u002Ffont\u003E include_right($grp){\u003Cbr\u002F\u003E\r\n    $clone=clone $\u003Cfont color=\"#0000ff\"\u003Ethis\u003C\u002Ffont\u003E;\u003Cfont color=\"#008000\"\u003E\u002F\u002FЧтобы не запортить объект, клонируем его\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    $clone-\u003Egroup[]=$grp;\u003Cfont color=\"#008000\"\u003E\u002F\u002FДобавляем права клону\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E $clone;\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#008000\"\u003E\u002F\u002F... constructor\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n}\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EНапомню, что портить объект нам не нужно, потому что мы будем к нему (parent) добавлять права от разных сообщений (child).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТеперь перепишем нашу функцию \u003Cstrong\u003Echeck\u003C\u002Fstrong\u003E, введя её в класс, и посмотрим что получилось:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Ca href=\"http:\u002F\u002Fvirtser.net\u002Fblog\u002Fpost\u002Fsource-code-highlighter.aspx\"\u003E\u003C\u002Fa\u003E\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003Eclass\u003C\u002Ffont\u003E Rights{\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E $usrID;\u003Cfont color=\"#008000\"\u003E\u002F\u002FUser rights ID\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E $group=array();\u003Cfont color=\"#008000\"\u003E\u002F\u002FСначала нет никаких объектов сравнения\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Efunction\u003C\u002Ffont\u003E __construct($user_rightsID){\u003Cbr\u002F\u003E\r\n    $\u003Cfont color=\"#0000ff\"\u003Ethis\u003C\u002Ffont\u003E-\u003EusrID=$user_rightsID;\u003Cbr\u002F\u003E\r\n  } \u003Cbr\u002F\u003E\r\n  \u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Efunction\u003C\u002Ffont\u003E include_right($grp){\u003Cbr\u002F\u003E\r\n    $clone=clone $\u003Cfont color=\"#0000ff\"\u003Ethis\u003C\u002Ffont\u003E;\u003Cfont color=\"#008000\"\u003E\u002F\u002FЧтобы не запортить объект, клонируем его\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    $clone-\u003Egroup[]=$grp;\u003Cfont color=\"#008000\"\u003E\u002F\u002FДобавляем права клону\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E $clone;\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Efunction\u003C\u002Ffont\u003E check($action){\u003Cbr\u002F\u003E\r\n    $result = mysql_query(\u003Cfont color=\"#A31515\"\u003E\"SELECT * FROM `rights_action` WHERE `RightsID` IN (\"\u003C\u002Ffont\u003E. implode(\u003Cfont color=\"#A31515\"\u003E\",\"\u003C\u002Ffont\u003E,$\u003Cfont color=\"#0000ff\"\u003Ethis\u003C\u002Ffont\u003E-\u003Egroup) .\u003Cfont color=\"#A31515\"\u003E\") AND `action`= '$action' AND `GroupID` IN (SELECT `GroupID` FROM `rights_group` WHERE `RightsID` = \"\u003C\u002Ffont\u003E. $\u003Cfont color=\"#0000ff\"\u003Ethis\u003C\u002Ffont\u003E-\u003EusrID .\u003Cfont color=\"#A31515\"\u003E\")\"\u003C\u002Ffont\u003E);\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E (!$result)\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Efalse\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    $tmp=array();\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Ewhile\u003C\u002Ffont\u003E ($t = mysql_fetch_assoc($result)){\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#008000\"\u003E\u002F\u002FВ каждую из найденных групп (Users, User1, Moderator) пользователей \u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#008000\"\u003E\u002F\u002Fзаполняем + (0) или - (1) (с приоритетом).\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E (!isset($tmp[$t[\u003Cfont color=\"#A31515\"\u003E'groupID'\u003C\u002Ffont\u003E]]))\u003Cbr\u002F\u003E\r\n        $tmp[$t[\u003Cfont color=\"#A31515\"\u003E'groupID'\u003C\u002Ffont\u003E]] = $t[\u003Cfont color=\"#A31515\"\u003E'sign'\u003C\u002Ffont\u003E];\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Eelse\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n        $tmp[$t[\u003Cfont color=\"#A31515\"\u003E'groupID'\u003C\u002Ffont\u003E]] |= $t[\u003Cfont color=\"#A31515\"\u003E'sign'\u003C\u002Ffont\u003E];\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n    mysql_free_result($result);\u003Cbr\u002F\u003E\r\n  \u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E ($tmp)\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#008000\"\u003E\u002F\u002FЕсли нашли + в любой из групп, возвращаем true. Иначе false.\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E (array_search(0, $tmp) !== FALSE);\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#008000\"\u003E\u002F\u002FНе нашли ни одного результата $tmp == false \u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Efalse\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n}\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"gray\"\u003E* This source code was highlighted with \u003Cfont color=\"gray\"\u003ESource Code Highlighter\u003C\u002Ffont\u003E.\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EТо, что мы сейчас с вами проделали (переделали функцию в класс, сделав её удобнее в использовании и универсальнее) называется \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fblogs\u002Frefactoring\u002F45589\u002F\"\u003EРефакторинг\u003C\u002Fa\u003E. (\u003Ca href=\"http:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002FРефакторинг\"\u003Ewiki\u003C\u002Fa\u003E)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСейчас этот класс можно использовать вот так:\u003Cblockquote\u003E\u003Ccode\u003E\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#008000\"\u003E\u002F\u002FСоздаём права пользователя\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n$UserRights = \u003Cfont color=\"#0000ff\"\u003Enew\u003C\u002Ffont\u003E Rights($CurrentUser-\u003ErightsID);\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#008000\"\u003E\u002F\u002FДобавляем права объекта, с которыми должен иметь дело пользователь.\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n$PageRights = $UserRights-\u003Einclude_right($MainPage-\u003ErightsID);\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#008000\"\u003E\u002F\u002FПроверяем, может ли пользователь просматривать страницу?\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E ($PageRights-\u003Echeck(\u003Cfont color=\"#A31515\"\u003E'messages_view'\u003C\u002Ffont\u003E)){\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#008000\"\u003E\u002F\u002FДа, может. Но что делать с сообщениями?\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#008000\"\u003E\u002F\u002FПройдемся по каждому из них\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eforeach\u003C\u002Ffont\u003E($MainPage-\u003EMessages \u003Cfont color=\"#0000ff\"\u003Eas\u003C\u002Ffont\u003E $msg){\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#008000\"\u003E\u002F\u002FДобавляем к правам страницы (parent), личные права сообщения (child)\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    $MsgRights = $PageRights-\u003Einclude_right($msg-\u003ErightsID);\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#008000\"\u003E\u002F\u002FИ проверяем на читаемость\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E ($MsgRights-\u003Echeck(\u003Cfont color=\"#A31515\"\u003E'messages_view'\u003C\u002Ffont\u003E)){\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#008000\"\u003E\u002F\u002FИ если оно читается, проверяем можем ли мы редактировать сообщения?\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E ($MsgRights-\u003Echeck(\u003Cfont color=\"#A31515\"\u003E'messages_edit'\u003C\u002Ffont\u003E))\u003Cbr\u002F\u003E\r\n        $msg-\u003Eeditable_flag = 1;\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#008000\"\u003E\u002F\u002FА удалять сообщения?\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E ($MsgRights-\u003Echeck(\u003Cfont color=\"#A31515\"\u003E'messages_delete'\u003C\u002Ffont\u003E))\u003Cbr\u002F\u003E\r\n        $msg-\u003Edelete_flag = 1;\u003Cbr\u002F\u003E\r\n    \u003Cbr\u002F\u003E\r\n      DrawMessage($msg);\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n}\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003Eгде \u003Cstrong\u003E$CurrentUser\u003C\u002Fstrong\u003E — структура пользователя, который смотрит страницу.\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E$MainPage\u003C\u002Fstrong\u003E — структура страницы, который смотрит пользователь.\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003E$MainPage-\u003EMessages\u003C\u002Fstrong\u003E — массив сообщений, которые выводятся на странице.\u003Cbr\u002F\u003E\r\nСтруктуры, предварительно, были считаны из БД.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EОптимизация\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nКачеством и функциональностью библиотеки мы с вами довольны, но возникает вопрос производительности.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПервое, что бросается в глаза — это при каждой проверке с новым 'action', происходит не хилый SQL запрос. Давайте попробуем это исправить.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля начала посмотрим, что от запроса к запросу не меняется и оптимизируем это.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003ESELECT\u003C\u002Ffont\u003E * \u003Cfont color=\"#0000ff\"\u003EFROM\u003C\u002Ffont\u003E `rights_action` \u003Cfont color=\"#0000ff\"\u003EWHERE\u003C\u002Ffont\u003E `RightsID` \u003Cfont color=\"#0000ff\"\u003EIN\u003C\u002Ffont\u003E ( .implode(\",\",$this-\u003E\u003Cfont color=\"#0000ff\"\u003Egroup\u003C\u002Ffont\u003E). ) \u003Cfont color=\"#0000ff\"\u003EAND\u003C\u002Ffont\u003E `\u003Cfont color=\"#0000ff\"\u003Eaction\u003C\u002Ffont\u003E`= \u003Cfont color=\"#A31515\"\u003E'$action'\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003EAND\u003C\u002Ffont\u003E `GroupID` \u003Cfont color=\"#0000ff\"\u003EIN\u003C\u002Ffont\u003E (\u003Cfont color=\"#0000ff\"\u003ESELECT\u003C\u002Ffont\u003E `GroupID` \u003Cfont color=\"#0000ff\"\u003EFROM\u003C\u002Ffont\u003E `rights_group` \u003Cfont color=\"#0000ff\"\u003EWHERE\u003C\u002Ffont\u003E `RightsID` = .$this-\u003EusrID. )\u003C\u002Ffont\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nВо-первых, каждый раз происходит запрос \u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003ESELECT\u003C\u002Ffont\u003E `GroupID` \u003Cfont color=\"#0000ff\"\u003EFROM\u003C\u002Ffont\u003E `rights_group` \u003Cfont color=\"#0000ff\"\u003EWHERE\u003C\u002Ffont\u003E `RightsID` = ...\u003C\u002Ffont\u003E. Давайте с него и начнем.\u003Cbr\u002F\u003E\r\nПри объявлении UserRights проведем этот запрос один раз, а результат уже будем вставлять в наш SQL-запрос.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cfont color=\"black\"\u003E  \u003Cfont color=\"#0000ff\"\u003Efunction\u003C\u002Ffont\u003E __construct($grp){\u003Cbr\u002F\u003E\r\n    $result=mysql_query(\u003Cfont color=\"#A31515\"\u003E\"SELECT `group_rights`.groupID FROM `group_rights` WHERE `group_rights`.rightsID=$grp\"\u003C\u002Ffont\u003E);\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    $\u003Cfont color=\"#0000ff\"\u003Ethis\u003C\u002Ffont\u003E-\u003EusrID=array();\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Ewhile\u003C\u002Ffont\u003E ($t=mysql_fetch_assoc($result)){\u003Cbr\u002F\u003E\r\n      $\u003Cfont color=\"#0000ff\"\u003Ethis\u003C\u002Ffont\u003E-\u003EusrID[]=$t[\u003Cfont color=\"#A31515\"\u003E'groupID'\u003C\u002Ffont\u003E];\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n    mysql_free_result($result);\u003Cbr\u002F\u003E\r\n    \u003Cbr\u002F\u003E\r\n    $\u003Cfont color=\"#0000ff\"\u003Ethis\u003C\u002Ffont\u003E-\u003EusrID=implode(\u003Cfont color=\"#A31515\"\u003E\",\"\u003C\u002Ffont\u003E,$\u003Cfont color=\"#0000ff\"\u003Ethis\u003C\u002Ffont\u003E-\u003EusrID);    \u003Cbr\u002F\u003E\r\n  }  \u003Cbr\u002F\u003E\r\n\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EТеперь в $this-\u003EusrID лежит готовая строка, которую можно пряма вставлять в запрос вместо целого SELECTa.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nУже стало легче, но все равно происходит поиск по всей БД каждый запрос. Как нам от этого можно избавиться? Вероятнее всего, создать предварительный результат, зависящий только от action — потому что выборка `RightsID` и `GroupID` остается неизменной.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nКогда добавляется группа объектов, считываем все результаты из БД в массив, который будет зависеть лишь от значений 'action'.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003ESELECT\u003C\u002Ffont\u003E * \u003Cfont color=\"#0000ff\"\u003EFROM\u003C\u002Ffont\u003E `rights_action` \u003Cfont color=\"#0000ff\"\u003EWHERE\u003C\u002Ffont\u003E `RightsID` \u003Cfont color=\"#0000ff\"\u003EIN\u003C\u002Ffont\u003E (...) \u003Cfont color=\"#0000ff\"\u003EAND\u003C\u002Ffont\u003E `GroupID` \u003Cfont color=\"#0000ff\"\u003EIN\u003C\u002Ffont\u003E (...)\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nДалее, уже перебором по каждому 'action' в массиве, ищем необходимый элемент. При этом запросов в БД больше нет — до следующего объекта с новыми правами.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ результате оптимизации, наш класс будет выглядеть вот так:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Ca href=\"http:\u002F\u002Fvirtser.net\u002Fblog\u002Fpost\u002Fsource-code-highlighter.aspx\"\u003E\u003C\u002Fa\u003E\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003Eclass\u003C\u002Ffont\u003E Rights{\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E $group=\u003Cfont color=\"#A31515\"\u003E\"\"\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E $usrID=array();\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E $temptable=\u003Cfont color=\"#A31515\"\u003E\"\"\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n  \u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Efunction\u003C\u002Ffont\u003E include_right($grp){\u003Cbr\u002F\u003E\r\n    $clone=clone $\u003Cfont color=\"#0000ff\"\u003Ethis\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n    $clone-\u003Egroup[]=$grp;\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    $result=mysql_query(\u003Cfont color=\"#A31515\"\u003E\"SELECT * FROM `action_rights` WHERE `action_rights`.groupID IN ({$this-\u003EusrID}) AND `action_rights`.rightsID IN (\"\u003C\u002Ffont\u003E.implode(\u003Cfont color=\"#A31515\"\u003E\",\"\u003C\u002Ffont\u003E,$clone-\u003Egroup).\u003Cfont color=\"#A31515\"\u003E\")\"\u003C\u002Ffont\u003E);\u003Cbr\u002F\u003E\r\n    $tmp=array();\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Ewhile\u003C\u002Ffont\u003E ($t=mysql_fetch_assoc($result)){\u003Cbr\u002F\u003E\r\n      $tmp[]=$t;\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n    mysql_free_result($result);\u003Cbr\u002F\u003E\r\n    \u003Cbr\u002F\u003E\r\n    $clone-\u003Etemptable=$tmp;\u003Cbr\u002F\u003E\r\n    \u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E $clone;\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n  \u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Efunction\u003C\u002Ffont\u003E check($action){\u003Cbr\u002F\u003E\r\n    $tmp=array();\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eforeach\u003C\u002Ffont\u003E ($\u003Cfont color=\"#0000ff\"\u003Ethis\u003C\u002Ffont\u003E-\u003Etemptable \u003Cfont color=\"#0000ff\"\u003Eas\u003C\u002Ffont\u003E $t){\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E ($t[\u003Cfont color=\"#A31515\"\u003E'action'\u003C\u002Ffont\u003E]==$action){\u003Cbr\u002F\u003E\r\n        \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E (!isset($tmp[$t[\u003Cfont color=\"#A31515\"\u003E'groupID'\u003C\u002Ffont\u003E]]))\u003Cbr\u002F\u003E\r\n          $tmp[$t[\u003Cfont color=\"#A31515\"\u003E'groupID'\u003C\u002Ffont\u003E]]=$t[\u003Cfont color=\"#A31515\"\u003E'sign'\u003C\u002Ffont\u003E];\u003Cbr\u002F\u003E\r\n        \u003Cfont color=\"#0000ff\"\u003Eelse\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n          $tmp[$t[\u003Cfont color=\"#A31515\"\u003E'groupID'\u003C\u002Ffont\u003E]]|=$t[\u003Cfont color=\"#A31515\"\u003E'sign'\u003C\u002Ffont\u003E];\u003Cbr\u002F\u003E\r\n      }\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E ($tmp){\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E (array_search(0,$tmp)!==FALSE);\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Efalse\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n  \u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Efunction\u003C\u002Ffont\u003E __construct($grp){\u003Cbr\u002F\u003E\r\n    $result=mysql_query(\u003Cfont color=\"#A31515\"\u003E\"SELECT `group_rights`.groupID FROM `group_rights` WHERE `group_rights`.rightsID=$grp\"\u003C\u002Ffont\u003E);\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    $\u003Cfont color=\"#0000ff\"\u003Ethis\u003C\u002Ffont\u003E-\u003EusrID=array();\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Ewhile\u003C\u002Ffont\u003E ($t=mysql_fetch_assoc($result)){\u003Cbr\u002F\u003E\r\n      $\u003Cfont color=\"#0000ff\"\u003Ethis\u003C\u002Ffont\u003E-\u003EusrID[]=$t[\u003Cfont color=\"#A31515\"\u003E'groupID'\u003C\u002Ffont\u003E];\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n    mysql_free_result($result);\u003Cbr\u002F\u003E\r\n    \u003Cbr\u002F\u003E\r\n    $\u003Cfont color=\"#0000ff\"\u003Ethis\u003C\u002Ffont\u003E-\u003EusrID=implode(\u003Cfont color=\"#A31515\"\u003E\",\"\u003C\u002Ffont\u003E,$\u003Cfont color=\"#0000ff\"\u003Ethis\u003C\u002Ffont\u003E-\u003EusrID);    \u003Cbr\u002F\u003E\r\n  }  \u003Cbr\u002F\u003E\r\n}\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"gray\"\u003E* This source code was highlighted with \u003Cfont color=\"gray\"\u003ESource Code Highlighter\u003C\u002Ffont\u003E.\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EМожно ли ещё быстрее?\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nДа, можно. \u003Cbr\u002F\u003E\r\n1) Если учитывать, например пустые группы прав у сообщений (child), которые не поменяют нашу уже используемую временную таблицу. В этом случае мы можем использовать её, не создавая заново. А для проверки, нам необходимо добавить лишь ещё один SELECT count(*) FROM `action_rights` WHERE `GroupID` =…, который пройдётся по индексу и вернет результат.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n2) Правильно расставить индексы в таблицах `action_rights` и `group_rights`.\u003Cbr\u002F\u003E\r\n\u003Ci\u003EТут я не уверен. Эксперты меня надеюсь, поправят. Лично сделал PK — 'rightsID', 'action', 'groupID', INDEX — 'groupID', 'rightsID'\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n3) После создания Temporary Table, добавлять в неё индекс по 'action': \u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003EALTER\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003ETABLE\u003C\u002Ffont\u003E `{$this-\u003Etemptable}` \u003Cfont color=\"#0000ff\"\u003EADD\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003EINDEX\u003C\u002Ffont\u003E ( `action` )\u003C\u002Ffont\u003E.\u003Cbr\u002F\u003E\r\n\u003Ci\u003EПравда я не уверен, что этот способ тоже действенен. Эксперты, посвятите пожалуйста.\u003C\u002Fi\u003E :)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n4) Использовать кеш. Но это уже другая история :)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EРаботающий пример\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nЯ думаю, что уже достаточно на сегодня кода. Вот как это работает:\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fzcn.ru\u002Fexamples\u002Frights\u002Ftest.php\"\u003Eработающий пример\u003C\u002Fa\u003E — извиняюсь за не наглядность.\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fzcn.ru\u002Fexamples\u002Frights\u002F#test.php\"\u003Etest.php (рабочий пример)\u003C\u002Fa\u003E — здесь используются мои библиотеки, которые работают с SQL БД, не удивляйтесь. Уверен, что разберетесь.\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fzcn.ru\u002Fexamples\u002Frights\u002F#rights.php\"\u003Erights.php\u003C\u002Fa\u003E — наша библиотека.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EРасширяемость\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nЛюбые новые действия, которые вы будете использовать в вашем проекте добавляются в 'action' ENUM.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли вы не хотите быть привязанным к конкретным действиям и добавлять их в реальном времени, то стоит заменить 'action' ENUM на integer и создать ещё одну таблицу соответствий actionID с action_name. (как мы сделали это с названиями Групп)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003EUpdate:\u003C\u002Fstrong\u003E Появилось продолжение: \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fblogs\u002Fwebdev\u002F51690\u002F\"\u003EОптимизации системы разделения прав доступа в веб-приложении\u003C\u002Fa\u003E\u003C\u002Ffont\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"php"},{"titleHtml":"основы"},{"titleHtml":"rights"},{"titleHtml":"права доступа"},{"titleHtml":"ACL"},{"titleHtml":"проектирование"},{"titleHtml":"рефакторинг"},{"titleHtml":"оптимизация"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F51327\u002F7a73189dda8c11917e453be8eeb8192f\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F51327\u002F7a73189dda8c11917e453be8eeb8192f\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F51327\\\u002F\"},\"headline\":\"Система разделения прав доступа в веб-приложении\",\"datePublished\":\"2009-02-07T15:27:06+03:00\",\"dateModified\":\"2009-02-12T15:31:27+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"l2k\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"В этой статье мы пройдём с вами полный цикл от идеи, проектирования БД, написания PHP-Кода, и завершающей оптимизации. Постараюсь рассказать обо всем, как можно...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F51327\\\u002F#post-content-body\",\"about\":[\"h_webdev\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F51327\\\u002F7a73189dda8c11917e453be8eeb8192f\\\u002F\"]}","metaDescription":"В этой статье мы пройдём с вами полный цикл от идеи, проектирования БД, написания PHP-Кода, и завершающей оптимизации. Постараюсь рассказать обо всем, как можно проще. Использовать для примеров буду...","mainImageUrl":null,"amp":false},"polls":[],"commentsEnabled":true,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false},"578296":{"id":"578296","timePublished":"2021-09-26T14:00:02+00:00","isCorporative":true,"lang":"ru","titleHtml":"Вектор? Растр? А может — и то, и другое?","editorVersion":"1.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Zach Leatherman","originalUrl":"https:\u002F\u002Fwww.zachleat.com\u002Fweb\u002Fvector-raster-split\u002F"}}],"author":{"id":"1220775","alias":"ru_vds","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fe36\u002F812\u002Fd3d\u002Fe36812d3de38eb3d479d7a13228717ef.png","speciality":"Пользователь"},"statistics":{"commentsCount":8,"favoritesCount":29,"readingCount":2501,"score":23,"votesCount":25},"hubs":[{"relatedData":null,"id":"19791","alias":"ruvds","type":"corporative","title":"Блог компании RUVDS.com","titleHtml":"Блог компании RUVDS.com","isProfiled":false},{"relatedData":null,"id":"449","alias":"vector_graphics","type":"collective","title":"Работа с векторной графикой","titleHtml":"Работа с векторной графикой","isProfiled":true},{"relatedData":null,"id":"8880","alias":"server_side_optimization","type":"collective","title":"Серверная оптимизация","titleHtml":"Серверная оптимизация","isProfiled":true},{"relatedData":null,"id":"17175","alias":"image_processing","type":"collective","title":"Обработка изображений","titleHtml":"Обработка изображений","isProfiled":true},{"relatedData":null,"id":"19802","alias":"graph_design","type":"collective","title":"Графический дизайн","titleHtml":"Графический дизайн","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"2","alias":"design","title":"Дизайн"},{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"На этой неделе я столкнулся с интересным классом задач, для решения которых, как я теперь понимаю, можно было использовать гораздо более удачный подход и раньше. Но существует ли такой подход?\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F578296\u002F\"\u003E\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fge\u002Fkf\u002F1n\u002Fgekf1nauxn50imhrqyil4rlzj5m.jpeg\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fa\u003E\u003Cbr\u003E\r\n\u003Ci\u003E\u003Cfont color=\"#999999\"\u003EИзображение для верхней части сайта\u003C\u002Ffont\u003E\u003C\u002Fi\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nРечь идёт о подготовке изображения, рассчитанного на использовании в верхней правой части сайта \u003Ca href=\"https:\u002F\u002Fjamstackconf.com\" rel=\"nofollow noopener noreferrer\"\u003Ejamstackconf.com\u003C\u002Fa\u003E. Мы, в маркетинговой команде Netlify, используем Figma. Первая моя попытка экспорта этого изображения для использования его на сайте оказалась далеко не самой удачной.\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"графика"},{"titleHtml":"веб-разработка"},{"titleHtml":"ruvds_перевод"}]},"579542":{"id":"579542","timePublished":"2021-09-26T19:00:02+00:00","isCorporative":true,"lang":"ru","titleHtml":"Jetpack Compose — как легко построить UI на Android","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2713395","alias":"i15in","fullname":"Иван","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F25f\u002Fe4b\u002Ff94\u002F25fe4bf94867d9647a0ae809abf2e429.jpg","speciality":"Android developer"},"statistics":{"commentsCount":8,"favoritesCount":49,"readingCount":3358,"score":31,"votesCount":39},"hubs":[{"relatedData":null,"id":"18232","alias":"funcorp","type":"corporative","title":"Блог компании FUNCORP","titleHtml":"Блог компании FUNCORP","isProfiled":false},{"relatedData":null,"id":"6345","alias":"mobile_dev","type":"collective","title":"Разработка мобильных приложений","titleHtml":"Разработка мобильных приложений","isProfiled":true},{"relatedData":null,"id":"9188","alias":"ui","type":"collective","title":"Интерфейсы","titleHtml":"Интерфейсы","isProfiled":true},{"relatedData":null,"id":"17107","alias":"android_dev","type":"collective","title":"Разработка под Android","titleHtml":"Разработка под Android","isProfiled":true},{"relatedData":null,"id":"19441","alias":"kotlin","type":"collective","title":"Kotlin","titleHtml":"Kotlin","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"2","alias":"design","title":"Дизайн"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EВ июле этого года вместе с Android Studio Arctic Fox вышла одна из долгожданных библиотек — Jetpack Compose. Она позволяет создавать пользовательский интерфейс в декларативном стиле и обещает быть революцией в построении UI.\u003C\u002Fp\u003E\u003Cp\u003EРазбираемся, так ли это на самом деле, какие у библиотеки преимущества и недостатки. Подробности — в статье.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5da\u002F63d\u002F3cb\u002F5da63d3cbeb8e38de3dde2792d851722.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5da\u002F63d\u002F3cb\u002F5da63d3cbeb8e38de3dde2792d851722.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"разработка мобильных приложений"},{"titleHtml":"jetpack compose"},{"titleHtml":"ui"},{"titleHtml":"интерфейсы"},{"titleHtml":"android"},{"titleHtml":"kotlin"},{"titleHtml":"android studio"},{"titleHtml":"arctic fox"},{"titleHtml":"пользовательские интерфейсы"}]},"579654":{"id":"579654","timePublished":"2021-09-27T09:05:53+00:00","isCorporative":true,"lang":"ru","titleHtml":"Стажировка в ABBYY-2021: гибридный формат, больше машинного обучения и планы на будущее","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"56275","alias":"ABBYYTeam","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F246\u002F3ca\u002Fee9\u002F2463caee983f82739ca5421e1e6a163a.jpg","speciality":"Пользователь"},"statistics":{"commentsCount":0,"favoritesCount":1,"readingCount":390,"score":5,"votesCount":7},"hubs":[{"relatedData":null,"id":"5027","alias":"abbyy","type":"corporative","title":"Блог компании ABBYY","titleHtml":"Блог компании ABBYY","isProfiled":false},{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"20696","alias":"study","type":"collective","title":"Учебный процесс в IT","titleHtml":"Учебный процесс в IT","isProfiled":false},{"relatedData":null,"id":"20740","alias":"career","type":"collective","title":"Карьера в IT-индустрии","titleHtml":"Карьера в IT-индустрии","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"3","alias":"management","title":"Менеджмент"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EМы в ABBYY понимаем, как важно начинать строить карьеру в интересном для себя направлении еще в студенческие годы. Поэтому помогаем талантливым ребятам пробовать свои силы и развиваться уже на третьем курсе университета. Мы проводим летние стажировки, где даем ребятам настоящие «боевые» задачи. По итогам лучшие студенты получают предложения о работе. \u003C\u002Fp\u003E\u003Cp\u003EЛетняя стажировка помогает будущим сотрудникам не только получить опыт и проявить себя, но и изучить внутренние стандарты и процессы разработки компании. Кроме того, это еще и отличная возможность получить предложение о постоянной работе уже на четвертом курсе. Как правило, ABBYY предлагает стажерам частичную занятость для комфортного совмещения с учебой. \u003C\u002Fp\u003E\u003Cp\u003EМы уже не раз подводили итоги летних стажировок в ABBYY (\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fabbyy\u002Fblog\u002F421369\u002F\"\u003Eтут\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fabbyy\u002Fblog\u002F471664\u002F\"\u003Eтут\u003C\u002Fa\u003E и \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fabbyy\u002Fblog\u002F478004\u002F\"\u003Eтут\u003C\u002Fa\u003E), но еще никогда не рассказывали о том, как в целом это проходит в нашей компании, какие тестовые задания и задачи выполняли стажеры, и что думают о стажировке менторы. Все подробности – под катом.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F63b\u002F15c\u002Fe94\u002F63b15ce943783d9aab19e36e15b8e7e6.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F63b\u002F15c\u002Fe94\u002F63b15ce943783d9aab19e36e15b8e7e6.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"nlp (natural language processing)"},{"titleHtml":"abbyy"},{"titleHtml":"abbyy_nlp"},{"titleHtml":"стажировка"},{"titleHtml":"стажер"},{"titleHtml":"практика программирования"},{"titleHtml":"python"},{"titleHtml":"c++"}]},"579772":{"id":"579772","timePublished":"2021-09-27T05:32:01+00:00","isCorporative":true,"lang":"ru","titleHtml":"Сливы процветают. Эксперт-«параноик» Майкл Баззель о защите личных данных","editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Michael Bazzell","originalUrl":"https:\u002F\u002Finteltechniques.com\u002Fblog\u002F2021\u002F07\u002F23\u002Fpersonal-ransomware-exposure\u002F"}}],"author":{"id":"2297567","alias":"SearchInform_team","fullname":null,"avatarUrl":"","speciality":"Пользователь"},"statistics":{"commentsCount":0,"favoritesCount":4,"readingCount":1822,"score":9,"votesCount":9},"hubs":[{"relatedData":null,"id":"22418","alias":"searchinform","type":"corporative","title":"Блог компании SearchInform","titleHtml":"Блог компании SearchInform","isProfiled":false},{"relatedData":null,"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EНаш очередной пост из серии «интересное на иностранном языке» – рассказ Майкла Баззеля о том, как сберечь свои персональные данные от утечек. Майкл – знаковая фигура в сфере OSINT, работал в правительстве США и ФБР, его приглашали в качестве технического эксперта в сериал «Мистер Робот», который считают достойным с точки зрения достоверности. В личной жизни эксперт придерживается настолько жестких правил в отношении информационной гигиены, что некоторые считают его «неадекватом». Так ли это – может быть несколько мнений. \u003C\u002Fp\u003E\u003Cp\u003EОдин из факторов, который убеждает в правильном подходе Майкла, – что риски обнаружить свои данные в интернете стали существенно выше, потому что шифровальщики без разбору сливают в сеть все, до чего дотягиваются при атаках на бизнес. Приводим перевод \u003Ca href=\"https:\u002F\u002Finteltechniques.com\u002Fblog\u002F2021\u002F07\u002F23\u002Fpersonal-ransomware-exposure\u002F\"\u003Eпоста Майкла Баззеля\u003C\u002Fa\u003E. \u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EАтакуют корпорации, а страдают люди\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003EБольшинство людей не задумываются о том, как их касается проблема распространения вирусов-шифровальщиков. Логика такова: речь идет о проблемах компаний, это они вынуждены платить выкуп. При чем тут, казалось бы, обычные люди?! \u003C\u002Fp\u003E\u003Cp\u003EА при том, что преступники сменили тактику: сейчас они не просто шифруют данные, но и скачивают их, выкладывают в открытый доступ, если компании не платят им выкуп. Теперь давайте подумаем, что в этих слитых базах? Множество данных о сотрудниках, клиентах, контрагентах, с которыми компания-жертва работает.\u003C\u002Fp\u003E\u003Cp\u003EХочу сразу уточнить: я это пишу не потому что выступаю за уплату выкупа. Я за то, чтобы сопротивляться избыточному сбору данных там, где это не обязательно. Мы халатно относимся к своим ПДн, раздавая их по первому требованию.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe3b\u002F3e1\u002F2c2\u002Fe3b3e12c2036d90018b804276e31ebea.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe3b\u002F3e1\u002F2c2\u002Fe3b3e12c2036d90018b804276e31ebea.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"персональные данные"},{"titleHtml":"пдн"},{"titleHtml":"сёрчинформ"},{"titleHtml":"Майкл Баззел"},{"titleHtml":"утечки информации"}]},"579804":{"id":"579804","timePublished":"2021-09-26T12:06:13+00:00","isCorporative":true,"lang":"ru","titleHtml":"ОС для работы со звуком — что она умеет","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2691015","alias":"mirhifi","fullname":"«Мир Hi-Fi»","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fdfb\u002F713\u002Fedb\u002Fdfb713edbeed85de6588bd27d6c43229.jpg","speciality":"Пользователь"},"statistics":{"commentsCount":0,"favoritesCount":24,"readingCount":6161,"score":9,"votesCount":11},"hubs":[{"relatedData":null,"id":"18822","alias":"audiomania","type":"corporative","title":"Блог компании Аудиомания","titleHtml":"Блог компании Аудиомания","isProfiled":false},{"relatedData":null,"id":"21484","alias":"electronics","type":"collective","title":"Производство и разработка электроники","titleHtml":"Производство и разработка электроники","isProfiled":true},{"relatedData":null,"id":"21918","alias":"soft","type":"collective","title":"Софт","titleHtml":"Софт","isProfiled":false},{"relatedData":null,"id":"21988","alias":"sound","type":"collective","title":"Звук","titleHtml":"Звук","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EОдин из предыдущих материалов мы посвятили \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Faudiomania\u002Fblog\u002F575076\u002F\"\u003Eинструментам\u003C\u002Fa\u003E для сборки цифровой звуковой рабочей станции (DAW). Еще мы говорили об \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Faudiomania\u002Fblog\u002F575892\u002F\"\u003Eopen source проектах\u003C\u002Fa\u003E, в рамках которых можно сделать собственный синтезатор или педалборд.\u003C\u002Fp\u003E\u003Cp\u003EСегодня продолжим тему и расскажем об открытой ОС \u003Cstrong\u003EElk Audio\u003C\u002Fstrong\u003E, построенной на базе Linux. Она заточена под обработку звука на встраиваемых системах.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa15\u002Ffc8\u002F97f\u002Fa15fc897faa2b01e93257c9af08a6eaa.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa15\u002Ffc8\u002F97f\u002Fa15fc897faa2b01e93257c9af08a6eaa.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"аудиомания"},{"titleHtml":"звук"},{"titleHtml":"Elk Audio"},{"titleHtml":"операционные системы"},{"titleHtml":"DAW"}]},"579854":{"id":"579854","timePublished":"2021-09-27T06:03:01+00:00","isCorporative":true,"lang":"ru","titleHtml":"Видишь уязвимости? А они есть! Наше исследование популярных CMS-систем","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2684283","alias":"Solar_Pentest","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":7,"favoritesCount":11,"readingCount":2250,"score":19,"votesCount":21},"hubs":[{"relatedData":null,"id":"20826","alias":"solarsecurity","type":"corporative","title":"Блог компании Ростелеком-Солар","titleHtml":"Блог компании Ростелеком-Солар","isProfiled":false},{"relatedData":null,"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true},{"relatedData":null,"id":"260","alias":"php","type":"collective","title":"PHP","titleHtml":"PHP","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЛьвиная доля всех работ по анализу защищенности внешнего периметра – это тестирование веб-приложений. Здесь могут быть как корпоративные решения, так и «домашние» разработки на базе различных публичных систем управления контентом (CMS). Мы всегда проводим глубокий анализ подобных решений на тестовых стендах и зачастую находим уязвимости нулевого дня. Собственно, из опыта таких проектов и родилась идея собрать исследовательскую команду и провести глубокий анализ популярных CMS-систем и различных плагинов для них. В этом посте мы поделимся результатами нашего исследования, а также продемонстрируем примеры уязвимого кода наиболее интересных, на наш взгляд, уязвимостей и примеры их эксплуатации. Конечно все эти уязвимости уже исправлены и описываются здесь с разрешения владельцев систем.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6df\u002F317\u002F4e6\u002F6df3174e60bbe263a70bcafdf9e51e6b.jpg","buttonTextHtml":"Не всё то в безопасности, что с Bug Bounty","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6df\u002F317\u002F4e6\u002F6df3174e60bbe263a70bcafdf9e51e6b.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"cms"},{"titleHtml":"уязвимости"},{"titleHtml":"уязвимости и их эксплуатация"},{"titleHtml":"уязвимость нулевого дня"}]},"580008":{"id":"580008","timePublished":"2021-09-27T06:30:02+00:00","isCorporative":false,"lang":"ru","titleHtml":"Летний Магнитогорск","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2614609","alias":"city_scraper","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F8f8\u002Fd6c\u002F328\u002F8f8d6c328ec3a513103b6757c2c21610.png","speciality":"Пользователь"},"statistics":{"commentsCount":5,"favoritesCount":2,"readingCount":2546,"score":9,"votesCount":15},"hubs":[{"relatedData":null,"id":"22012","alias":"Ecology","type":"collective","title":"Экология","titleHtml":"Экология","isProfiled":false},{"relatedData":null,"id":"22024","alias":"urban","type":"collective","title":"Урбанизм","titleHtml":"Урбанизм","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EМагнитогорск Челябинской области – один из крупнейших мировых центров чёрной металлургии. В России это шестой из крупнейших городов, которые не являются центрами субъектов страны. \u003C\u002Fp\u003E\u003Cp\u003EСовсем недавно город был одним из наиболее неблагополучных с точки зрения загрязнения атмосферного воздуха, но в 2021 году был зафиксирован «повышенный» уровень – то есть не «высокий» или «очень высокий», как раньше. \u003C\u002Fp\u003E\u003Cp\u003EКак этот город выглядит летом? Где и как его жители могут проводить время?\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F030\u002F0d1\u002Fcff\u002F0300d1cff2029948d33d803000331724.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F030\u002F0d1\u002Fcff\u002F0300d1cff2029948d33d803000331724.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Магнитогорск"},{"titleHtml":"промышленность"},{"titleHtml":"промышленные города"},{"titleHtml":"урбанизм\u002Fурбания"},{"titleHtml":"урбанистика"},{"titleHtml":"города России"},{"titleHtml":"города"}]},"580038":{"id":"580038","timePublished":"2021-09-26T13:35:19+00:00","isCorporative":false,"lang":"ru","titleHtml":"KODI: собираем удобный и функциональный медиацентр для дома. Часть 9. Spotify","editorVersion":"2.0","postType":"article","postLabels":[{"type":"tutorial","data":null}],"author":{"id":"2644801","alias":"arboozof","fullname":"Роман","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Ff76\u002F452\u002F3d5\u002Ff764523d55be8ef6fc4307ea3158dadf.png","speciality":"IT\u002FRetail"},"statistics":{"commentsCount":15,"favoritesCount":37,"readingCount":5622,"score":10,"votesCount":10},"hubs":[{"relatedData":null,"id":"36","alias":"linux","type":"collective","title":"Настройка Linux","titleHtml":"Настройка Linux","isProfiled":true},{"relatedData":null,"id":"144","alias":"open_source","type":"collective","title":"Open source","titleHtml":"Open source","isProfiled":true},{"relatedData":null,"id":"21908","alias":"smartphones","type":"collective","title":"Смартфоны","titleHtml":"Смартфоны","isProfiled":false},{"relatedData":null,"id":"21946","alias":"video_tech","type":"collective","title":"Видеотехника","titleHtml":"Видеотехника","isProfiled":false},{"relatedData":null,"id":"21988","alias":"sound","type":"collective","title":"Звук","titleHtml":"Звук","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"6","alias":"admin","title":"Администрирование"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EПродолжаем тему интеграции в наш медиацентр онлайн-сервисов прослушивания музыки. Ранее мы уже «подружили» медиацентр KODI с сервисом Яндекс.Музыка. Сегодня на очереди не менее популярный сервис – Spotify.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd36\u002Fb76\u002Fd13\u002Fd36b76d13fccd166d952840d838d4997.png","buttonTextHtml":"Читать дальше &rarr;","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd36\u002Fb76\u002Fd13\u002Fd36b76d13fccd166d952840d838d4997.png","fit":"cover","positionY":0,"positionX":14.74358974359}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"kodi"},{"titleHtml":"xbmc"},{"titleHtml":"ubuntu"},{"titleHtml":"kubuntu"},{"titleHtml":"music"},{"titleHtml":"spotify"},{"titleHtml":"addons"},{"titleHtml":"дополнения"},{"titleHtml":"тв"}]},"580048":{"id":"580048","timePublished":"2021-09-26T14:22:36+00:00","isCorporative":false,"lang":"ru","titleHtml":"Будь строже к себе: как ограничения помогают сделать код лучше","editorVersion":"2.0","postType":"article","postLabels":[{"type":"sandbox","data":null}],"author":{"id":"2787821","alias":"ZeBrains_team","fullname":"Станислав Маслов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fae3\u002F3ee\u002F4f1\u002Fae33ee4f1a117aeeab42ec5a9e2eba25.jpg","speciality":"директор продакшена в IT-компании"},"statistics":{"commentsCount":10,"favoritesCount":48,"readingCount":4472,"score":8,"votesCount":16},"hubs":[{"relatedData":null,"id":"19583","alias":"dev_management","type":"collective","title":"Управление разработкой","titleHtml":"Управление разработкой","isProfiled":true},{"relatedData":null,"id":"20682","alias":"pm","type":"collective","title":"Управление проектами","titleHtml":"Управление проектами","isProfiled":true},{"relatedData":null,"id":"20726","alias":"productpm","type":"collective","title":"Управление продуктом","titleHtml":"Управление продуктом","isProfiled":true}],"flows":[{"id":"3","alias":"management","title":"Менеджмент"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003E\u003Cstrong\u003E\u003Cem\u003EЕсли вам приходилось задумываться о построении эффективной экосистемы проекта и определении ролей тимлида и разработчика — статья Артема Прозорова из ZeBrains для вас. \u003C\u002Fem\u003E\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003EПредлагаю вам задуматься над одним вопросом. Но не спешите с ответом, потому что он не так очевиден, как может показаться:\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EКакая из команд может реализовать более технически стабильный продукт?&nbsp;\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EКоманда №1:\u003C\u002Fstrong\u003E Проектный менеджер, аналитик, тестировщик и несколько разработчиков, у каждого из которых за плечами минимум три года опыта. Все работают в одном офисе, посвящая свое время одному проекту в режиме fulltime.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EКоманда №2:\u003C\u002Fstrong\u003E Один сильный разработчик. Ему помогают множество не знакомых между собой людей из разных часовых поясов. У каждого — свой набор компетенций и уровень опыта. Работой над проектом участники занимаются в свободном режиме, по несколько часов в неделю.\u003C\u002Fp\u003E\u003Cp\u003E* * *\u003C\u002Fp\u003E\u003Cp\u003EОтвет на этот вопрос получим к концу статьи.\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fefe\u002F413\u002Feb2\u002Fefe413eb27c391cfcfef0484e6997aab.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"управление проектами"},{"titleHtml":"управление продуктом"},{"titleHtml":"управление командой разработки"},{"titleHtml":"управление командами разработчиков"},{"titleHtml":"тимлид"},{"titleHtml":"тимлиды и разработчики"}]},"580052":{"id":"580052","timePublished":"2021-09-26T15:29:26+00:00","isCorporative":false,"lang":"ru","titleHtml":"Почему экология не может быть плохой?","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2568695","alias":"phanerozoi_evidence","fullname":"Фанерозой","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fdcc\u002F862\u002F561\u002Fdcc862561429f2ed85090ac53e39cf7d.jpg","speciality":"Биологи, врач, научный популяризатор, палеонтолог"},"statistics":{"commentsCount":46,"favoritesCount":26,"readingCount":4853,"score":8,"votesCount":28},"hubs":[{"relatedData":null,"id":"20742","alias":"read","type":"collective","title":"Читальный зал","titleHtml":"Читальный зал","isProfiled":false},{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"22012","alias":"Ecology","type":"collective","title":"Экология","titleHtml":"Экология","isProfiled":false},{"relatedData":null,"id":"22750","alias":"biology","type":"collective","title":"Биология","titleHtml":"Биология","isProfiled":false}],"flows":[{"id":"3","alias":"management","title":"Менеджмент"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003E\u003Cem\u003EСо второй половины ХХ в мы всё чаще слышим из средств массовой информации выражения «плохая экология», «сохранить экологию», «экология строительных материалов». Но, к сожалению, не многие знают, что такое «экология» на самом деле. Для разгадки тайн экологии нам предстоит окунуться в удивительный мир науки...\u003C\u002Fem\u003E\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F9a4\u002Fecf\u002Fd11\u002F9a4ecfd1144e299873622d45d23d2ce0.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F9a4\u002Fecf\u002Fd11\u002F9a4ecfd1144e299873622d45d23d2ce0.png","fit":"cover","positionY":29.545454545455,"positionX":1.4102564102564}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"виды"},{"titleHtml":"охрана окружающей среды"},{"titleHtml":"мифы"},{"titleHtml":"экосистема"},{"titleHtml":"биогеоценоз"},{"titleHtml":"экология"},{"titleHtml":"экосистемы"},{"titleHtml":"биоценозы"},{"titleHtml":"биология"},{"titleHtml":"вирусы"}]},"580060":{"id":"580060","timePublished":"2021-09-27T09:00:04+00:00","isCorporative":true,"lang":"ru","titleHtml":"Арракис, который мы заслужили","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"238277","alias":"Zelenyikot","fullname":"Виталий Егоров","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F22b\u002F2d7\u002F7a5\u002F22b2d77a57b687aae24784a3e53089c9.jpg","speciality":"Популяризатор космонавтики"},"statistics":{"commentsCount":11,"favoritesCount":21,"readingCount":6597,"score":64,"votesCount":70},"hubs":[{"relatedData":null,"id":"19791","alias":"ruvds","type":"corporative","title":"Блог компании RUVDS.com","titleHtml":"Блог компании RUVDS.com","isProfiled":false},{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"21962","alias":"space","type":"collective","title":"Космонавтика","titleHtml":"Космонавтика","isProfiled":false},{"relatedData":null,"id":"21984","alias":"sci-fi","type":"collective","title":"Научная фантастика","titleHtml":"Научная фантастика","isProfiled":false},{"relatedData":null,"id":"22014","alias":"futurenow","type":"collective","title":"Будущее здесь","titleHtml":"Будущее здесь","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F580060\u002F\"\u003E\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fk0\u002Fds\u002Fy5\u002Fk0dsy5npxclyjdytiroqga7-leu.jpeg\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fa\u003E\u003Cbr\u003E\r\nВо вселенной писателя-фантаста Фрэнка Герберта, Дюна, она же Арракис &mdash; это пустынная и маловодная планета с двумя лунами. По сюжету, она находится за пределами Солнечной системы, но если мы захотим поискать ближайшую схожую параллель,&nbsp;то больше всего подходит планета Марс. Предлагаю воспользоваться возможностями, которые даёт современная космонавтика, и совершить воображаемую прогулку на нашу Дюну.\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Марс"},{"titleHtml":"Дюна"},{"titleHtml":"MRO"},{"titleHtml":"Curiosity"},{"titleHtml":"марсоход"},{"titleHtml":"ruvds_статьи"}]},"580066":{"id":"580066","timePublished":"2021-09-26T18:12:37+00:00","isCorporative":false,"lang":"ru","titleHtml":"Сколько мы переплачиваем за сервера используя Ruby on Rails","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"941194","alias":"motoroller95","fullname":"Искандар Гохар","avatarUrl":"","speciality":"Ruby on Rails developer at IT-territory"},"statistics":{"commentsCount":48,"favoritesCount":6,"readingCount":4488,"score":7,"votesCount":13},"hubs":[{"relatedData":null,"id":"224","alias":"ruby","type":"collective","title":"Ruby","titleHtml":"Ruby","isProfiled":true},{"relatedData":null,"id":"8279","alias":"ror","type":"collective","title":"Ruby on Rails","titleHtml":"Ruby on Rails","isProfiled":true},{"relatedData":null,"id":"17822","alias":"parallel_programming","type":"collective","title":"Параллельное программирование","titleHtml":"Параллельное программирование","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EВ \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F577948\u002F\" rel=\"noopener noreferrer nofollow\"\u003Eпрошлой\u003C\u002Fa\u003E статье я разбирался с тем как работает GIL, а сегодня меня захватила идея узнать насколько дорого обходится этот GIL для кода, который исполняется у нас на бэкенде. Для этого я решил пропатчить MRI и добавить пару переменных, в которые буду засекать сколько времени поток реально выполнял код, а сколько ничего не делал и ждал пока ему удастся завладеть локом. \u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"ruby"},{"titleHtml":"gil"}]},"580080":{"id":"580080","timePublished":"2021-09-26T19:12:55+00:00","isCorporative":false,"lang":"ru","titleHtml":"Дайджест свежих материалов из мира фронтенда за последнюю неделю №486 (20 — 26 сентября 2021)","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"59347","alias":"alexzfort","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd2a\u002Fe8a\u002F5ac\u002Fd2ae8a5ac9876f838ebdd45f3ea3bc3b.png","speciality":""},"statistics":{"commentsCount":2,"favoritesCount":18,"readingCount":3174,"score":17,"votesCount":17},"hubs":[{"relatedData":null,"id":"91","alias":"webdev","type":"collective","title":"Разработка веб-сайтов","titleHtml":"Разработка веб-сайтов","isProfiled":true},{"relatedData":null,"id":"307","alias":"css","type":"collective","title":"CSS","titleHtml":"CSS","isProfiled":true},{"relatedData":null,"id":"357","alias":"javascript","type":"collective","title":"JavaScript","titleHtml":"JavaScript","isProfiled":true},{"relatedData":null,"id":"17103","alias":"html5","type":"collective","title":"HTML","titleHtml":"HTML","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"Предлагаем вашему вниманию подборку с ссылками на новые материалы из области фронтенда и около него.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fec\u002F0x\u002Fkx\u002Fec0xkxfr5jd-rci1wjo9bmr4cns.jpeg\"\u003E\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"дайджест"},{"titleHtml":"фронтенд"},{"titleHtml":"css"},{"titleHtml":"js"},{"titleHtml":"es6"},{"titleHtml":"vue"},{"titleHtml":"react"},{"titleHtml":"angular"},{"titleHtml":"ember"},{"titleHtml":"html5"},{"titleHtml":"браузеры"},{"titleHtml":"ссылки"}]},"580084":{"id":"580084","timePublished":"2021-09-26T19:30:13+00:00","isCorporative":false,"lang":"ru","titleHtml":"Telegram Bots vs Google Forms","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2705023","alias":"dm_aq","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":4,"favoritesCount":21,"readingCount":3751,"score":7,"votesCount":7},"hubs":[{"relatedData":null,"id":"144","alias":"open_source","type":"collective","title":"Open source","titleHtml":"Open source","isProfiled":true},{"relatedData":null,"id":"19441","alias":"kotlin","type":"collective","title":"Kotlin","titleHtml":"Kotlin","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EGoogle forms отличный инструмент для решения простых организационных задач, например, сбор информации для регистрации людей на небольшое мероприятие. Но что если мы попытаемся решить эту задачу по другому? Например через telegram.&nbsp;\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"telegrambot"},{"titleHtml":"telegram"},{"titleHtml":"kotlin"},{"titleHtml":"spring"}]},"580086":{"id":"580086","timePublished":"2021-09-26T19:37:10+00:00","isCorporative":false,"lang":"ru","titleHtml":"Термо принтер и JavaScript","editorVersion":"2.0","postType":"article","postLabels":[{"type":"recovery","data":null}],"author":{"id":"1709955","alias":"IIIarp","fullname":"Сергей Шарпов","avatarUrl":"","speciality":"Веб разработчик"},"statistics":{"commentsCount":46,"favoritesCount":33,"readingCount":7984,"score":38,"votesCount":40},"hubs":[{"relatedData":null,"id":"84","alias":"crazydev","type":"collective","title":"Ненормальное программирование","titleHtml":"Ненормальное программирование","isProfiled":true},{"relatedData":null,"id":"357","alias":"javascript","type":"collective","title":"JavaScript","titleHtml":"JavaScript","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EПриобрел я на днях термопринтер (кассовый аппарат, если изволите) жене для магазина и решил что смогу его обуздать как истинный программист и сделать свою веб кассу, вместо того, что-бы использовать платные решения, ведь задача простая, печатать чеки, но это оказалось не так то и просто...\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4f3\u002F259\u002Fe4e\u002F4f3259e4e73b5bfae82890fd3db512a0.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4f3\u002F259\u002Fe4e\u002F4f3259e4e73b5bfae82890fd3db512a0.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"термопринтер"},{"titleHtml":"javascript"},{"titleHtml":"webusb"}]},"580088":{"id":"580088","timePublished":"2021-09-26T21:17:27+00:00","isCorporative":false,"lang":"ru","titleHtml":"Запуск X-приложения в chroot на примере POSE (или «QEMU не нужен»)","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"1481597","alias":"edo1h","fullname":null,"avatarUrl":"","speciality":"немного программист, немного админ"},"statistics":{"commentsCount":5,"favoritesCount":8,"readingCount":959,"score":11,"votesCount":11},"hubs":[{"relatedData":null,"id":"221","alias":"sys_admin","type":"collective","title":"Системное администрирование","titleHtml":"Системное администрирование","isProfiled":true},{"relatedData":null,"id":"7289","alias":"nix","type":"collective","title":"*nix","titleHtml":"*nix","isProfiled":true}],"flows":[{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЭта мини-статья родилась как ответ на статью \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F579296\" rel=\"noopener noreferrer nofollow\"\u003EУпрощаем эмуляцию X86 с помощью Live CD\u003C\u002Fa\u003E, в которой для запуска старых 32-битных приложений на 64-битных дистрибутивах Linux предлагалось использовать QEMU + Live CD — по моему мнению «из пушки по воробьям». Опишу своё решение на \u003Ccode\u003Echroot\u003C\u002Fcode\u003E + \u003Ccode\u003Edebootstrap\u003C\u002Fcode\u003E. \u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"chroot"},{"titleHtml":"debootstrap"},{"titleHtml":"xwindow"}]},"580090":{"id":"580090","timePublished":"2021-09-26T21:19:11+00:00","isCorporative":false,"lang":"ru","titleHtml":"Сравнение подходов к реализации распределенных транзакций для микросервисов","editorVersion":"2.0","postType":"article","postLabels":[{"type":"sandbox","data":null},{"type":"translation","data":{"originalAuthorName":"Bilgin Ibryam","originalUrl":"https:\u002F\u002Fdevelopers.redhat.com\u002Farticles\u002F2021\u002F09\u002F21\u002Fdistributed-transaction-patterns-microservices-compared"}}],"author":{"id":"194270","alias":"sprosin","fullname":"Sergey Prosin","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd67\u002F5d8\u002F1d6\u002Fd675d81d6fe5bf69493735cef4910eb5.jpg","speciality":"Веду команды к релизам, пишу статьи, выступаю."},"statistics":{"commentsCount":6,"favoritesCount":78,"readingCount":3673,"score":14,"votesCount":14},"hubs":[{"relatedData":null,"id":"7504","alias":"refactoring","type":"collective","title":"Проектирование и рефакторинг","titleHtml":"Проектирование и рефакторинг","isProfiled":true},{"relatedData":null,"id":"21482","alias":"distributed_systems","type":"collective","title":"Распределённые системы","titleHtml":"Распределённые системы","isProfiled":true},{"relatedData":null,"id":"22115","alias":"microservices","type":"collective","title":"Микросервисы","titleHtml":"Микросервисы","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EКак архитектор-консультант в Red Hat, я имел возможность поработать над множеством проектов для наших клиентов. У каждого из них есть свои особенности, которые, однако, имеют некоторые общие черты. Большинство клиентов хотят знать, как скоординировать запись в несколько систем одновременно. Ответ на этот вопрос обычно включает подробное объяснение двойной записи, распределенных транзакций, современных альтернатив, а также возможных сценариев сбоев и недостатков каждого подхода. Как правило, именно в этот момент заказчик понимает, что разделение монолитного приложения на микросервисы - долгий и сложный путь, обычно требующий компромиссов.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbc4\u002F35d\u002Fff3\u002Fbc435dff35d09143dacf29bbc1e470a7.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbc4\u002F35d\u002Fff3\u002Fbc435dff35d09143dacf29bbc1e470a7.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"распределенные системы"},{"titleHtml":"микросервисы"},{"titleHtml":"транзакции"},{"titleHtml":"распределенные транзакции"},{"titleHtml":"оркестрация"},{"titleHtml":"оркестрация микросервисов"},{"titleHtml":"хореография"},{"titleHtml":"конвейеры"}]},"580092":{"id":"580092","timePublished":"2021-09-26T21:49:14+00:00","isCorporative":false,"lang":"ru","titleHtml":"30 сентября: Let's Encrypt и конец срока действия IdenTrust DST Root CA X3","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"805873","alias":"rantal","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":79,"favoritesCount":44,"readingCount":14114,"score":41,"votesCount":41},"hubs":[{"relatedData":null,"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true},{"relatedData":null,"id":"17350","alias":"s_admin","type":"collective","title":"Серверное администрирование","titleHtml":"Серверное администрирование","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003E30 сентября 2021 14:01:15  GMT оканчивается срок действия корневого сертификата IdenTrust DST Root CA X3.\u003C\u002Fp\u003E\u003Cp\u003EЭто событие достойно вашего внимания по той причине, что после наступления этого момента ряд устаревших систем перестанут доверять сертификатам,&nbsp;выпущенным центром сертификации Let’s Encrypt. С учётом того, что на текущий момент Let's Encrypt предоставляет бесплатные криптографические сертификаты примерно для \u003Ca href=\"https:\u002F\u002Fletsencrypt.org\u002Fstats\u002F\" rel=\"noopener noreferrer nofollow\"\u003E250 миллионов доменных имен\u003C\u002Fa\u003E, а \"устаревшие системы\" - это порой системы возрастом всего 5-6 лет, вряд ли окончание срока действия сертификата&nbsp;DST Root CA X3 пройдёт для всех гладко и незаметно. В чём причина, кого конкретно это затронет, и что можно сделать?\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"let's encrypt"},{"titleHtml":"DST Root CA X3"},{"titleHtml":"корневой сертификат"},{"titleHtml":"https"},{"titleHtml":"tls"},{"titleHtml":"openssl"}]},"580094":{"id":"580094","timePublished":"2021-09-26T22:35:26+00:00","isCorporative":false,"lang":"ru","titleHtml":"Блокчейн нас подвёл? Почему ДЭГ — это плохо и можем ли мы адекватно контролировать процесс подсчёта голосов?","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"206414","alias":"PoltoS","fullname":"Сергей Полторак","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F5cf\u002F03a\u002Fc7f\u002F5cf03ac7fe60ea8a6686bd4c57627ddc.png","speciality":""},"statistics":{"commentsCount":78,"favoritesCount":19,"readingCount":11203,"score":25,"votesCount":45},"hubs":[{"relatedData":null,"id":"118","alias":"crypto","type":"collective","title":"Криптография","titleHtml":"Криптография","isProfiled":true},{"relatedData":null,"id":"210","alias":"it_testing","type":"collective","title":"Тестирование IT-систем","titleHtml":"Тестирование IT-систем","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EИнтересно наблюдать, как дискредитируется термин блокчейна на выборах в госдуму. Вроде голосование было на блокчейне, но его якобы подделали. Т.е. блокчейн можно подделать или ЦИК и ДИТ нам подсунули какой-то лохчейн вместо блокчейна?!? И мало кто обсуждает происходящее по существу без эмоций, связанных с результатами партий и кандидатов.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6e5\u002F82b\u002F9d0\u002F6e582b9d062dd29fa41c7842a8b76495.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6e5\u002F82b\u002F9d0\u002F6e582b9d062dd29fa41c7842a8b76495.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Криптография"},{"titleHtml":"блокчейн"},{"titleHtml":"открытые данные"},{"titleHtml":"электронное голосование"},{"titleHtml":"выборы"},{"titleHtml":"выборы в госдуму"},{"titleHtml":"дэг"},{"titleHtml":"дэг 2021"}]},"580150":{"id":"580150","timePublished":"2021-09-27T10:50:03+00:00","isCorporative":true,"lang":"ru","titleHtml":"Топ-5 когнитивных искажений при планировании в IT","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2794469","alias":"KM_QA","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":0,"favoritesCount":13,"readingCount":1099,"score":13,"votesCount":13},"hubs":[{"relatedData":null,"id":"14332","alias":"oleg-bunin","type":"corporative","title":"Блог компании Конференции Олега Бунина (Онтико)","titleHtml":"Блог компании Конференции Олега Бунина (Онтико)","isProfiled":false},{"relatedData":null,"id":"19583","alias":"dev_management","type":"collective","title":"Управление разработкой","titleHtml":"Управление разработкой","isProfiled":true},{"relatedData":null,"id":"20736","alias":"hr_management","type":"collective","title":"Управление персоналом","titleHtml":"Управление персоналом","isProfiled":true},{"relatedData":null,"id":"20754","alias":"tech_events","type":"collective","title":"Конференции","titleHtml":"Конференции","isProfiled":false},{"relatedData":null,"id":"21990","alias":"brain","type":"collective","title":"Мозг","titleHtml":"Мозг","isProfiled":false}],"flows":[{"id":"3","alias":"management","title":"Менеджмент"},{"id":"4","alias":"marketing","title":"Маркетинг"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЭта статья подходит для тимлидов и их подопечных, а также для всех, кто оценивает проекты и задачи. Я расскажу, как и почему мы делаем ошибки из-за когнитивных искажений. Попадаем в них мы почти все, просто потому что мы живые люди. И на примере одного дня из жизни тимлида я хочу показать, в какие искажения чаще всего влетают в IT, и&nbsp; — самое полезное&nbsp; —&nbsp; как из них можно выходить.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EЗамечу, что искать когнитивные искажения стоит, в первую очередь, у себя, а не у коллег. \u003C\u002Fstrong\u003EИ что рассказывать про искажения намного проще, чем не влетать в их на практике, однако, если этому научиться, то в перспективе это изрядно окупается, потому что экономит и время, и деньги, помогая и нам, и команде.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb78\u002F76f\u002F001\u002Fb7876f0010e85c328462a735df0b76e8.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb78\u002F76f\u002F001\u002Fb7876f0010e85c328462a735df0b76e8.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"когнитивные искажения"},{"titleHtml":"нейрофизиология"},{"titleHtml":"мозг"},{"titleHtml":"психология"},{"titleHtml":"тимлидство"},{"titleHtml":"тимлид"},{"titleHtml":"управление людьми"},{"titleHtml":"управление проектами и командой"},{"titleHtml":"управление командой"},{"titleHtml":"управление персоналом"}]}},"articlesIds":{"ARTICLES_LIST_TOP_PERIOD_DAILY":["580060","580092","580086","579542","580094","578296","579854","580080","580090","580150","580088","580038","580008","579772","579804","580052","580048","580084","580066","579654"]},"isLoading":false,"pagesCount":{"ARTICLES_LIST_TOP_PERIOD_DAILY":2},"route":{"name":"ARTICLES_LIST_TOP_PERIOD","params":{"period":"daily"},"query":{}},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":["577750","553112","37686"],"similarListRefs":{"37686":{"id":"37686","timePublished":"2008-08-21T15:27:55+00:00","isCorporative":false,"lang":"ru","titleHtml":"Использование Nginx и php для проверки прав доступа перед отдачей файлов","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"16118","alias":"Chrome","fullname":"Владимир Храмцов","avatarUrl":null,"speciality":"Web-разработчик"},"statistics":{"commentsCount":12,"favoritesCount":89,"readingCount":11280,"score":20,"votesCount":27},"hubs":[{"id":"91","alias":"webdev","type":"collective","title":"Разработка веб-сайтов","titleHtml":"Разработка веб-сайтов","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"Иногда на сайте возникает необходимость ограничить доступ к некоторым файлам по разным причинам(раздавать файлы только авторизованным пользователям, антилич и так далее). Для решения данной задачи можно использовать разные подходы:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003E Раздавать файлы с помощью скрипта на php(заменить php на то, что нравится больше). При данном подходе мы передаем в качестве параметра скрипту имя файла. Код проверяет все условия, при которых возможно получения доступа к данному файлу и принимает решение, выдать 404 или запрошенный файл. Данный подход подходит для мелких файлов, однако при возрастании размера отдаваемого файла он будет потреблять много системных ресурсов, т.к. файл будет вычитываться в память и затем отдаваться.\u003C\u002Fli\u003E\r\n\u003Cli\u003E Использовать некоторые неочевидные возможности веб-серверов.\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\r\n","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null},"553112":{"id":"553112","timePublished":"2021-05-05T08:14:01+00:00","isCorporative":true,"lang":"ru","titleHtml":"Как «озадачить» всех инженеров и не перемудрить с правами доступа. Опыт Cloud4Y","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"64252","alias":"Cloud4Y","fullname":"Cloud4Y","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fc2d\u002Fd0d\u002Fc05\u002Fc2dd0dc05834aebeb86bb76e35caeaab.png","speciality":"Корпоративный облачный провайдер"},"statistics":{"commentsCount":13,"favoritesCount":8,"readingCount":1272,"score":12,"votesCount":14},"hubs":[{"id":"17352","alias":"cloud4y","type":"corporative","title":"Блог компании Cloud4Y","titleHtml":"Блог компании Cloud4Y","isProfiled":false},{"id":"221","alias":"sys_admin","type":"collective","title":"Системное администрирование","titleHtml":"Системное администрирование","isProfiled":true},{"id":"17681","alias":"db_admins","type":"collective","title":"Администрирование баз данных","titleHtml":"Администрирование баз данных","isProfiled":true},{"id":"21470","alias":"cloud_services","type":"collective","title":"Облачные сервисы","titleHtml":"Облачные сервисы","isProfiled":false}],"flows":[{"id":"6","alias":"admin","title":"Администрирование","titleHtml":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EНаша компания постепенно расширяется, у нас работает всё больше инженеров. А когда их много, надо как-то распределять права и доступы. Почему это важно? У нас есть большое количество скриптов по мониторингу, обслуживанию и т.п., которые обслуживаются просто по крону. Но всегда присутствует необходимость писать новые скрипты, актуализировать уже работающие при изменениях конфигурации, а так же дебажить какие-то проблемы. Поэтому технической команде нужно выбрать инженера, который будет заниматься данным вопросом в конкретный момент времени. \u003C\u002Fp\u003E\u003Cp\u003EНо иногда бывает так, что написать новый скрипт или чинить уже существующий отправляют человека, у которого нет права на доступ в эту область инфраструктуры. Например, потому что он новичок. И что делать в этой ситуации? \u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F0b7\u002F49b\u002Fe04\u002F0b749be0495663caaf697ff7cc2a5c81.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F0b7\u002F49b\u002Fe04\u002F0b749be0495663caaf697ff7cc2a5c81.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null},"577750":{"id":"577750","timePublished":"2021-09-14T07:38:11+00:00","isCorporative":false,"lang":"ru","titleHtml":"PHP Generics. Right here. Right now","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"1012434","alias":"mrsuh","fullname":"Anton Sukhachev","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F1c8\u002F6e2\u002F315\u002F1c86e2315ac2204ccb56030444286fad.jpg","speciality":"Web Developer"},"statistics":{"commentsCount":15,"favoritesCount":18,"readingCount":5201,"score":29,"votesCount":29},"hubs":[{"id":"144","alias":"open_source","type":"collective","title":"Open source","titleHtml":"Open source","isProfiled":true},{"id":"260","alias":"php","type":"collective","title":"PHP","titleHtml":"PHP","isProfiled":true},{"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F_x\u002Fey\u002Fw6\u002F_xeyw6-xutglqjdkkumytrmgcl4.png\"\u003E\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003EМногие PHP разработчики хотели бы видеть в PHP поддержку \u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FGeneric_programming\" rel=\"nofollow noopener noreferrer\"\u003Eдженериков\u003C\u002Fa\u003E, и я в том числе. \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FPHPGenerics\u002Fphp-generics-rfc\" rel=\"nofollow noopener noreferrer\"\u003ERFC\u003C\u002Fa\u003E по их добавлению был создан ещё в 2016 году, но до сих пор не принял окончательный вид. Я рассмотрел несколько вариантов решений поддержки дженериков в синтаксисе PHP, но не нашёл рабочей версии, которой мог бы воспользоваться обычный разработчик.\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003EВ итоге я решил, что могу сам попробовать реализовать такое решение на PHP. Скриншот выше — реальный пример того, что у меня получилось.\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003EЕсли хочется сразу попробовать, то вот библиотека \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fmrsuh\u002Fphp-generics\" rel=\"nofollow noopener noreferrer\"\u003Emrsuh\u002Fphp-generics\u003C\u002Fa\u003E и \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fmrsuh\u002Fphp-generics-example\" rel=\"nofollow noopener noreferrer\"\u003Eрепо\u003C\u002Fa\u003E, в котором можно поиграться.\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null}}},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{"l2k":{"scoreStats":{"score":28.3,"votesCount":278},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"40128","alias":"l2k","fullname":"l2k","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fbf6\u002F784\u002Ff3c\u002Fbf6784f3c323091e91f5deba0ae6641d.jpg","speciality":null}},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.670ab961.js" defer></script><script src="https://assets.habr.com/habr-web/js/chunk-f458c7c4.6e221df6.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.76acc47b.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
