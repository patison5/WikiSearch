<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Часть 1/3. Компилятор идеальной VM для ICFPC 2009, на Haskell, с популяризаторскими комментариями / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.0f7bdd8f.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.670ab961.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.01bb2993.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.76acc47b.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-f458c7c4.e48e8f79.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-f458c7c4.6e221df6.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.0f7bdd8f.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.01bb2993.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-f458c7c4.e48e8f79.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.4f7c12b4e1b1b4c0e44ef6f9f33b1f9f.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/68995\/"},"headline":"Часть 1\/3. Компилятор идеальной VM для ICFPC 2009, на Haskell, с популяризаторскими комментариями","datePublished":"2009-09-21T01:37:24+04:00","dateModified":"2009-09-21T17:10:40+04:00","author":{"@type":"Person","name":"Я робот"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Здесь мы будем разбирать по буквам некую программу (компилятор VM) на Хаскеле. На вход этому компилятору дается бинарный файл с инструкциями некоего процессора,...","url":"https:\/\/habr.com\/ru\/post\/68995\/#post-content-body","about":["h_haskell","f_develop"],"image":["https:\/\/habr.com\/share\/publication\/68995\/11ebce96cc1af072c97dc76eb3d32773\/"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.47.1">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Часть 1/3. Компилятор идеальной VM для ICFPC 2009, на Haskell, с популяризаторскими комментариями" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Часть 1/3. Компилятор идеальной VM для ICFPC 2009, на Haskell, с популяризаторскими комментариями" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Часть 1/3. Компилятор идеальной VM для ICFPC 2009, на Haskell, с популяризаторскими комментариями" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Здесь мы будем разбирать по буквам некую программу (компилятор VM) на Хаскеле. На вход этому компилятору дается бинарный файл с инструкциями некоего процессора, где в этих инструкциях описываются..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Здесь мы будем разбирать по буквам некую программу (компилятор VM) на Хаскеле. На вход этому компилятору дается бинарный файл с инструкциями некоего процессора, где в этих инструкциях описываются..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Здесь мы будем разбирать по буквам некую программу (компилятор VM) на Хаскеле. На вход этому компилятору дается бинарный файл с инструкциями некоего процессора, где в этих инструкциях описываются..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Здесь мы будем разбирать по буквам некую программу (компилятор VM) на Хаскеле. На вход этому компилятору дается бинарный файл с инструкциями некоего процессора, где в этих инструкциях описываются..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Здесь мы будем разбирать по буквам некую программу (компилятор VM) на Хаскеле. На вход этому компилятору дается бинарный файл с инструкциями некоего процессора, где в этих инструкциях описываются..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/68995/11ebce96cc1af072c97dc76eb3d32773/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/68995/11ebce96cc1af072c97dc76eb3d32773/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/68995/11ebce96cc1af072c97dc76eb3d32773/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/68995/11ebce96cc1af072c97dc76eb3d32773/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/68995/11ebce96cc1af072c97dc76eb3d32773/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="68995" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2009-09-20T21:37:24.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/68995/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/68995/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/68995/11ebce96cc1af072c97dc76eb3d32773/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.cee85629.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
              Как стать автором
            </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.cee85629.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.cee85629.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.cee85629.svg#pull-arrow"></use></svg></div></div> <!----> <div class="tm-page-article__body"><article class="tm-page-article__content tm-page-article__content_inner"><div class="tm-page-article__head-wrapper"><!----> <div class="tm-article-snippet tm-page-article__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/San13/" title="San13" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_lilac"><!----> <use xlink:href="/img/megazord-v24.cee85629.svg#placeholder-user"></use></svg></div></a> <span class="tm-user-info__user"><a href="/ru/users/San13/" class="tm-user-info__username">
      San13
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2009-09-20T21:37:24.000Z" title="2009-09-21, 01:37">21  сентября  2009 в 01:37</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Часть 1/3. Компилятор идеальной VM для ICFPC 2009, на Haskell, с популяризаторскими комментариями</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/haskell/" class="tm-article-snippet__hubs-item-link"><span>Haskell</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <!----> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml">Здесь мы будем разбирать по буквам некую программу (компилятор VM) на Хаскеле. На вход этому компилятору дается бинарный файл с инструкциями некоего процессора, где в этих инструкциях описываются некие вычисления. На выходе нашего компилятора получается текст программы, тоже на Хаскеле, которая производит те же самые вычисления, с большой скоростью. Возможно, это не компилятор, а декомпилятор, не знаю. Сравнение работы результирующих программ на Haskell/Java приводится в <a href="http://san13.habrahabr.ru/blog/67225/">предыдущем посте</a>.<br/>
<br/>
<a name="habracut"></a><br/>
<br/>
Предупреждение: людям с формальным математическим мышлением <b>читать запрещено</b>! Вы уже и так всё знаете. Этот пост для людей, интересующихся еще чем-то сверх обычных C/C++/C#/Java, потому что в последние 5 лет им надоело писать одно и то же на этих чудесных языках.<br/>
<br/>
Про исходное задание ICFP контеста еще раз, с техническими подробностями: нам дается бинарный файл, в котором программа (вычисляющая формулы) написанная в машинных инструкциях некоторого процессора. Формул сразу несколько, потому при вычислении формул используется специальный пул для возвращаемых значений. Есть пул для входных значений. И есть пул для хранения значений, требующихся во время расчета формул, и для значений, живущих от итерации к итерации (т.е. когда программа запускается много раз, она может использовать данные от прошлого запуска). Входной пул в терминах задачи называется набором входных портов, аналогично существуют выходные порты, всё остальное называют просто «память».<br/>
<br/>
Вычисления производятся следующим образом: посредством сложений, вычитаний и прочих арифметических операций над данными из входных портов и памяти, получается значение, которое записывается в один из выходных портов. По замыслу авторов, бинарный файл из задания является программой для «черного ящика», который умеет нам что-то вычислять.<br/>
<br/>
Реализовать этот черный ящик, чтобы он вычислял вообще быстро, и является нашей первой целью в ICFPC 2009, а остальное (рассчитать управляющие воздействия на спутник, чтобы он правильно летал в мире, который описывается этими формулами) — является самой главной целью контеста, которую мы рассматривать этом посте не будем, а может быть, в другом.<br/>
<br/>
В этом бинарном файле первоначальные данные были расположены вперемешку с кодом следующим образом:<br/>
<table cellpadding="3" border="1">
<tbody>
<tr>
<td>Смещение (дес)<br/>
</td>
<td>Длина<br/>
</td>
<td>Содержимое<br/>
</td>
<td>Тип<br/>
</td>
</tr>
<tr>
<td>O<br/>
</td>
<td>8<br/>
</td>
<td><font>данные(ячейка 0)</font></td>
<td>Double<br/>
</td>
</tr>
<tr>
<td>8<br/>
</td>
<td>4<br/>
</td>
<td><font>опкод(ячейка 0)</font></td>
<td>UInt32<br/>
</td>
</tr>
<tr>
<td>12<br/>
</td>
<td>4<br/>
</td>
<td><font>опкод(ячейка 1)</font></td>
<td>UInt32<br/>
</td>
</tr>
<tr>
<td>16<br/>
</td>
<td>8<br/>
</td>
<td><font>данные(ячейка 1)</font></td>
<td>Double<br/>
</td>
</tr>
</tbody>
</table>потом тот же порядок повторяется для ячеек 2,3, затем 4,5 итд. В спецификации написано: для четных ячеек вначале идут данные, затем опкод, для нечетных наоборот. Зачем здесь есть данные, почему вообще существуют даннные, отличные от нуля? Очень просто, 1) в опкодах невозможно забить константу, используется переменная (ячейка памяти), которая никем не модифицируется 2) некоторые переменные инициализированы, и они тоже лежат в данных.<br/>
<br/>
Для того чтобы скомпилировать таковой бинарник в красивый текст на любом языке, необходимо:<br/>
<br/>
1) прочитать бинарник в буфер<br/>
2) отделить данные от опкодов<br/>
3) построить AST из опкодов (AST в здешних терминах — это дизассемблированный опкод разложеный в удобную для манипуляций форму, в оригинале это означает Abstract Syntax Tree, дерево абстрактное потому что содержит суть программы, а не ее текстовое или бинарное представление)<br/>
4) трансформировать AST в другой вид (более высокоуровневый)<br/>
5) вывести AST в текстовом виде на требуемом языке, а также вывести определение данных с их первоначальным значением.<br/>
<br/>
Далее идет программа с комментариями для совершенно далеких от Хаскеля людей, поэтому некоторые моменты в объяснениях намеренно упрощены и даже слегка искажены (помечено отдельно), для легкости восприятия.<br/>
<br/>
Подключение некоторых стандартных модулей:<br/>
<br/>
<blockquote><code><font color="#a020f0">import</font> System.IO&lt;br><br/>
<font color="#a020f0">import</font> Foreign.Marshal.Alloc&lt;br><br/>
<font color="#a020f0">import</font> Foreign.Ptr&lt;br><br/>
<font color="#a020f0">import</font> Data.Word&lt;br><br/>
<font color="#a020f0">import</font> Foreign.Storable&lt;br><br/>
<font color="#a020f0">import</font> Debug.Trace&lt;br><br/>
<font color="#a020f0">import</font> Data.Bits&lt;br><br/>
<font color="#a020f0">import</font> Data.List&lt;br><br/>
<font color="#a020f0">import</font> Data.Maybe</code></blockquote><br/>
Описание синонимов типов, для подробности последующих определений данных: говорится, что исходный адрес в составе команды имеет тип Int, равно как и адрес назначения.<br/>
<br/>
<blockquote><code><font color="#2e8b57"><b>type</b></font> DestAddr <font color="#a52a2a"><b>=</b></font> Int&lt;br><br/>
<font color="#2e8b57"><b>type</b></font> SrcAddr <font color="#a52a2a"><b>=</b></font> Int</code></blockquote><br/>
Теперь (ниже) идет элемент AST, то есть декодированная команда из спецификации. Команды обычно содержат адреса входных данных (или несколько штук, например команда сложения) — упоминается тип SrcAddr, и один адрес, в который они пишут результат (упоминается DstAddr).<br/>
<br/>
В нашей задаче с AST проделываются разные штуки: несколько команд заменяются одной, которой нету в спецификации, затем все команды заменяются на вообще какое-то дерево, элементами которого являются те же команды, но из другого набора (об этом позднее). Положено бы разделить наборы команд в разные типы, но в данном случае у нас тут свалка, и только комментарии помогают отделить набор от набора (см ниже).<br/>
<br/>
В Хаскеле существует так называемый алгебраический тип данных, который вообще повсюду, и он очень удобен для использования в нашем случае. Мы создаем тип Op (от слова opcode) и задаем ему несколько конструкторов (это не конструкторы из OOП, а если мыслить в терминах из OOП, то здесь декларируется пустой класс Op, и множество производных от него классов, и у каждого свои данные).<br/>
 <br/>
<blockquote><code><font color="#2e8b57"><b>data</b></font> Op <font color="#a52a2a"><b>=</b></font> &lt;br><br/>
<font color="#0000ff">-- это конструкторы использующиеся в дереве. В частности, листья дерева:</font>&lt;br><br/>
 Const Double <font color="#a52a2a"><b>|</b></font>&lt;br><br/>
 ReadExp SrcAddr <font color="#a52a2a"><b>|</b></font>  <font color="#0000ff">-- read main memory</font>&lt;br><br/>
 ReadVarExp SrcAddr <font color="#a52a2a"><b>|</b></font> <font color="#0000ff">-- read temporary variable</font>&lt;br><br/>
 ReadPortExp SrcAddr <font color="#a52a2a"><b>|</b></font> <font color="#0000ff">-- read port</font>&lt;br><br/>
               <font color="#0000ff">-- узлы дерева:</font>&lt;br><br/>
          SqrtExp Op <font color="#a52a2a"><b>|</b></font> SubExp Op Op <font color="#a52a2a"><b>|</b></font> AddExp Op Op <font color="#a52a2a"><b>|</b></font> MulExp Op Op <font color="#a52a2a"><b>|</b></font> DivExp Op Op <font color="#a52a2a"><b>|</b></font> <font color="#0000ff">-- math</font>&lt;br><br/>
 IfExp CmdOp Op Op Op  <font color="#a52a2a"><b>|</b></font> <font color="#0000ff">-- branch: compare 1st op with zero, choose from other ops.</font>&lt;br><br/>
<font color="#0000ff">-- плоские операции (из спецификации+дополнительные)</font>&lt;br><br/>
 Add DestAddr SrcAddr SrcAddr <font color="#a52a2a"><b>|</b></font>&lt;br><br/>
 Sub DestAddr SrcAddr SrcAddr <font color="#a52a2a"><b>|</b></font>&lt;br><br/>
 Mul DestAddr SrcAddr SrcAddr <font color="#a52a2a"><b>|</b></font>&lt;br><br/>
 Div DestAddr SrcAddr SrcAddr <font color="#a52a2a"><b>|</b></font>&lt;br><br/>
 Output SrcAddr SrcAddr <font color="#a52a2a"><b>|</b></font>         <font color="#0000ff">-- copy from memory to out port.</font>&lt;br><br/>
 If CmdOp SrcAddr DestAddr SrcAddr SrcAddr <font color="#a52a2a"><b>|</b></font>  <font color="#0000ff">--  compare mem with 0,choose,store </font>&lt;br><br/>
 Input DestAddr SrcAddr <font color="#a52a2a"><b>|</b></font>   <font color="#0000ff">-- read src port into memory</font>&lt;br><br/>
 Sqrt DestAddr SrcAddr <font color="#a52a2a"><b>|</b></font>&lt;br><br/>
 Copy DestAddr SrcAddr <font color="#a52a2a"><b>|</b></font>&lt;br><br/>
<font color="#0000ff">-- низкоуровневые плоские операции, от которых мы избавляемся практически сразу</font>&lt;br><br/>
 Cmpz CmdOp SrcAddr <font color="#a52a2a"><b>|</b></font>   <font color="#0000ff">-- first part of "If"</font>&lt;br><br/>
 Phi DestAddr SrcAddr SrcAddr <font color="#a52a2a"><b>|</b></font>    <font color="#0000ff">-- second part of "If"</font>&lt;br><br/>
 Noop DestAddr   &lt;br><br/>
                                <font color="#2e8b57"><b>deriving</b></font> Show<br/>
</code></blockquote><br/>
Видим, что варианты у нас перечисляются через символ "|", традиционно означающий «или». Также наличествует «deriving Show», означающее, что если мы захотим перевести какое-то значение данного типа к строке, то получим строку на хаскеле, приблизительно близкую к оригиналу. Данная конструкция означает буквально следующее: «компилятор, сделай указанный тип принадлежащим к классу Show, а метод класса Show, который переводит из значения в строку, сгенерируй сам таким, какой умеешь.»<br/>
<br/>
Теперь о том, что у нас будет про дерево. Предположим, в результирующем коде будет сгенерено выражение:<br/>
 o32 = (i2 * 37) + (m75 * (m76 * t4))<br/>
Оно означает: в выходной порт поместить значение входного порта умноженное на 37 плюс произведение двух ячеек памяти и одной временной переменной. Выражение справа от скобок записывается в терминах нашего AST следующим образом:<br/>
<br/>
<code>     AddExp (MulExp (ReadPortExp <font color="#ff00ff">2</font>) (ConstExp <font color="#ff00ff">37</font>)) <font color="#a52a2a"><b>...</b></font>&lt;br><br/>
         <font color="#a52a2a"><b>...</b></font> (MulExp (ReadExp <font color="#ff00ff">75</font>) (MulExp (ReadExp <font color="#ff00ff">76</font>) (ReadVarExp <font color="#ff00ff">4</font>)))   <font color="#0000ff">-- lisp? ;)</font></code><br/>
<br/>
Если посчитать скобки, должно сходиться 8). Что у нас в листьях дерева? Константы, входные порты, память и временные переменные. Как мы отличаем одно от другого? Ведь по спецификации у нас есть только входные порты и память? Откуда же берутся константы, например?<br/>
<br/>
Очень просто. Если у нас в ячейку никто не пишет, а все только читают из нее, то это константа. Имеет смысл вынести ее из «памяти» и забить ее константой в результирующем коде. Аналогичным образом отделяются временные пременные от постоянных переменных, а так же переменные, которых вообще не должно быть, то есть они должны быть преобразованы прямо в выражения со скобками (см несколько ниже).<br/>
<br/>
Продолжаем. Ниже описан кусок AST для условных операций (сравнение с нулем, из спецификации). Сравнений пять штук, по результатам сравнения идет выбор из одного или из другого адреса памяти.<br/>
<br/>
<blockquote><code><font color="#2e8b57"><b>data</b></font> CmdOp <font color="#a52a2a"><b>=</b></font> Ltz <font color="#a52a2a"><b>|</b></font> Lez <font color="#a52a2a"><b>|</b></font> Eqz <font color="#a52a2a"><b>|</b></font> Gez <font color="#a52a2a"><b>|</b></font> Gtz <font color="#2e8b57"><b>deriving</b></font> Enum</code></blockquote><br/>
Представляет интерес конструкция «deriving Enum». Она автоматически относит данный тип к классу Enum, а типы этого класса имеют метод, позволяющий перевести экземпляр типа в целое, и наоборот. Будет использоваться в следующем абзаце.<br/>
<br/>
Теперь зададим, что тип CmdOp принадлежит к классу Show. Данный класс используется для перевода значений какого-либо типа к строковому типу, как было упомянуто выше в «deriving Show». В нашем случае мы не хотим, чтобы компилятор сам генерировал конвертирующие методы по умолчанию, а реализуем свой метод (функцию).<br/>
<br/>
<blockquote><code><font color="#2e8b57"><b>instance</b></font> Show CmdOp <font color="#2e8b57"><b>where</b></font>&lt;br><br/>
show cmdOp <font color="#a52a2a"><b>=</b></font> [<font color="#ff00ff">"&lt;0"</font>,<font color="#ff00ff">"&lt;=0"</font>,<font color="#ff00ff">"==0"</font>,<font color="#ff00ff">">=0"</font>,<font color="#ff00ff">">0"</font>] <font color="#a52a2a"><b>!!</b></font> fromEnum cmdOp</code></blockquote><br/>
Собственно функция — это show, она берет параметром cmdOp, возвращает строку, одну из списка. Выражение справа от знака равенства означает: перевести из значения в целое (fromEnum, вспоминаем deriving Enum), затем это целое использовать как индекс (функция "!!") для выборки из списка (список в квадратных скобках). Коротко и ясно, зато O(N), ну и что. O(N) здесь означает что для получения пятого элемента списка потребуется 5 итераций (потому что здесь использован список, а не массив), а для N-ного, следовательно, N итераций, что долго. Существует простая возможность ускорить, написав case или использовав массив, но я экономил строки программы 8-) <br/>
<br/>
Далее идет функция, переводящая Op в язык, в который мы компилируем. Мы компилируем в хаскель, и поэтому требуется следующее введение:<br/>
<br/>
Наш черный ящик на входе имеет входные порты, и свое предыдущее состояние, а на выходе имеет свое состояние и выходные порты. А скомпилированный в Хаскель бинарный файл будет содержать в себе одну функцию, которая на входе и на выходе будет иметь те же данные. Возвращать выходные порты будем как часть структуры. Таким образом, откомпилированный файл будет содержать в себе:<br/>
<br/>
1) описание данных:<br/>
<br/>
<code><font color="#2e8b57"><b>data</b></font> VMState <font color="#a52a2a"><b>=</b></font> VMState { m13, m55, m77, o11 <font color="#a52a2a"><b>::</b></font> Double }  <font color="#0000ff">-- выходные порты и persistent mem</font></code><br/>
<br/>
2) главную функцию (подробно разбирается далее):<br/>
<br/>
<code>nextState <font color="#a52a2a"><b>::</b></font> VMState <font color="#a52a2a"><b>-></b></font> (Double,Double,<font color="#a52a2a"><b>Double...</b></font>) <font color="#a52a2a"><b>-></b></font> VMState&lt;br><br/>
getNextState x (i2,i3,i16000<font color="#a52a2a"><b>...</b></font>) <font color="#a52a2a"><b>=</b></font>                                                                                       (<font color="#ff00ff">1</font>)&lt;br><br/>
   <font color="#a52a2a"><b>let</b></font> t1 <font color="#a52a2a"><b>=</b></font> i2<font color="#a52a2a"><b>+</b></font>i3 <font color="#a52a2a"><b>+</b></font> m55 x;&lt;br><br/>
        t2 <font color="#a52a2a"><b>=</b></font> <font color="#a52a2a"><b>if</b></font> (i<font color="#a52a2a"><b>-</b></font><font color="#ff00ff">16000</font> <font color="#a52a2a"><b>></b></font> <font color="#ff00ff">O</font>) <font color="#a52a2a"><b>then</b></font> t1<font color="#a52a2a"><b>*</b></font>(i16000<font color="#a52a2a"><b>+</b></font><font color="#ff00ff">1</font>) <font color="#a52a2a"><b>else</b></font> <font color="#ff00ff">O</font>&lt;br><br/>
   <font color="#a52a2a"><b>in</b></font> VMState { m13 <font color="#a52a2a"><b>=</b></font> t1<font color="#a52a2a"><b>+</b></font>t2<font color="#a52a2a"><b>*</b></font><font color="#ff00ff">2</font>, m55 <font color="#a52a2a"><b>=</b></font> <font color="#ff00ff">2</font><font color="#a52a2a"><b>*</b></font>i3<font color="#a52a2a"><b>.....</b></font> o10 <font color="#a52a2a"><b>=</b></font> (i2<font color="#a52a2a"><b>+</b></font><font color="#ff00ff">22</font>)<font color="#a52a2a"><b>*</b></font><font color="#ff00ff">576000.0</font> }</code><br/>
<br/>
3) функцию, возврающую состояние черного ящика в момент времени 0 — то есть те данные, которые мы будем кормить ему итерация за итерацией:<br/>
<br/>
<code>initState <font color="#a52a2a"><b>=</b></font> VMState { m13<font color="#a52a2a"><b>=</b></font><font color="#ff00ff">O</font>, m55<font color="#a52a2a"><b>=</b></font><font color="#ff00ff">123.456</font>, <font color="#a52a2a"><b>...</b></font>o90 <font color="#a52a2a"><b>=</b></font> <font color="#ff00ff">O</font>}</code><br/>
<br/>
Рассмотрим по пунктам каждую строку. Первая объявляет «структуру» данных. Ее отличие от структур C/Java в том, что ее поля нельзя менять, возможно только получить новую структуру с некоторыми (или одним, или всеми) измененными значениями текущей структуры. Пишется это так:<br/>
<br/>
<code>     <font color="#a52a2a"><b>let</b></font> newStruct <font color="#a52a2a"><b>=</b></font> oldStruct { field5 <font color="#a52a2a"><b>=</b></font> <font color="#ff00ff">7</font>, field10 <font color="#a52a2a"><b>=</b></font> <font color="#ff00ff">O</font> }</code><br/>
<br/>
После чего, при желании, старые данные можно выкинуть.<br/>
Для чтения одного поля из структуры используется синтаксис:<br/>
<br/>
<code>     <font color="#a52a2a"><b>let</b></font> myFieldValue <font color="#a52a2a"><b>=</b></font> field5 newStruct</code><br/>
<br/>
Почему так странно? Потому что при объявлении структуры автоматически объявляются все функции для доступа к ее полям. В частности, неявно появляется функция (например):<br/>
<br/>
<code>field5 <font color="#a52a2a"><b>::</b></font> VMState <font color="#a52a2a"><b>-></b></font> Double </code><br/>
<br/>
Это значит, что функция получает на вход значение VMState (в нашем примере наверху мы передали целиком newStruct), а возвращает численное значение с плавающей точкой.<br/>
Попутно мы поняли, как выглядят сигнатуры методов (название метода :: тип). Смотрим на главную функцию<br/>
<br/>
<code>nextState <font color="#a52a2a"><b>::</b></font> VMState <font color="#a52a2a"><b>-></b></font> (Double,Double,<font color="#a52a2a"><b>Double...</b></font>) <font color="#a52a2a"><b>-></b></font> VMState</code><br/>
<br/>
В хаскеле троеточий нет, это я их добавил для иллюстрации того, что мы объявим кортеж из стольких double, сколько нам нужно будет. Функция берет 2 параметра, первый это VMState, второй состоит из нескольких значений (в нашем случае это значения всех портов), и возвращает эта функция новое значение VMState.<br/>
<br/>
Главная функция идеальной VM имеет синтаксис, подобный нижеследующему:<br/>
<br/>
<code>fun arg1 arg2 <font color="#a52a2a"><b>=</b></font> &lt;br><br/>
  <font color="#a52a2a"><b>let</b></font> bind1 <font color="#a52a2a"><b>=</b></font> expr1; bind2 <font color="#a52a2a"><b>=</b></font> expr2&lt;br><br/>
  <font color="#a52a2a"><b>in</b></font> exprResult&lt;br><br/>
  <font color="#2e8b57"><b>where</b></font> bind3 a1 a2 a3 <font color="#a52a2a"><b>=</b></font> expr3&lt;br><br/>
             bind4 a5 a6 <font color="#a52a2a"><b>=</b></font> expr4</code><br/>
<br/>
То есть, мы можем определить некоторые повторно используемые выражения в разделе «let», а потом их свободно использовать в результирующем выражении (которое в «in»). Также мы можем определить такие же выражения в разделе «where», только там обычно описывают не переменные, а функции, локальные (по видимости) к объемлющей функции (fun). Функции можно также описывать в разделе let, но это менее удобно. Добавлю, что из where не видно значений из раздела «let».<br/>
<br/>
Далее, отмечу, что конструкция «if» в хаскеле является выражением. Конструкции «for» в самом языке нету, она есть в отдельном модуле и является обычной функцией. Равно как и «while» и подобные.<br/>
<br/>
В свете вышесказанного продолжим рассмотрение компилятора бинарных файлов.<br/>
<br/>
Нижеследующая функция переводит элемент AST (имеющий тип Op), в строковое представление на языке результата (на Хаскеле). Первым параметром идет строка, содержащая имя параметра с исходным состоянием (потому что мы будем генерировать операции чтения из него), в формуле (1) это будет «x». На самом деле я мог захардкодить это имя, потому что оно встречается всего один раз.<br/>
<br/>
<blockquote><code>ast2haskell <font color="#a52a2a"><b>::</b></font> String <font color="#a52a2a"><b>-></b></font> Op <font color="#a52a2a"><b>-></b></font> String&lt;br><br/>
ast2haskell x op <font color="#a52a2a"><b>=</b></font> s op <font color="#2e8b57"><b>where</b></font> &lt;br><br/>
s (Const d) <font color="#a52a2a"><b>=</b></font> show d  <font color="#0000ff">-- константа показывается как есть.</font>&lt;br><br/>
s (ReadExp r1) <font color="#a52a2a"><b>=</b></font> <font color="#ff00ff">"m"</font><font color="#a52a2a"><b>++</b></font>(show r1)<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">" "</font><font color="#a52a2a"><b>++</b></font>x&lt;br><font color="#0000ff">-- generate read access to memory</font>&lt;br><br/>
s (ReadVarExp r1) <font color="#a52a2a"><b>=</b></font> <font color="#ff00ff">"t"</font><font color="#a52a2a"><b>++</b></font>(show r1)&lt;br>                         <font color="#0000ff">-- to temporary variable </font>&lt;br><br/>
s (ReadPortExp r1) <font color="#a52a2a"><b>=</b></font><font color="#ff00ff">"i"</font><font color="#a52a2a"><b>++</b></font>(show r1)&lt;br>                        <font color="#0000ff">--  to input port </font>&lt;br><br/>
s (SqrtExp op') <font color="#a52a2a"><b>=</b></font> <font color="#ff00ff">"(sqrt "</font><font color="#a52a2a"><b>++</b></font>s op'<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">")"</font>&lt;br><br/>
s (AddExp op1 op2) <font color="#a52a2a"><b>=</b></font> <font color="#ff00ff">"("</font><font color="#a52a2a"><b>++</b></font>s op1<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">"+"</font><font color="#a52a2a"><b>++</b></font>s op2<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">")"</font>&lt;br><br/>
s (SubExp op1 op2) <font color="#a52a2a"><b>=</b></font> <font color="#ff00ff">"("</font><font color="#a52a2a"><b>++</b></font>s op1<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">"-"</font><font color="#a52a2a"><b>++</b></font>s op2<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">")"</font>&lt;br><br/>
s (MulExp op1 op2) <font color="#a52a2a"><b>=</b></font> <font color="#ff00ff">"("</font><font color="#a52a2a"><b>++</b></font>s op1<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">"*"</font><font color="#a52a2a"><b>++</b></font>s op2<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">")"</font>&lt;br><br/>
s (DivExp op1 (Const x)) <font color="#a52a2a"><b>=</b></font> <font color="#ff00ff">"("</font><font color="#a52a2a"><b>++</b></font>s op1<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">"/"</font><font color="#a52a2a"><b>++</b></font>(show x)<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">")"</font>&lt;br><br/>
s (DivExp op1 op2) <font color="#a52a2a"><b>=</b></font> <font color="#ff00ff">"(if "</font><font color="#a52a2a"><b>++</b></font>s op2<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">" /= 0 then "</font><font color="#a52a2a"><b>++</b></font>s op1<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">"/"</font><font color="#a52a2a"><b>++</b></font>s op2<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">" else 0)"</font>&lt;br><br/>
s (IfExp cond opc op1 op2) <font color="#a52a2a"><b>=</b></font> <font color="#ff00ff">"(if "</font><font color="#a52a2a"><b>++</b></font>s opc<font color="#a52a2a"><b>++</b></font>show cond<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">" then "</font><font color="#a52a2a"><b>++</b></font>s op1<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">" else "</font><font color="#a52a2a"><b>++</b></font>s op2<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">")"</font></code></blockquote><br/>
Что мы здесь имеем? Знакомую нам конструкцию fun param = expr where ...., но только сразу идет вызов одной из локальных функций. Почему? Сейчас разберемся. Сначала только обратим внимание, что функция «s» (от «string») имеет несколько определений, по одному определению для каждого конструктора типа Op. В результате, понятное дело, вызовется только одна функция, и сразу же конкретный объект типа Op разобьется на свои компоненты, которым дадутся имена:<br/>
<br/>
<code>s <font color="#a52a2a"><b>::</b></font> Op <font color="#a52a2a"><b>-></b></font> String&lt;br><br/>
s (AddExp op1 op2) <font color="#a52a2a"><b>=</b></font> <font color="#ff00ff">"("</font><font color="#a52a2a"><b>++</b></font>s op1<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">"+"</font><font color="#a52a2a"><b>++</b></font>s op2<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">")"</font></code><br/>
<br/>
Это реализация функции s для конструктора типа Op по имени AddExp, который имеет два параметра: две ветки AST, которые складываются. А сама функция s имеет один аргумент, поэтому там стоят скобки вокруг AddExp. Результатом работы этой функции будет строка, склеенная из кусочков (операция ++ соединяет два списка; строки тоже являются списками). Тут по бокам приклеиваются скобки, а между ними строковые представления обеих веток, между которыми вклеивается плюс. Строковое представление каждой ветки, стало быть, вычисляется рекурсивно, это обычная практика в таких задачах. И, наконец, функция show переводит число в строку, а также она используется для CmdOp (условие сравнения с нулем), который тоже относится к классу Show (описано выше).<br/>
<br/>
Обратим внимание на следующее определение:<br/>
<br/>
<code>s (DivExp op1 (Const x)) <font color="#a52a2a"><b>=</b></font> <font color="#ff00ff">"("</font><font color="#a52a2a"><b>++</b></font>s op1<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">"/"</font><font color="#a52a2a"><b>++</b></font>(show x)<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">")"</font>&lt;br><br/>
s (DivExp op1 op2) <font color="#a52a2a"><b>=</b></font> <font color="#ff00ff">"(if "</font><font color="#a52a2a"><b>++</b></font>s op2<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">" /= 0 then "</font><font color="#a52a2a"><b>++</b></font>s op1<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">"/"</font><font color="#a52a2a"><b>++</b></font>s op2<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">" else 0)"</font></code><br/>
<br/>
Оно замечательно тем, что обе функции работают над данными DivExp, но для выбора первой необходимо чтобы делителем в этом узле была константа! Для этого случая сгенерируется особенный, более простой код, потому что здесь не нужно делать проверку на 0.<br/>
<br/>
Из этого следует, что определение того, какая функция вызывается, не идет по «типу конструктора», а происходит гораздо гибче: входное значение по очереди пытается «пролезть» в каждую реализацию функции с требуемым именем, и вызывается та функция, в которую оно пролезет. В указанном случае в первую функцию не пролезет DivExp, у которого второй параметр инициализирован чем-либо, отличным от Const. Это называется Pattern Matching (не путать с оным для строк).<br/>
<br/>
Теперь о том, для чего вообще была сделана функция «s». Исключительно для удобства. Сравниваем 2 куска, с ней:<br/>
<br/>
<code>ast2haskell x op <font color="#a52a2a"><b>=</b></font> s op <font color="#2e8b57"><b>where</b></font> &lt;br><br/>
s (SubExp op1 op2) <font color="#a52a2a"><b>=</b></font> <font color="#ff00ff">"("</font><font color="#a52a2a"><b>++</b></font>s op1<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">"-"</font><font color="#a52a2a"><b>++</b></font>s op2<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">")"</font>&lt;br><br/>
s (MulExp op1 op2) <font color="#a52a2a"><b>=</b></font> <font color="#ff00ff">"("</font><font color="#a52a2a"><b>++</b></font>s op1<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">"*"</font><font color="#a52a2a"><b>++</b></font>s op2<font color="#a52a2a"><b>++</b></font><font color="#ff00ff">")"</font></code><br/>
<br/>
и без нее:<br/>
<br/>
<code>ast2haskell x (SubExp op1 op2) = "("++ast2haskell x op1++"-"++ast2haskell x op2++")" <br/>
ast2haskell x (MulExp op1 op2) = "("++ast2haskell x op1++"*"++ast2haskell x op2++")" </code><br/>
<br/>
Вывод: код с функцией «s» короче, и не нужно постоянно таскать этот «x», передавая его дальше.<br/>
<br/>
Рассмотрим теперь новую тему — о том, как производится декодирование опкода в операцию, которая у нас представляется типом Op. Каждая операция изначально лежит по какому-то адресу в бинарном файле. Для большинства операций этот же адрес является адресом назначения для результата работы операции (результат сложения и прочих операций — всё кладется в «память» по этому адресу, для каждой операции своему). Именно поэтому мы передаем в функцию пару «опкод, его адрес», а на выходе имеем уже инициализированную операцию, в которой в дополнение к адресу назначения инициализированы дополнительные аргументы, для каждой операции свои.<br/>
<br/>
В спецификации опкодов они декодируются каскадно, то есть если старшая часть опкода равна нулю, то смотрится следующий кусок, иначе это готовый опкод Старшая часть — четыре старших бита, то есть 4 бита вверх, начиная с 28-го бита (28, 29, 30, 31). <br/>
<br/>
Для выкусывания битов из Word32 нами здесь определена функция (.%.), которая может использоваться как операция (инфиксная, то есть стоять между двумя операндами, как + или *). Синтаксис хаскеля позволяет определить функцию с именем из всяких символов, например "++++" Определяется это так:<br/>
<br/>
<code>(<font color="#a52a2a"><b>++++</b></font>) a b <font color="#a52a2a"><b>=</b></font> sqrt(a<font color="#a52a2a"><b>*</b></font>a <font color="#a52a2a"><b>+</b></font> b<font color="#a52a2a"><b>*</b></font>b)</code><br/>
<br/>
или иначе:<br/>
<br/>
<code>a <font color="#a52a2a"><b>++++</b></font> b <font color="#a52a2a"><b>=</b></font> sqrt(a<font><b>*</b></font>a <font color="#a52a2a"><b>+</b></font> b<font color="#a52a2a"><b>*</b></font>b)</code><br/>
<br/>
а используется так:<br/>
<br/>
<code><font color="#a52a2a"><b>let</b></font> q <font color="#a52a2a"><b>=</b></font> <font color="#ff00ff">3</font> <font color="#a52a2a"><b>++++</b></font> <font color="#ff00ff">4</font>&lt;br><br/>
<font color="#a52a2a"><b>let</b></font> p <font color="#a52a2a"><b>=</b></font> (<font color="#a52a2a"><b>++++</b></font>) <font color="#ff00ff">3</font> <font color="#ff00ff">4</font></code><br/>
<br/>
Таким образом, получается очень удобно. Также, можно любую из «обычных» функций двух аргументов сделать инфиксной, см пример ниже с 'shiftL' (сдвиг влево). Для этих целей имя функции берется в обратные кавычки и ставится между операндами. Для инфиксных операторов действуют всякие приоритеты, но это не наша тема сейчас, а сама функция (.%.) будет определена ниже.<br/>
<br/>
<blockquote><code>disasm <font color="#a52a2a"><b>::</b></font> (Word32, Int) <font color="#a52a2a"><b>-></b></font> Op&lt;br><br/>
disasm (opcode, addr) <font color="#a52a2a"><b>=</b></font> disasm1 (opcode <font color="#a52a2a"><b>.%.</b></font> (<font color="#ff00ff">28</font>, <font color="#ff00ff">4</font>))  <font color="#0000ff">-- декодируется первый "каскад"</font>&lt;br>                                         <font color="#0000ff">-- заданный четырьмя старшими битами</font>&lt;br><br/>
   <font color="#2e8b57"><b>where</b></font>&lt;br><br/>
       r1 <font color="#a52a2a"><b>=</b></font> recast <font color="#a52a2a"><b>$</b></font> opcode <font color="#a52a2a"><b>.%.</b></font> (<font color="#ff00ff">14</font>,<font color="#ff00ff">14</font>)  <font color="#0000ff">-- а это выкусываем из опкода сразу</font>&lt;br><br/>
       r2 <font color="#a52a2a"><b>=</b></font> recast <font color="#a52a2a"><b>$</b></font> opcode <font color="#a52a2a"><b>.%.</b></font> (<font color="#ff00ff">O</font>,<font color="#ff00ff">14</font>)  nbsp; <font color="#0000ff">-- два аргумента</font>&lt;br><br/>
       r1' <font color="#a52a2a"><b>=</b></font>    <font color="#0000ff">-- а это для красоты для второго каскада</font>&lt;br><br/>
       disasm1 i <font color="#a52a2a"><b>=</b></font> [disasm2 <font color="#a52a2a"><b>$</b></font> opcode <font color="#a52a2a"><b>.%.</b></font> (<font color="#ff00ff">24</font>,<font color="#ff00ff">4</font>) , Add addr r1 r2,Sub addr r1 r2,Mul addr r1 r2, Div addr r1 r2,Output r1 r2,Phi addr r1 r2] <font color="#a52a2a"><b>!!</b></font> recast i<br/>
</code></blockquote><br/>
Что происходит в disasm1? Снова определение списка (квадратные скобки) с выбором по индексу (операция "!!"). Функция recast описана ниже, она преобразует знаковые в беззнаковые, оттого, что мы связались с Word32, а не только с Int — а Хаскель не особо любит их мешать, это не C. Ну, а что же в рассматриваемом списке? В нулевом индексе нас посылают задекодировать второй каскад (код операции закодирован 4 битами начиная с 24 бита вверх). Дальше идут операции сложить, вычесть, и далее по спецификации. Операция Phi будет отдельно рассмотрена дальше.<br/>
<br/>
<blockquote><code>disasm2 i <font color="#a52a2a"><b>=</b></font> [Noop addr, Cmpz (decodeImm (opcode <font color="#a52a2a"><b>.%.</b></font> (<font color="#ff00ff">21</font>,<font color="#ff00ff">3</font>))) r1',&lt;br><br/>
Sqrt addr r1',Copy addr r1',Input addr r1'] <font color="#a52a2a"><b>!!</b></font> recast i&lt;br></code></blockquote><br/>
Второй каскад, он же завершающий, состоит из того же мяса. В спецификации r1 для этих операций лежит в том же месте, что r2 для первого каскада, оттого там синоним r1', для красоты. Также идет выборка из списка по индексу. В первом (начиная с нуля) лежит сложное выражение — конструктор Cmpz, для которого аргумент вычисляется специальным декодированием из куска опкода (тип сравнения с нулем):<br/>
<br/>
<blockquote><code>decodeImm i <font color="#a52a2a"><b>=</b></font> [Ltz,Lez,Eqz,Gez,Gtz] <font color="#a52a2a"><b>!!</b></font> recast i <font color="#0000ff">-- а могли бы написать ту же функцию и через enum (благо он определен для этого типа). </font></code></blockquote><br/>
А вот и сами операции выкусывания битов — прямая трансляция из C.<br/>
<br/>
<blockquote><code>        mask x n <font color="#a52a2a"><b>=</b></font> x <font color="#a52a2a"><b>.&amp;.</b></font> ((<font color="#ff00ff">1</font> <font color="#a52a2a"><b>`shiftL`</b></font> n) <font color="#a52a2a"><b>-</b></font> <font color="#ff00ff">1</font>)  <font color="#0000ff">-- маскирование = отрезание n младших битов из x</font>&lt;br><br/>
        (<font color="#a52a2a"><b>.%.</b></font>) w32 (start,len) <font color="#a52a2a"><b>=</b></font> (w32 <font color="#a52a2a"><b>`shiftR`</b></font> start) <font color="#a52a2a"><b>`mask`</b></font> len  <font color="#0000ff">-- сдвиг, затем маскирование</font>&lt;br></code></blockquote><br/>
А эта функция (recast) преобразует из signed в unsigned и наоборот, в зависимости от контекста. Она не очень эффективна, зато работает нормально в нашей задаче. Здесь типы явно не указаны, указан лишь их класс (Integral). Здесь хаскель замечательно подставит в каждом случае нужные типы (Int или Word32) и для каждого из них есть операции fromInteger/toInteger. Заметим, что типы выведутся в процессе компиляции, а не в runtime (это я на всякий случай напоминаю).<br/>
<br/>
<blockquote><code>recast <font color="#a52a2a"><b>::</b></font> (Integral a, Integral b) <font color="#a52a2a"><b>=></b></font> a <font color="#a52a2a"><b>-></b></font> b&lt;br><br/>
recast x <font color="#a52a2a"><b>=</b></font> (fromInteger <font color="#a52a2a"><b>.</b></font> toInteger) x  <font color="#0000ff">-- то же, что "fromInteger (toInteger x)", только заумнее</font></code></blockquote><br/>
а еще можно написать так:<br/>
<br/>
<blockquote><code>recast x <font color="#a52a2a"><b>=</b></font> fromInteger <font color="#a52a2a"><b>$</b></font> toInteger x <font color="#0000ff">-- это совсем на заумно, а придумано специально</font>&lt;br><br/>
   <font color="#0000ff">-- для тех, кто не любит скобки: выражение справа от</font>&lt;br><br/>
   <font color="#0000ff">-- знака $ скармливается целиком как последний</font>&lt;br><br/>
   <font color="#0000ff">--  аргумент (или как единственный) функции слева.</font>&lt;br></code></blockquote><br/>
а еще можно написать так:<br/>
<br/>
<blockquote><code>recast <font color="#a52a2a"><b>=</b></font> fromInteger <font color="#a52a2a"><b>.</b></font> toInteger   <font color="#0000ff">-- совсем заумно, зато жуть как коротко. </font><br/>
  <font color="#0000ff">-- Ну, а затем проходит время, и такие конструкции </font><br/>
  <font color="#0000ff">-- читаются на ура</font><br/>
</code><br/>
<br/>
Конец 1 части (ограничение по размеру), вторая часть <a href="http://san13.habrahabr.ru/blog/70179/">последует</a>.</blockquote></div></div> <!----> <!----></div> <div class="tm-article-body__tags"><div class="tm-article-body__tags-links"><span class="tm-article-body__tags-title">Теги:</span> <span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bhaskell%5D" class="tm-article-body__tags-item-link">haskell</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bicfpc%5D" class="tm-article-body__tags-item-link">icfpc</a></span></div> <div class="tm-article-body__tags-links"><span class="tm-article-body__tags-title">Хабы:</span> <span class="tm-article-body__tags-item"><a href="/ru/hub/haskell/" class="tm-article-body__tags-item-link">
                  Haskell
                </a></span></div></div></article> <div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 40: ↑34 и ↓6</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 40: ↑34 и ↓6" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+28</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <!----> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    15
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/68995/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      4
    </span></a> <!----></div> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div></div> <!----></div> <!----> <div class="tm-page-article__additional-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body"><div class="tm-article-author tm-page-article__author"><!----> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-two-column"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/San13/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><svg class="tm-svg-img tm-image-placeholder tm-image-placeholder_lilac"><!----> <use xlink:href="/img/megazord-v24.cee85629.svg#placeholder-user"></use></svg></div></a> <div class="tm-user-card__meta"><div title=" 100 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    72
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info"><div class="tm-user-card__title"><span class="tm-user-card__name">Я робот</span> <a href="/ru/users/San13/" class="tm-user-card__nickname">
          @San13
        </a> <!----></div> <p class="tm-user-card__short-info">Пользователь</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-two-column"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div></div> <!----></section> <div class="tm-page-article__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/68995/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 4 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <section class="tm-block tm-block_spacing-around"><header class="tm-block__header"><h2 class="tm-block__title">Похожие публикации</h2> <!----></header> <div class="tm-block__body"><ul class="tm-article-list-block__list"><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-08-25T16:26:36.000Z" title="2021-08-25, 19:26">25  августа   в 19:26</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/skbkontur/blog/574620/" class="tm-article-title__link"><span>Как мы поучаствовали в ICFPC 2021 и что из этого вышло</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 13: ↑13 и ↓0</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 13: ↑13 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+13</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">931</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    5
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/skbkontur/blog/574620/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      1
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-06-18T15:01:42.000Z" title="2021-06-18, 18:01">18  июня   в 18:01</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/typeable/blog/563550/" class="tm-article-title__link"><span>Создаем веб-приложение на Haskell с использованием Reflex. Часть 4</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 8: ↑8 и ↓0</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 8: ↑8 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+8</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">2K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    25
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/typeable/blog/563550/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      0
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-05-31T15:20:58.000Z" title="2021-05-31, 18:20">31  мая   в 18:20</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/typeable/blog/560286/" class="tm-article-title__link"><span>Почему я считаю Haskell хорошим выбором с точки зрения безопасности ПО?</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 23: ↑23 и ↓0</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 23: ↑23 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+23</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">5.6K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    30
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/typeable/blog/560286/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      60
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li> <!----></ul></div> <!----></section> <!----> <!----> <section class="tm-block tm-block_spacing-around"><header class="tm-block__header"><h2 class="tm-block__title">Лучшие публикации за сутки</h2> <!----></header> <div class="tm-block__body"><ul class="tm-article-list-block__list"><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-27T09:00:04.000Z" title="2021-09-27, 12:00">сегодня в 12:00</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/ruvds/blog/580060/" class="tm-article-title__link"><span>Арракис, который мы заслужили</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 141: ↑136 и ↓5</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 141: ↑136 и ↓5" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+131</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">19K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    37
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/ruvds/blog/580060/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      103
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-27T13:03:14.000Z" title="2021-09-27, 16:03">сегодня в 16:03</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/ruvds/blog/580124/" class="tm-article-title__link"><span>Электролюминесцентные индикаторы из прошлого</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 66: ↑66 и ↓0</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 66: ↑66 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+66</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">4.3K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    36
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/ruvds/blog/580124/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      11
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-27T16:41:21.000Z" title="2021-09-27, 19:41">сегодня в 19:41</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/lamptest/blog/580228/" class="tm-article-title__link"><span>Идеальная светодиодная лампа за 21 рубль</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 63: ↑62 и ↓1</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 63: ↑62 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+61</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">7.2K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    31
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/lamptest/blog/580228/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      22
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-26T21:49:14.000Z" title="2021-09-27, 00:49">сегодня в 00:49</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/580092/" class="tm-article-title__link"><span>30 сентября: Let's Encrypt и конец срока действия IdenTrust DST Root CA X3</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 48: ↑48 и ↓0</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 48: ↑48 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+48</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">19K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    58
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/580092/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      93
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-27T12:53:02.000Z" title="2021-09-27, 15:53">сегодня в 15:53</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/580210/" class="tm-article-title__link"><span>PHP Дайджест № 212 (13 – 27 сентября 2021)</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 33: ↑33 и ↓0</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 33: ↑33 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+33</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">3.2K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    9
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/580210/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      1
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li> <!----></ul></div> <!----></section> <!----> <!----></div></div></div> <div class="tm-page__sidebar"><div hl="ru" id="68995" class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/68995/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/68995/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"68995":{"id":"68995","timePublished":"2009-09-20T21:37:24+00:00","isCorporative":false,"lang":"ru","titleHtml":"Часть 1\u002F3. Компилятор идеальной VM для ICFPC 2009, на Haskell, с популяризаторскими комментариями","leadData":{"textHtml":"Здесь мы будем разбирать по буквам некую программу (компилятор VM) на Хаскеле. На вход этому компилятору дается бинарный файл с инструкциями некоего процессора, где в этих инструкциях описываются некие вычисления. На выходе нашего компилятора получается текст программы, тоже на Хаскеле, которая производит те же самые вычисления, с большой скоростью. Возможно, это не компилятор, а декомпилятор, не знаю. Сравнение работы результирующих программ на Haskell\u002FJava приводится в \u003Ca href=\"http:\u002F\u002Fsan13.habrahabr.ru\u002Fblog\u002F67225\u002F\"\u003Eпредыдущем посте\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"editorVersion":"1.0","postType":"article","postLabels":[],"author":{"scoreStats":{"score":72,"votesCount":100},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"50634","alias":"San13","fullname":"Я робот","avatarUrl":null,"speciality":null},"statistics":{"commentsCount":4,"favoritesCount":15,"readingCount":1074,"score":28,"votesCount":40},"hubs":[{"relatedData":null,"id":"8424","alias":"haskell","type":"collective","title":"Haskell","titleHtml":"Haskell","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EЗдесь мы будем разбирать по буквам некую программу (компилятор VM) на Хаскеле. На вход этому компилятору дается бинарный файл с инструкциями некоего процессора, где в этих инструкциях описываются некие вычисления. На выходе нашего компилятора получается текст программы, тоже на Хаскеле, которая производит те же самые вычисления, с большой скоростью. Возможно, это не компилятор, а декомпилятор, не знаю. Сравнение работы результирующих программ на Haskell\u002FJava приводится в \u003Ca href=\"http:\u002F\u002Fsan13.habrahabr.ru\u002Fblog\u002F67225\u002F\"\u003Eпредыдущем посте\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПредупреждение: людям с формальным математическим мышлением \u003Cb\u003Eчитать запрещено\u003C\u002Fb\u003E! Вы уже и так всё знаете. Этот пост для людей, интересующихся еще чем-то сверх обычных C\u002FC++\u002FC#\u002FJava, потому что в последние 5 лет им надоело писать одно и то же на этих чудесных языках.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПро исходное задание ICFP контеста еще раз, с техническими подробностями: нам дается бинарный файл, в котором программа (вычисляющая формулы) написанная в машинных инструкциях некоторого процессора. Формул сразу несколько, потому при вычислении формул используется специальный пул для возвращаемых значений. Есть пул для входных значений. И есть пул для хранения значений, требующихся во время расчета формул, и для значений, живущих от итерации к итерации (т.е. когда программа запускается много раз, она может использовать данные от прошлого запуска). Входной пул в терминах задачи называется набором входных портов, аналогично существуют выходные порты, всё остальное называют просто «память».\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВычисления производятся следующим образом: посредством сложений, вычитаний и прочих арифметических операций над данными из входных портов и памяти, получается значение, которое записывается в один из выходных портов. По замыслу авторов, бинарный файл из задания является программой для «черного ящика», который умеет нам что-то вычислять.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nРеализовать этот черный ящик, чтобы он вычислял вообще быстро, и является нашей первой целью в ICFPC 2009, а остальное (рассчитать управляющие воздействия на спутник, чтобы он правильно летал в мире, который описывается этими формулами) — является самой главной целью контеста, которую мы рассматривать этом посте не будем, а может быть, в другом.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ этом бинарном файле первоначальные данные были расположены вперемешку с кодом следующим образом:\u003Cbr\u002F\u003E\r\n\u003Ctable cellpadding=\"3\" border=\"1\"\u003E\r\n\u003Ctbody\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003EСмещение (дес)\u003Cbr\u002F\u003E\r\n\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EДлина\u003Cbr\u002F\u003E\r\n\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EСодержимое\u003Cbr\u002F\u003E\r\n\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EТип\u003Cbr\u002F\u003E\r\n\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003EO\u003Cbr\u002F\u003E\r\n\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E8\u003Cbr\u002F\u003E\r\n\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E\u003Cfont\u003Eданные(ячейка 0)\u003C\u002Ffont\u003E\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EDouble\u003Cbr\u002F\u003E\r\n\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E8\u003Cbr\u002F\u003E\r\n\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E4\u003Cbr\u002F\u003E\r\n\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E\u003Cfont\u003Eопкод(ячейка 0)\u003C\u002Ffont\u003E\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EUInt32\u003Cbr\u002F\u003E\r\n\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E12\u003Cbr\u002F\u003E\r\n\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E4\u003Cbr\u002F\u003E\r\n\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E\u003Cfont\u003Eопкод(ячейка 1)\u003C\u002Ffont\u003E\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EUInt32\u003Cbr\u002F\u003E\r\n\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003Ctr\u003E\r\n\u003Ctd\u003E16\u003Cbr\u002F\u003E\r\n\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E8\u003Cbr\u002F\u003E\r\n\u003C\u002Ftd\u003E\r\n\u003Ctd\u003E\u003Cfont\u003Eданные(ячейка 1)\u003C\u002Ffont\u003E\u003C\u002Ftd\u003E\r\n\u003Ctd\u003EDouble\u003Cbr\u002F\u003E\r\n\u003C\u002Ftd\u003E\r\n\u003C\u002Ftr\u003E\r\n\u003C\u002Ftbody\u003E\r\n\u003C\u002Ftable\u003Eпотом тот же порядок повторяется для ячеек 2,3, затем 4,5 итд. В спецификации написано: для четных ячеек вначале идут данные, затем опкод, для нечетных наоборот. Зачем здесь есть данные, почему вообще существуют даннные, отличные от нуля? Очень просто, 1) в опкодах невозможно забить константу, используется переменная (ячейка памяти), которая никем не модифицируется 2) некоторые переменные инициализированы, и они тоже лежат в данных.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля того чтобы скомпилировать таковой бинарник в красивый текст на любом языке, необходимо:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n1) прочитать бинарник в буфер\u003Cbr\u002F\u003E\r\n2) отделить данные от опкодов\u003Cbr\u002F\u003E\r\n3) построить AST из опкодов (AST в здешних терминах — это дизассемблированный опкод разложеный в удобную для манипуляций форму, в оригинале это означает Abstract Syntax Tree, дерево абстрактное потому что содержит суть программы, а не ее текстовое или бинарное представление)\u003Cbr\u002F\u003E\r\n4) трансформировать AST в другой вид (более высокоуровневый)\u003Cbr\u002F\u003E\r\n5) вывести AST в текстовом виде на требуемом языке, а также вывести определение данных с их первоначальным значением.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДалее идет программа с комментариями для совершенно далеких от Хаскеля людей, поэтому некоторые моменты в объяснениях намеренно упрощены и даже слегка искажены (помечено отдельно), для легкости восприятия.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПодключение некоторых стандартных модулей:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cfont color=\"#a020f0\"\u003Eimport\u003C\u002Ffont\u003E System.IO&lt;br\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#a020f0\"\u003Eimport\u003C\u002Ffont\u003E Foreign.Marshal.Alloc&lt;br\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#a020f0\"\u003Eimport\u003C\u002Ffont\u003E Foreign.Ptr&lt;br\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#a020f0\"\u003Eimport\u003C\u002Ffont\u003E Data.Word&lt;br\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#a020f0\"\u003Eimport\u003C\u002Ffont\u003E Foreign.Storable&lt;br\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#a020f0\"\u003Eimport\u003C\u002Ffont\u003E Debug.Trace&lt;br\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#a020f0\"\u003Eimport\u003C\u002Ffont\u003E Data.Bits&lt;br\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#a020f0\"\u003Eimport\u003C\u002Ffont\u003E Data.List&lt;br\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#a020f0\"\u003Eimport\u003C\u002Ffont\u003E Data.Maybe\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nОписание синонимов типов, для подробности последующих определений данных: говорится, что исходный адрес в составе команды имеет тип Int, равно как и адрес назначения.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cfont color=\"#2e8b57\"\u003E\u003Cb\u003Etype\u003C\u002Fb\u003E\u003C\u002Ffont\u003E DestAddr \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E Int&lt;br\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#2e8b57\"\u003E\u003Cb\u003Etype\u003C\u002Fb\u003E\u003C\u002Ffont\u003E SrcAddr \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E Int\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nТеперь (ниже) идет элемент AST, то есть декодированная команда из спецификации. Команды обычно содержат адреса входных данных (или несколько штук, например команда сложения) — упоминается тип SrcAddr, и один адрес, в который они пишут результат (упоминается DstAddr).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ нашей задаче с AST проделываются разные штуки: несколько команд заменяются одной, которой нету в спецификации, затем все команды заменяются на вообще какое-то дерево, элементами которого являются те же команды, но из другого набора (об этом позднее). Положено бы разделить наборы команд в разные типы, но в данном случае у нас тут свалка, и только комментарии помогают отделить набор от набора (см ниже).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ Хаскеле существует так называемый алгебраический тип данных, который вообще повсюду, и он очень удобен для использования в нашем случае. Мы создаем тип Op (от слова opcode) и задаем ему несколько конструкторов (это не конструкторы из OOП, а если мыслить в терминах из OOП, то здесь декларируется пустой класс Op, и множество производных от него классов, и у каждого свои данные).\u003Cbr\u002F\u003E\r\n \u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cfont color=\"#2e8b57\"\u003E\u003Cb\u003Edata\u003C\u002Fb\u003E\u003C\u002Ffont\u003E Op \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E &lt;br\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003E-- это конструкторы использующиеся в дереве. В частности, листья дерева:\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n Const Double \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n ReadExp SrcAddr \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E  \u003Cfont color=\"#0000ff\"\u003E-- read main memory\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n ReadVarExp SrcAddr \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003E-- read temporary variable\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n ReadPortExp SrcAddr \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003E-- read port\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n               \u003Cfont color=\"#0000ff\"\u003E-- узлы дерева:\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n          SqrtExp Op \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E SubExp Op Op \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E AddExp Op Op \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E MulExp Op Op \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E DivExp Op Op \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003E-- math\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n IfExp CmdOp Op Op Op  \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003E-- branch: compare 1st op with zero, choose from other ops.\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003E-- плоские операции (из спецификации+дополнительные)\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n Add DestAddr SrcAddr SrcAddr \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n Sub DestAddr SrcAddr SrcAddr \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n Mul DestAddr SrcAddr SrcAddr \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n Div DestAddr SrcAddr SrcAddr \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n Output SrcAddr SrcAddr \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E         \u003Cfont color=\"#0000ff\"\u003E-- copy from memory to out port.\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n If CmdOp SrcAddr DestAddr SrcAddr SrcAddr \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E  \u003Cfont color=\"#0000ff\"\u003E--  compare mem with 0,choose,store \u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n Input DestAddr SrcAddr \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E   \u003Cfont color=\"#0000ff\"\u003E-- read src port into memory\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n Sqrt DestAddr SrcAddr \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n Copy DestAddr SrcAddr \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003E-- низкоуровневые плоские операции, от которых мы избавляемся практически сразу\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n Cmpz CmdOp SrcAddr \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E   \u003Cfont color=\"#0000ff\"\u003E-- first part of \"If\"\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n Phi DestAddr SrcAddr SrcAddr \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E    \u003Cfont color=\"#0000ff\"\u003E-- second part of \"If\"\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n Noop DestAddr   &lt;br\u003E\u003Cbr\u002F\u003E\r\n                                \u003Cfont color=\"#2e8b57\"\u003E\u003Cb\u003Ederiving\u003C\u002Fb\u003E\u003C\u002Ffont\u003E Show\u003Cbr\u002F\u003E\r\n\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nВидим, что варианты у нас перечисляются через символ \"|\", традиционно означающий «или». Также наличествует «deriving Show», означающее, что если мы захотим перевести какое-то значение данного типа к строке, то получим строку на хаскеле, приблизительно близкую к оригиналу. Данная конструкция означает буквально следующее: «компилятор, сделай указанный тип принадлежащим к классу Show, а метод класса Show, который переводит из значения в строку, сгенерируй сам таким, какой умеешь.»\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТеперь о том, что у нас будет про дерево. Предположим, в результирующем коде будет сгенерено выражение:\u003Cbr\u002F\u003E\r\n o32 = (i2 * 37) + (m75 * (m76 * t4))\u003Cbr\u002F\u003E\r\nОно означает: в выходной порт поместить значение входного порта умноженное на 37 плюс произведение двух ячеек памяти и одной временной переменной. Выражение справа от скобок записывается в терминах нашего AST следующим образом:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003E     AddExp (MulExp (ReadPortExp \u003Cfont color=\"#ff00ff\"\u003E2\u003C\u002Ffont\u003E) (ConstExp \u003Cfont color=\"#ff00ff\"\u003E37\u003C\u002Ffont\u003E)) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E...\u003C\u002Fb\u003E\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n         \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E...\u003C\u002Fb\u003E\u003C\u002Ffont\u003E (MulExp (ReadExp \u003Cfont color=\"#ff00ff\"\u003E75\u003C\u002Ffont\u003E) (MulExp (ReadExp \u003Cfont color=\"#ff00ff\"\u003E76\u003C\u002Ffont\u003E) (ReadVarExp \u003Cfont color=\"#ff00ff\"\u003E4\u003C\u002Ffont\u003E)))   \u003Cfont color=\"#0000ff\"\u003E-- lisp? ;)\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли посчитать скобки, должно сходиться 8). Что у нас в листьях дерева? Константы, входные порты, память и временные переменные. Как мы отличаем одно от другого? Ведь по спецификации у нас есть только входные порты и память? Откуда же берутся константы, например?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОчень просто. Если у нас в ячейку никто не пишет, а все только читают из нее, то это константа. Имеет смысл вынести ее из «памяти» и забить ее константой в результирующем коде. Аналогичным образом отделяются временные пременные от постоянных переменных, а так же переменные, которых вообще не должно быть, то есть они должны быть преобразованы прямо в выражения со скобками (см несколько ниже).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПродолжаем. Ниже описан кусок AST для условных операций (сравнение с нулем, из спецификации). Сравнений пять штук, по результатам сравнения идет выбор из одного или из другого адреса памяти.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cfont color=\"#2e8b57\"\u003E\u003Cb\u003Edata\u003C\u002Fb\u003E\u003C\u002Ffont\u003E CmdOp \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E Ltz \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E Lez \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E Eqz \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E Gez \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E|\u003C\u002Fb\u003E\u003C\u002Ffont\u003E Gtz \u003Cfont color=\"#2e8b57\"\u003E\u003Cb\u003Ederiving\u003C\u002Fb\u003E\u003C\u002Ffont\u003E Enum\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nПредставляет интерес конструкция «deriving Enum». Она автоматически относит данный тип к классу Enum, а типы этого класса имеют метод, позволяющий перевести экземпляр типа в целое, и наоборот. Будет использоваться в следующем абзаце.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТеперь зададим, что тип CmdOp принадлежит к классу Show. Данный класс используется для перевода значений какого-либо типа к строковому типу, как было упомянуто выше в «deriving Show». В нашем случае мы не хотим, чтобы компилятор сам генерировал конвертирующие методы по умолчанию, а реализуем свой метод (функцию).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cfont color=\"#2e8b57\"\u003E\u003Cb\u003Einstance\u003C\u002Fb\u003E\u003C\u002Ffont\u003E Show CmdOp \u003Cfont color=\"#2e8b57\"\u003E\u003Cb\u003Ewhere\u003C\u002Fb\u003E\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\nshow cmdOp \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E [\u003Cfont color=\"#ff00ff\"\u003E\"&lt;0\"\u003C\u002Ffont\u003E,\u003Cfont color=\"#ff00ff\"\u003E\"&lt;=0\"\u003C\u002Ffont\u003E,\u003Cfont color=\"#ff00ff\"\u003E\"==0\"\u003C\u002Ffont\u003E,\u003Cfont color=\"#ff00ff\"\u003E\"\u003E=0\"\u003C\u002Ffont\u003E,\u003Cfont color=\"#ff00ff\"\u003E\"\u003E0\"\u003C\u002Ffont\u003E] \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E!!\u003C\u002Fb\u003E\u003C\u002Ffont\u003E fromEnum cmdOp\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nСобственно функция — это show, она берет параметром cmdOp, возвращает строку, одну из списка. Выражение справа от знака равенства означает: перевести из значения в целое (fromEnum, вспоминаем deriving Enum), затем это целое использовать как индекс (функция \"!!\") для выборки из списка (список в квадратных скобках). Коротко и ясно, зато O(N), ну и что. O(N) здесь означает что для получения пятого элемента списка потребуется 5 итераций (потому что здесь использован список, а не массив), а для N-ного, следовательно, N итераций, что долго. Существует простая возможность ускорить, написав case или использовав массив, но я экономил строки программы 8-) \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДалее идет функция, переводящая Op в язык, в который мы компилируем. Мы компилируем в хаскель, и поэтому требуется следующее введение:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНаш черный ящик на входе имеет входные порты, и свое предыдущее состояние, а на выходе имеет свое состояние и выходные порты. А скомпилированный в Хаскель бинарный файл будет содержать в себе одну функцию, которая на входе и на выходе будет иметь те же данные. Возвращать выходные порты будем как часть структуры. Таким образом, откомпилированный файл будет содержать в себе:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n1) описание данных:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003E\u003Cfont color=\"#2e8b57\"\u003E\u003Cb\u003Edata\u003C\u002Fb\u003E\u003C\u002Ffont\u003E VMState \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E VMState { m13, m55, m77, o11 \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E::\u003C\u002Fb\u003E\u003C\u002Ffont\u003E Double }  \u003Cfont color=\"#0000ff\"\u003E-- выходные порты и persistent mem\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n2) главную функцию (подробно разбирается далее):\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003EnextState \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E::\u003C\u002Fb\u003E\u003C\u002Ffont\u003E VMState \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E-\u003E\u003C\u002Fb\u003E\u003C\u002Ffont\u003E (Double,Double,\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003EDouble...\u003C\u002Fb\u003E\u003C\u002Ffont\u003E) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E-\u003E\u003C\u002Fb\u003E\u003C\u002Ffont\u003E VMState&lt;br\u003E\u003Cbr\u002F\u003E\r\ngetNextState x (i2,i3,i16000\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E...\u003C\u002Fb\u003E\u003C\u002Ffont\u003E) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E                                                                                       (\u003Cfont color=\"#ff00ff\"\u003E1\u003C\u002Ffont\u003E)&lt;br\u003E\u003Cbr\u002F\u003E\r\n   \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003Elet\u003C\u002Fb\u003E\u003C\u002Ffont\u003E t1 \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E i2\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E+\u003C\u002Fb\u003E\u003C\u002Ffont\u003Ei3 \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E+\u003C\u002Fb\u003E\u003C\u002Ffont\u003E m55 x;&lt;br\u003E\u003Cbr\u002F\u003E\r\n        t2 \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003Eif\u003C\u002Fb\u003E\u003C\u002Ffont\u003E (i\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E-\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E16000\u003C\u002Ffont\u003E \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E\u003E\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003EO\u003C\u002Ffont\u003E) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003Ethen\u003C\u002Fb\u003E\u003C\u002Ffont\u003E t1\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E*\u003C\u002Fb\u003E\u003C\u002Ffont\u003E(i16000\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E+\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E1\u003C\u002Ffont\u003E) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003Eelse\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003EO\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n   \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003Ein\u003C\u002Fb\u003E\u003C\u002Ffont\u003E VMState { m13 \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E t1\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E+\u003C\u002Fb\u003E\u003C\u002Ffont\u003Et2\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E*\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E2\u003C\u002Ffont\u003E, m55 \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003E2\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E*\u003C\u002Fb\u003E\u003C\u002Ffont\u003Ei3\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E.....\u003C\u002Fb\u003E\u003C\u002Ffont\u003E o10 \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E (i2\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E+\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E22\u003C\u002Ffont\u003E)\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E*\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E576000.0\u003C\u002Ffont\u003E }\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n3) функцию, возврающую состояние черного ящика в момент времени 0 — то есть те данные, которые мы будем кормить ему итерация за итерацией:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003EinitState \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E VMState { m13\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003EO\u003C\u002Ffont\u003E, m55\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E123.456\u003C\u002Ffont\u003E, \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E...\u003C\u002Fb\u003E\u003C\u002Ffont\u003Eo90 \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003EO\u003C\u002Ffont\u003E}\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nРассмотрим по пунктам каждую строку. Первая объявляет «структуру» данных. Ее отличие от структур C\u002FJava в том, что ее поля нельзя менять, возможно только получить новую структуру с некоторыми (или одним, или всеми) измененными значениями текущей структуры. Пишется это так:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003E     \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003Elet\u003C\u002Fb\u003E\u003C\u002Ffont\u003E newStruct \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E oldStruct { field5 \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003E7\u003C\u002Ffont\u003E, field10 \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003EO\u003C\u002Ffont\u003E }\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПосле чего, при желании, старые данные можно выкинуть.\u003Cbr\u002F\u003E\r\nДля чтения одного поля из структуры используется синтаксис:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003E     \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003Elet\u003C\u002Fb\u003E\u003C\u002Ffont\u003E myFieldValue \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E field5 newStruct\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПочему так странно? Потому что при объявлении структуры автоматически объявляются все функции для доступа к ее полям. В частности, неявно появляется функция (например):\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003Efield5 \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E::\u003C\u002Fb\u003E\u003C\u002Ffont\u003E VMState \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E-\u003E\u003C\u002Fb\u003E\u003C\u002Ffont\u003E Double \u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЭто значит, что функция получает на вход значение VMState (в нашем примере наверху мы передали целиком newStruct), а возвращает численное значение с плавающей точкой.\u003Cbr\u002F\u003E\r\nПопутно мы поняли, как выглядят сигнатуры методов (название метода :: тип). Смотрим на главную функцию\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003EnextState \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E::\u003C\u002Fb\u003E\u003C\u002Ffont\u003E VMState \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E-\u003E\u003C\u002Fb\u003E\u003C\u002Ffont\u003E (Double,Double,\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003EDouble...\u003C\u002Fb\u003E\u003C\u002Ffont\u003E) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E-\u003E\u003C\u002Fb\u003E\u003C\u002Ffont\u003E VMState\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ хаскеле троеточий нет, это я их добавил для иллюстрации того, что мы объявим кортеж из стольких double, сколько нам нужно будет. Функция берет 2 параметра, первый это VMState, второй состоит из нескольких значений (в нашем случае это значения всех портов), и возвращает эта функция новое значение VMState.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nГлавная функция идеальной VM имеет синтаксис, подобный нижеследующему:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003Efun arg1 arg2 \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E &lt;br\u003E\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003Elet\u003C\u002Fb\u003E\u003C\u002Ffont\u003E bind1 \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E expr1; bind2 \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E expr2&lt;br\u003E\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003Ein\u003C\u002Fb\u003E\u003C\u002Ffont\u003E exprResult&lt;br\u003E\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#2e8b57\"\u003E\u003Cb\u003Ewhere\u003C\u002Fb\u003E\u003C\u002Ffont\u003E bind3 a1 a2 a3 \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E expr3&lt;br\u003E\u003Cbr\u002F\u003E\r\n             bind4 a5 a6 \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E expr4\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТо есть, мы можем определить некоторые повторно используемые выражения в разделе «let», а потом их свободно использовать в результирующем выражении (которое в «in»). Также мы можем определить такие же выражения в разделе «where», только там обычно описывают не переменные, а функции, локальные (по видимости) к объемлющей функции (fun). Функции можно также описывать в разделе let, но это менее удобно. Добавлю, что из where не видно значений из раздела «let».\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДалее, отмечу, что конструкция «if» в хаскеле является выражением. Конструкции «for» в самом языке нету, она есть в отдельном модуле и является обычной функцией. Равно как и «while» и подобные.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ свете вышесказанного продолжим рассмотрение компилятора бинарных файлов.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНижеследующая функция переводит элемент AST (имеющий тип Op), в строковое представление на языке результата (на Хаскеле). Первым параметром идет строка, содержащая имя параметра с исходным состоянием (потому что мы будем генерировать операции чтения из него), в формуле (1) это будет «x». На самом деле я мог захардкодить это имя, потому что оно встречается всего один раз.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003East2haskell \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E::\u003C\u002Fb\u003E\u003C\u002Ffont\u003E String \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E-\u003E\u003C\u002Fb\u003E\u003C\u002Ffont\u003E Op \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E-\u003E\u003C\u002Fb\u003E\u003C\u002Ffont\u003E String&lt;br\u003E\u003Cbr\u002F\u003E\r\nast2haskell x op \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E s op \u003Cfont color=\"#2e8b57\"\u003E\u003Cb\u003Ewhere\u003C\u002Fb\u003E\u003C\u002Ffont\u003E &lt;br\u003E\u003Cbr\u002F\u003E\r\ns (Const d) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E show d  \u003Cfont color=\"#0000ff\"\u003E-- константа показывается как есть.\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\ns (ReadExp r1) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003E\"m\"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E(show r1)\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\" \"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Ex&lt;br\u003E\u003Cfont color=\"#0000ff\"\u003E-- generate read access to memory\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\ns (ReadVarExp r1) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003E\"t\"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E(show r1)&lt;br\u003E                         \u003Cfont color=\"#0000ff\"\u003E-- to temporary variable \u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\ns (ReadPortExp r1) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\"i\"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E(show r1)&lt;br\u003E                        \u003Cfont color=\"#0000ff\"\u003E--  to input port \u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\ns (SqrtExp op') \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003E\"(sqrt \"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op'\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\")\"\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\ns (AddExp op1 op2) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003E\"(\"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op1\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\"+\"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op2\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\")\"\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\ns (SubExp op1 op2) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003E\"(\"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op1\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\"-\"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op2\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\")\"\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\ns (MulExp op1 op2) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003E\"(\"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op1\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\"*\"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op2\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\")\"\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\ns (DivExp op1 (Const x)) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003E\"(\"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op1\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\"\u002F\"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E(show x)\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\")\"\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\ns (DivExp op1 op2) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003E\"(if \"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op2\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\" \u002F= 0 then \"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op1\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\"\u002F\"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op2\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\" else 0)\"\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\ns (IfExp cond opc op1 op2) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003E\"(if \"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es opc\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Eshow cond\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\" then \"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op1\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\" else \"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op2\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\")\"\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nЧто мы здесь имеем? Знакомую нам конструкцию fun param = expr where ...., но только сразу идет вызов одной из локальных функций. Почему? Сейчас разберемся. Сначала только обратим внимание, что функция «s» (от «string») имеет несколько определений, по одному определению для каждого конструктора типа Op. В результате, понятное дело, вызовется только одна функция, и сразу же конкретный объект типа Op разобьется на свои компоненты, которым дадутся имена:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003Es \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E::\u003C\u002Fb\u003E\u003C\u002Ffont\u003E Op \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E-\u003E\u003C\u002Fb\u003E\u003C\u002Ffont\u003E String&lt;br\u003E\u003Cbr\u002F\u003E\r\ns (AddExp op1 op2) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003E\"(\"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op1\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\"+\"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op2\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\")\"\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЭто реализация функции s для конструктора типа Op по имени AddExp, который имеет два параметра: две ветки AST, которые складываются. А сама функция s имеет один аргумент, поэтому там стоят скобки вокруг AddExp. Результатом работы этой функции будет строка, склеенная из кусочков (операция ++ соединяет два списка; строки тоже являются списками). Тут по бокам приклеиваются скобки, а между ними строковые представления обеих веток, между которыми вклеивается плюс. Строковое представление каждой ветки, стало быть, вычисляется рекурсивно, это обычная практика в таких задачах. И, наконец, функция show переводит число в строку, а также она используется для CmdOp (условие сравнения с нулем), который тоже относится к классу Show (описано выше).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОбратим внимание на следующее определение:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003Es (DivExp op1 (Const x)) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003E\"(\"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op1\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\"\u002F\"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E(show x)\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\")\"\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\ns (DivExp op1 op2) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003E\"(if \"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op2\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\" \u002F= 0 then \"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op1\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\"\u002F\"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op2\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\" else 0)\"\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОно замечательно тем, что обе функции работают над данными DivExp, но для выбора первой необходимо чтобы делителем в этом узле была константа! Для этого случая сгенерируется особенный, более простой код, потому что здесь не нужно делать проверку на 0.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nИз этого следует, что определение того, какая функция вызывается, не идет по «типу конструктора», а происходит гораздо гибче: входное значение по очереди пытается «пролезть» в каждую реализацию функции с требуемым именем, и вызывается та функция, в которую оно пролезет. В указанном случае в первую функцию не пролезет DivExp, у которого второй параметр инициализирован чем-либо, отличным от Const. Это называется Pattern Matching (не путать с оным для строк).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТеперь о том, для чего вообще была сделана функция «s». Исключительно для удобства. Сравниваем 2 куска, с ней:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003East2haskell x op \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E s op \u003Cfont color=\"#2e8b57\"\u003E\u003Cb\u003Ewhere\u003C\u002Fb\u003E\u003C\u002Ffont\u003E &lt;br\u003E\u003Cbr\u002F\u003E\r\ns (SubExp op1 op2) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003E\"(\"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op1\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\"-\"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op2\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\")\"\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\ns (MulExp op1 op2) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003E\"(\"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op1\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\"*\"\u003C\u002Ffont\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003Es op2\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#ff00ff\"\u003E\")\"\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nи без нее:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003East2haskell x (SubExp op1 op2) = \"(\"++ast2haskell x op1++\"-\"++ast2haskell x op2++\")\" \u003Cbr\u002F\u003E\r\nast2haskell x (MulExp op1 op2) = \"(\"++ast2haskell x op1++\"*\"++ast2haskell x op2++\")\" \u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВывод: код с функцией «s» короче, и не нужно постоянно таскать этот «x», передавая его дальше.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nРассмотрим теперь новую тему — о том, как производится декодирование опкода в операцию, которая у нас представляется типом Op. Каждая операция изначально лежит по какому-то адресу в бинарном файле. Для большинства операций этот же адрес является адресом назначения для результата работы операции (результат сложения и прочих операций — всё кладется в «память» по этому адресу, для каждой операции своему). Именно поэтому мы передаем в функцию пару «опкод, его адрес», а на выходе имеем уже инициализированную операцию, в которой в дополнение к адресу назначения инициализированы дополнительные аргументы, для каждой операции свои.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ спецификации опкодов они декодируются каскадно, то есть если старшая часть опкода равна нулю, то смотрится следующий кусок, иначе это готовый опкод Старшая часть — четыре старших бита, то есть 4 бита вверх, начиная с 28-го бита (28, 29, 30, 31). \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля выкусывания битов из Word32 нами здесь определена функция (.%.), которая может использоваться как операция (инфиксная, то есть стоять между двумя операндами, как + или *). Синтаксис хаскеля позволяет определить функцию с именем из всяких символов, например \"++++\" Определяется это так:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003E(\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E) a b \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E sqrt(a\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E*\u003C\u002Fb\u003E\u003C\u002Ffont\u003Ea \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E+\u003C\u002Fb\u003E\u003C\u002Ffont\u003E b\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E*\u003C\u002Fb\u003E\u003C\u002Ffont\u003Eb)\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nили иначе:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003Ea \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E b \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E sqrt(a\u003Cfont\u003E\u003Cb\u003E*\u003C\u002Fb\u003E\u003C\u002Ffont\u003Ea \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E+\u003C\u002Fb\u003E\u003C\u002Ffont\u003E b\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E*\u003C\u002Fb\u003E\u003C\u002Ffont\u003Eb)\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nа используется так:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003E\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003Elet\u003C\u002Fb\u003E\u003C\u002Ffont\u003E q \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003E3\u003C\u002Ffont\u003E \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003E4\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003Elet\u003C\u002Fb\u003E\u003C\u002Ffont\u003E p \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E (\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E++++\u003C\u002Fb\u003E\u003C\u002Ffont\u003E) \u003Cfont color=\"#ff00ff\"\u003E3\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003E4\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТаким образом, получается очень удобно. Также, можно любую из «обычных» функций двух аргументов сделать инфиксной, см пример ниже с 'shiftL' (сдвиг влево). Для этих целей имя функции берется в обратные кавычки и ставится между операндами. Для инфиксных операторов действуют всякие приоритеты, но это не наша тема сейчас, а сама функция (.%.) будет определена ниже.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003Edisasm \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E::\u003C\u002Fb\u003E\u003C\u002Ffont\u003E (Word32, Int) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E-\u003E\u003C\u002Fb\u003E\u003C\u002Ffont\u003E Op&lt;br\u003E\u003Cbr\u002F\u003E\r\ndisasm (opcode, addr) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E disasm1 (opcode \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E.%.\u003C\u002Fb\u003E\u003C\u002Ffont\u003E (\u003Cfont color=\"#ff00ff\"\u003E28\u003C\u002Ffont\u003E, \u003Cfont color=\"#ff00ff\"\u003E4\u003C\u002Ffont\u003E))  \u003Cfont color=\"#0000ff\"\u003E-- декодируется первый \"каскад\"\u003C\u002Ffont\u003E&lt;br\u003E                                         \u003Cfont color=\"#0000ff\"\u003E-- заданный четырьмя старшими битами\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n   \u003Cfont color=\"#2e8b57\"\u003E\u003Cb\u003Ewhere\u003C\u002Fb\u003E\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n       r1 \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E recast \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E$\u003C\u002Fb\u003E\u003C\u002Ffont\u003E opcode \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E.%.\u003C\u002Fb\u003E\u003C\u002Ffont\u003E (\u003Cfont color=\"#ff00ff\"\u003E14\u003C\u002Ffont\u003E,\u003Cfont color=\"#ff00ff\"\u003E14\u003C\u002Ffont\u003E)  \u003Cfont color=\"#0000ff\"\u003E-- а это выкусываем из опкода сразу\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n       r2 \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E recast \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E$\u003C\u002Fb\u003E\u003C\u002Ffont\u003E opcode \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E.%.\u003C\u002Fb\u003E\u003C\u002Ffont\u003E (\u003Cfont color=\"#ff00ff\"\u003EO\u003C\u002Ffont\u003E,\u003Cfont color=\"#ff00ff\"\u003E14\u003C\u002Ffont\u003E)  nbsp; \u003Cfont color=\"#0000ff\"\u003E-- два аргумента\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n       r1' \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E    \u003Cfont color=\"#0000ff\"\u003E-- а это для красоты для второго каскада\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n       disasm1 i \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E [disasm2 \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E$\u003C\u002Fb\u003E\u003C\u002Ffont\u003E opcode \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E.%.\u003C\u002Fb\u003E\u003C\u002Ffont\u003E (\u003Cfont color=\"#ff00ff\"\u003E24\u003C\u002Ffont\u003E,\u003Cfont color=\"#ff00ff\"\u003E4\u003C\u002Ffont\u003E) , Add addr r1 r2,Sub addr r1 r2,Mul addr r1 r2, Div addr r1 r2,Output r1 r2,Phi addr r1 r2] \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E!!\u003C\u002Fb\u003E\u003C\u002Ffont\u003E recast i\u003Cbr\u002F\u003E\r\n\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nЧто происходит в disasm1? Снова определение списка (квадратные скобки) с выбором по индексу (операция \"!!\"). Функция recast описана ниже, она преобразует знаковые в беззнаковые, оттого, что мы связались с Word32, а не только с Int — а Хаскель не особо любит их мешать, это не C. Ну, а что же в рассматриваемом списке? В нулевом индексе нас посылают задекодировать второй каскад (код операции закодирован 4 битами начиная с 24 бита вверх). Дальше идут операции сложить, вычесть, и далее по спецификации. Операция Phi будет отдельно рассмотрена дальше.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003Edisasm2 i \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E [Noop addr, Cmpz (decodeImm (opcode \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E.%.\u003C\u002Fb\u003E\u003C\u002Ffont\u003E (\u003Cfont color=\"#ff00ff\"\u003E21\u003C\u002Ffont\u003E,\u003Cfont color=\"#ff00ff\"\u003E3\u003C\u002Ffont\u003E))) r1',&lt;br\u003E\u003Cbr\u002F\u003E\r\nSqrt addr r1',Copy addr r1',Input addr r1'] \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E!!\u003C\u002Fb\u003E\u003C\u002Ffont\u003E recast i&lt;br\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nВторой каскад, он же завершающий, состоит из того же мяса. В спецификации r1 для этих операций лежит в том же месте, что r2 для первого каскада, оттого там синоним r1', для красоты. Также идет выборка из списка по индексу. В первом (начиная с нуля) лежит сложное выражение — конструктор Cmpz, для которого аргумент вычисляется специальным декодированием из куска опкода (тип сравнения с нулем):\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003EdecodeImm i \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E [Ltz,Lez,Eqz,Gez,Gtz] \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E!!\u003C\u002Fb\u003E\u003C\u002Ffont\u003E recast i \u003Cfont color=\"#0000ff\"\u003E-- а могли бы написать ту же функцию и через enum (благо он определен для этого типа). \u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nА вот и сами операции выкусывания битов — прямая трансляция из C.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E        mask x n \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E x \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E.&amp;.\u003C\u002Fb\u003E\u003C\u002Ffont\u003E ((\u003Cfont color=\"#ff00ff\"\u003E1\u003C\u002Ffont\u003E \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E`shiftL`\u003C\u002Fb\u003E\u003C\u002Ffont\u003E n) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E-\u003C\u002Fb\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#ff00ff\"\u003E1\u003C\u002Ffont\u003E)  \u003Cfont color=\"#0000ff\"\u003E-- маскирование = отрезание n младших битов из x\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n        (\u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E.%.\u003C\u002Fb\u003E\u003C\u002Ffont\u003E) w32 (start,len) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E (w32 \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E`shiftR`\u003C\u002Fb\u003E\u003C\u002Ffont\u003E start) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E`mask`\u003C\u002Fb\u003E\u003C\u002Ffont\u003E len  \u003Cfont color=\"#0000ff\"\u003E-- сдвиг, затем маскирование\u003C\u002Ffont\u003E&lt;br\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nА эта функция (recast) преобразует из signed в unsigned и наоборот, в зависимости от контекста. Она не очень эффективна, зато работает нормально в нашей задаче. Здесь типы явно не указаны, указан лишь их класс (Integral). Здесь хаскель замечательно подставит в каждом случае нужные типы (Int или Word32) и для каждого из них есть операции fromInteger\u002FtoInteger. Заметим, что типы выведутся в процессе компиляции, а не в runtime (это я на всякий случай напоминаю).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003Erecast \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E::\u003C\u002Fb\u003E\u003C\u002Ffont\u003E (Integral a, Integral b) \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003E\u003C\u002Fb\u003E\u003C\u002Ffont\u003E a \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E-\u003E\u003C\u002Fb\u003E\u003C\u002Ffont\u003E b&lt;br\u003E\u003Cbr\u002F\u003E\r\nrecast x \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E (fromInteger \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E.\u003C\u002Fb\u003E\u003C\u002Ffont\u003E toInteger) x  \u003Cfont color=\"#0000ff\"\u003E-- то же, что \"fromInteger (toInteger x)\", только заумнее\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nа еще можно написать так:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003Erecast x \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E fromInteger \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E$\u003C\u002Fb\u003E\u003C\u002Ffont\u003E toInteger x \u003Cfont color=\"#0000ff\"\u003E-- это совсем на заумно, а придумано специально\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n   \u003Cfont color=\"#0000ff\"\u003E-- для тех, кто не любит скобки: выражение справа от\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n   \u003Cfont color=\"#0000ff\"\u003E-- знака $ скармливается целиком как последний\u003C\u002Ffont\u003E&lt;br\u003E\u003Cbr\u002F\u003E\r\n   \u003Cfont color=\"#0000ff\"\u003E--  аргумент (или как единственный) функции слева.\u003C\u002Ffont\u003E&lt;br\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nа еще можно написать так:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003Erecast \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E=\u003C\u002Fb\u003E\u003C\u002Ffont\u003E fromInteger \u003Cfont color=\"#a52a2a\"\u003E\u003Cb\u003E.\u003C\u002Fb\u003E\u003C\u002Ffont\u003E toInteger   \u003Cfont color=\"#0000ff\"\u003E-- совсем заумно, зато жуть как коротко. \u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003E-- Ну, а затем проходит время, и такие конструкции \u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003E-- читаются на ура\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nКонец 1 части (ограничение по размеру), вторая часть \u003Ca href=\"http:\u002F\u002Fsan13.habrahabr.ru\u002Fblog\u002F70179\u002F\"\u003Eпоследует\u003C\u002Fa\u003E.\u003C\u002Fblockquote\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"haskell"},{"titleHtml":"icfpc"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F68995\u002F11ebce96cc1af072c97dc76eb3d32773\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F68995\u002F11ebce96cc1af072c97dc76eb3d32773\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F68995\\\u002F\"},\"headline\":\"Часть 1\\\u002F3. Компилятор идеальной VM для ICFPC 2009, на Haskell, с популяризаторскими комментариями\",\"datePublished\":\"2009-09-21T01:37:24+04:00\",\"dateModified\":\"2009-09-21T17:10:40+04:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Я робот\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Здесь мы будем разбирать по буквам некую программу (компилятор VM) на Хаскеле. На вход этому компилятору дается бинарный файл с инструкциями некоего процессора,...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F68995\\\u002F#post-content-body\",\"about\":[\"h_haskell\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F68995\\\u002F11ebce96cc1af072c97dc76eb3d32773\\\u002F\"]}","metaDescription":"Здесь мы будем разбирать по буквам некую программу (компилятор VM) на Хаскеле. На вход этому компилятору дается бинарный файл с инструкциями некоего процессора, где в этих инструкциях описываются...","mainImageUrl":null,"amp":false},"polls":[],"commentsEnabled":true,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false},"572164":{"id":"572164","timePublished":"2021-09-27T11:37:23+00:00","isCorporative":false,"lang":"ru","titleHtml":"Первые шаги в ОТО: прецессия орбиты Меркурия","editorVersion":"2.0","postType":"article","postLabels":[{"type":"tutorial","data":null}],"author":{"id":"1832999","alias":"Yermack","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F690\u002F140\u002F823\u002F690140823f555d03574a59d46f648d24.jpg","speciality":"Пользователь"},"statistics":{"commentsCount":2,"favoritesCount":20,"readingCount":2712,"score":16,"votesCount":16},"hubs":[{"relatedData":null,"id":"18840","alias":"julia","type":"collective","title":"Julia","titleHtml":"Julia","isProfiled":true},{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"21968","alias":"physics","type":"collective","title":"Физика","titleHtml":"Физика","isProfiled":false},{"relatedData":null,"id":"22022","alias":"astronomy","type":"collective","title":"Астрономия","titleHtml":"Астрономия","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EКогда речь заходит о теории относительности, частенько на ровном месте разрастаются споры, которые были занесены в почву непонимания и обильно удобрены мифами, недосказанностью и недостаточной математической подготовкой. Даже на лекциях от некоторых профессоров можно услышать, что детище гения Эйнштейна не имеет практической пользы, а на робкие попытки пролепетать что-то про спутниковые системы навигации они пренебрежительно отмахиваются, дескать, там все сложно и двояко. \u003C\u002Fp\u003E\u003Cp\u003EТак что совершенно естественно желание попробовать провести некоторые расчеты самолично, потрогать формулы, покрутить параметры, чтобы постепенно заложить интуицию в столь горячей теме.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa9f\u002Ff59\u002Fb65\u002Fa9ff59b65da6e8b1e6f59314aadb8e3d.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa9f\u002Ff59\u002Fb65\u002Fa9ff59b65da6e8b1e6f59314aadb8e3d.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"прецессия"},{"titleHtml":"меркурий"},{"titleHtml":"теория относительности"},{"titleHtml":"уравнения эйнштейна"},{"titleHtml":"метрики"},{"titleHtml":"спасибо scihub"},{"titleHtml":"спасибо mathpix"},{"titleHtml":"астрология_точная_наука"}]},"579772":{"id":"579772","timePublished":"2021-09-27T05:32:01+00:00","isCorporative":true,"lang":"ru","titleHtml":"Сливы процветают. Эксперт-«параноик» Майкл Баззель о защите личных данных","editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Michael Bazzell","originalUrl":"https:\u002F\u002Finteltechniques.com\u002Fblog\u002F2021\u002F07\u002F23\u002Fpersonal-ransomware-exposure\u002F"}}],"author":{"id":"2297567","alias":"SearchInform_team","fullname":null,"avatarUrl":"","speciality":"Пользователь"},"statistics":{"commentsCount":0,"favoritesCount":7,"readingCount":2326,"score":9,"votesCount":9},"hubs":[{"relatedData":null,"id":"22418","alias":"searchinform","type":"corporative","title":"Блог компании SearchInform","titleHtml":"Блог компании SearchInform","isProfiled":false},{"relatedData":null,"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EНаш очередной пост из серии «интересное на иностранном языке» – рассказ Майкла Баззеля о том, как сберечь свои персональные данные от утечек. Майкл – знаковая фигура в сфере OSINT, работал в правительстве США и ФБР, его приглашали в качестве технического эксперта в сериал «Мистер Робот», который считают достойным с точки зрения достоверности. В личной жизни эксперт придерживается настолько жестких правил в отношении информационной гигиены, что некоторые считают его «неадекватом». Так ли это – может быть несколько мнений. \u003C\u002Fp\u003E\u003Cp\u003EОдин из факторов, который убеждает в правильном подходе Майкла, – что риски обнаружить свои данные в интернете стали существенно выше, потому что шифровальщики без разбору сливают в сеть все, до чего дотягиваются при атаках на бизнес. Приводим перевод \u003Ca href=\"https:\u002F\u002Finteltechniques.com\u002Fblog\u002F2021\u002F07\u002F23\u002Fpersonal-ransomware-exposure\u002F\"\u003Eпоста Майкла Баззеля\u003C\u002Fa\u003E. \u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EАтакуют корпорации, а страдают люди\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003EБольшинство людей не задумываются о том, как их касается проблема распространения вирусов-шифровальщиков. Логика такова: речь идет о проблемах компаний, это они вынуждены платить выкуп. При чем тут, казалось бы, обычные люди?! \u003C\u002Fp\u003E\u003Cp\u003EА при том, что преступники сменили тактику: сейчас они не просто шифруют данные, но и скачивают их, выкладывают в открытый доступ, если компании не платят им выкуп. Теперь давайте подумаем, что в этих слитых базах? Множество данных о сотрудниках, клиентах, контрагентах, с которыми компания-жертва работает.\u003C\u002Fp\u003E\u003Cp\u003EХочу сразу уточнить: я это пишу не потому что выступаю за уплату выкупа. Я за то, чтобы сопротивляться избыточному сбору данных там, где это не обязательно. Мы халатно относимся к своим ПДн, раздавая их по первому требованию.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe3b\u002F3e1\u002F2c2\u002Fe3b3e12c2036d90018b804276e31ebea.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe3b\u002F3e1\u002F2c2\u002Fe3b3e12c2036d90018b804276e31ebea.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"персональные данные"},{"titleHtml":"пдн"},{"titleHtml":"сёрчинформ"},{"titleHtml":"Майкл Баззел"},{"titleHtml":"утечки информации"}]},"579854":{"id":"579854","timePublished":"2021-09-27T06:03:01+00:00","isCorporative":true,"lang":"ru","titleHtml":"Видишь уязвимости? А они есть! Наше исследование популярных CMS-систем","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2684283","alias":"Solar_Pentest","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":8,"favoritesCount":21,"readingCount":3777,"score":27,"votesCount":29},"hubs":[{"relatedData":null,"id":"20826","alias":"solarsecurity","type":"corporative","title":"Блог компании Ростелеком-Солар","titleHtml":"Блог компании Ростелеком-Солар","isProfiled":false},{"relatedData":null,"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true},{"relatedData":null,"id":"260","alias":"php","type":"collective","title":"PHP","titleHtml":"PHP","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЛьвиная доля всех работ по анализу защищенности внешнего периметра – это тестирование веб-приложений. Здесь могут быть как корпоративные решения, так и «домашние» разработки на базе различных публичных систем управления контентом (CMS). Мы всегда проводим глубокий анализ подобных решений на тестовых стендах и зачастую находим уязвимости нулевого дня. Собственно, из опыта таких проектов и родилась идея собрать исследовательскую команду и провести глубокий анализ популярных CMS-систем и различных плагинов для них. В этом посте мы поделимся результатами нашего исследования, а также продемонстрируем примеры уязвимого кода наиболее интересных, на наш взгляд, уязвимостей и примеры их эксплуатации. Конечно все эти уязвимости уже исправлены и описываются здесь с разрешения владельцев систем.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6df\u002F317\u002F4e6\u002F6df3174e60bbe263a70bcafdf9e51e6b.jpg","buttonTextHtml":"Не всё то в безопасности, что с Bug Bounty","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6df\u002F317\u002F4e6\u002F6df3174e60bbe263a70bcafdf9e51e6b.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"cms"},{"titleHtml":"уязвимости"},{"titleHtml":"уязвимости и их эксплуатация"},{"titleHtml":"уязвимость нулевого дня"}]},"579984":{"id":"579984","timePublished":"2021-09-27T15:37:51+00:00","isCorporative":true,"lang":"ru","titleHtml":"Добро пожаловать на хабрадегустацию","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2424555","alias":"anya_plotkina","fullname":"Аня Плоткина","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd4c\u002Ffcb\u002Fa37\u002Fd4cfcba3704ace3b85715c75b0db0d73.jpg","speciality":"DevRel"},"statistics":{"commentsCount":22,"favoritesCount":3,"readingCount":591,"score":8,"votesCount":20},"hubs":[{"relatedData":null,"id":"17931","alias":"skillfactory","type":"corporative","title":"Блог компании SkillFactory","titleHtml":"Блог компании SkillFactory","isProfiled":false},{"relatedData":null,"id":"161","alias":"habr","type":"collective","title":"Habr","titleHtml":"Habr","isProfiled":false}],"flows":[{"id":"4","alias":"marketing","title":"Маркетинг"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EПривет, Хабр! Меня зовут Аня Плоткина, я занимаюсь Developer Relations в команде SkillFactory, развивая сообщество авторов и менторов, которые создают наш образовательный продукт. Это будет не совсем обычный пост, а скорее воззвание к хабрасообществу, так как я верю, что на Хабре собрались самые знающие люди в IT. Если коротко: мы хотим предоставить любому члену сообщества, который обладает экспертизой, продегустировать наше обучение. \u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff28\u002F73d\u002F875\u002Ff2873d87531005948f40169432f05ebb.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff28\u002F73d\u002F875\u002Ff2873d87531005948f40169432f05ebb.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"курсы"},{"titleHtml":"edtech"},{"titleHtml":"образование"},{"titleHtml":"образование онлайн"},{"titleHtml":"образовательные ресурсы"}]},"580008":{"id":"580008","timePublished":"2021-09-27T06:30:02+00:00","isCorporative":false,"lang":"ru","titleHtml":"Летний Магнитогорск","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2614609","alias":"city_scraper","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F8f8\u002Fd6c\u002F328\u002F8f8d6c328ec3a513103b6757c2c21610.png","speciality":"Пользователь"},"statistics":{"commentsCount":6,"favoritesCount":3,"readingCount":3654,"score":14,"votesCount":20},"hubs":[{"relatedData":null,"id":"22012","alias":"Ecology","type":"collective","title":"Экология","titleHtml":"Экология","isProfiled":false},{"relatedData":null,"id":"22024","alias":"urban","type":"collective","title":"Урбанизм","titleHtml":"Урбанизм","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EМагнитогорск Челябинской области – один из крупнейших мировых центров чёрной металлургии. В России это шестой из крупнейших городов, которые не являются центрами субъектов страны. \u003C\u002Fp\u003E\u003Cp\u003EСовсем недавно город был одним из наиболее неблагополучных с точки зрения загрязнения атмосферного воздуха, но в 2021 году был зафиксирован «повышенный» уровень – то есть не «высокий» или «очень высокий», как раньше. \u003C\u002Fp\u003E\u003Cp\u003EКак этот город выглядит летом? Где и как его жители могут проводить время?\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F030\u002F0d1\u002Fcff\u002F0300d1cff2029948d33d803000331724.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F030\u002F0d1\u002Fcff\u002F0300d1cff2029948d33d803000331724.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Магнитогорск"},{"titleHtml":"промышленность"},{"titleHtml":"промышленные города"},{"titleHtml":"урбанизм\u002Fурбания"},{"titleHtml":"урбанистика"},{"titleHtml":"города России"},{"titleHtml":"города"}]},"580050":{"id":"580050","timePublished":"2021-09-27T10:23:25+00:00","isCorporative":false,"lang":"ru","titleHtml":"Один человек ответил на 85+ тысяч вопросов на Stack Overflow (24,1 ответа в день)","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"1585037","alias":"sahsAGU","fullname":"Александр Гуреев","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F43c\u002F6c7\u002F0ab\u002F43c6c70ab024d45474e6abe8db797573.jpg","speciality":"Автор"},"statistics":{"commentsCount":34,"favoritesCount":10,"readingCount":10431,"score":11,"votesCount":17},"hubs":[{"relatedData":null,"id":"260","alias":"php","type":"collective","title":"PHP","titleHtml":"PHP","isProfiled":true},{"relatedData":null,"id":"306","alias":"mysql","type":"collective","title":"MySQL","titleHtml":"MySQL","isProfiled":true},{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"594","alias":"sql","type":"collective","title":"SQL","titleHtml":"SQL","isProfiled":true},{"relatedData":null,"id":"7152","alias":"data_mining","type":"collective","title":"Data Mining","titleHtml":"Data Mining","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003E\u003Cstrong\u003EВ среднем 24,1 ответа в день (если все 365 дней в году считать рабочими) на протяжении почти 10 лет.\u003C\u002Fstrong\u003E \u003C\u002Fp\u003E\u003Cp\u003EНесколько дней назад на некоторых англоязычных ресурсах началось обсуждение одного очень необычного пользователя Stack Overflow. Его зовут Гордон Линофф (Gordon Linoff), он из Нью-Йорка, и за 9 лет и 8 месяцев своего присутствия на платформе он дал 85,201 ответов на различные вопросы, в основном связанные с SQL и дата-майнингом (цифра актуальна на 27.09.2021). \u003C\u002Fp\u003E\u003Cp\u003EЧто это за маг?\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F396\u002F5ac\u002Fef4\u002F3965acef48ae14917c514fa091f60d1a.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F396\u002F5ac\u002Fef4\u002F3965acef48ae14917c514fa091f60d1a.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"sql"},{"titleHtml":"mysql"},{"titleHtml":"stackoverflow"},{"titleHtml":"базы данных"},{"titleHtml":"дата майнинг"},{"titleHtml":"data mining"}]},"580060":{"id":"580060","timePublished":"2021-09-27T09:00:04+00:00","isCorporative":true,"lang":"ru","titleHtml":"Арракис, который мы заслужили","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"238277","alias":"Zelenyikot","fullname":"Виталий Егоров","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F22b\u002F2d7\u002F7a5\u002F22b2d77a57b687aae24784a3e53089c9.jpg","speciality":"Популяризатор космонавтики"},"statistics":{"commentsCount":103,"favoritesCount":37,"readingCount":19378,"score":131,"votesCount":141},"hubs":[{"relatedData":null,"id":"19791","alias":"ruvds","type":"corporative","title":"Блог компании RUVDS.com","titleHtml":"Блог компании RUVDS.com","isProfiled":false},{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"21962","alias":"space","type":"collective","title":"Космонавтика","titleHtml":"Космонавтика","isProfiled":false},{"relatedData":null,"id":"21984","alias":"sci-fi","type":"collective","title":"Научная фантастика","titleHtml":"Научная фантастика","isProfiled":false},{"relatedData":null,"id":"22014","alias":"futurenow","type":"collective","title":"Будущее здесь","titleHtml":"Будущее здесь","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F580060\u002F\"\u003E\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fk0\u002Fds\u002Fy5\u002Fk0dsy5npxclyjdytiroqga7-leu.jpeg\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fa\u003E\u003Cbr\u003E\r\nВо вселенной писателя-фантаста Фрэнка Герберта, Дюна, она же Арракис &mdash; это пустынная и маловодная планета с двумя лунами. По сюжету, она находится за пределами Солнечной системы, но если мы захотим поискать ближайшую схожую параллель,&nbsp;то больше всего подходит планета Марс. Предлагаю воспользоваться возможностями, которые даёт современная космонавтика, и совершить воображаемую прогулку на нашу Дюну.\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Марс"},{"titleHtml":"Дюна"},{"titleHtml":"MRO"},{"titleHtml":"Curiosity"},{"titleHtml":"марсоход"},{"titleHtml":"ruvds_статьи"}]},"580088":{"id":"580088","timePublished":"2021-09-26T21:17:27+00:00","isCorporative":false,"lang":"ru","titleHtml":"Запуск X-приложения в chroot на примере POSE (или «QEMU не нужен»)","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"1481597","alias":"edo1h","fullname":null,"avatarUrl":"","speciality":"немного программист, немного админ"},"statistics":{"commentsCount":5,"favoritesCount":15,"readingCount":1259,"score":17,"votesCount":17},"hubs":[{"relatedData":null,"id":"221","alias":"sys_admin","type":"collective","title":"Системное администрирование","titleHtml":"Системное администрирование","isProfiled":true},{"relatedData":null,"id":"7289","alias":"nix","type":"collective","title":"*nix","titleHtml":"*nix","isProfiled":true}],"flows":[{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЭта мини-статья родилась как ответ на статью \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F579296\" rel=\"noopener noreferrer nofollow\"\u003EУпрощаем эмуляцию X86 с помощью Live CD\u003C\u002Fa\u003E, в которой для запуска старых 32-битных приложений на 64-битных дистрибутивах Linux предлагалось использовать QEMU + Live CD — по моему мнению «из пушки по воробьям». Опишу своё решение на \u003Ccode\u003Echroot\u003C\u002Fcode\u003E + \u003Ccode\u003Edebootstrap\u003C\u002Fcode\u003E. \u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"chroot"},{"titleHtml":"debootstrap"},{"titleHtml":"xwindow"}]},"580090":{"id":"580090","timePublished":"2021-09-26T21:19:11+00:00","isCorporative":false,"lang":"ru","titleHtml":"Сравнение подходов к реализации распределенных транзакций для микросервисов","editorVersion":"2.0","postType":"article","postLabels":[{"type":"sandbox","data":null},{"type":"translation","data":{"originalAuthorName":"Bilgin Ibryam","originalUrl":"https:\u002F\u002Fdevelopers.redhat.com\u002Farticles\u002F2021\u002F09\u002F21\u002Fdistributed-transaction-patterns-microservices-compared"}}],"author":{"id":"194270","alias":"sprosin","fullname":"Sergey Prosin","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd67\u002F5d8\u002F1d6\u002Fd675d81d6fe5bf69493735cef4910eb5.jpg","speciality":"Веду команды к релизам, пишу статьи, выступаю."},"statistics":{"commentsCount":6,"favoritesCount":100,"readingCount":5783,"score":20,"votesCount":20},"hubs":[{"relatedData":null,"id":"7504","alias":"refactoring","type":"collective","title":"Проектирование и рефакторинг","titleHtml":"Проектирование и рефакторинг","isProfiled":true},{"relatedData":null,"id":"21482","alias":"distributed_systems","type":"collective","title":"Распределённые системы","titleHtml":"Распределённые системы","isProfiled":true},{"relatedData":null,"id":"22115","alias":"microservices","type":"collective","title":"Микросервисы","titleHtml":"Микросервисы","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EКак архитектор-консультант в Red Hat, я имел возможность поработать над множеством проектов для наших клиентов. У каждого из них есть свои особенности, которые, однако, имеют некоторые общие черты. Большинство клиентов хотят знать, как скоординировать запись в несколько систем одновременно. Ответ на этот вопрос обычно включает подробное объяснение двойной записи, распределенных транзакций, современных альтернатив, а также возможных сценариев сбоев и недостатков каждого подхода. Как правило, именно в этот момент заказчик понимает, что разделение монолитного приложения на микросервисы - долгий и сложный путь, обычно требующий компромиссов.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbc4\u002F35d\u002Fff3\u002Fbc435dff35d09143dacf29bbc1e470a7.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbc4\u002F35d\u002Fff3\u002Fbc435dff35d09143dacf29bbc1e470a7.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"распределенные системы"},{"titleHtml":"микросервисы"},{"titleHtml":"транзакции"},{"titleHtml":"распределенные транзакции"},{"titleHtml":"оркестрация"},{"titleHtml":"оркестрация микросервисов"},{"titleHtml":"хореография"},{"titleHtml":"конвейеры"}]},"580092":{"id":"580092","timePublished":"2021-09-26T21:49:14+00:00","isCorporative":false,"lang":"ru","titleHtml":"30 сентября: Let's Encrypt и конец срока действия IdenTrust DST Root CA X3","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"805873","alias":"rantal","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":93,"favoritesCount":58,"readingCount":19267,"score":48,"votesCount":48},"hubs":[{"relatedData":null,"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true},{"relatedData":null,"id":"17350","alias":"s_admin","type":"collective","title":"Серверное администрирование","titleHtml":"Серверное администрирование","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003E30 сентября 2021 14:01:15  GMT оканчивается срок действия корневого сертификата IdenTrust DST Root CA X3.\u003C\u002Fp\u003E\u003Cp\u003EЭто событие достойно вашего внимания по той причине, что после наступления этого момента ряд устаревших систем перестанут доверять сертификатам,&nbsp;выпущенным центром сертификации Let’s Encrypt. С учётом того, что на текущий момент Let's Encrypt предоставляет бесплатные криптографические сертификаты примерно для \u003Ca href=\"https:\u002F\u002Fletsencrypt.org\u002Fstats\u002F\" rel=\"noopener noreferrer nofollow\"\u003E250 миллионов доменных имен\u003C\u002Fa\u003E, а \"устаревшие системы\" - это порой системы возрастом всего 5-6 лет, вряд ли окончание срока действия сертификата&nbsp;DST Root CA X3 пройдёт для всех гладко и незаметно. В чём причина, кого конкретно это затронет, и что можно сделать?\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"let's encrypt"},{"titleHtml":"DST Root CA X3"},{"titleHtml":"корневой сертификат"},{"titleHtml":"https"},{"titleHtml":"tls"},{"titleHtml":"openssl"}]},"580094":{"id":"580094","timePublished":"2021-09-26T22:35:26+00:00","isCorporative":false,"lang":"ru","titleHtml":"Блокчейн нас подвёл? Почему ДЭГ — это плохо и можем ли мы адекватно контролировать процесс подсчёта голосов?","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"206414","alias":"PoltoS","fullname":"Сергей Полторак","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F5cf\u002F03a\u002Fc7f\u002F5cf03ac7fe60ea8a6686bd4c57627ddc.png","speciality":""},"statistics":{"commentsCount":100,"favoritesCount":27,"readingCount":15136,"score":32,"votesCount":54},"hubs":[{"relatedData":null,"id":"118","alias":"crypto","type":"collective","title":"Криптография","titleHtml":"Криптография","isProfiled":true},{"relatedData":null,"id":"210","alias":"it_testing","type":"collective","title":"Тестирование IT-систем","titleHtml":"Тестирование IT-систем","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EИнтересно наблюдать, как дискредитируется термин блокчейна на выборах в госдуму. Вроде голосование было на блокчейне, но его якобы подделали. Т.е. блокчейн можно подделать или ЦИК и ДИТ нам подсунули какой-то лохчейн вместо блокчейна?!? И мало кто обсуждает происходящее по существу без эмоций, связанных с результатами партий и кандидатов.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6e5\u002F82b\u002F9d0\u002F6e582b9d062dd29fa41c7842a8b76495.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6e5\u002F82b\u002F9d0\u002F6e582b9d062dd29fa41c7842a8b76495.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Криптография"},{"titleHtml":"блокчейн"},{"titleHtml":"открытые данные"},{"titleHtml":"электронное голосование"},{"titleHtml":"выборы"},{"titleHtml":"выборы в госдуму"},{"titleHtml":"дэг"},{"titleHtml":"дэг 2021"}]},"580124":{"id":"580124","timePublished":"2021-09-27T13:03:14+00:00","isCorporative":true,"lang":"ru","titleHtml":"Электролюминесцентные индикаторы из прошлого","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"146371","alias":"radiolok","fullname":"Артем Кашканов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fa46\u002Fc6a\u002F151\u002Fa46c6a15193f7c0cac79d2736b107358.jpg","speciality":"Релейно-декатронный маньяк"},"statistics":{"commentsCount":11,"favoritesCount":36,"readingCount":4337,"score":66,"votesCount":66},"hubs":[{"relatedData":null,"id":"19791","alias":"ruvds","type":"corporative","title":"Блог компании RUVDS.com","titleHtml":"Блог компании RUVDS.com","isProfiled":false},{"relatedData":null,"id":"21484","alias":"electronics","type":"collective","title":"Производство и разработка электроники","titleHtml":"Производство и разработка электроники","isProfiled":true},{"relatedData":null,"id":"21906","alias":"history","type":"collective","title":"История IT","titleHtml":"История IT","isProfiled":false},{"relatedData":null,"id":"21930","alias":"antikvariat","type":"collective","title":"Старое железо","titleHtml":"Старое железо","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"Сегодня речь пойдёт об электролюминесцентных индикаторах. Но, не о тех, которые окружают вас повсюду и к которым вы привыкли, а о других — получивших огромную популярность в 60-е годы прошлого века, и так же стремительно канувших в небытие. Заодно запущу свою коллекцию индикаторов, как серийно выпускавшихся, так и уникальных опытных и даже — лабораторных образцов.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F523004\u002F\"\u003E\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F94e\u002F51f\u002F459\u002F94e51f459ae59c9d2fe6c448cb07bcca.gif\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fa\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Индикатор"},{"titleHtml":"электролюминесцентность"},{"titleHtml":"ruvds_статьи"}]},"580150":{"id":"580150","timePublished":"2021-09-27T10:50:03+00:00","isCorporative":true,"lang":"ru","titleHtml":"Топ-5 когнитивных искажений при планировании в IT","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2794469","alias":"KM_QA","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":7,"favoritesCount":47,"readingCount":4930,"score":32,"votesCount":34},"hubs":[{"relatedData":null,"id":"14332","alias":"oleg-bunin","type":"corporative","title":"Блог компании Конференции Олега Бунина (Онтико)","titleHtml":"Блог компании Конференции Олега Бунина (Онтико)","isProfiled":false},{"relatedData":null,"id":"19583","alias":"dev_management","type":"collective","title":"Управление разработкой","titleHtml":"Управление разработкой","isProfiled":true},{"relatedData":null,"id":"20736","alias":"hr_management","type":"collective","title":"Управление персоналом","titleHtml":"Управление персоналом","isProfiled":true},{"relatedData":null,"id":"20754","alias":"tech_events","type":"collective","title":"Конференции","titleHtml":"Конференции","isProfiled":false},{"relatedData":null,"id":"21990","alias":"brain","type":"collective","title":"Мозг","titleHtml":"Мозг","isProfiled":false}],"flows":[{"id":"3","alias":"management","title":"Менеджмент"},{"id":"4","alias":"marketing","title":"Маркетинг"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЭта статья подходит для тимлидов и их подопечных, а также для всех, кто оценивает проекты и задачи. Я расскажу, как и почему мы делаем ошибки из-за когнитивных искажений. Попадаем в них мы почти все, просто потому что мы живые люди. И на примере одного дня из жизни тимлида я хочу показать, в какие искажения чаще всего влетают в IT, и&nbsp; — самое полезное&nbsp; —&nbsp; как из них можно выходить.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EЗамечу, что искать когнитивные искажения стоит, в первую очередь, у себя, а не у коллег. \u003C\u002Fstrong\u003EИ что рассказывать про искажения намного проще, чем не влетать в их на практике, однако, если этому научиться, то в перспективе это изрядно окупается, потому что экономит и время, и деньги, помогая и нам, и команде.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb78\u002F76f\u002F001\u002Fb7876f0010e85c328462a735df0b76e8.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb78\u002F76f\u002F001\u002Fb7876f0010e85c328462a735df0b76e8.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"когнитивные искажения"},{"titleHtml":"нейрофизиология"},{"titleHtml":"мозг"},{"titleHtml":"психология"},{"titleHtml":"тимлидство"},{"titleHtml":"тимлид"},{"titleHtml":"управление людьми"},{"titleHtml":"управление проектами и командой"},{"titleHtml":"управление командой"},{"titleHtml":"управление персоналом"}]},"580172":{"id":"580172","timePublished":"2021-09-27T11:45:49+00:00","isCorporative":true,"lang":"ru","titleHtml":"Небинарный ngIf*","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"1050218","alias":"Waterplea","fullname":"Александр Инкин","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fa70\u002F569\u002Ff31\u002Fa70569f31346559ce2b8b875e7f97480.jpg","speciality":"Google Developer Expert | Angular"},"statistics":{"commentsCount":1,"favoritesCount":11,"readingCount":840,"score":14,"votesCount":14},"hubs":[{"relatedData":null,"id":"17420","alias":"tinkoff","type":"corporative","title":"Блог компании TINKOFF","titleHtml":"Блог компании TINKOFF","isProfiled":false},{"relatedData":null,"id":"91","alias":"webdev","type":"collective","title":"Разработка веб-сайтов","titleHtml":"Разработка веб-сайтов","isProfiled":true},{"relatedData":null,"id":"18109","alias":"angular","type":"collective","title":"Angular","titleHtml":"Angular","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EВам когда-нибудь хотелось отобразить состояние загрузки, пока \u003Ccode\u003EngIf\u003C\u002Fcode\u003E ждет ответа от \u003Ccode\u003Easync\u003C\u002Fcode\u003E-пайпа? Или, может, вы мечтали передать в \u003Ccode\u003EngFor\u003C\u002Fcode\u003E шаблон для пустого массива? Возможно, вы бросили это, потому что вам не хотелось реализовывать базовую логику этих директив самому. На самом деле в этом нет нужды! Один и тот же селектор может подцепить несколько директив, что позволяет расширить функциональность встроенных директив дополнительной логикой.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F846\u002F786\u002F3e2\u002F8467863e2df65db32cb31f4b16c822ef.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F846\u002F786\u002F3e2\u002F8467863e2df65db32cb31f4b16c822ef.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"template"},{"titleHtml":"directive"},{"titleHtml":"angular"},{"titleHtml":"structural"}]},"580194":{"id":"580194","timePublished":"2021-09-27T12:36:12+00:00","isCorporative":true,"lang":"ru","titleHtml":"Сотрудники на карте: отвечаем на 10 важных вопросов о трекинге","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"1254716","alias":"Axelus","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F118\u002Fc4f\u002F08f\u002F118c4f08ffa66438ad6be22e205d563d.png","speciality":"Разработчик"},"statistics":{"commentsCount":0,"favoritesCount":6,"readingCount":982,"score":13,"votesCount":15},"hubs":[{"relatedData":null,"id":"20758","alias":"regionsoft","type":"corporative","title":"Блог компании RegionSoft","titleHtml":"Блог компании RegionSoft","isProfiled":false},{"relatedData":null,"id":"6398","alias":"it-infrastructure","type":"collective","title":"IT-инфраструктура","titleHtml":"IT-инфраструктура","isProfiled":true},{"relatedData":null,"id":"12365","alias":"saas","type":"collective","title":"SaaS \u002F S+S","titleHtml":"SaaS \u002F S+S","isProfiled":true},{"relatedData":null,"id":"17783","alias":"geo","type":"collective","title":"Геоинформационные сервисы","titleHtml":"Геоинформационные сервисы","isProfiled":true},{"relatedData":null,"id":"20736","alias":"hr_management","type":"collective","title":"Управление персоналом","titleHtml":"Управление персоналом","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"3","alias":"management","title":"Менеджмент"},{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЛюбой контроль сотрудников — опасный и болезненный вопрос, особенно в небольших компаниях. Часто в дружеские и открытые отношения компании не вписывается ни одна из форм контроля, рассчитывать можно только на доверие. Но пресловутый ковид и здесь внёс свои коррективы: расширение удалённой работы, увеличение штата мобильных сотрудников, частичная занятость пополнили ряды полевых сисадминов, аутсорсеров поддержки и остальных «разъездных» работников. Увы, люди разные и вслед за приятными плодами и бонусами удалёнки пришли негативные истории про поведение курьеров, опоздания и откровенные нарушения сотрудников на территории клиентов, неявки на работу или к заказчику и т.д. С этим столкнулись и ритейл, и ИТ, и любая сфера с мобильными сотрудниками. Очень хочется верить в лучшее, но без минимального контроля можно просто потерять бизнес — и тогда пострадают коллеги нерадивых сотрудников.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe4a\u002F5b9\u002Fa9d\u002Fe4a5b9a9d62c342fa897f4531ec9301b.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe4a\u002F5b9\u002Fa9d\u002Fe4a5b9a9d62c342fa897f4531ec9301b.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"geomonitor"},{"titleHtml":"геолокация"},{"titleHtml":"геозона"},{"titleHtml":"трекинг"}]},"580196":{"id":"580196","timePublished":"2021-09-27T12:28:15+00:00","isCorporative":true,"lang":"ru","titleHtml":"Зачем нужен динамический анализ кода, на примере проекта PVS-Studio","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"2302295","alias":"MrROBUST","fullname":"Алексей Говоров","avatarUrl":"","speciality":"Пользователь"},"statistics":{"commentsCount":0,"favoritesCount":3,"readingCount":609,"score":9,"votesCount":9},"hubs":[{"relatedData":null,"id":"18095","alias":"pvs-studio","type":"corporative","title":"Блог компании PVS-Studio","titleHtml":"Блог компании PVS-Studio","isProfiled":false},{"relatedData":null,"id":"559","alias":"cpp","type":"collective","title":"C++","titleHtml":"C++","isProfiled":true},{"relatedData":null,"id":"11606","alias":"vs","type":"collective","title":"Visual Studio","titleHtml":"Visual Studio","isProfiled":true},{"relatedData":null,"id":"21456","alias":"win_dev","type":"collective","title":"Разработка под Windows","titleHtml":"Разработка под Windows","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EВ разговоре с Маршаллом Клоу на подкасте CppCast #300 ABI Stability была затронута достаточно давняя новость о поддержке компиляторами Visual Studio инструмента AddressSanitizer (ASan). Мы уже достаточно давно внедрили ASan в свою систему тестирования и хотим рассказать о паре интересных ошибок, которые он помог найти.\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F7ef\u002F2db\u002F210\u002F7ef2db210d677f9a8c07026d4361d3ba.png\" alt=\"0868_PVS-Studio_ASan_ru\u002Fimage2.png\"\u003E\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"pvs-studio"},{"titleHtml":"clang"},{"titleHtml":"asan"},{"titleHtml":"sanitizer"},{"titleHtml":"динамический анализ кода"}]},"580206":{"id":"580206","timePublished":"2021-09-27T12:51:03+00:00","isCorporative":false,"lang":"ru","titleHtml":"МТС отказался от скрытых мобильных подписок?","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2467147","alias":"Plusodin","fullname":"Владимир","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F343\u002Fb77\u002Fd12\u002F343b77d12f047368849a9880276f936e.jpg","speciality":"Пользователь"},"statistics":{"commentsCount":8,"favoritesCount":3,"readingCount":4256,"score":11,"votesCount":11},"hubs":[{"relatedData":null,"id":"22008","alias":"cellular","type":"collective","title":"Сотовая связь","titleHtml":"Сотовая связь","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EПривет, Хабр!\u003C\u002Fp\u003E\u003Cp\u003EНу что, подходит к концу первый сезон сериала «О скрытых мобильных подписках и операторах связи». Предыдущие три серии: \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F550448\u002F\" rel=\"noopener noreferrer nofollow\"\u003EМегафон\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F563260\u002F\" rel=\"noopener noreferrer nofollow\"\u003EБилайн\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F571256\u002F\" rel=\"noopener noreferrer nofollow\"\u003ETele2\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cp\u003EНу и вишенка на этом торте – МТС.\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"мтс"},{"titleHtml":"мобильные подписки"},{"titleHtml":"подписки"},{"titleHtml":"оператор связи"},{"titleHtml":"теле2"},{"titleHtml":"мегафон"},{"titleHtml":"билайн"}]},"580208":{"id":"580208","timePublished":"2021-09-27T12:52:27+00:00","isCorporative":false,"lang":"ru","titleHtml":"Основная проблема образования","editorVersion":"2.0","postType":"article","postLabels":[{"type":"recovery","data":null}],"author":{"id":"2270142","alias":"Chronicler","fullname":"Пушиз де Хрониклер","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Faa3\u002F149\u002Fdb0\u002Faa3149db0de5f6c071dfade7285fcb99.jpg","speciality":"Исследователь ближнего заполярья, почетный манул"},"statistics":{"commentsCount":11,"favoritesCount":10,"readingCount":2111,"score":8,"votesCount":20},"hubs":[{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"17189","alias":"itstandarts","type":"collective","title":"IT-стандарты","titleHtml":"IT-стандарты","isProfiled":true},{"relatedData":null,"id":"20682","alias":"pm","type":"collective","title":"Управление проектами","titleHtml":"Управление проектами","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"3","alias":"management","title":"Менеджмент"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EНа днях на Хабре появилась \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F579998\u002F\" rel=\"noopener noreferrer nofollow\"\u003Eкритическая статья\u003C\u002Fa\u003E о бакалавриате, что называется \"из первых уст\", от очередного первохода. Статья далеко не лишена смысла, однако главная проблема не была в ней затронута. А заключается она вовсе не в обилии посторонних дисциплин и даже не в том, что в учебных заведениях так мало разъясняют суровую конкретику жизни \"научиться штамповать JavaScript сайты за месяц\".  Да, эти проблемы присутствуют, наряду с плохой подготовкой педагогов и отношением к студентам, но не они на корню обесценивают нынешнее образование.\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Что же на самом деле не так?","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"программирование"},{"titleHtml":"образование"},{"titleHtml":"курсы не нужны"},{"titleHtml":"вуз"}]},"580210":{"id":"580210","timePublished":"2021-09-27T12:53:02+00:00","isCorporative":false,"lang":"ru","titleHtml":"PHP Дайджест № 212 (13 – 27 сентября 2021)","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"100489","alias":"pronskiy","fullname":"Роман Пронский","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F27f\u002Fb99\u002Feb3\u002F27fb99eb3e30e3221c5839e88be02395.jpg","speciality":"PHP"},"statistics":{"commentsCount":1,"favoritesCount":9,"readingCount":3188,"score":33,"votesCount":33},"hubs":[{"relatedData":null,"id":"91","alias":"webdev","type":"collective","title":"Разработка веб-сайтов","titleHtml":"Разработка веб-сайтов","isProfiled":true},{"relatedData":null,"id":"260","alias":"php","type":"collective","title":"PHP","titleHtml":"PHP","isProfiled":true},{"relatedData":null,"id":"477","alias":"symfony","type":"collective","title":"Symfony","titleHtml":"Symfony","isProfiled":true},{"relatedData":null,"id":"9554","alias":"yii","type":"collective","title":"Yii","titleHtml":"Yii","isProfiled":true},{"relatedData":null,"id":"18812","alias":"laravel","type":"collective","title":"Laravel","titleHtml":"Laravel","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fek\u002F6r\u002Fr1\u002Fek6rr1odvyzb89tfv0lq4cmfxi4.jpeg\"\u003E\u003C\u002Fdiv\u003E\u003Cbr\u003E\r\nПодборка свежих новостей и материалов из мира PHP.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nВышел PHP 8.1 RC2 и уже доступен первый пакет с использованием перечислений, будет сделан форк Magento, новый тип стандартов PER в дополнение к PSR, стартовала PhpStorm 2021.3 EAP, Symfony 6 будет полностью типизирован — как обновляться?\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nДля PHP 8.2 предложены новые оптимизированные структуры данных.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nТакже в выпуске порция инструментов, полезные статьи, видео и анонсы двух митапов.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nПриятного чтения!\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"дайджест"},{"titleHtml":"php-дайджест"},{"titleHtml":"PHP"},{"titleHtml":"Symfony"},{"titleHtml":"Laravel"},{"titleHtml":"Magento"},{"titleHtml":"PHPUnit"},{"titleHtml":"PHP 8.1"},{"titleHtml":"PHP 8.2"}]},"580228":{"id":"580228","timePublished":"2021-09-27T16:41:21+00:00","isCorporative":true,"lang":"ru","titleHtml":"Идеальная светодиодная лампа за 21 рубль","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"108988","alias":"AlexeyNadezhin","fullname":"Алексей Надежин","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Ffdc\u002F3ac\u002F9a2\u002Ffdc3ac9a2dc0107cc956f1bd0cf5fc2b.jpg","speciality":"Блогер"},"statistics":{"commentsCount":22,"favoritesCount":31,"readingCount":7219,"score":61,"votesCount":63},"hubs":[{"relatedData":null,"id":"21646","alias":"lamptest","type":"corporative","title":"Блог компании LampTest","titleHtml":"Блог компании LampTest","isProfiled":false},{"relatedData":null,"id":"21894","alias":"gadgets","type":"collective","title":"Гаджеты","titleHtml":"Гаджеты","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"Удивительно осознавать, что достаточно сложное электронное устройство, которым является светодиодная лампочка, может стоить 21 рубль. \u003Cbr\u003E\r\n\u003Cbr\u003E\r\nЕщё сложнее поверить, что эта лампочка безукоризненна по всем параметрам.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F20f\u002F849\u002Ffcd\u002F20f849fcd6a3891f506676fc87223bdf.jpg\"\u003E\u003C\u002Fdiv\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"led"},{"titleHtml":"светодиодные лампы"},{"titleHtml":"тест"}]}},"articlesIds":{"ARTICLES_LIST_TOP_PERIOD_DAILY":["580060","580124","580228","580092","580210","580150","580094","579854","580090","580088","572164","580172","580008","580194","580206","580050","580196","579772","579984","580208"]},"isLoading":false,"pagesCount":{"ARTICLES_LIST_TOP_PERIOD_DAILY":3},"route":{"name":"ARTICLES_LIST_TOP_PERIOD","params":{"period":"daily"},"query":{}},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":["574620","563550","560286"],"similarListRefs":{"560286":{"id":"560286","timePublished":"2021-05-31T15:20:58+00:00","isCorporative":true,"lang":"ru","titleHtml":"Почему я считаю Haskell хорошим выбором с точки зрения безопасности ПО?","editorVersion":"1.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Ville Tirronen","originalUrl":"https:\u002F\u002Fblog.typeable.io\u002Fposts\u002F2021-05-31-haskell-security.html"}}],"author":{"id":"1869315","alias":"fierce-katie","fullname":"Катерина Галкина","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F113\u002Fdd7\u002F06c\u002F113dd706c9ff01b2197c251da05267a0.jpg","speciality":"Программист"},"statistics":{"commentsCount":60,"favoritesCount":30,"readingCount":5575,"score":23,"votesCount":23},"hubs":[{"id":"22642","alias":"typeable","type":"corporative","title":"Блог компании Typeable","titleHtml":"Блог компании Typeable","isProfiled":false},{"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true},{"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"id":"8424","alias":"haskell","type":"collective","title":"Haskell","titleHtml":"Haskell","isProfiled":true},{"id":"17853","alias":"funcprog","type":"collective","title":"Функциональное программирование","titleHtml":"Функциональное программирование","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fpt\u002Fh8\u002F_b\u002Fpth8_bbbuzhgff6vh_ievhuxk7u.jpeg\"\u003E\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003EКоманда Typeable понимает ценность безопасности. Мы любим Haskell, но стоит ли его выбирать, если ваша цель – создание защищенного программного обеспечения? Хотелось бы сказать «да», но как и для большинства эмпирических вопросов о разработке ПО, здесь просто нет объективного доказательства, подтверждающего, что Haskell – или ещё какой-нибудь язык программирования – обеспечивает большую безопасность, чем любой другой. Нельзя сказать, что \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Ftypeable\u002Fblog\u002F554516\u002F\"\u003Eвыбор языка в Typeable\u003C\u002Fa\u003E не имеет значения для безопасности, но какое именно значение он имеет, еще нужно подумать.\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003EОпираясь на пятилетний опыт преподавания вводного курса по защите ПО, я могу подтвердить, что универсальной теории, на которой может строиться защита ПО, не существует. Вопросы безопасности чаще всего преподаются путем перечисления различных уязвимостей, способов их минимизации и моделей безопасности в надежде на то, что на этой основе студенты смогут получить общее понимание вопроса. Из немногих существующих теоретических работ только некоторые содержат попытки провести связь между языком программирования и аспектами безопасности.\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null},"563550":{"id":"563550","timePublished":"2021-06-18T15:01:42+00:00","isCorporative":true,"lang":"ru","titleHtml":"Создаем веб-приложение на Haskell с использованием Reflex. Часть 4","editorVersion":"1.0","postType":"article","postLabels":[{"type":"tutorial","data":null}],"author":{"id":"196914","alias":"anisimoffnikita","fullname":"Анисимов Никита","avatarUrl":null,"speciality":"Haskell программист"},"statistics":{"commentsCount":0,"favoritesCount":25,"readingCount":1975,"score":8,"votesCount":8},"hubs":[{"id":"22642","alias":"typeable","type":"corporative","title":"Блог компании Typeable","titleHtml":"Блог компании Typeable","isProfiled":false},{"id":"91","alias":"webdev","type":"collective","title":"Разработка веб-сайтов","titleHtml":"Разработка веб-сайтов","isProfiled":true},{"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"id":"8424","alias":"haskell","type":"collective","title":"Haskell","titleHtml":"Haskell","isProfiled":true},{"id":"17853","alias":"funcprog","type":"collective","title":"Функциональное программирование","titleHtml":"Функциональное программирование","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Ftypeable\u002Fblog\u002F543998\u002F\"\u003EЧасть 1\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Ftypeable\u002Fblog\u002F549542\u002F\"\u003EЧасть 2\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Ftypeable\u002Fblog\u002F557852\u002F\"\u003EЧасть 3\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003EВсем привет! В новой части мы рассмотрим использование \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fghcjs\u002Fghcjs\u002Fblob\u002Fmaster\u002Fdoc\u002Fforeign-function-interface.md\" rel=\"nofollow noopener noreferrer\"\u003EJSFFI\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F9w\u002Fm3\u002Fnt\u002F9wm3ntdpgxeukkjephuvba7tevc.gif\" alt=\"intro\"\u003E\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null},"574620":{"id":"574620","timePublished":"2021-08-25T16:26:36+00:00","isCorporative":true,"lang":"ru","titleHtml":"Как мы поучаствовали в ICFPC 2021 и что из этого вышло","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"1181772","alias":"nevoroman","fullname":"Роман Неволин","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F21d\u002F1d5\u002F7d9\u002F21d1d57d92a296101a1da62761632a78.jpg","speciality":"DevRel"},"statistics":{"commentsCount":1,"favoritesCount":5,"readingCount":931,"score":13,"votesCount":13},"hubs":[{"id":"15878","alias":"skbkontur","type":"corporative","title":"Блог компании Контур","titleHtml":"Блог компании Контур","isProfiled":false},{"id":"84","alias":"crazydev","type":"collective","title":"Ненормальное программирование","titleHtml":"Ненормальное программирование","isProfiled":true},{"id":"89","alias":"sport_programming","type":"collective","title":"Спортивное программирование","titleHtml":"Спортивное программирование","isProfiled":true},{"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"id":"8000","alias":"algorithms","type":"collective","title":"Алгоритмы","titleHtml":"Алгоритмы","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EОдна старая академическая конференция,&nbsp;\u003Ca href=\"https:\u002F\u002Fwww.icfpconference.org\u002F\"\u003E\u003Cu\u003EInternational Conference on Functional Programming\u003C\u002Fu\u003E\u003C\u002Fa\u003E, уже больше двадцати лет организует соревнование по программированию своего имени. 1 задание, 72 часа, участвуют команды произвольного размера. На этом ограничения все. Задача может быть любой, решения — тем более.\u003C\u002Fp\u003E\u003Cp\u003EВас могут заставить писать ботов для игр или управлять марсоходом. Реализовывать виртуальные машины или разворачивать оригами. Искать кратчайшие маршруты в лабиринтах или разгадывать послания инопланетян. А в этом году мы пропихивали человечков в лямбды и клали песиков в гробы.\u003C\u002Fp\u003E\u003Cp\u003EПод катом обзор контеста 2021 года и нашего участия в нем. А еще алгоритмы, теории, байки и разбор решений других команд.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fda4\u002Fa9f\u002Fc9c\u002Fda4a9fc9c4397338e2f28c9642879316.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fda4\u002Fa9f\u002Fc9c\u002Fda4a9fc9c4397338e2f28c9642879316.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null}}},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{"san13":{"scoreStats":{"score":72,"votesCount":100},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"50634","alias":"San13","fullname":"Я робот","avatarUrl":null,"speciality":null}},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.670ab961.js" defer></script><script src="https://assets.habr.com/habr-web/js/chunk-f458c7c4.6e221df6.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.76acc47b.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
