<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Классы типов, монады / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.0f7bdd8f.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.670ab961.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.01bb2993.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.76acc47b.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-f458c7c4.e48e8f79.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-f458c7c4.6e221df6.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.0f7bdd8f.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.01bb2993.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-f458c7c4.e48e8f79.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.4f7c12b4e1b1b4c0e44ef6f9f33b1f9f.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/51046\/"},"headline":"Классы типов, монады","datePublished":"2009-02-04T12:11:09+03:00","dateModified":"2011-11-20T03:28:53+04:00","author":{"@type":"Person","name":"VoidEx"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Темой сегодняшней статьи будут классы типов, некоторые стандартные из них, синтаксический сахар с их использованием и класс монад. Классы привносят динамический...","url":"https:\/\/habr.com\/ru\/post\/51046\/#post-content-body","about":["h_haskell","f_develop"],"image":["https:\/\/habrastorage.org\/getpro\/habr\/post_images\/39d\/477\/584\/39d477584b00e663434eb8885b830aa4.png"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.47.1">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Классы типов, монады" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Классы типов, монады" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Классы типов, монады" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Темой сегодняшней статьи будут классы типов, некоторые стандартные из них, синтаксический сахар с их использованием и класс монад.
Классы привносят динамический полиморфизм, как и интерфейсы в..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Темой сегодняшней статьи будут классы типов, некоторые стандартные из них, синтаксический сахар с их использованием и класс монад.
Классы привносят динамический полиморфизм, как и интерфейсы в..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Темой сегодняшней статьи будут классы типов, некоторые стандартные из них, синтаксический сахар с их использованием и класс монад.
Классы привносят динамический полиморфизм, как и интерфейсы в..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Темой сегодняшней статьи будут классы типов, некоторые стандартные из них, синтаксический сахар с их использованием и класс монад.
Классы привносят динамический полиморфизм, как и интерфейсы в..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Темой сегодняшней статьи будут классы типов, некоторые стандартные из них, синтаксический сахар с их использованием и класс монад.
Классы привносят динамический полиморфизм, как и интерфейсы в..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/51046/d8013d8100dad213a6c8ff598098bc2b/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/51046/d8013d8100dad213a6c8ff598098bc2b/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/51046/d8013d8100dad213a6c8ff598098bc2b/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/51046/d8013d8100dad213a6c8ff598098bc2b/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/51046/d8013d8100dad213a6c8ff598098bc2b/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="51046" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2009-02-04T09:11:09.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/51046/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/51046/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/51046/d8013d8100dad213a6c8ff598098bc2b/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.cee85629.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
              Как стать автором
            </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.cee85629.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.cee85629.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.cee85629.svg#pull-arrow"></use></svg></div></div> <!----> <div class="tm-page-article__body"><article class="tm-page-article__content tm-page-article__content_inner"><div class="tm-page-article__head-wrapper"><!----> <div class="tm-article-snippet tm-page-article__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/VoidEx/" title="VoidEx" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" loading="lazy" src="//habrastorage.org/r/w32/getpro/habr/avatars/d5f/d69/bc4/d5fd69bc4f16d3a7a11b42c68549d070.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/VoidEx/" class="tm-user-info__username">
      VoidEx
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2009-02-04T09:11:09.000Z" title="2009-02-04, 12:11">4  февраля  2009 в 12:11</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Классы типов, монады</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/haskell/" class="tm-article-snippet__hubs-item-link"><span>Haskell</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <!----> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml">Темой сегодняшней статьи будут классы типов, некоторые стандартные из них, синтаксический сахар с их использованием и класс монад.<br/>
Классы привносят динамический полиморфизм, как и интерфейсы в традиционных императивных языках, а также могут быть использованы как замены отсутствующей в Хаскеле перегрузки функций.<br/>
Я расскажу, как определить класс типов, его экземпляры (instance) и как это всё устроено внутри.<br/>
<br/>
Предыдущие статьи:<br/>
<a href="http://habrahabr.ru/blogs/Haskell/50600/">Типы данных, паттернг матчинг и функции</a><br/>
<a href="http://habrahabr.ru/blogs/Haskell/50310/">Основы</a><br/>
<a name="habracut"></a><br/>
<h4>Классы типов</h4><br/>
Предположим, вы написали свой тип данных и хотите написать для него оператор сравнения. Проблема в том, что перегрузки функций в Хаскеле нет и потому использовать для этих целей (==) простым способом не получится. Более того, придумывать для каждого типа новое имя — не вариант.<br/>
Но вы можете определить класс типов «сравниваемый». Тогда, если ваш тип данных принадлежит к этому классу, значения этого типа можно будет сравнивать.<br/>
<blockquote><code><b><font color="#0080FF">class</font></b> MyEq a <b><font color="#0080FF">where</font></b><br/>
    myEqual <font color="#8000FF">::</font> a <font color="#8000FF">-></font> a <font color="#8000FF">-></font> Bool<br/>
    myNotEqual <font color="#8000FF">::</font> a <font color="#8000FF">-></font> a <font color="#8000FF">-></font> Bool</code></blockquote><code>MyEq</code> — это имя класса типов (как и типы данных, оно должно начинаться с заглавной буквы), <code>a</code> — некий принадлежащий к данному классу тип. Параметров у класса может быть несколько (<code>FooClass a b c</code>), но в данном случае только один.<br/>
Тип <code>a</code> принадлежит к классу <code>MyEq</code>, если для него определены соотстветствующие функции.<br/>
В классе можно дать определение функции по умолчанию. Например, функции <code>myEqual</code> и <code>myNotEqual</code> могут быть выражены друг через друга:<br/>
<blockquote><code>    myEqual x y <font color="#8000FF">=</font> not <font color="#8000FF">(</font>myNotEqual x y<font color="#8000FF">)</font><br/>
    myNotEqual x y <font color="#8000FF">=</font> not <font color="#8000FF">(</font>myEqual x y<font color="#8000FF">)</font></code></blockquote>Такие определения приведут к бесконечной рекурсии, но в экземпляре класса достаточно определить хотя бы одну из них.<br/>
Теперь напишем экземпляр класса для <code>Bool</code>:<br/>
<blockquote><code><b><font color="#0080FF">instance</font></b> MyEq Bool <b><font color="#0080FF">where</font></b><br/>
    myEqual True True <font color="#8000FF">=</font> True<br/>
    myEqual False False <font color="#8000FF">=</font> True<br/>
    myEqual <b><font color="#0080FF">_</font></b> <b><font color="#0080FF">_</font></b> <font color="#8000FF">=</font> False</code></blockquote>Определение экземпляра начинается с ключевого слова <code><b><font color="#0080FF">instance</font></b></code>, затем вместо переменной типа <code>a</code> в определении самого класса мы пишем тот тип, для которого определяется экзмепляр, т.е. <code>Bool</code>.<br/>
Определяем одну функцию <code>myEqual</code> и теперь можно проверить в интерпретаторе результат:<br/>
<blockquote><code>ghci> myEqual True True<br/>
True<br/>
ghci> myNotEqual True False<br/>
True<br/>
ghci> :t myEqual<br/>
myEqual :: (MyEq a) => a -> a -> Bool</code></blockquote>Видим, что тип функции <code>myEqual</code> накладывает ограничение (constraints) на тип — он должен принадлежать к классу <code>MyEq</code>.<br/>
Такие же ограничения можно накладывать и при объявлении самого класса:<br/>
<blockquote><code><b><font color="#0080FF">class</font></b> <font color="#8000FF">(</font>MyEq a<font color="#8000FF">)</font> <font color="#8000FF">=></font> SomeClass a <b><font color="#0080FF">where</font></b><br/>
    <font color="#008080">-- ...</font></code></blockquote><br/>
Классы чем-то похожи на интерфейсы — мы объявляем фукнции, для которых потом предоставляем реализации. Другие функции могут использовать эти функции только если для некоторого типа есть такая реализация.<br/>
Однако есть существенные отличия как в возможностях, так и в реализации самого механизма.<br/>
<ol>
<li>Как видно по функции <code>myEqual</code>, она принимает два значения типа <code>a</code>, тогда как виртуальная функция принимает только один скрытый параметр <code>this</code>.<br/>
Даже если у нас есть <code><b><font color="#0080FF">instance</font></b> MyEq Bool</code> и <code><b><font color="#0080FF">instance</font></b> MyEq Int</code>, вызов функции <code>myEqual True <font color="#80C000">5</font></code> приведёт к неудаче:<br/>
<blockquote><code>ghci> myEqual True (5::Int)<br/>
<br/>
&lt;interactive>:1:14:<br/>
    Couldn't match expected type `Bool' against inferred type `Int'<br/>
    In the second argument of `myEqual', namely `(5::Int)'<br/>
    In the expression: myEqual True (5 :: Int)<br/>
    In the definition of `it': it = myEqual True (5 :: Int)<br/>
ghci></code></blockquote>Компилятор (интерпретатор) знает, что параметры <code>myEqual</code> должны иметь один тип и потому предотвращает такие попытки.</li>
<li>Экземпляр класса может быть определён в любой момент, что также очень удобно. Наследование от интерфейсов же указывается при определении самого класса.</li>
<li>Функция может потребовать принадлежность типа данных сразу к нескольким классам:<br/>
<blockquote><code>foo <font color="#8000FF">::</font> <font color="#8000FF">(</font>Eq a<font color="#8000FF">,</font> Show a<font color="#8000FF">,</font> Read a<font color="#8000FF">)</font> <font color="#8000FF">=></font> a <font color="#8000FF">-></font> String <font color="#8000FF">-></font> String</code></blockquote>Как это сделать, например, в С++/C#? Создавать композитный <code>IEquableShowableReadable</code>? Но от него не отнаследуешься. Передавать аргумент три раза с приведением к разным интерфейсам и полагать внутри функции, что это один и тот же объект, а ответственность лежит на вызывающей стороне?</li>
</ol><br/>
Раз уж упомянул C++, то заодно скажу, что в новом стандарте C++0x <a href="http://en.wikipedia.org/wiki/C++0x#Concepts">concept и concept_map</a> есть суть классы типов, но используемые на этапе компиляции :)<br/>
<br/>
Но есть и недостаток. Как нам завести список объектов, которые, к примеру, принадлежат к классу <code>Show</code> (функция <code>show <font color="#8000FF">::</font> a <font color="#8000FF">-></font> String</code>)?<br/>
Способ есть, но он нестандартен. В начало файла необходимо добавить соответствующие опции GHC:<br/>
<blockquote><code><font color="#008080">{-#<br/>
  OPTIONS_GHC<br/>
  -XExistentialQuantification<br/>
#-}</font><br/>
<font color="#008080">-- Не знаю, почему, но при выравнивании TAB'ом GHC опции игнорировал</font></code></blockquote>Теперь мы можем объявить такой тип данных:<br/>
<blockquote><code><b><font color="#0080FF">data</font></b> ShowObj <font color="#8000FF">=</font> <b><font color="#0080FF">forall</font></b> a<font color="#8000FF">.</font> Show a <font color="#8000FF">=></font> ShowObj a</code></blockquote>(Прочитать подробнее про <a href="http://haskell.org/haskellwiki/Existential_type">existential types</a>)<br/>
И заодно определить для него экземляр класса <code>Show</code>, чтобы он сам также к нему принадлежал:<br/>
<blockquote><code><b><font color="#0080FF">instance</font></b> Show ShowObj <b><font color="#0080FF">where</font></b><br/>
    show <font color="#8000FF">(</font>ShowObj x<font color="#8000FF">)</font> <font color="#8000FF">=</font> show x</code></blockquote>Проверим:<br/>
<blockquote><code>ghci> [ShowObj 4, ShowObj True, ShowObj (ShowObj 'x')]<br/>
[4,True,'x']</code></blockquote>Хотя функцию <code>show</code> я явно не вызывал, интерпретатор использует именно её, так что можно быть уверенным, что всё работает.<br/>
<br/>
<h4>Как это всё реализуется?</h4><br/>
В функцию, которая накладывает ограничения на тип, передаётся скрытый параметр (на каждый класс и тип — свой) — словарь со всеми необходимыми функциями.<br/>
Фактически, <code><b><font color="#0080FF">instance</font></b></code> — это определение экземпляра словаря для конкретного типа.<br/>
Чтобы было проще это понять, я просто приведу псевдо-реализацию для класса <code>Eq</code> на Haskell'е и на C++:<br/>
<blockquote><code><font color="#008080">-- class MyEq</font><br/>
<b><font color="#0080FF">data</font></b> MyEq a <font color="#8000FF">=</font> MyEq <font color="#8000FF">{</font><br/>
    myEqual <font color="#8000FF">::</font> a <font color="#8000FF">-></font> a <font color="#8000FF">-></font> Bool<font color="#8000FF">,</font><br/>
    myNotEqual <font color="#8000FF">::</font> a <font color="#8000FF">-></font> a <font color="#8000FF">-></font> Bool<font color="#8000FF">}</font><br/>
<br/>
<font color="#008080">-- instance MyEq Bool</font><br/>
myEqBool <font color="#8000FF">=</font> MyEq <font color="#8000FF">{</font><br/>
    myEqual <font color="#8000FF">=</font> <font color="#8000FF">\</font>x y <font color="#8000FF">-></font> x <font color="#8000FF">==</font> y<font color="#8000FF">,</font><br/>
    myNotEqual <font color="#8000FF">=</font> <font color="#8000FF">\</font>x y <font color="#8000FF">-></font> not <font color="#8000FF">(</font>x <font color="#8000FF">==</font> y<font color="#8000FF">)</font><font color="#8000FF">}</font><br/>
<br/>
<font color="#008080">-- foo :: (MyEq a) => a -> a -> Bool</font><br/>
foo <font color="#8000FF">::</font> MyEq a <font color="#8000FF">-></font> a <font color="#8000FF">-></font> a <font color="#8000FF">-></font> Bool<br/>
foo dict x y <font color="#8000FF">=</font> <font color="#8000FF">(</font>myEqual dict<font color="#8000FF">)</font> x y<br/>
<font color="#008080">-- foo True False</font><br/>
fooResult <font color="#8000FF">=</font> foo myEqBool True False</code></blockquote>То же самое на C++:<br/>
<blockquote><code><font color="#339900">#include &lt;iostream></font>&lt;br/><br/>
 &lt;br/><br/>
<font color="#666666">// class MyEq a</font>&lt;br/><br/>
<font color="#0000ff">class</font> MyEq&lt;br/><br/>
<font color="#008000">{</font>&lt;br/><br/>
<font color="#0000ff">public</font><font color="#008080">:</font>&lt;br/><br/>
    <font color="#0000ff">virtual</font> ~MyEq<font color="#008000">(</font><font color="#008000">)</font> <font color="#0000ff">throw</font><font color="#008000">(</font><font color="#008000">)</font> <font color="#008000">{</font><font color="#008000">}</font>&lt;br/><br/>
    <font color="#666666">// принимаем void const *, так как сам тип в базовом классе неизвестен</font>&lt;br/><br/>
    <font color="#0000ff">virtual</font> <font color="#0000ff">bool</font> unsafeMyEqual<font color="#008000">(</font><font color="#0000ff">void</font> <font color="#0000ff">const</font> <font color="#000040">*</font> x, <font color="#0000ff">void</font> <font color="#0000ff">const</font> <font color="#000040">*</font> y<font color="#008000">)</font> <font color="#0000ff">const</font> <font color="#000080">=</font> <font>0</font>;&lt;br/><br/>
    <font color="#0000ff">virtual</font> <font color="#0000ff">bool</font> unsafeMyNotEqual<font color="#008000">(</font><font color="#0000ff">void</font> <font color="#0000ff">const</font> <font color="#000040">*</font> x, <font color="#0000ff">void</font> <font color="#0000ff">const</font> <font color="#000040">*</font> y<font color="#008000">)</font> <font color="#0000ff">const</font> <font color="#000080">=</font> <font>0</font>;&lt;br/><br/>
<font color="#008000">}</font>;&lt;br/><br/>
 &lt;br/><br/>
<font color="#666666">// Шаблонная обёртка, знающая о типе и потому определяющая</font>&lt;br/><br/>
<font color="#666666">// безопасные виртуальные функции</font>&lt;br/><br/>
<font color="#0000ff">template</font> <font color="#000080">&lt;</font><font color="#0000ff">typename</font> T<font color="#000080">></font>&lt;br/><br/>
<font color="#0000ff">class</font> MyEqDictBase <font color="#008080">:</font> <font color="#0000ff">public</font> MyEq&lt;br/><br/>
<font color="#008000">{</font>&lt;br/><br/>
    <font color="#0000ff">virtual</font> <font color="#0000ff">bool</font> unsafeMyEqual<font color="#008000">(</font><font color="#0000ff">void</font> <font color="#0000ff">const</font> <font color="#000040">*</font> x, <font color="#0000ff">void</font> <font color="#0000ff">const</font> <font color="#000040">*</font> y<font color="#008000">)</font> <font color="#0000ff">const</font>&lt;br/><br/>
    <font color="#008000">{</font> <font color="#0000ff">return</font> myEqual<font color="#008000">(</font><font color="#000040">*</font><font color="#0000ff">static_cast</font><font color="#000080">&lt;</font>T <font color="#0000ff">const</font> <font color="#000040">*</font><font color="#000080">></font><font color="#008000">(</font>x<font color="#008000">)</font>, <font color="#000040">*</font><font color="#0000ff">static_cast</font><font color="#000080">&lt;</font>T <font color="#0000ff">const</font> <font color="#000040">*</font><font color="#000080">></font><font color="#008000">(</font>y<font color="#008000">)</font><font color="#008000">)</font>; <font color="#008000">}</font>&lt;br/><br/>
    <font color="#0000ff">virtual</font> <font color="#0000ff">bool</font> unsafeMyNotEqual<font color="#008000">(</font><font color="#0000ff">void</font> <font color="#0000ff">const</font> <font color="#000040">*</font> x, <font color="#0000ff">void</font> <font color="#0000ff">const</font> <font color="#000040">*</font> y<font color="#008000">)</font> <font color="#0000ff">const</font>&lt;br/><br/>
    <font color="#008000">{</font> <font color="#0000ff">return</font> myNotEqual<font color="#008000">(</font><font color="#000040">*</font><font color="#0000ff">static_cast</font><font color="#000080">&lt;</font>T <font color="#0000ff">const</font> <font color="#000040">*</font><font color="#000080">></font><font color="#008000">(</font>x<font color="#008000">)</font>, <font color="#000040">*</font><font color="#0000ff">static_cast</font><font color="#000080">&lt;</font>T <font color="#0000ff">const</font> <font color="#000040">*</font><font color="#000080">></font><font color="#008000">(</font>y<font color="#008000">)</font><font color="#008000">)</font>; <font color="#008000">}</font>&lt;br/><br/>
<font color="#0000ff">public</font><font color="#008080">:</font>&lt;br/><br/>
    <font color="#0000ff">virtual</font> <font color="#0000ff">bool</font> myEqual <font color="#008000">(</font>T <font color="#0000ff">const</font> <font color="#000040">&amp;</font> x, T <font color="#0000ff">const</font> <font color="#000040">&amp;</font> y<font color="#008000">)</font> <font color="#0000ff">const</font> <font color="#008000">{</font> <font color="#0000ff">return</font> <font color="#000040">!</font>myNotEqual<font color="#008000">(</font>x, y<font color="#008000">)</font>; <font color="#008000">}</font>&lt;br/><br/>
    <font color="#0000ff">virtual</font> <font color="#0000ff">bool</font> myNotEqual <font color="#008000">(</font>T <font color="#0000ff">const</font> <font color="#000040">&amp;</font> x, T <font color="#0000ff">const</font> <font color="#000040">&amp;</font> y<font color="#008000">)</font> <font color="#0000ff">const</font> <font color="#008000">{</font> <font color="#0000ff">return</font> <font color="#000040">!</font>myEqual<font color="#008000">(</font>x, y<font color="#008000">)</font>; <font color="#008000">}</font>&lt;br/><br/>
<font color="#008000">}</font>;&lt;br/><br/>
 &lt;br/><br/>
<font color="#666666">// Экземпляры классов. Определяться будут через специализацию.</font>&lt;br/><br/>
<font color="#0000ff">template</font> <font color="#000080">&lt;</font><font color="#0000ff">typename</font> T<font color="#000080">></font>&lt;br/><br/>
<font color="#0000ff">class</font> MyEqDict;&lt;br/><br/>
 &lt;br/><br/>
<font color="#666666">// Создать словарь для определённого экземпляра класса</font>&lt;br/><br/>
<font color="#0000ff">template</font> <font color="#000080">&lt;</font><font color="#0000ff">typename</font> T<font color="#000080">></font>&lt;br/><br/>
MyEqDict<font color="#000080">&lt;</font>T<font color="#000080">></font> makeMyEqDict<font color="#008000">(</font><font color="#008000">)</font> <font color="#008000">{</font> <font color="#0000ff">return</font> MyEqDict<font color="#000080">&lt;</font>T<font color="#000080">></font><font color="#008000">(</font><font color="#008000">)</font>; <font color="#008000">}</font>&lt;br/><br/>
 &lt;br/><br/>
<font color="#666666">// instance MyEq Bool</font>&lt;br/><br/>
<font color="#666666">// Экземпляр класса MyEq для bool</font>&lt;br/><br/>
<font color="#0000ff">template</font> <font color="#000080">&lt;></font>&lt;br/><br/>
<font color="#0000ff">class</font> MyEqDict<font color="#000080">&lt;</font><font color="#0000ff">bool</font><font color="#000080">></font> <font color="#008080">:</font> <font color="#0000ff">public</font> MyEqDictBase<font color="#000080">&lt;</font><font color="#0000ff">bool</font><font color="#000080">></font>&lt;br/><br/>
<font color="#008000">{</font>&lt;br/><br/>
<font color="#0000ff">public</font><font color="#008080">:</font>&lt;br/><br/>
    <font color="#0000ff">virtual</font> <font color="#0000ff">bool</font> myEqual<font color="#008000">(</font><font color="#0000ff">bool</font> <font color="#0000ff">const</font> <font color="#000040">&amp;</font> l, <font color="#0000ff">bool</font> <font color="#0000ff">const</font> <font color="#000040">&amp;</font> r<font color="#008000">)</font> <font color="#0000ff">const</font> <font color="#008000">{</font> <font color="#0000ff">return</font> l <font color="#000080">==</font> r; <font color="#008000">}</font>&lt;br/><br/>
<font color="#008000">}</font>;&lt;br/><br/>
 &lt;br/><br/>
<font color="#666666">// Функиця принимает словарь и два параметра</font>&lt;br/><br/>
<font color="#666666">// То, что эти параметры на самом деле bool, гарантируется компиляторов Haskell'я</font>&lt;br/><br/>
<font color="#0000ff">bool</font> fooDict<font color="#008000">(</font>MyEq <font color="#0000ff">const</font> <font color="#000040">&amp;</font> dict, <font color="#0000ff">void</font> <font color="#0000ff">const</font> <font color="#000040">*</font> x, <font color="#0000ff">void</font> <font color="#0000ff">const</font> <font color="#000040">*</font> y<font color="#008000">)</font>&lt;br/><br/>
<font color="#008000">{</font>&lt;br/><br/>
    <font color="#0000ff">return</font> dict.<font color="#007788">unsafeMyNotEqual</font><font color="#008000">(</font>x, y<font color="#008000">)</font>; <font color="#666666">// myNotEqual</font>&lt;br/><br/>
<font color="#008000">}</font>&lt;br/><br/>
 &lt;br/><br/>
<font color="#666666">// Вспомогательная функция</font>&lt;br/><br/>
<font color="#666666">// foo :: (MyEq a) => a -> a -> Bool</font>&lt;br/><br/>
<font color="#0000ff">template</font> <font color="#000080">&lt;</font><font color="#0000ff">typename</font> T<font color="#000080">></font>&lt;br/><br/>
<font color="#0000ff">bool</font> foo <font color="#008000">(</font>T <font color="#0000ff">const</font> <font color="#000040">&amp;</font> x, T <font color="#0000ff">const</font> <font color="#000040">&amp;</font> y<font color="#008000">)</font>&lt;br/><br/>
<font color="#008000">{</font>&lt;br/><br/>
    <font color="#0000ff">return</font> fooDict<font color="#008000">(</font>makeMyEqDict<font color="#000080">&lt;</font>T<font color="#000080">></font><font color="#008000">(</font><font color="#008000">)</font>, <font color="#000040">&amp;</font>x, <font color="#000040">&amp;</font>y<font color="#008000">)</font>;&lt;br/><br/>
<font color="#008000">}</font>&lt;br/><br/>
 &lt;br/><br/>
<font color="#0000ff">int</font> main<font color="#008000">(</font><font color="#008000">)</font>&lt;br/><br/>
<font color="#008000">{</font>&lt;br/><br/>
    std<font color="#008080">::</font><font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> foo<font color="#008000">(</font><font color="#0000ff">true</font>, <font color="#0000ff">false</font><font color="#008000">)</font> <font color="#000080">&lt;&lt;</font> std<font color="#008080">::</font><font color="#007788">endl</font>; <font color="#666666">// 1</font>&lt;br/><br/>
    std<font color="#008080">::</font><font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> foo<font color="#008000">(</font><font color="#0000ff">false</font>, <font color="#0000ff">false</font><font color="#008000">)</font> <font color="#000080">&lt;&lt;</font> std<font color="#008080">::</font><font color="#007788">endl</font>; <font color="#666666">// 0</font>&lt;br/><br/>
    <font color="#0000ff">return</font> <font>0</font>;&lt;br/><br/>
<font color="#008000">}</font></code></blockquote><br/>
<h4>Некоторые стандартные классы и синтаксический сахар</h4><br/>
<a href="http://haskell.org/ghc/docs/6.10.1/html/libraries/base/Prelude.html#t%3AEnum">Enum</a> — перечисление. Определяет функции для получение следующего/предыдущего значения, а также значения по номеру.<br/>
Используется в синтаксическом сахаре для списков <code><font color="#8000FF">[</font><font color="#80C000">1</font> <font color="#8000FF">..</font> <font color="#80C000">10</font><font color="#8000FF">]</font></code>, фактически, это означает <code>enumFromTo <font color="#80C000">1</font> <font color="#80C000">10</font></code>, <code><font color="#8000FF">[</font><font color="#80C000">1</font><font color="#8000FF">,</font><font color="#80C000">3</font> <font color="#8000FF">..</font> <font color="#80C000">10</font><font color="#8000FF">]</font> <font color="#8000FF">=></font> enumFromThenTo <font color="#80C000">1</font> <font color="#80C000">3</font> <font color="#80C000">10</font></code><br/>
<br/>
<a href="http://haskell.org/ghc/docs/6.10.1/html/libraries/base/Text-Show.html">Show</a> — преобразование в строку, основная функция <code>show <font color="#8000FF">::</font> a <font color="#8000FF">-></font> String</code>.<br/>
Используется, например, интерпретатором для вывода значений.<br/>
<br/>
<a href="http://haskell.org/ghc/docs/6.10.1/html/libraries/base/Text-Read.html">Read</a> — преобразование из строки, основная функция <code>read <font color="#8000FF">::</font> String <font color="#8000FF">-></font> a</code>.<br/>
Не знаю, почему выбрали возвращение значения, а не <code>Maybe a</code> (опциональное значение), чтобы сигнализировать об ошибке «чистым» способом, а не «грязным» исключением.<br/>
<br/>
<a href="http://haskell.org/ghc/docs/6.10.1/html/libraries/base/Prelude.html#t%3AEq">Eq</a> — сравнение, операторы <code><font color="#8000FF">(</font><font color="#8000FF">==</font><font color="#8000FF">)</font></code> и <code><font color="#8000FF">(</font><font color="#8000FF">/=</font><font color="#8000FF">)</font></code> (как бы перечёркнутый знак равенства)<br/>
<br/>
<a href="http://haskell.org/ghc/docs/6.10.1/html/libraries/base/Prelude.html#t%3AOrd">Ord</a> — упорядоченные типы, операторы <code><font color="#8000FF">(</font><font color="#8000FF">&lt;</font><font color="#8000FF">)</font></code> <code><font color="#8000FF">(</font><font color="#8000FF">></font><font color="#8000FF">)</font></code> <code><font color="#8000FF">(</font><font color="#8000FF">&lt;=</font><font color="#8000FF">)</font></code> <code><font color="#8000FF">(</font><font color="#8000FF">>=</font><font color="#8000FF">)</font></code>. Требует принадлежности типа к классу <a href="http://haskell.org/ghc/docs/6.10.1/html/libraries/base/Prelude.html#t%3AEq">Eq</a>.<br/>
<br/>
Более полный список различных классов можно посмотреть <a href="http://haskell.org/ghc/docs/6.10.1/html/libraries/base/Prelude.html">здесь</a>.<br/>
<br/>
<a href="http://haskell.org/ghc/docs/6.10.1/html/libraries/base/Control-Monad.html#t%3AFunctor">Functor</a> — функтор, функция <code>fmap <font color="#8000FF">::</font> <font color="#8000FF">(</font>a <font color="#8000FF">-></font> b<font color="#8000FF">)</font> <font color="#8000FF">-></font> f a <font color="#8000FF">-></font> f b</code>.<br/>
Чтобы было понятно, приведу примеры применения этой функции:<br/>
<blockquote><code>ghci> fmap (+1) [1,2,3]<br/>
[2,3,4]<br/>
ghci> fmap (+1) (Just 6)<br/>
Just 7<br/>
ghci> fmap (+1) Nothing<br/>
Nothing<br/>
ghci> fmap reverse getLine<br/>
hello<br/>
"olleh"</code></blockquote>Т.е. для списка это просто <code>map</code>, для опционального значения <code>Maybe a</code> функция <code><font color="#8000FF">(</font><font color="#8000FF">+</font><font color="#80C000">1</font><font color="#8000FF">)</font></code> применяется, если само значение есть, а для ввода-вывода функция применяется к результату этого ввода-вывода.<br/>
Подробнее про ввод-вывод я напишу далее, сейчас можно просто запомнить, что <code>getLine</code> не возвращает строку, так что применить к нему <code>reverse</code> напрямую не получится.<br/>
<br/>
Чтобы каждый раз не определять экземпляры для вновь написанных типов данных, Haskell умеет делать это автоматически для некоторых классов.<br/>
<blockquote><code><b><font color="#0080FF">data</font></b> Test a <font color="#8000FF">=</font> NoValue <font color="#8000FF">|</font> Test a a <b><font color="#0080FF">deriving</font></b> <font color="#8000FF">(</font>Show<font color="#8000FF">,</font> Read<font color="#8000FF">,</font> Eq<font color="#8000FF">,</font> Ord<font color="#8000FF">)</font><br/>
<b><font color="#0080FF">data</font></b> Color <font color="#8000FF">=</font> Red <font color="#8000FF">|</font> Green <font color="#8000FF">|</font> Yellow <font color="#8000FF">|</font> Blue <font color="#8000FF">|</font> Black <font color="#8000FF">|</font> Write <b><font color="#0080FF">deriving</font></b> <font color="#8000FF">(</font>Show<font color="#8000FF">,</font> Read<font color="#8000FF">,</font> Enum<font color="#8000FF">,</font> Eq<font color="#8000FF">,</font> Ord<font color="#8000FF">)</font></code></blockquote><blockquote><code>ghci> NoValue <font color="#8000FF">==</font> <font color="#8000FF">(</font>Test <font color="#80C000">4</font> <font color="#80C000">5</font><font color="#8000FF">)</font><br/>
False<br/>
ghci> read <font color="#80C000">"Test 5 6"</font> <font color="#8000FF">::</font> Test Int<br/>
Test <font color="#80C000">5</font> <font color="#80C000">6</font><br/>
ghci> <font color="#8000FF">(</font>Test <font color="#80C000">1</font> <font color="#80C000">100</font><font color="#8000FF">)</font> <font color="#8000FF">&lt;</font> <font color="#8000FF">(</font>Test <font color="#80C000">2</font> <font color="#80C000">0</font><font color="#8000FF">)</font><br/>
True<br/>
ghci> <font color="#8000FF">(</font>Test <font color="#80C000">2</font> <font color="#80C000">100</font><font color="#8000FF">)</font> <font color="#8000FF">&lt;</font> <font color="#8000FF">(</font>Test <font color="#80C000">2</font> <font color="#80C000">0</font><font color="#8000FF">)</font><br/>
False<br/>
ghci> <font color="#8000FF">[</font>Red <font color="#8000FF">..</font> Black<font color="#8000FF">]</font><br/>
<font color="#8000FF">[</font>Red<font color="#8000FF">,</font>Green<font color="#8000FF">,</font>Yellow<font color="#8000FF">,</font>Blue<font color="#8000FF">,</font>Black<font color="#8000FF">]</font></code></blockquote><br/>
<h4>Великие и ужасные монады</h4><br/>
Класс <a href="http://haskell.org/ghc/docs/6.10.1/html/libraries/base/Control-Monad.html">Monad</a> представляет собой «вычисление», т.е. он позволяет описывать способ комбинирования вычислений и результатов.<br/>
Вряд ли я напишу статью лучше, чем есть уже написанные, так что я просто дам ссылки на лучшие (по моему мнению) статьи для понимания, для чего эти монады нужны.<br/>
1. <a href="http://spbhug.folding-maps.org/wiki/Monads?action=AttachFile&amp;do=get&amp;target=monad.html">Монады</a> — статья с <a href="http://spbhug.folding-maps.org/wiki/">SPbHUG</a> о монадах на русском языке и с аналогиями на привычных императивных языках.<br/>
2. <a href="http://haskell.org/haskellwiki/IO_inside">IO inside</a> — статья на английском о вводе-выводе с использованием монад<br/>
3. <a href="http://en.wikibooks.org/wiki/Haskell/YAHT">Yet Another Haskell Tutorial</a> — книга по Хаскелю, в разделе <a href="http://en.wikibooks.org/wiki/Haskell/YAHT/Monads">Monads</a> очень хорошо написано на примере создания класса Computation, который суть и есть монада.<br/>
<br/>
Здесь я напишу очень вкратце, чтобы можно было потом подглядеть.<br/>
Допутим, мы хотим описать последовательные вычисления, где каждое следующее зависит от результатов предыдущего (некоторым не заданным наперёд способом). Для этого можно определить соответствующий класс, в котором должны быть как минимум две функции:<br/>
<blockquote><code><b><font color="#0080FF">class</font></b> Computation c <b><font color="#0080FF">where</font></b><br/>
    return <font color="#8000FF">::</font> a <font color="#8000FF">-></font> c a<br/>
    bind <font color="#8000FF">::</font> c a <font color="#8000FF">-></font> <font color="#8000FF">(</font>a <font color="#8000FF">-></font> c b<font color="#8000FF">)</font> <font color="#8000FF">-></font> c b</code></blockquote>Первая функция по сути принимает некоторое значение и возвращает вычисление, которые при выполнении просто вернёт это же самое значение.<br/>
Вторая функция принимает 2 аргумента:<br/>
1. вычисление, которое при выполнении вернёт значение типа <code>a</code><br/>
2. функцию, которое примет значение типа <code>a</code> и вернёт новое вычисление, возвращающее значение типа <code>b</code><br/>
Результатом будет вычисление, которое вернёт значение типа <code>b</code>.<br/>
<br/>
Зачем всё это может быть нужно, я покажу на примере опционального значения<br/>
<blockquote><code><b><font color="#0080FF">data</font></b> Maybe a <font color="#8000FF">=</font> Just a <font color="#8000FF">|</font> Nothing</code></blockquote>Допустим, у нас есть несколько функций, каждая из которых может завершиться неудачей и вернуть <code>Nothing</code>. Тогда, используя их напрямую, мы рискуем получить такой слабочитаемый код:<br/>
<nobr><blockquote><code>funOnMaybes x <font color="#8000FF">=</font><br/>
    <b><font color="#0080FF">case</font></b> functionMayFail1 x <b><font color="#0080FF">of</font></b><br/>
        Nothing <font color="#8000FF">-></font> Nothing <font color="#008080">-- первая функция ничего нам не вернула, и мы тоже ничего не вернём</font><br/>
        Just x1 <font color="#8000FF">-></font> <font color="#008080">-- отлично, первая функция вернула некоторое значение, продолжим с ним работу</font><br/>
            <b><font color="#0080FF">case</font></b> functionMayFail2 x1 <b><font color="#0080FF">of</font></b><br/>
                Nothing <font color="#8000FF">-></font> Nothing <font color="#008080">-- теперь вторая функция ничего не вернула (точнее вернула "ничего")</font><br/>
                Just x2 <font color="#8000FF">-></font> <font color="#008080">-- и так далее</font></code></blockquote></nobr>Т.е. вместо простого последовательного вызова этих функций приходится каждый раз проверять значение.<br/>
Но ведь у нас язык позволяет передавать функции в качестве аргументов и возвращать так же, воспользуемся:<br/>
<blockquote><code>combineMaybe <font color="#8000FF">::</font> Maybe a <font color="#8000FF">-></font> <font color="#8000FF">(</font>a <font color="#8000FF">-></font> Maybe b<font color="#8000FF">)</font> <font color="#8000FF">-></font> Maybe b<br/>
combineMaybe Nothing <b><font color="#0080FF">_</font></b> <font color="#8000FF">=</font> Nothing<br/>
combineMaybe <font color="#8000FF">(</font>Just x<font color="#8000FF">)</font> f <font color="#8000FF">=</font> f x</code></blockquote>Функция <code>combineMaybe</code> принимает опциональное значение и функцию, а возвращает результат применения этой функции к опциональному значению, либо неудачу.<br/>
Перепишем функцию <code>funOnMaybes</code>:<br/>
<nobr><blockquote><code>funOnMaybes x <font color="#8000FF">=</font> combineMaybe <font color="#8000FF">(</font>combineMaybe x functionMayFail1<font color="#8000FF">)</font> functionMayFail2 <font color="#8000FF">--...</font></code></blockquote></nobr>Или, используя то, что функцию можно вызвать инфиксно:<br/>
<nobr><blockquote><code>funOnMaybes x <font color="#8000FF">=</font> x <font color="#8000FF">`combineMaybe`</font> functionMayFail1 <font color="#8000FF">`combineMaybe`</font> functionMayFail2 <font color="#8000FF">--...</font></code></blockquote></nobr><br/>
Можно заметит, что тип функции <code>combineMaybe</code> в точности повторяет тип <code>bind</code>, только вместо <code>c</code> стоит <code>Maybe</code>.<br/>
<blockquote><code><b><font color="#0080FF">instance</font></b> Computation Maybe <b><font color="#0080FF">where</font></b><br/>
    return x <font color="#8000FF">=</font> Just x<br/>
    bind Nothing f <font color="#8000FF">=</font> Nothing<br/>
    bind <font color="#8000FF">(</font>Just x<font color="#8000FF">)</font> f <font color="#8000FF">=</font> f x</code></blockquote>Именно так и определена монада <code>Maybe</code>, только <code>bind</code> там называется <code><font color="#8000FF">(</font><font color="#8000FF">>>=</font><font color="#8000FF">)</font></code>, плюс есть дополнительный оператор <code><font color="#8000FF">(</font><font color="#8000FF">>></font><font color="#8000FF">)</font></code>, который не использует результат предыдущего вычисления.<br/>
Кроме того, для монад определён синтаксический сахар, который значительно упрощает их использование:<br/>
<blockquote><code>funOnMaybes x <font color="#8000FF">=</font> <b><font color="#0080FF">do</font></b><br/>
    x1 <font color="#8000FF">&lt;-</font> functionMayFail1 x<br/>
    x2 <font color="#8000FF">&lt;-</font> functionMayFail2 x1<br/>
    <b><font color="#0080FF">if</font></b> x2 <font color="#8000FF">==</font> <font color="#80C000">(0)</font><br/>
        <b><font color="#0080FF">then</font></b> return <font color="#80C000">(0)</font><br/>
        <b><font color="#0080FF">else</font></b> <b><font color="#0080FF">do</font></b><br/>
            x3 <font color="#8000FF">&lt;-</font> functionMayFail3 x2<br/>
            return <font color="#8000FF">(</font>x1 <font color="#8000FF">+</font> x3<font color="#8000FF">)</font></code></blockquote>Обратите внимание на дополнительный <code><b><font color="#0080FF">do</font></b></code> внутри <code><b><font color="#0080FF">else</font></b></code> и на его отсутствие в <code><b><font color="#0080FF">then</font></b></code>. <code><b><font color="#0080FF">do</font></b></code> — это всего лишь синтаксический сахар, который комбинирует несколько вычислений в одно, а так как в ветке <code><b><font color="#0080FF">then</font></b></code> вычисление и так одно <code><font color="#8000FF">(</font>return <font color="#80C000">(0)</font><font color="#8000FF">)</font></code>, то <code><b><font color="#0080FF">do</font></b></code> там не нужен; в ветке <code><b><font color="#0080FF">else</font></b></code> вычисления два подряд, и чтобы их скомбинировать, надо снова использовать <code><b><font color="#0080FF">do</font></b></code>.<br/>
Специальный синтаксис с обратной стрелкой <code>(&lt;-)</code> преобразуется очень просто:<br/>
1. do {e} -> e<br/>
do с одним вычислением есть само это вычисление, комбинировать ничего не нужно<br/>
2. do {e; es} -> e >> do {es}<br/>
несколько подряд идущих вычислений соединяются оператором <code><font color="#8000FF">(</font><font color="#8000FF">>></font><font color="#8000FF">)</font></code><br/>
3. do {let decls; es} -> let decls in do {es}<br/>
внутри do можно заводить дополнительные декларации наподобие <code><b><font color="#0080FF">let</font></b> <font color="#8000FF">...</font> <b><font color="#0080FF">in</font></b></code><br/>
4. do {p &lt; — e; es} -> let ok p = do {es}; ok _ = fail "..." in e >>= ok<br/>
если результат первого вычисления используется в дальнейшем, то для комбинации используется оператор <code><font color="#8000FF">(</font><font color="#8000FF">>>=</font><font color="#8000FF">)</font></code><br/>
В последнем случае такая конструкция используется потому, что в качестве <code>p</code> может выступать образец, который может и не совпасть.<br/>
Если он совпадёт, то будет выполнено дальшейшее вычисление, в противном случае будет возвращена ошибка со строковым описанием.<br/>
Функция <code>fail</code> — ещё одна дополнительная функция в монаде, которая вообще говоря к концепции монад отношения не имеет.<br/>
<br/>
Какие ещё экземпляры монад есть в стандартной библиотеке?<br/>
<br/>
<a href="http://haskell.org/ghc/docs/6.10.1/html/libraries/mtl/Control-Monad-State-Lazy.html">State</a> — вычисления с состоянием. При помощи функций <code>get/put</code>, которые знают о внутреннем устройстве <code>State</code>, можно получать и устанавливать состояние.<br/>
<nobr><blockquote><code><b><font color="#0080FF">import</font></b> Control<font color="#8000FF">.</font>Monad<font color="#8000FF">.</font>State<br/>
<br/>
fact' <font color="#8000FF">::</font> Int <font color="#8000FF">-></font> State Int Int <font color="#008080">-- тип состояния - Int, тип результата - тоже Int</font><br/>
fact' <font color="#80C000">0</font> <font color="#8000FF">=</font> <b><font color="#0080FF">do</font></b><br/>
    acc <font color="#8000FF">&lt;-</font> get <font color="#008080">-- получаем накопленный результат</font><br/>
    return acc <font color="#008080">-- возвращаем его</font><br/>
fact' n <font color="#8000FF">=</font> <b><font color="#0080FF">do</font></b><br/>
    acc <font color="#8000FF">&lt;-</font> get <font color="#008080">-- получаем аккумулятор</font><br/>
    put <font color="#8000FF">(</font>acc <font color="#8000FF">*</font> n<font color="#8000FF">)</font> <font color="#008080">-- домножаем его на n и сохраняем</font><br/>
    fact' <font color="#8000FF">(</font>n <font color="#008080">-</font> <font color="#80C000">1</font><font color="#8000FF">)</font> <font color="#008080">-- продолжаем вычисление факториала</font><br/>
<br/>
fact <font color="#8000FF">::</font> Int <font color="#8000FF">-></font> Int<br/>
fact n <font color="#8000FF">=</font> fst <font color="#8000FF">$</font> runState <font color="#8000FF">(</font>fact' n<font color="#8000FF">)</font> <font color="#80C000">1</font> <font color="#008080">-- начальное значение состояния - 1</font></code></blockquote></nobr><code>runState</code> вычисляет функцию с состоянием, возвращает кортеж с результатом и изменённым состоянием. Нам нужен только результат, поэтому <code>fst</code>.<br/>
<br/>
Список — тоже монада. Последующие вычисления применяются ко всем результатам предыдущего.<br/>
<blockquote><code>dummyFun contents <font color="#8000FF">=</font> <b><font color="#0080FF">do</font></b><br/>
    l <font color="#8000FF">&lt;-</font> lines contents <font color="#008080">-- получаем все строки</font><br/>
    <b><font color="#0080FF">if</font></b> length l <font color="#8000FF">&lt;</font> <font color="#80C000">3</font> <b><font color="#0080FF">then</font></b> fail <font color="#80C000">""</font> <font color="#008080">-- строки менее 3 символов игнорируем</font><br/>
    <b><font color="#0080FF">else</font></b> <b><font color="#0080FF">do</font></b><br/>
        w <font color="#8000FF">&lt;-</font> words l <font color="#008080">-- разбиваем строку на слова</font><br/>
        return w <font color="#008080">-- возвращаем слово</font></code></blockquote><blockquote><code>ghci> dummyFun "line1\nword1 word2 word3\n \n \nline5"<br/>
["line1","word1","word2","word3","line5"]</code></blockquote><br/>
<br/>
Continuations (продолжения) в Хаскеле — тоже монада — <a href="http://haskell.org/ghc/docs/6.10.1/html/libraries/mtl/Control-Monad-Cont.html">Cont</a><br/>
Про продолжения можно почитать на <a href="http://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%BE%D0%B4%D0%BE%D0%BB%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5">русской вики</a> и <a href="http://en.wikipedia.org/wiki/Continuation">английской вики</a> и далее по ссылкам.<br/>
Они заслуживают отдельного внимания, но всё я не умещу, да и к монадам они непосредственного отношения не имеют.<br/>
<a href="http://palm-mute.livejournal.com/12291.html">Хорошая статья про продолжения в Scheme</a> есть у пользователя <a href="http://palm-mute.livejournal.com">palm_mute</a> в живом журнале.<br/>
<br/>
Ввод-вывод тоже реализован с использованием монады. Например, тип функции <code>getLine</code>:<br/>
<blockquote><code>getLine <font color="#8000FF">::</font> IO String</code></blockquote>IO-действие, которое вернёт нам строку. <code>IO</code> можно понимать так:<br/>
<blockquote><code>getLine <font color="#8000FF">::</font> World <font color="#8000FF">-></font> <font color="#8000FF">(</font>String<font color="#8000FF">,</font> World<font color="#8000FF">)</font></code></blockquote>где <code>World</code> — состояние мира<br/>
т.е. любая функция ввода-вывода как бы принимает состояние мира, а возвращает некоторый результат и новое состояние мира, которое затем используется последующими функциями.<br/>
Разумеется, это всего лишь мысленное представление.<br/>
Так как в отличие от списков и Maybe у нас нет конструкторов типа <code>IO</code>, то мы никогда не сможем результат типа <code>IO String</code> разобрать на составляющие, а обязаны будем только использовать его в других вычислениях, таким образом гарантируется, что использование ввода-вывода будет отражено в типе функции.<br/>
<br/>
<font color="#888888">(«Никогда» — это громко сказано, на самом деле есть <code>unsafePerformIO :: IO a -> a</code>, но на то и unsafe, чтобы использоваться только с пониманием дела и когда это крайне необходимо. Я лично ни разу не использовал).</font><br/>
<br/>
Стоит упомянуть <a href="http://haskell.org/ghc/docs/6.10.1/html/libraries/mtl/Control-Monad-Trans.html">Monad transformers</a> (трансформаторы монад).<br/>
Если нам нужно состояние, мы можем использовать <code>State</code>, если ввод-вывод — <code>IO</code>. А что если наша функция хочет иметь состояния и при этом осуществлять ввод-вывод?<br/>
Для этого предназначен трансформер <a href="http://haskell.org/ghc/docs/6.10.1/html/libraries/mtl/Control-Monad-State-Lazy.html">StateT</a>, который соединяет <code>State</code> и другую монаду. Для выполнения вычислений в этой другой монаде используется функция <code>lift</code>.<br/>
Посмотрим на примере факториала, который мы изменим так, чтобы он печатал аккумулятор<br/>
<nobr><blockquote><code><b><font color="#0080FF">import</font></b> Control<font color="#8000FF">.</font>Monad<font color="#8000FF">.</font>State<br/>
<br/>
fact' <font color="#8000FF">::</font> Int <font color="#8000FF">-></font> StateT Int IO Int <font color="#008080">-- добавили IO</font><br/>
fact' <font color="#80C000">0</font> <font color="#8000FF">=</font> <b><font color="#0080FF">do</font></b><br/>
    acc <font color="#8000FF">&lt;-</font> get<br/>
    return acc<br/>
fact' n <font color="#8000FF">=</font> <b><font color="#0080FF">do</font></b><br/>
    acc <font color="#8000FF">&lt;-</font> get<br/>
    lift <font color="#8000FF">$</font> print acc <font color="#008080">-- print acc - вычисление типа IO (), поэтому его мы передаём функции lift</font><br/>
    put <font color="#8000FF">(</font>acc <font color="#8000FF">*</font> n<font color="#8000FF">)</font><br/>
    fact' <font color="#8000FF">(</font>n <font color="#008080">-</font> <font color="#80C000">1</font><font color="#8000FF">)</font><br/>
<br/>
fact <font color="#8000FF">::</font> Int <font color="#8000FF">-></font> IO Int <font color="#008080">-- Пришлось поставить IO и здесь, никуда не деться :)</font><br/>
fact n <font color="#8000FF">=</font> <b><font color="#0080FF">do</font></b><br/>
    <font color="#8000FF">(</font>r<font color="#8000FF">,</font> <b><font color="#0080FF">_</font></b><font color="#8000FF">)</font> <font color="#8000FF">&lt;-</font> runStateT <font color="#8000FF">(</font>fact' n<font color="#8000FF">)</font> <font color="#80C000">1</font><br/>
    return r</code></blockquote></nobr><blockquote><code>ghci> fact 5<br/>
1<br/>
5<br/>
20<br/>
60<br/>
120<br/>
120</code></blockquote><br/>
Кроме <a href="http://haskell.org/ghc/docs/6.10.1/html/libraries/mtl/Control-Monad-State-Lazy.html">StateT</a> есть также <a href="http://haskell.org/ghc/docs/6.10.1/html/libraries/mtl/Control-Monad-List.html">ListT</a> (для списка).<br/>
<br/>
Полный список <a href="http://haskell.org/ghc/docs/6.10.1/html/libraries/base/Control-Monad.html#t%3AMonad">монад</a> и <a href="http://haskell.org/ghc/docs/6.10.1/html/libraries/mtl/Control-Monad-Trans.html#t%3AMonadTrans">трансформеров монад</a>.<br/>
<br/>
Для удобства над монадами определены обобщённые функции. Их названия говорят за себя, большинство из них дублируют списочные функции, так что я просто перечислю некоторые из их и дам <a href="http://haskell.org/ghc/docs/6.10.1/html/libraries/base/Control-Monad.html">эту ссылку</a><br/>
<blockquote><code>sequence <font color="#8000FF">::</font> Monad m <font color="#8000FF">=></font> <font color="#8000FF">[</font>m a<font color="#8000FF">]</font> <font color="#8000FF">-></font> m <font color="#8000FF">[</font>a<font color="#8000FF">]</font><br/>
<font color="#008080">-- выполнить последовательно все вычисления и вернуть список результатов</font><br/>
mapM f <font color="#8000FF">=</font> sequence<font color="#8000FF">.</font>map f<br/>
forM <font color="#8000FF">=</font> flip mapM<br/>
<font color="#008080">-- forM [1..10] $ \i -> print i</font><br/>
forever <font color="#8000FF">::</font> Monad m <font color="#8000FF">=></font> m a <font color="#8000FF">-></font> m b <font color="#008080">-- думаю, пояснять не надо</font><br/>
filterM <font color="#8000FF">::</font> Monad m <font color="#8000FF">=></font> <font color="#8000FF">(</font>a <font color="#8000FF">-></font> m Bool<font color="#8000FF">)</font> <font color="#8000FF">-></font> <font color="#8000FF">[</font>a<font color="#8000FF">]</font> <font color="#8000FF">-></font> m <font color="#8000FF">[</font>a<font color="#8000FF">]</font> <font color="#008080">-- filter</font><br/>
foldM <font color="#8000FF">::</font> Monad m <font color="#8000FF">=></font> <font color="#8000FF">(</font>a <font color="#8000FF">-></font> b <font color="#8000FF">-></font> m a<font color="#8000FF">)</font> <font color="#8000FF">-></font> a <font color="#8000FF">-></font> <font color="#8000FF">[</font>b<font color="#8000FF">]</font> <font color="#8000FF">-></font> m a <font color="#008080">-- foldl</font><br/>
when <font color="#8000FF">::</font> Monad m <font color="#8000FF">=></font> Bool <font color="#8000FF">-></font> m () <font color="#8000FF">-></font> m () <font color="#008080">-- if без ветки else</font></code></blockquote><br/>
<h4>List comprehensions</h4><br/>
<font color="#888888">(Перевести этот термин я не берусь)</font><br/>
List comprehensions позволяет конструировать списки в соответствии с математической нотацией:<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/39d/477/584/39d477584b00e663434eb8885b830aa4.png"/><br/>
<blockquote><code>ghci> take <font color="#80C000">5</font> <font color="#8000FF">$</font> <font color="#8000FF">[</font><font color="#80C000">2</font><font color="#8000FF">*</font>x <font color="#8000FF">|</font> x <font color="#8000FF">&lt;-</font> <font color="#8000FF">[</font><font color="#80C000">1</font><font color="#8000FF">..</font><font color="#8000FF">]</font><font color="#8000FF">,</font> x<font color="#8000FF">^</font><font color="#80C000">2</font> <font color="#8000FF">></font> <font color="#80C000">3</font><font color="#8000FF">]</font><br/>
<font color="#8000FF">[</font><font color="#80C000">4</font><font color="#8000FF">,</font> <font color="#80C000">6</font><font color="#8000FF">,</font> <font color="#80C000">8</font><font color="#8000FF">,</font> <font color="#80C000">10</font><font color="#8000FF">,</font> <font color="#80C000">12</font><font color="#8000FF">]</font><br/>
ghci> <font color="#8000FF">[</font><font color="#8000FF">(</font>x<font color="#8000FF">,</font> y<font color="#8000FF">)</font> <font color="#8000FF">|</font> x <font color="#8000FF">&lt;-</font> <font color="#8000FF">[</font><font color="#80C000">1</font><font color="#8000FF">..</font><font color="#80C000">3</font><font color="#8000FF">]</font><font color="#8000FF">,</font> y <font color="#8000FF">&lt;-</font> <font color="#8000FF">[</font><font color="#80C000">1</font><font color="#8000FF">..</font><font color="#80C000">3</font><font color="#8000FF">]</font><font color="#8000FF">]</font><br/>
<font color="#8000FF">[</font><font color="#8000FF">(</font><font color="#80C000">1</font><font color="#8000FF">,</font><font color="#80C000">1</font><font color="#8000FF">)</font><font color="#8000FF">,</font><font color="#8000FF">(</font><font color="#80C000">1</font><font color="#8000FF">,</font><font color="#80C000">2</font><font color="#8000FF">)</font><font color="#8000FF">,</font><font color="#8000FF">(</font><font color="#80C000">1</font><font color="#8000FF">,</font><font color="#80C000">3</font><font color="#8000FF">)</font><font color="#8000FF">,</font><font color="#8000FF">(</font><font color="#80C000">2</font><font color="#8000FF">,</font><font color="#80C000">1</font><font color="#8000FF">)</font><font color="#8000FF">,</font><font color="#8000FF">(</font><font color="#80C000">2</font><font color="#8000FF">,</font><font color="#80C000">2</font><font color="#8000FF">)</font><font color="#8000FF">,</font><font color="#8000FF">(</font><font color="#80C000">2</font><font color="#8000FF">,</font><font color="#80C000">3</font><font color="#8000FF">)</font><font color="#8000FF">,</font><font color="#8000FF">(</font><font color="#80C000">3</font><font color="#8000FF">,</font><font color="#80C000">1</font><font color="#8000FF">)</font><font color="#8000FF">,</font><font color="#8000FF">(</font><font color="#80C000">3</font><font color="#8000FF">,</font><font color="#80C000">2</font><font color="#8000FF">)</font><font color="#8000FF">,</font><font color="#8000FF">(</font><font color="#80C000">3</font><font color="#8000FF">,</font><font color="#80C000">3</font><font color="#8000FF">)</font><font color="#8000FF">]</font></code></blockquote>Видно, что последний список перебирается чаще<br/>
y может зависеть от x:<br/>
<blockquote><code>ghci> <font color="#8000FF">[</font>x <font color="#8000FF">+</font> y <font color="#8000FF">|</font> x <font color="#8000FF">&lt;-</font> <font color="#8000FF">[</font><font color="#80C000">1</font><font color="#8000FF">..</font><font color="#80C000">4</font><font color="#8000FF">]</font><font color="#8000FF">,</font> y <font color="#8000FF">&lt;-</font> <font color="#8000FF">[</font><font color="#80C000">1</font><font color="#8000FF">..</font>x<font color="#8000FF">]</font><font color="#8000FF">,</font> even x<font color="#8000FF">]</font><br/>
<font color="#8000FF">[</font><font color="#80C000">3</font><font color="#8000FF">,</font><font color="#80C000">4</font><font color="#8000FF">,</font><font color="#80C000">5</font><font color="#8000FF">,</font><font color="#80C000">6</font><font color="#8000FF">,</font><font color="#80C000">7</font><font color="#8000FF">,</font><font color="#80C000">8</font><font color="#8000FF">]</font></code></blockquote><br/>
List comprehensions тоже синтаксический сахар и разворачивается в (последний пример):<br/>
<blockquote><code><b><font color="#0080FF">do</font></b><br/>
    x <font color="#8000FF">&lt;-</font> <font color="#8000FF">[</font><font color="#80C000">1</font><font color="#8000FF">..</font><font color="#80C000">4</font><font color="#8000FF">]</font><br/>
    y <font color="#8000FF">&lt;-</font> <font color="#8000FF">[</font><font color="#80C000">1</font><font color="#8000FF">..</font>x<font color="#8000FF">]</font><br/>
    True <font color="#8000FF">&lt;-</font> return <font color="#8000FF">(</font>even x<font color="#8000FF">)</font><br/>
    return <font color="#8000FF">(</font>x <font color="#8000FF">+</font> y<font color="#8000FF">)</font></code></blockquote>Конечно, он разворачивается напрямую, но так видна связь между монадическими вычислениями над списками и list comprehensions.<br/>
<br/>
В следующий раз я попробую ответить на все вопросы, а потом можно будет приниматься за реализацию чата (или сразу, если вопросов будет мало/не будет), так что спрашивайте, если что непонятно по всем статьям.</div></div> <!----> <!----></div> <div class="tm-article-body__tags"><div class="tm-article-body__tags-links"><span class="tm-article-body__tags-title">Теги:</span> <span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bhaskell%5D" class="tm-article-body__tags-item-link">haskell</a></span></div> <div class="tm-article-body__tags-links"><span class="tm-article-body__tags-title">Хабы:</span> <span class="tm-article-body__tags-item"><a href="/ru/hub/haskell/" class="tm-article-body__tags-item-link">
                  Haskell
                </a></span></div></div></article> <div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 30: ↑29 и ↓1</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 30: ↑29 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+28</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <!----> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    44
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/51046/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      24
    </span></a> <!----></div> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div></div> <!----></div> <!----> <div class="tm-page-article__additional-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body"><div class="tm-article-author tm-page-article__author"><!----> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-two-column"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/VoidEx/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/d5f/d69/bc4/d5fd69bc4f16d3a7a11b42c68549d070.jpg" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 200 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    59.5
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info"><div class="tm-user-card__title"><!----> <a href="/ru/users/VoidEx/" class="tm-user-card__nickname">
          @VoidEx
        </a> <!----></div> <p class="tm-user-card__short-info">Пользователь</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-two-column"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div></div> <!----></section> <div class="tm-page-article__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/51046/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 24 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <section class="tm-block tm-block_spacing-around"><header class="tm-block__header"><h2 class="tm-block__title">Похожие публикации</h2> <!----></header> <div class="tm-block__body"><ul class="tm-article-list-block__list"><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2011-11-21T09:07:54.000Z" title="2011-11-21, 13:07">21  ноября  2011 в 13:07</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/133009/" class="tm-article-title__link"><span>Введение в Template Haskell. Часть 3. Прочие аспекты TH</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 15: ↑13 и ↓2</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 15: ↑13 и ↓2" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+11</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">2.1K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    27
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/133009/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      1
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2011-11-11T04:19:27.000Z" title="2011-11-11, 08:19">11  ноября  2011 в 08:19</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/131998/" class="tm-article-title__link"><span>Введение в Template Haskell. Часть 1. Необходимый минимум</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 19: ↑19 и ↓0</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 19: ↑19 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+19</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">7.5K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    47
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/131998/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      7
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2009-11-03T09:16:01.000Z" title="2009-11-03, 12:16">3  ноября  2009 в 12:16</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/74164/" class="tm-article-title__link"><span>Изучай Haskell ради… Haskell'а</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 40: ↑29 и ↓11</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 40: ↑29 и ↓11" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+18</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">16K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    15
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/74164/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      50
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li> <!----></ul></div> <!----></section> <!----> <!----> <section class="tm-block tm-block_spacing-around"><header class="tm-block__header"><h2 class="tm-block__title">Лучшие публикации за сутки</h2> <!----></header> <div class="tm-block__body"><ul class="tm-article-list-block__list"><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-27T09:00:04.000Z" title="2021-09-27, 12:00">сегодня в 12:00</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/ruvds/blog/580060/" class="tm-article-title__link"><span>Арракис, который мы заслужили</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 67: ↑64 и ↓3</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 67: ↑64 и ↓3" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+61</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">6.3K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    21
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/ruvds/blog/580060/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      10
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-26T21:49:14.000Z" title="2021-09-27, 00:49">сегодня в 00:49</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/580092/" class="tm-article-title__link"><span>30 сентября: Let's Encrypt и конец срока действия IdenTrust DST Root CA X3</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 41: ↑41 и ↓0</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 41: ↑41 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+41</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">14K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    44
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/580092/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      78
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-26T19:37:10.000Z" title="2021-09-26, 22:37">вчера в 22:37</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/580086/" class="tm-article-title__link"><span>Термо принтер и JavaScript</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 40: ↑39 и ↓1</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 40: ↑39 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+38</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">7.9K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    33
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/580086/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      46
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-26T19:00:02.000Z" title="2021-09-26, 22:00">вчера в 22:00</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/funcorp/blog/579542/" class="tm-article-title__link"><span>Jetpack Compose — как легко построить UI на Android</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 39: ↑35 и ↓4</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 39: ↑35 и ↓4" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+31</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">3.3K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    49
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/funcorp/blog/579542/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      8
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-26T22:35:26.000Z" title="2021-09-27, 01:35">сегодня в 01:35</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/580094/" class="tm-article-title__link"><span>Блокчейн нас подвёл? Почему ДЭГ — это плохо и можем ли мы адекватно контролировать процесс подсчёта голосов?</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 45: ↑35 и ↓10</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 45: ↑35 и ↓10" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+25</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">11K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    19
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/580094/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      77
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li> <!----></ul></div> <!----></section> <!----> <!----></div></div></div> <div class="tm-page__sidebar"><div hl="ru" id="51046" class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/51046/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/51046/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"51046":{"id":"51046","timePublished":"2009-02-04T09:11:09+00:00","isCorporative":false,"lang":"ru","titleHtml":"Классы типов, монады","leadData":{"textHtml":"Темой сегодняшней статьи будут классы типов, некоторые стандартные из них, синтаксический сахар с их использованием и класс монад.\u003Cbr\u002F\u003E\r\nКлассы привносят динамический полиморфизм, как и интерфейсы в традиционных императивных языках, а также могут быть использованы как замены отсутствующей в Хаскеле перегрузки функций.\u003Cbr\u002F\u003E\r\nЯ расскажу, как определить класс типов, его экземпляры (instance) и как это всё устроено внутри.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПредыдущие статьи:\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fblogs\u002FHaskell\u002F50600\u002F\"\u003EТипы данных, паттернг матчинг и функции\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fblogs\u002FHaskell\u002F50310\u002F\"\u003EОсновы\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"editorVersion":"1.0","postType":"article","postLabels":[],"author":{"scoreStats":{"score":59.5,"votesCount":200},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"33916","alias":"VoidEx","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd5f\u002Fd69\u002Fbc4\u002Fd5fd69bc4f16d3a7a11b42c68549d070.jpg","speciality":"Пользователь"},"statistics":{"commentsCount":24,"favoritesCount":44,"readingCount":10830,"score":28,"votesCount":30},"hubs":[{"relatedData":null,"id":"8424","alias":"haskell","type":"collective","title":"Haskell","titleHtml":"Haskell","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EТемой сегодняшней статьи будут классы типов, некоторые стандартные из них, синтаксический сахар с их использованием и класс монад.\u003Cbr\u002F\u003E\r\nКлассы привносят динамический полиморфизм, как и интерфейсы в традиционных императивных языках, а также могут быть использованы как замены отсутствующей в Хаскеле перегрузки функций.\u003Cbr\u002F\u003E\r\nЯ расскажу, как определить класс типов, его экземпляры (instance) и как это всё устроено внутри.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПредыдущие статьи:\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fblogs\u002FHaskell\u002F50600\u002F\"\u003EТипы данных, паттернг матчинг и функции\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fblogs\u002FHaskell\u002F50310\u002F\"\u003EОсновы\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EКлассы типов\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nПредположим, вы написали свой тип данных и хотите написать для него оператор сравнения. Проблема в том, что перегрузки функций в Хаскеле нет и потому использовать для этих целей (==) простым способом не получится. Более того, придумывать для каждого типа новое имя — не вариант.\u003Cbr\u002F\u003E\r\nНо вы можете определить класс типов «сравниваемый». Тогда, если ваш тип данных принадлежит к этому классу, значения этого типа можно будет сравнивать.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Eclass\u003C\u002Ffont\u003E\u003C\u002Fb\u003E MyEq a \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Ewhere\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n    myEqual \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E a \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E a \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E Bool\u003Cbr\u002F\u003E\r\n    myNotEqual \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E a \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E a \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E Bool\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Ccode\u003EMyEq\u003C\u002Fcode\u003E — это имя класса типов (как и типы данных, оно должно начинаться с заглавной буквы), \u003Ccode\u003Ea\u003C\u002Fcode\u003E — некий принадлежащий к данному классу тип. Параметров у класса может быть несколько (\u003Ccode\u003EFooClass a b c\u003C\u002Fcode\u003E), но в данном случае только один.\u003Cbr\u002F\u003E\r\nТип \u003Ccode\u003Ea\u003C\u002Fcode\u003E принадлежит к классу \u003Ccode\u003EMyEq\u003C\u002Fcode\u003E, если для него определены соотстветствующие функции.\u003Cbr\u002F\u003E\r\nВ классе можно дать определение функции по умолчанию. Например, функции \u003Ccode\u003EmyEqual\u003C\u002Fcode\u003E и \u003Ccode\u003EmyNotEqual\u003C\u002Fcode\u003E могут быть выражены друг через друга:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E    myEqual x y \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E not \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003EmyNotEqual x y\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    myNotEqual x y \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E not \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003EmyEqual x y\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EТакие определения приведут к бесконечной рекурсии, но в экземпляре класса достаточно определить хотя бы одну из них.\u003Cbr\u002F\u003E\r\nТеперь напишем экземпляр класса для \u003Ccode\u003EBool\u003C\u002Fcode\u003E:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Einstance\u003C\u002Ffont\u003E\u003C\u002Fb\u003E MyEq Bool \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Ewhere\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n    myEqual True True \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E True\u003Cbr\u002F\u003E\r\n    myEqual False False \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E True\u003Cbr\u002F\u003E\r\n    myEqual \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003E_\u003C\u002Ffont\u003E\u003C\u002Fb\u003E \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003E_\u003C\u002Ffont\u003E\u003C\u002Fb\u003E \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E False\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EОпределение экземпляра начинается с ключевого слова \u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Einstance\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003C\u002Fcode\u003E, затем вместо переменной типа \u003Ccode\u003Ea\u003C\u002Fcode\u003E в определении самого класса мы пишем тот тип, для которого определяется экзмепляр, т.е. \u003Ccode\u003EBool\u003C\u002Fcode\u003E.\u003Cbr\u002F\u003E\r\nОпределяем одну функцию \u003Ccode\u003EmyEqual\u003C\u002Fcode\u003E и теперь можно проверить в интерпретаторе результат:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003Eghci\u003E myEqual True True\u003Cbr\u002F\u003E\r\nTrue\u003Cbr\u002F\u003E\r\nghci\u003E myNotEqual True False\u003Cbr\u002F\u003E\r\nTrue\u003Cbr\u002F\u003E\r\nghci\u003E :t myEqual\u003Cbr\u002F\u003E\r\nmyEqual :: (MyEq a) =\u003E a -\u003E a -\u003E Bool\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EВидим, что тип функции \u003Ccode\u003EmyEqual\u003C\u002Fcode\u003E накладывает ограничение (constraints) на тип — он должен принадлежать к классу \u003Ccode\u003EMyEq\u003C\u002Fcode\u003E.\u003Cbr\u002F\u003E\r\nТакие же ограничения можно накладывать и при объявлении самого класса:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Eclass\u003C\u002Ffont\u003E\u003C\u002Fb\u003E \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003EMyEq a\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E=\u003E\u003C\u002Ffont\u003E SomeClass a \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Ewhere\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#008080\"\u003E-- ...\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nКлассы чем-то похожи на интерфейсы — мы объявляем фукнции, для которых потом предоставляем реализации. Другие функции могут использовать эти функции только если для некоторого типа есть такая реализация.\u003Cbr\u002F\u003E\r\nОднако есть существенные отличия как в возможностях, так и в реализации самого механизма.\u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003EКак видно по функции \u003Ccode\u003EmyEqual\u003C\u002Fcode\u003E, она принимает два значения типа \u003Ccode\u003Ea\u003C\u002Fcode\u003E, тогда как виртуальная функция принимает только один скрытый параметр \u003Ccode\u003Ethis\u003C\u002Fcode\u003E.\u003Cbr\u002F\u003E\r\nДаже если у нас есть \u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Einstance\u003C\u002Ffont\u003E\u003C\u002Fb\u003E MyEq Bool\u003C\u002Fcode\u003E и \u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Einstance\u003C\u002Ffont\u003E\u003C\u002Fb\u003E MyEq Int\u003C\u002Fcode\u003E, вызов функции \u003Ccode\u003EmyEqual True \u003Cfont color=\"#80C000\"\u003E5\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E приведёт к неудаче:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003Eghci\u003E myEqual True (5::Int)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n&lt;interactive\u003E:1:14:\u003Cbr\u002F\u003E\r\n    Couldn't match expected type `Bool' against inferred type `Int'\u003Cbr\u002F\u003E\r\n    In the second argument of `myEqual', namely `(5::Int)'\u003Cbr\u002F\u003E\r\n    In the expression: myEqual True (5 :: Int)\u003Cbr\u002F\u003E\r\n    In the definition of `it': it = myEqual True (5 :: Int)\u003Cbr\u002F\u003E\r\nghci\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EКомпилятор (интерпретатор) знает, что параметры \u003Ccode\u003EmyEqual\u003C\u002Fcode\u003E должны иметь один тип и потому предотвращает такие попытки.\u003C\u002Fli\u003E\r\n\u003Cli\u003EЭкземпляр класса может быть определён в любой момент, что также очень удобно. Наследование от интерфейсов же указывается при определении самого класса.\u003C\u002Fli\u003E\r\n\u003Cli\u003EФункция может потребовать принадлежность типа данных сразу к нескольким классам:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003Efoo \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003EEq a\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E Show a\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E Read a\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E=\u003E\u003C\u002Ffont\u003E a \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E String \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E String\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EКак это сделать, например, в С++\u002FC#? Создавать композитный \u003Ccode\u003EIEquableShowableReadable\u003C\u002Fcode\u003E? Но от него не отнаследуешься. Передавать аргумент три раза с приведением к разным интерфейсам и полагать внутри функции, что это один и тот же объект, а ответственность лежит на вызывающей стороне?\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\r\nРаз уж упомянул C++, то заодно скажу, что в новом стандарте C++0x \u003Ca href=\"http:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FC++0x#Concepts\"\u003Econcept и concept_map\u003C\u002Fa\u003E есть суть классы типов, но используемые на этапе компиляции :)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНо есть и недостаток. Как нам завести список объектов, которые, к примеру, принадлежат к классу \u003Ccode\u003EShow\u003C\u002Fcode\u003E (функция \u003Ccode\u003Eshow \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E a \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E String\u003C\u002Fcode\u003E)?\u003Cbr\u002F\u003E\r\nСпособ есть, но он нестандартен. В начало файла необходимо добавить соответствующие опции GHC:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cfont color=\"#008080\"\u003E{-#\u003Cbr\u002F\u003E\r\n  OPTIONS_GHC\u003Cbr\u002F\u003E\r\n  -XExistentialQuantification\u003Cbr\u002F\u003E\r\n#-}\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#008080\"\u003E-- Не знаю, почему, но при выравнивании TAB'ом GHC опции игнорировал\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EТеперь мы можем объявить такой тип данных:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Edata\u003C\u002Ffont\u003E\u003C\u002Fb\u003E ShowObj \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Eforall\u003C\u002Ffont\u003E\u003C\u002Fb\u003E a\u003Cfont color=\"#8000FF\"\u003E.\u003C\u002Ffont\u003E Show a \u003Cfont color=\"#8000FF\"\u003E=\u003E\u003C\u002Ffont\u003E ShowObj a\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E(Прочитать подробнее про \u003Ca href=\"http:\u002F\u002Fhaskell.org\u002Fhaskellwiki\u002FExistential_type\"\u003Eexistential types\u003C\u002Fa\u003E)\u003Cbr\u002F\u003E\r\nИ заодно определить для него экземляр класса \u003Ccode\u003EShow\u003C\u002Fcode\u003E, чтобы он сам также к нему принадлежал:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Einstance\u003C\u002Ffont\u003E\u003C\u002Fb\u003E Show ShowObj \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Ewhere\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n    show \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003EShowObj x\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E show x\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EПроверим:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003Eghci\u003E [ShowObj 4, ShowObj True, ShowObj (ShowObj 'x')]\u003Cbr\u002F\u003E\r\n[4,True,'x']\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EХотя функцию \u003Ccode\u003Eshow\u003C\u002Fcode\u003E я явно не вызывал, интерпретатор использует именно её, так что можно быть уверенным, что всё работает.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EКак это всё реализуется?\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nВ функцию, которая накладывает ограничения на тип, передаётся скрытый параметр (на каждый класс и тип — свой) — словарь со всеми необходимыми функциями.\u003Cbr\u002F\u003E\r\nФактически, \u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Einstance\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003C\u002Fcode\u003E — это определение экземпляра словаря для конкретного типа.\u003Cbr\u002F\u003E\r\nЧтобы было проще это понять, я просто приведу псевдо-реализацию для класса \u003Ccode\u003EEq\u003C\u002Fcode\u003E на Haskell'е и на C++:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cfont color=\"#008080\"\u003E-- class MyEq\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Edata\u003C\u002Ffont\u003E\u003C\u002Fb\u003E MyEq a \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E MyEq \u003Cfont color=\"#8000FF\"\u003E{\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    myEqual \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E a \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E a \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E Bool\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    myNotEqual \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E a \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E a \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E Bool\u003Cfont color=\"#8000FF\"\u003E}\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#008080\"\u003E-- instance MyEq Bool\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\nmyEqBool \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E MyEq \u003Cfont color=\"#8000FF\"\u003E{\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    myEqual \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E\\\u003C\u002Ffont\u003Ex y \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E x \u003Cfont color=\"#8000FF\"\u003E==\u003C\u002Ffont\u003E y\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    myNotEqual \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E\\\u003C\u002Ffont\u003Ex y \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E not \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003Ex \u003Cfont color=\"#8000FF\"\u003E==\u003C\u002Ffont\u003E y\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E}\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#008080\"\u003E-- foo :: (MyEq a) =\u003E a -\u003E a -\u003E Bool\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\nfoo \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E MyEq a \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E a \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E a \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E Bool\u003Cbr\u002F\u003E\r\nfoo dict x y \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003EmyEqual dict\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E x y\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#008080\"\u003E-- foo True False\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\nfooResult \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E foo myEqBool True False\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EТо же самое на C++:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cfont color=\"#339900\"\u003E#include &lt;iostream\u003E\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n &lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#666666\"\u003E\u002F\u002F class MyEq a\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Eclass\u003C\u002Ffont\u003E MyEq&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#008000\"\u003E{\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E\u003Cfont color=\"#008080\"\u003E:\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Evirtual\u003C\u002Ffont\u003E ~MyEq\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Ethrow\u003C\u002Ffont\u003E\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#008000\"\u003E{\u003C\u002Ffont\u003E\u003Cfont color=\"#008000\"\u003E}\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#666666\"\u003E\u002F\u002F принимаем void const *, так как сам тип в базовом классе неизвестен\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Evirtual\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Ebool\u003C\u002Ffont\u003E unsafeMyEqual\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E*\u003C\u002Ffont\u003E x, \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E*\u003C\u002Ffont\u003E y\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000080\"\u003E=\u003C\u002Ffont\u003E \u003Cfont\u003E0\u003C\u002Ffont\u003E;&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Evirtual\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Ebool\u003C\u002Ffont\u003E unsafeMyNotEqual\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E*\u003C\u002Ffont\u003E x, \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E*\u003C\u002Ffont\u003E y\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000080\"\u003E=\u003C\u002Ffont\u003E \u003Cfont\u003E0\u003C\u002Ffont\u003E;&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#008000\"\u003E}\u003C\u002Ffont\u003E;&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n &lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#666666\"\u003E\u002F\u002F Шаблонная обёртка, знающая о типе и потому определяющая\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#666666\"\u003E\u002F\u002F безопасные виртуальные функции\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Etemplate\u003C\u002Ffont\u003E \u003Cfont color=\"#000080\"\u003E&lt;\u003C\u002Ffont\u003E\u003Cfont color=\"#0000ff\"\u003Etypename\u003C\u002Ffont\u003E T\u003Cfont color=\"#000080\"\u003E\u003E\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Eclass\u003C\u002Ffont\u003E MyEqDictBase \u003Cfont color=\"#008080\"\u003E:\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E MyEq&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#008000\"\u003E{\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Evirtual\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Ebool\u003C\u002Ffont\u003E unsafeMyEqual\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E*\u003C\u002Ffont\u003E x, \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E*\u003C\u002Ffont\u003E y\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#008000\"\u003E{\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E myEqual\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#000040\"\u003E*\u003C\u002Ffont\u003E\u003Cfont color=\"#0000ff\"\u003Estatic_cast\u003C\u002Ffont\u003E\u003Cfont color=\"#000080\"\u003E&lt;\u003C\u002Ffont\u003ET \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E*\u003C\u002Ffont\u003E\u003Cfont color=\"#000080\"\u003E\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003Ex\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E, \u003Cfont color=\"#000040\"\u003E*\u003C\u002Ffont\u003E\u003Cfont color=\"#0000ff\"\u003Estatic_cast\u003C\u002Ffont\u003E\u003Cfont color=\"#000080\"\u003E&lt;\u003C\u002Ffont\u003ET \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E*\u003C\u002Ffont\u003E\u003Cfont color=\"#000080\"\u003E\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003Ey\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E; \u003Cfont color=\"#008000\"\u003E}\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Evirtual\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Ebool\u003C\u002Ffont\u003E unsafeMyNotEqual\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E*\u003C\u002Ffont\u003E x, \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E*\u003C\u002Ffont\u003E y\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#008000\"\u003E{\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E myNotEqual\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#000040\"\u003E*\u003C\u002Ffont\u003E\u003Cfont color=\"#0000ff\"\u003Estatic_cast\u003C\u002Ffont\u003E\u003Cfont color=\"#000080\"\u003E&lt;\u003C\u002Ffont\u003ET \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E*\u003C\u002Ffont\u003E\u003Cfont color=\"#000080\"\u003E\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003Ex\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E, \u003Cfont color=\"#000040\"\u003E*\u003C\u002Ffont\u003E\u003Cfont color=\"#0000ff\"\u003Estatic_cast\u003C\u002Ffont\u003E\u003Cfont color=\"#000080\"\u003E&lt;\u003C\u002Ffont\u003ET \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E*\u003C\u002Ffont\u003E\u003Cfont color=\"#000080\"\u003E\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003Ey\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E; \u003Cfont color=\"#008000\"\u003E}\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E\u003Cfont color=\"#008080\"\u003E:\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Evirtual\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Ebool\u003C\u002Ffont\u003E myEqual \u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003ET \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E&amp;\u003C\u002Ffont\u003E x, T \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E&amp;\u003C\u002Ffont\u003E y\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#008000\"\u003E{\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E!\u003C\u002Ffont\u003EmyNotEqual\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003Ex, y\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E; \u003Cfont color=\"#008000\"\u003E}\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Evirtual\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Ebool\u003C\u002Ffont\u003E myNotEqual \u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003ET \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E&amp;\u003C\u002Ffont\u003E x, T \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E&amp;\u003C\u002Ffont\u003E y\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#008000\"\u003E{\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E!\u003C\u002Ffont\u003EmyEqual\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003Ex, y\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E; \u003Cfont color=\"#008000\"\u003E}\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#008000\"\u003E}\u003C\u002Ffont\u003E;&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n &lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#666666\"\u003E\u002F\u002F Экземпляры классов. Определяться будут через специализацию.\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Etemplate\u003C\u002Ffont\u003E \u003Cfont color=\"#000080\"\u003E&lt;\u003C\u002Ffont\u003E\u003Cfont color=\"#0000ff\"\u003Etypename\u003C\u002Ffont\u003E T\u003Cfont color=\"#000080\"\u003E\u003E\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Eclass\u003C\u002Ffont\u003E MyEqDict;&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n &lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#666666\"\u003E\u002F\u002F Создать словарь для определённого экземпляра класса\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Etemplate\u003C\u002Ffont\u003E \u003Cfont color=\"#000080\"\u003E&lt;\u003C\u002Ffont\u003E\u003Cfont color=\"#0000ff\"\u003Etypename\u003C\u002Ffont\u003E T\u003Cfont color=\"#000080\"\u003E\u003E\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\nMyEqDict\u003Cfont color=\"#000080\"\u003E&lt;\u003C\u002Ffont\u003ET\u003Cfont color=\"#000080\"\u003E\u003E\u003C\u002Ffont\u003E makeMyEqDict\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#008000\"\u003E{\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E MyEqDict\u003Cfont color=\"#000080\"\u003E&lt;\u003C\u002Ffont\u003ET\u003Cfont color=\"#000080\"\u003E\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E; \u003Cfont color=\"#008000\"\u003E}\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n &lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#666666\"\u003E\u002F\u002F instance MyEq Bool\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#666666\"\u003E\u002F\u002F Экземпляр класса MyEq для bool\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Etemplate\u003C\u002Ffont\u003E \u003Cfont color=\"#000080\"\u003E&lt;\u003E\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Eclass\u003C\u002Ffont\u003E MyEqDict\u003Cfont color=\"#000080\"\u003E&lt;\u003C\u002Ffont\u003E\u003Cfont color=\"#0000ff\"\u003Ebool\u003C\u002Ffont\u003E\u003Cfont color=\"#000080\"\u003E\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#008080\"\u003E:\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E MyEqDictBase\u003Cfont color=\"#000080\"\u003E&lt;\u003C\u002Ffont\u003E\u003Cfont color=\"#0000ff\"\u003Ebool\u003C\u002Ffont\u003E\u003Cfont color=\"#000080\"\u003E\u003E\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#008000\"\u003E{\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E\u003Cfont color=\"#008080\"\u003E:\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Evirtual\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Ebool\u003C\u002Ffont\u003E myEqual\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#0000ff\"\u003Ebool\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E&amp;\u003C\u002Ffont\u003E l, \u003Cfont color=\"#0000ff\"\u003Ebool\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E&amp;\u003C\u002Ffont\u003E r\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#008000\"\u003E{\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E l \u003Cfont color=\"#000080\"\u003E==\u003C\u002Ffont\u003E r; \u003Cfont color=\"#008000\"\u003E}\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#008000\"\u003E}\u003C\u002Ffont\u003E;&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n &lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#666666\"\u003E\u002F\u002F Функиця принимает словарь и два параметра\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#666666\"\u003E\u002F\u002F То, что эти параметры на самом деле bool, гарантируется компиляторов Haskell'я\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Ebool\u003C\u002Ffont\u003E fooDict\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003EMyEq \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E&amp;\u003C\u002Ffont\u003E dict, \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E*\u003C\u002Ffont\u003E x, \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E*\u003C\u002Ffont\u003E y\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#008000\"\u003E{\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E dict.\u003Cfont color=\"#007788\"\u003EunsafeMyNotEqual\u003C\u002Ffont\u003E\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003Ex, y\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E; \u003Cfont color=\"#666666\"\u003E\u002F\u002F myNotEqual\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#008000\"\u003E}\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n &lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#666666\"\u003E\u002F\u002F Вспомогательная функция\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#666666\"\u003E\u002F\u002F foo :: (MyEq a) =\u003E a -\u003E a -\u003E Bool\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Etemplate\u003C\u002Ffont\u003E \u003Cfont color=\"#000080\"\u003E&lt;\u003C\u002Ffont\u003E\u003Cfont color=\"#0000ff\"\u003Etypename\u003C\u002Ffont\u003E T\u003Cfont color=\"#000080\"\u003E\u003E\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Ebool\u003C\u002Ffont\u003E foo \u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003ET \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E&amp;\u003C\u002Ffont\u003E x, T \u003Cfont color=\"#0000ff\"\u003Econst\u003C\u002Ffont\u003E \u003Cfont color=\"#000040\"\u003E&amp;\u003C\u002Ffont\u003E y\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#008000\"\u003E{\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E fooDict\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003EmakeMyEqDict\u003Cfont color=\"#000080\"\u003E&lt;\u003C\u002Ffont\u003ET\u003Cfont color=\"#000080\"\u003E\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E, \u003Cfont color=\"#000040\"\u003E&amp;\u003C\u002Ffont\u003Ex, \u003Cfont color=\"#000040\"\u003E&amp;\u003C\u002Ffont\u003Ey\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E;&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#008000\"\u003E}\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n &lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Eint\u003C\u002Ffont\u003E main\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#008000\"\u003E{\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n    std\u003Cfont color=\"#008080\"\u003E::\u003C\u002Ffont\u003E\u003Cfont color=\"#0000dd\"\u003Ecout\u003C\u002Ffont\u003E \u003Cfont color=\"#000080\"\u003E&lt;&lt;\u003C\u002Ffont\u003E foo\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#0000ff\"\u003Etrue\u003C\u002Ffont\u003E, \u003Cfont color=\"#0000ff\"\u003Efalse\u003C\u002Ffont\u003E\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#000080\"\u003E&lt;&lt;\u003C\u002Ffont\u003E std\u003Cfont color=\"#008080\"\u003E::\u003C\u002Ffont\u003E\u003Cfont color=\"#007788\"\u003Eendl\u003C\u002Ffont\u003E; \u003Cfont color=\"#666666\"\u003E\u002F\u002F 1\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n    std\u003Cfont color=\"#008080\"\u003E::\u003C\u002Ffont\u003E\u003Cfont color=\"#0000dd\"\u003Ecout\u003C\u002Ffont\u003E \u003Cfont color=\"#000080\"\u003E&lt;&lt;\u003C\u002Ffont\u003E foo\u003Cfont color=\"#008000\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#0000ff\"\u003Efalse\u003C\u002Ffont\u003E, \u003Cfont color=\"#0000ff\"\u003Efalse\u003C\u002Ffont\u003E\u003Cfont color=\"#008000\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#000080\"\u003E&lt;&lt;\u003C\u002Ffont\u003E std\u003Cfont color=\"#008080\"\u003E::\u003C\u002Ffont\u003E\u003Cfont color=\"#007788\"\u003Eendl\u003C\u002Ffont\u003E; \u003Cfont color=\"#666666\"\u003E\u002F\u002F 0\u003C\u002Ffont\u003E&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E \u003Cfont\u003E0\u003C\u002Ffont\u003E;&lt;br\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#008000\"\u003E}\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EНекоторые стандартные классы и синтаксический сахар\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fhaskell.org\u002Fghc\u002Fdocs\u002F6.10.1\u002Fhtml\u002Flibraries\u002Fbase\u002FPrelude.html#t%3AEnum\"\u003EEnum\u003C\u002Fa\u003E — перечисление. Определяет функции для получение следующего\u002Fпредыдущего значения, а также значения по номеру.\u003Cbr\u002F\u003E\r\nИспользуется в синтаксическом сахаре для списков \u003Ccode\u003E\u003Cfont color=\"#8000FF\"\u003E[\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E..\u003C\u002Ffont\u003E \u003Cfont color=\"#80C000\"\u003E10\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E]\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E, фактически, это означает \u003Ccode\u003EenumFromTo \u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E \u003Cfont color=\"#80C000\"\u003E10\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E, \u003Ccode\u003E\u003Cfont color=\"#8000FF\"\u003E[\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E3\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E..\u003C\u002Ffont\u003E \u003Cfont color=\"#80C000\"\u003E10\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E]\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E=\u003E\u003C\u002Ffont\u003E enumFromThenTo \u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E \u003Cfont color=\"#80C000\"\u003E3\u003C\u002Ffont\u003E \u003Cfont color=\"#80C000\"\u003E10\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fhaskell.org\u002Fghc\u002Fdocs\u002F6.10.1\u002Fhtml\u002Flibraries\u002Fbase\u002FText-Show.html\"\u003EShow\u003C\u002Fa\u003E — преобразование в строку, основная функция \u003Ccode\u003Eshow \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E a \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E String\u003C\u002Fcode\u003E.\u003Cbr\u002F\u003E\r\nИспользуется, например, интерпретатором для вывода значений.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fhaskell.org\u002Fghc\u002Fdocs\u002F6.10.1\u002Fhtml\u002Flibraries\u002Fbase\u002FText-Read.html\"\u003ERead\u003C\u002Fa\u003E — преобразование из строки, основная функция \u003Ccode\u003Eread \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E String \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E a\u003C\u002Fcode\u003E.\u003Cbr\u002F\u003E\r\nНе знаю, почему выбрали возвращение значения, а не \u003Ccode\u003EMaybe a\u003C\u002Fcode\u003E (опциональное значение), чтобы сигнализировать об ошибке «чистым» способом, а не «грязным» исключением.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fhaskell.org\u002Fghc\u002Fdocs\u002F6.10.1\u002Fhtml\u002Flibraries\u002Fbase\u002FPrelude.html#t%3AEq\"\u003EEq\u003C\u002Fa\u003E — сравнение, операторы \u003Ccode\u003E\u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E==\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E и \u003Ccode\u003E\u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E\u002F=\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E (как бы перечёркнутый знак равенства)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fhaskell.org\u002Fghc\u002Fdocs\u002F6.10.1\u002Fhtml\u002Flibraries\u002Fbase\u002FPrelude.html#t%3AOrd\"\u003EOrd\u003C\u002Fa\u003E — упорядоченные типы, операторы \u003Ccode\u003E\u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E&lt;\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E \u003Ccode\u003E\u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E \u003Ccode\u003E\u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E&lt;=\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E \u003Ccode\u003E\u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E\u003E=\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E. Требует принадлежности типа к классу \u003Ca href=\"http:\u002F\u002Fhaskell.org\u002Fghc\u002Fdocs\u002F6.10.1\u002Fhtml\u002Flibraries\u002Fbase\u002FPrelude.html#t%3AEq\"\u003EEq\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nБолее полный список различных классов можно посмотреть \u003Ca href=\"http:\u002F\u002Fhaskell.org\u002Fghc\u002Fdocs\u002F6.10.1\u002Fhtml\u002Flibraries\u002Fbase\u002FPrelude.html\"\u003Eздесь\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fhaskell.org\u002Fghc\u002Fdocs\u002F6.10.1\u002Fhtml\u002Flibraries\u002Fbase\u002FControl-Monad.html#t%3AFunctor\"\u003EFunctor\u003C\u002Fa\u003E — функтор, функция \u003Ccode\u003Efmap \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003Ea \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E b\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E f a \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E f b\u003C\u002Fcode\u003E.\u003Cbr\u002F\u003E\r\nЧтобы было понятно, приведу примеры применения этой функции:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003Eghci\u003E fmap (+1) [1,2,3]\u003Cbr\u002F\u003E\r\n[2,3,4]\u003Cbr\u002F\u003E\r\nghci\u003E fmap (+1) (Just 6)\u003Cbr\u002F\u003E\r\nJust 7\u003Cbr\u002F\u003E\r\nghci\u003E fmap (+1) Nothing\u003Cbr\u002F\u003E\r\nNothing\u003Cbr\u002F\u003E\r\nghci\u003E fmap reverse getLine\u003Cbr\u002F\u003E\r\nhello\u003Cbr\u002F\u003E\r\n\"olleh\"\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EТ.е. для списка это просто \u003Ccode\u003Emap\u003C\u002Fcode\u003E, для опционального значения \u003Ccode\u003EMaybe a\u003C\u002Fcode\u003E функция \u003Ccode\u003E\u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E+\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E применяется, если само значение есть, а для ввода-вывода функция применяется к результату этого ввода-вывода.\u003Cbr\u002F\u003E\r\nПодробнее про ввод-вывод я напишу далее, сейчас можно просто запомнить, что \u003Ccode\u003EgetLine\u003C\u002Fcode\u003E не возвращает строку, так что применить к нему \u003Ccode\u003Ereverse\u003C\u002Fcode\u003E напрямую не получится.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЧтобы каждый раз не определять экземпляры для вновь написанных типов данных, Haskell умеет делать это автоматически для некоторых классов.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Edata\u003C\u002Ffont\u003E\u003C\u002Fb\u003E Test a \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E NoValue \u003Cfont color=\"#8000FF\"\u003E|\u003C\u002Ffont\u003E Test a a \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Ederiving\u003C\u002Ffont\u003E\u003C\u002Fb\u003E \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003EShow\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E Read\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E Eq\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E Ord\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Edata\u003C\u002Ffont\u003E\u003C\u002Fb\u003E Color \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E Red \u003Cfont color=\"#8000FF\"\u003E|\u003C\u002Ffont\u003E Green \u003Cfont color=\"#8000FF\"\u003E|\u003C\u002Ffont\u003E Yellow \u003Cfont color=\"#8000FF\"\u003E|\u003C\u002Ffont\u003E Blue \u003Cfont color=\"#8000FF\"\u003E|\u003C\u002Ffont\u003E Black \u003Cfont color=\"#8000FF\"\u003E|\u003C\u002Ffont\u003E Write \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Ederiving\u003C\u002Ffont\u003E\u003C\u002Fb\u003E \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003EShow\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E Read\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E Enum\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E Eq\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E Ord\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cblockquote\u003E\u003Ccode\u003Eghci\u003E NoValue \u003Cfont color=\"#8000FF\"\u003E==\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003ETest \u003Cfont color=\"#80C000\"\u003E4\u003C\u002Ffont\u003E \u003Cfont color=\"#80C000\"\u003E5\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\nFalse\u003Cbr\u002F\u003E\r\nghci\u003E read \u003Cfont color=\"#80C000\"\u003E\"Test 5 6\"\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E Test Int\u003Cbr\u002F\u003E\r\nTest \u003Cfont color=\"#80C000\"\u003E5\u003C\u002Ffont\u003E \u003Cfont color=\"#80C000\"\u003E6\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\nghci\u003E \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003ETest \u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E \u003Cfont color=\"#80C000\"\u003E100\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E&lt;\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003ETest \u003Cfont color=\"#80C000\"\u003E2\u003C\u002Ffont\u003E \u003Cfont color=\"#80C000\"\u003E0\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\nTrue\u003Cbr\u002F\u003E\r\nghci\u003E \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003ETest \u003Cfont color=\"#80C000\"\u003E2\u003C\u002Ffont\u003E \u003Cfont color=\"#80C000\"\u003E100\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E&lt;\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003ETest \u003Cfont color=\"#80C000\"\u003E2\u003C\u002Ffont\u003E \u003Cfont color=\"#80C000\"\u003E0\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\nFalse\u003Cbr\u002F\u003E\r\nghci\u003E \u003Cfont color=\"#8000FF\"\u003E[\u003C\u002Ffont\u003ERed \u003Cfont color=\"#8000FF\"\u003E..\u003C\u002Ffont\u003E Black\u003Cfont color=\"#8000FF\"\u003E]\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#8000FF\"\u003E[\u003C\u002Ffont\u003ERed\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003EGreen\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003EYellow\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003EBlue\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003EBlack\u003Cfont color=\"#8000FF\"\u003E]\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EВеликие и ужасные монады\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nКласс \u003Ca href=\"http:\u002F\u002Fhaskell.org\u002Fghc\u002Fdocs\u002F6.10.1\u002Fhtml\u002Flibraries\u002Fbase\u002FControl-Monad.html\"\u003EMonad\u003C\u002Fa\u003E представляет собой «вычисление», т.е. он позволяет описывать способ комбинирования вычислений и результатов.\u003Cbr\u002F\u003E\r\nВряд ли я напишу статью лучше, чем есть уже написанные, так что я просто дам ссылки на лучшие (по моему мнению) статьи для понимания, для чего эти монады нужны.\u003Cbr\u002F\u003E\r\n1. \u003Ca href=\"http:\u002F\u002Fspbhug.folding-maps.org\u002Fwiki\u002FMonads?action=AttachFile&amp;do=get&amp;target=monad.html\"\u003EМонады\u003C\u002Fa\u003E — статья с \u003Ca href=\"http:\u002F\u002Fspbhug.folding-maps.org\u002Fwiki\u002F\"\u003ESPbHUG\u003C\u002Fa\u003E о монадах на русском языке и с аналогиями на привычных императивных языках.\u003Cbr\u002F\u003E\r\n2. \u003Ca href=\"http:\u002F\u002Fhaskell.org\u002Fhaskellwiki\u002FIO_inside\"\u003EIO inside\u003C\u002Fa\u003E — статья на английском о вводе-выводе с использованием монад\u003Cbr\u002F\u003E\r\n3. \u003Ca href=\"http:\u002F\u002Fen.wikibooks.org\u002Fwiki\u002FHaskell\u002FYAHT\"\u003EYet Another Haskell Tutorial\u003C\u002Fa\u003E — книга по Хаскелю, в разделе \u003Ca href=\"http:\u002F\u002Fen.wikibooks.org\u002Fwiki\u002FHaskell\u002FYAHT\u002FMonads\"\u003EMonads\u003C\u002Fa\u003E очень хорошо написано на примере создания класса Computation, который суть и есть монада.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЗдесь я напишу очень вкратце, чтобы можно было потом подглядеть.\u003Cbr\u002F\u003E\r\nДопутим, мы хотим описать последовательные вычисления, где каждое следующее зависит от результатов предыдущего (некоторым не заданным наперёд способом). Для этого можно определить соответствующий класс, в котором должны быть как минимум две функции:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Eclass\u003C\u002Ffont\u003E\u003C\u002Fb\u003E Computation c \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Ewhere\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n    return \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E a \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E c a\u003Cbr\u002F\u003E\r\n    bind \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E c a \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003Ea \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E c b\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E c b\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EПервая функция по сути принимает некоторое значение и возвращает вычисление, которые при выполнении просто вернёт это же самое значение.\u003Cbr\u002F\u003E\r\nВторая функция принимает 2 аргумента:\u003Cbr\u002F\u003E\r\n1. вычисление, которое при выполнении вернёт значение типа \u003Ccode\u003Ea\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n2. функцию, которое примет значение типа \u003Ccode\u003Ea\u003C\u002Fcode\u003E и вернёт новое вычисление, возвращающее значение типа \u003Ccode\u003Eb\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\nРезультатом будет вычисление, которое вернёт значение типа \u003Ccode\u003Eb\u003C\u002Fcode\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЗачем всё это может быть нужно, я покажу на примере опционального значения\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Edata\u003C\u002Ffont\u003E\u003C\u002Fb\u003E Maybe a \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E Just a \u003Cfont color=\"#8000FF\"\u003E|\u003C\u002Ffont\u003E Nothing\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EДопустим, у нас есть несколько функций, каждая из которых может завершиться неудачей и вернуть \u003Ccode\u003ENothing\u003C\u002Fcode\u003E. Тогда, используя их напрямую, мы рискуем получить такой слабочитаемый код:\u003Cbr\u002F\u003E\r\n\u003Cnobr\u003E\u003Cblockquote\u003E\u003Ccode\u003EfunOnMaybes x \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Ecase\u003C\u002Ffont\u003E\u003C\u002Fb\u003E functionMayFail1 x \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Eof\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n        Nothing \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E Nothing \u003Cfont color=\"#008080\"\u003E-- первая функция ничего нам не вернула, и мы тоже ничего не вернём\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n        Just x1 \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#008080\"\u003E-- отлично, первая функция вернула некоторое значение, продолжим с ним работу\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n            \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Ecase\u003C\u002Ffont\u003E\u003C\u002Fb\u003E functionMayFail2 x1 \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Eof\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n                Nothing \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E Nothing \u003Cfont color=\"#008080\"\u003E-- теперь вторая функция ничего не вернула (точнее вернула \"ничего\")\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n                Just x2 \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#008080\"\u003E-- и так далее\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003C\u002Fnobr\u003EТ.е. вместо простого последовательного вызова этих функций приходится каждый раз проверять значение.\u003Cbr\u002F\u003E\r\nНо ведь у нас язык позволяет передавать функции в качестве аргументов и возвращать так же, воспользуемся:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003EcombineMaybe \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E Maybe a \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003Ea \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E Maybe b\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E Maybe b\u003Cbr\u002F\u003E\r\ncombineMaybe Nothing \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003E_\u003C\u002Ffont\u003E\u003C\u002Fb\u003E \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E Nothing\u003Cbr\u002F\u003E\r\ncombineMaybe \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003EJust x\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E f \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E f x\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EФункция \u003Ccode\u003EcombineMaybe\u003C\u002Fcode\u003E принимает опциональное значение и функцию, а возвращает результат применения этой функции к опциональному значению, либо неудачу.\u003Cbr\u002F\u003E\r\nПерепишем функцию \u003Ccode\u003EfunOnMaybes\u003C\u002Fcode\u003E:\u003Cbr\u002F\u003E\r\n\u003Cnobr\u003E\u003Cblockquote\u003E\u003Ccode\u003EfunOnMaybes x \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E combineMaybe \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003EcombineMaybe x functionMayFail1\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E functionMayFail2 \u003Cfont color=\"#8000FF\"\u003E--...\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003C\u002Fnobr\u003EИли, используя то, что функцию можно вызвать инфиксно:\u003Cbr\u002F\u003E\r\n\u003Cnobr\u003E\u003Cblockquote\u003E\u003Ccode\u003EfunOnMaybes x \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E x \u003Cfont color=\"#8000FF\"\u003E`combineMaybe`\u003C\u002Ffont\u003E functionMayFail1 \u003Cfont color=\"#8000FF\"\u003E`combineMaybe`\u003C\u002Ffont\u003E functionMayFail2 \u003Cfont color=\"#8000FF\"\u003E--...\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003C\u002Fnobr\u003E\u003Cbr\u002F\u003E\r\nМожно заметит, что тип функции \u003Ccode\u003EcombineMaybe\u003C\u002Fcode\u003E в точности повторяет тип \u003Ccode\u003Ebind\u003C\u002Fcode\u003E, только вместо \u003Ccode\u003Ec\u003C\u002Fcode\u003E стоит \u003Ccode\u003EMaybe\u003C\u002Fcode\u003E.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Einstance\u003C\u002Ffont\u003E\u003C\u002Fb\u003E Computation Maybe \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Ewhere\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n    return x \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E Just x\u003Cbr\u002F\u003E\r\n    bind Nothing f \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E Nothing\u003Cbr\u002F\u003E\r\n    bind \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003EJust x\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E f \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E f x\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EИменно так и определена монада \u003Ccode\u003EMaybe\u003C\u002Fcode\u003E, только \u003Ccode\u003Ebind\u003C\u002Fcode\u003E там называется \u003Ccode\u003E\u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E\u003E\u003E=\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E, плюс есть дополнительный оператор \u003Ccode\u003E\u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E\u003E\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E, который не использует результат предыдущего вычисления.\u003Cbr\u002F\u003E\r\nКроме того, для монад определён синтаксический сахар, который значительно упрощает их использование:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003EfunOnMaybes x \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Edo\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n    x1 \u003Cfont color=\"#8000FF\"\u003E&lt;-\u003C\u002Ffont\u003E functionMayFail1 x\u003Cbr\u002F\u003E\r\n    x2 \u003Cfont color=\"#8000FF\"\u003E&lt;-\u003C\u002Ffont\u003E functionMayFail2 x1\u003Cbr\u002F\u003E\r\n    \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Eif\u003C\u002Ffont\u003E\u003C\u002Fb\u003E x2 \u003Cfont color=\"#8000FF\"\u003E==\u003C\u002Ffont\u003E \u003Cfont color=\"#80C000\"\u003E(0)\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n        \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Ethen\u003C\u002Ffont\u003E\u003C\u002Fb\u003E return \u003Cfont color=\"#80C000\"\u003E(0)\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n        \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Eelse\u003C\u002Ffont\u003E\u003C\u002Fb\u003E \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Edo\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n            x3 \u003Cfont color=\"#8000FF\"\u003E&lt;-\u003C\u002Ffont\u003E functionMayFail3 x2\u003Cbr\u002F\u003E\r\n            return \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003Ex1 \u003Cfont color=\"#8000FF\"\u003E+\u003C\u002Ffont\u003E x3\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EОбратите внимание на дополнительный \u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Edo\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003C\u002Fcode\u003E внутри \u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Eelse\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003C\u002Fcode\u003E и на его отсутствие в \u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Ethen\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003C\u002Fcode\u003E. \u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Edo\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003C\u002Fcode\u003E — это всего лишь синтаксический сахар, который комбинирует несколько вычислений в одно, а так как в ветке \u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Ethen\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003C\u002Fcode\u003E вычисление и так одно \u003Ccode\u003E\u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003Ereturn \u003Cfont color=\"#80C000\"\u003E(0)\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E, то \u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Edo\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003C\u002Fcode\u003E там не нужен; в ветке \u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Eelse\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003C\u002Fcode\u003E вычисления два подряд, и чтобы их скомбинировать, надо снова использовать \u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Edo\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003C\u002Fcode\u003E.\u003Cbr\u002F\u003E\r\nСпециальный синтаксис с обратной стрелкой \u003Ccode\u003E(&lt;-)\u003C\u002Fcode\u003E преобразуется очень просто:\u003Cbr\u002F\u003E\r\n1. do {e} -\u003E e\u003Cbr\u002F\u003E\r\ndo с одним вычислением есть само это вычисление, комбинировать ничего не нужно\u003Cbr\u002F\u003E\r\n2. do {e; es} -\u003E e \u003E\u003E do {es}\u003Cbr\u002F\u003E\r\nнесколько подряд идущих вычислений соединяются оператором \u003Ccode\u003E\u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E\u003E\u003E\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n3. do {let decls; es} -\u003E let decls in do {es}\u003Cbr\u002F\u003E\r\nвнутри do можно заводить дополнительные декларации наподобие \u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Elet\u003C\u002Ffont\u003E\u003C\u002Fb\u003E \u003Cfont color=\"#8000FF\"\u003E...\u003C\u002Ffont\u003E \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Ein\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n4. do {p &lt; — e; es} -\u003E let ok p = do {es}; ok _ = fail \"...\" in e \u003E\u003E= ok\u003Cbr\u002F\u003E\r\nесли результат первого вычисления используется в дальнейшем, то для комбинации используется оператор \u003Ccode\u003E\u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E\u003E\u003E=\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\nВ последнем случае такая конструкция используется потому, что в качестве \u003Ccode\u003Ep\u003C\u002Fcode\u003E может выступать образец, который может и не совпасть.\u003Cbr\u002F\u003E\r\nЕсли он совпадёт, то будет выполнено дальшейшее вычисление, в противном случае будет возвращена ошибка со строковым описанием.\u003Cbr\u002F\u003E\r\nФункция \u003Ccode\u003Efail\u003C\u002Fcode\u003E — ещё одна дополнительная функция в монаде, которая вообще говоря к концепции монад отношения не имеет.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nКакие ещё экземпляры монад есть в стандартной библиотеке?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fhaskell.org\u002Fghc\u002Fdocs\u002F6.10.1\u002Fhtml\u002Flibraries\u002Fmtl\u002FControl-Monad-State-Lazy.html\"\u003EState\u003C\u002Fa\u003E — вычисления с состоянием. При помощи функций \u003Ccode\u003Eget\u002Fput\u003C\u002Fcode\u003E, которые знают о внутреннем устройстве \u003Ccode\u003EState\u003C\u002Fcode\u003E, можно получать и устанавливать состояние.\u003Cbr\u002F\u003E\r\n\u003Cnobr\u003E\u003Cblockquote\u003E\u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Eimport\u003C\u002Ffont\u003E\u003C\u002Fb\u003E Control\u003Cfont color=\"#8000FF\"\u003E.\u003C\u002Ffont\u003EMonad\u003Cfont color=\"#8000FF\"\u003E.\u003C\u002Ffont\u003EState\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nfact' \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E Int \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E State Int Int \u003Cfont color=\"#008080\"\u003E-- тип состояния - Int, тип результата - тоже Int\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\nfact' \u003Cfont color=\"#80C000\"\u003E0\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Edo\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n    acc \u003Cfont color=\"#8000FF\"\u003E&lt;-\u003C\u002Ffont\u003E get \u003Cfont color=\"#008080\"\u003E-- получаем накопленный результат\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    return acc \u003Cfont color=\"#008080\"\u003E-- возвращаем его\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\nfact' n \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Edo\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n    acc \u003Cfont color=\"#8000FF\"\u003E&lt;-\u003C\u002Ffont\u003E get \u003Cfont color=\"#008080\"\u003E-- получаем аккумулятор\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    put \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003Eacc \u003Cfont color=\"#8000FF\"\u003E*\u003C\u002Ffont\u003E n\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#008080\"\u003E-- домножаем его на n и сохраняем\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    fact' \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003En \u003Cfont color=\"#008080\"\u003E-\u003C\u002Ffont\u003E \u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#008080\"\u003E-- продолжаем вычисление факториала\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nfact \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E Int \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E Int\u003Cbr\u002F\u003E\r\nfact n \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E fst \u003Cfont color=\"#8000FF\"\u003E$\u003C\u002Ffont\u003E runState \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003Efact' n\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E \u003Cfont color=\"#008080\"\u003E-- начальное значение состояния - 1\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003C\u002Fnobr\u003E\u003Ccode\u003ErunState\u003C\u002Fcode\u003E вычисляет функцию с состоянием, возвращает кортеж с результатом и изменённым состоянием. Нам нужен только результат, поэтому \u003Ccode\u003Efst\u003C\u002Fcode\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСписок — тоже монада. Последующие вычисления применяются ко всем результатам предыдущего.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003EdummyFun contents \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Edo\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n    l \u003Cfont color=\"#8000FF\"\u003E&lt;-\u003C\u002Ffont\u003E lines contents \u003Cfont color=\"#008080\"\u003E-- получаем все строки\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Eif\u003C\u002Ffont\u003E\u003C\u002Fb\u003E length l \u003Cfont color=\"#8000FF\"\u003E&lt;\u003C\u002Ffont\u003E \u003Cfont color=\"#80C000\"\u003E3\u003C\u002Ffont\u003E \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Ethen\u003C\u002Ffont\u003E\u003C\u002Fb\u003E fail \u003Cfont color=\"#80C000\"\u003E\"\"\u003C\u002Ffont\u003E \u003Cfont color=\"#008080\"\u003E-- строки менее 3 символов игнорируем\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Eelse\u003C\u002Ffont\u003E\u003C\u002Fb\u003E \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Edo\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n        w \u003Cfont color=\"#8000FF\"\u003E&lt;-\u003C\u002Ffont\u003E words l \u003Cfont color=\"#008080\"\u003E-- разбиваем строку на слова\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n        return w \u003Cfont color=\"#008080\"\u003E-- возвращаем слово\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cblockquote\u003E\u003Ccode\u003Eghci\u003E dummyFun \"line1\\nword1 word2 word3\\n \\n \\nline5\"\u003Cbr\u002F\u003E\r\n[\"line1\",\"word1\",\"word2\",\"word3\",\"line5\"]\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nContinuations (продолжения) в Хаскеле — тоже монада — \u003Ca href=\"http:\u002F\u002Fhaskell.org\u002Fghc\u002Fdocs\u002F6.10.1\u002Fhtml\u002Flibraries\u002Fmtl\u002FControl-Monad-Cont.html\"\u003ECont\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\nПро продолжения можно почитать на \u003Ca href=\"http:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002F%D0%9F%D1%80%D0%BE%D0%B4%D0%BE%D0%BB%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5\"\u003Eрусской вики\u003C\u002Fa\u003E и \u003Ca href=\"http:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FContinuation\"\u003Eанглийской вики\u003C\u002Fa\u003E и далее по ссылкам.\u003Cbr\u002F\u003E\r\nОни заслуживают отдельного внимания, но всё я не умещу, да и к монадам они непосредственного отношения не имеют.\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fpalm-mute.livejournal.com\u002F12291.html\"\u003EХорошая статья про продолжения в Scheme\u003C\u002Fa\u003E есть у пользователя \u003Ca href=\"http:\u002F\u002Fpalm-mute.livejournal.com\"\u003Epalm_mute\u003C\u002Fa\u003E в живом журнале.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВвод-вывод тоже реализован с использованием монады. Например, тип функции \u003Ccode\u003EgetLine\u003C\u002Fcode\u003E:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003EgetLine \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E IO String\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EIO-действие, которое вернёт нам строку. \u003Ccode\u003EIO\u003C\u002Fcode\u003E можно понимать так:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003EgetLine \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E World \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003EString\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E World\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003Eгде \u003Ccode\u003EWorld\u003C\u002Fcode\u003E — состояние мира\u003Cbr\u002F\u003E\r\nт.е. любая функция ввода-вывода как бы принимает состояние мира, а возвращает некоторый результат и новое состояние мира, которое затем используется последующими функциями.\u003Cbr\u002F\u003E\r\nРазумеется, это всего лишь мысленное представление.\u003Cbr\u002F\u003E\r\nТак как в отличие от списков и Maybe у нас нет конструкторов типа \u003Ccode\u003EIO\u003C\u002Fcode\u003E, то мы никогда не сможем результат типа \u003Ccode\u003EIO String\u003C\u002Fcode\u003E разобрать на составляющие, а обязаны будем только использовать его в других вычислениях, таким образом гарантируется, что использование ввода-вывода будет отражено в типе функции.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#888888\"\u003E(«Никогда» — это громко сказано, на самом деле есть \u003Ccode\u003EunsafePerformIO :: IO a -\u003E a\u003C\u002Fcode\u003E, но на то и unsafe, чтобы использоваться только с пониманием дела и когда это крайне необходимо. Я лично ни разу не использовал).\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСтоит упомянуть \u003Ca href=\"http:\u002F\u002Fhaskell.org\u002Fghc\u002Fdocs\u002F6.10.1\u002Fhtml\u002Flibraries\u002Fmtl\u002FControl-Monad-Trans.html\"\u003EMonad transformers\u003C\u002Fa\u003E (трансформаторы монад).\u003Cbr\u002F\u003E\r\nЕсли нам нужно состояние, мы можем использовать \u003Ccode\u003EState\u003C\u002Fcode\u003E, если ввод-вывод — \u003Ccode\u003EIO\u003C\u002Fcode\u003E. А что если наша функция хочет иметь состояния и при этом осуществлять ввод-вывод?\u003Cbr\u002F\u003E\r\nДля этого предназначен трансформер \u003Ca href=\"http:\u002F\u002Fhaskell.org\u002Fghc\u002Fdocs\u002F6.10.1\u002Fhtml\u002Flibraries\u002Fmtl\u002FControl-Monad-State-Lazy.html\"\u003EStateT\u003C\u002Fa\u003E, который соединяет \u003Ccode\u003EState\u003C\u002Fcode\u003E и другую монаду. Для выполнения вычислений в этой другой монаде используется функция \u003Ccode\u003Elift\u003C\u002Fcode\u003E.\u003Cbr\u002F\u003E\r\nПосмотрим на примере факториала, который мы изменим так, чтобы он печатал аккумулятор\u003Cbr\u002F\u003E\r\n\u003Cnobr\u003E\u003Cblockquote\u003E\u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Eimport\u003C\u002Ffont\u003E\u003C\u002Fb\u003E Control\u003Cfont color=\"#8000FF\"\u003E.\u003C\u002Ffont\u003EMonad\u003Cfont color=\"#8000FF\"\u003E.\u003C\u002Ffont\u003EState\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nfact' \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E Int \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E StateT Int IO Int \u003Cfont color=\"#008080\"\u003E-- добавили IO\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\nfact' \u003Cfont color=\"#80C000\"\u003E0\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Edo\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n    acc \u003Cfont color=\"#8000FF\"\u003E&lt;-\u003C\u002Ffont\u003E get\u003Cbr\u002F\u003E\r\n    return acc\u003Cbr\u002F\u003E\r\nfact' n \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Edo\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n    acc \u003Cfont color=\"#8000FF\"\u003E&lt;-\u003C\u002Ffont\u003E get\u003Cbr\u002F\u003E\r\n    lift \u003Cfont color=\"#8000FF\"\u003E$\u003C\u002Ffont\u003E print acc \u003Cfont color=\"#008080\"\u003E-- print acc - вычисление типа IO (), поэтому его мы передаём функции lift\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    put \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003Eacc \u003Cfont color=\"#8000FF\"\u003E*\u003C\u002Ffont\u003E n\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    fact' \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003En \u003Cfont color=\"#008080\"\u003E-\u003C\u002Ffont\u003E \u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nfact \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E Int \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E IO Int \u003Cfont color=\"#008080\"\u003E-- Пришлось поставить IO и здесь, никуда не деться :)\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\nfact n \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Edo\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003Er\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E \u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003E_\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E&lt;-\u003C\u002Ffont\u003E runStateT \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003Efact' n\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    return r\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003C\u002Fnobr\u003E\u003Cblockquote\u003E\u003Ccode\u003Eghci\u003E fact 5\u003Cbr\u002F\u003E\r\n1\u003Cbr\u002F\u003E\r\n5\u003Cbr\u002F\u003E\r\n20\u003Cbr\u002F\u003E\r\n60\u003Cbr\u002F\u003E\r\n120\u003Cbr\u002F\u003E\r\n120\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nКроме \u003Ca href=\"http:\u002F\u002Fhaskell.org\u002Fghc\u002Fdocs\u002F6.10.1\u002Fhtml\u002Flibraries\u002Fmtl\u002FControl-Monad-State-Lazy.html\"\u003EStateT\u003C\u002Fa\u003E есть также \u003Ca href=\"http:\u002F\u002Fhaskell.org\u002Fghc\u002Fdocs\u002F6.10.1\u002Fhtml\u002Flibraries\u002Fmtl\u002FControl-Monad-List.html\"\u003EListT\u003C\u002Fa\u003E (для списка).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПолный список \u003Ca href=\"http:\u002F\u002Fhaskell.org\u002Fghc\u002Fdocs\u002F6.10.1\u002Fhtml\u002Flibraries\u002Fbase\u002FControl-Monad.html#t%3AMonad\"\u003Eмонад\u003C\u002Fa\u003E и \u003Ca href=\"http:\u002F\u002Fhaskell.org\u002Fghc\u002Fdocs\u002F6.10.1\u002Fhtml\u002Flibraries\u002Fmtl\u002FControl-Monad-Trans.html#t%3AMonadTrans\"\u003Eтрансформеров монад\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля удобства над монадами определены обобщённые функции. Их названия говорят за себя, большинство из них дублируют списочные функции, так что я просто перечислю некоторые из их и дам \u003Ca href=\"http:\u002F\u002Fhaskell.org\u002Fghc\u002Fdocs\u002F6.10.1\u002Fhtml\u002Flibraries\u002Fbase\u002FControl-Monad.html\"\u003Eэту ссылку\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003Esequence \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E Monad m \u003Cfont color=\"#8000FF\"\u003E=\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E[\u003C\u002Ffont\u003Em a\u003Cfont color=\"#8000FF\"\u003E]\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E m \u003Cfont color=\"#8000FF\"\u003E[\u003C\u002Ffont\u003Ea\u003Cfont color=\"#8000FF\"\u003E]\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#008080\"\u003E-- выполнить последовательно все вычисления и вернуть список результатов\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\nmapM f \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E sequence\u003Cfont color=\"#8000FF\"\u003E.\u003C\u002Ffont\u003Emap f\u003Cbr\u002F\u003E\r\nforM \u003Cfont color=\"#8000FF\"\u003E=\u003C\u002Ffont\u003E flip mapM\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#008080\"\u003E-- forM [1..10] $ \\i -\u003E print i\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\nforever \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E Monad m \u003Cfont color=\"#8000FF\"\u003E=\u003E\u003C\u002Ffont\u003E m a \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E m b \u003Cfont color=\"#008080\"\u003E-- думаю, пояснять не надо\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\nfilterM \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E Monad m \u003Cfont color=\"#8000FF\"\u003E=\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003Ea \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E m Bool\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E[\u003C\u002Ffont\u003Ea\u003Cfont color=\"#8000FF\"\u003E]\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E m \u003Cfont color=\"#8000FF\"\u003E[\u003C\u002Ffont\u003Ea\u003Cfont color=\"#8000FF\"\u003E]\u003C\u002Ffont\u003E \u003Cfont color=\"#008080\"\u003E-- filter\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\nfoldM \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E Monad m \u003Cfont color=\"#8000FF\"\u003E=\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003Ea \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E b \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E m a\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E a \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E[\u003C\u002Ffont\u003Eb\u003Cfont color=\"#8000FF\"\u003E]\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E m a \u003Cfont color=\"#008080\"\u003E-- foldl\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\nwhen \u003Cfont color=\"#8000FF\"\u003E::\u003C\u002Ffont\u003E Monad m \u003Cfont color=\"#8000FF\"\u003E=\u003E\u003C\u002Ffont\u003E Bool \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E m () \u003Cfont color=\"#8000FF\"\u003E-\u003E\u003C\u002Ffont\u003E m () \u003Cfont color=\"#008080\"\u003E-- if без ветки else\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EList comprehensions\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#888888\"\u003E(Перевести этот термин я не берусь)\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\nList comprehensions позволяет конструировать списки в соответствии с математической нотацией:\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F39d\u002F477\u002F584\u002F39d477584b00e663434eb8885b830aa4.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003Eghci\u003E take \u003Cfont color=\"#80C000\"\u003E5\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E$\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E[\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E2\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E*\u003C\u002Ffont\u003Ex \u003Cfont color=\"#8000FF\"\u003E|\u003C\u002Ffont\u003E x \u003Cfont color=\"#8000FF\"\u003E&lt;-\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E[\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E..\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E]\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E x\u003Cfont color=\"#8000FF\"\u003E^\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E2\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E\u003E\u003C\u002Ffont\u003E \u003Cfont color=\"#80C000\"\u003E3\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E]\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#8000FF\"\u003E[\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E4\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E \u003Cfont color=\"#80C000\"\u003E6\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E \u003Cfont color=\"#80C000\"\u003E8\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E \u003Cfont color=\"#80C000\"\u003E10\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E \u003Cfont color=\"#80C000\"\u003E12\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E]\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\nghci\u003E \u003Cfont color=\"#8000FF\"\u003E[\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003Ex\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E y\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E|\u003C\u002Ffont\u003E x \u003Cfont color=\"#8000FF\"\u003E&lt;-\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E[\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E..\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E3\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E]\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E y \u003Cfont color=\"#8000FF\"\u003E&lt;-\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E[\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E..\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E3\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E]\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E]\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#8000FF\"\u003E[\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E2\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E3\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E2\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E2\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E2\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E2\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E3\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E3\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E3\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E2\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E3\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E3\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E]\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EВидно, что последний список перебирается чаще\u003Cbr\u002F\u003E\r\ny может зависеть от x:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003Eghci\u003E \u003Cfont color=\"#8000FF\"\u003E[\u003C\u002Ffont\u003Ex \u003Cfont color=\"#8000FF\"\u003E+\u003C\u002Ffont\u003E y \u003Cfont color=\"#8000FF\"\u003E|\u003C\u002Ffont\u003E x \u003Cfont color=\"#8000FF\"\u003E&lt;-\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E[\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E..\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E4\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E]\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E y \u003Cfont color=\"#8000FF\"\u003E&lt;-\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E[\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E..\u003C\u002Ffont\u003Ex\u003Cfont color=\"#8000FF\"\u003E]\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E even x\u003Cfont color=\"#8000FF\"\u003E]\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#8000FF\"\u003E[\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E3\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E4\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E5\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E6\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E7\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E,\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E8\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E]\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nList comprehensions тоже синтаксический сахар и разворачивается в (последний пример):\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Cb\u003E\u003Cfont color=\"#0080FF\"\u003Edo\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n    x \u003Cfont color=\"#8000FF\"\u003E&lt;-\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E[\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E..\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E4\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E]\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    y \u003Cfont color=\"#8000FF\"\u003E&lt;-\u003C\u002Ffont\u003E \u003Cfont color=\"#8000FF\"\u003E[\u003C\u002Ffont\u003E\u003Cfont color=\"#80C000\"\u003E1\u003C\u002Ffont\u003E\u003Cfont color=\"#8000FF\"\u003E..\u003C\u002Ffont\u003Ex\u003Cfont color=\"#8000FF\"\u003E]\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    True \u003Cfont color=\"#8000FF\"\u003E&lt;-\u003C\u002Ffont\u003E return \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003Eeven x\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    return \u003Cfont color=\"#8000FF\"\u003E(\u003C\u002Ffont\u003Ex \u003Cfont color=\"#8000FF\"\u003E+\u003C\u002Ffont\u003E y\u003Cfont color=\"#8000FF\"\u003E)\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003EКонечно, он разворачивается напрямую, но так видна связь между монадическими вычислениями над списками и list comprehensions.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ следующий раз я попробую ответить на все вопросы, а потом можно будет приниматься за реализацию чата (или сразу, если вопросов будет мало\u002Fне будет), так что спрашивайте, если что непонятно по всем статьям.\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"haskell"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F51046\u002Fd8013d8100dad213a6c8ff598098bc2b\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F51046\u002Fd8013d8100dad213a6c8ff598098bc2b\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F51046\\\u002F\"},\"headline\":\"Классы типов, монады\",\"datePublished\":\"2009-02-04T12:11:09+03:00\",\"dateModified\":\"2011-11-20T03:28:53+04:00\",\"author\":{\"@type\":\"Person\",\"name\":\"VoidEx\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Темой сегодняшней статьи будут классы типов, некоторые стандартные из них, синтаксический сахар с их использованием и класс монад. Классы привносят динамический...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F51046\\\u002F#post-content-body\",\"about\":[\"h_haskell\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F39d\\\u002F477\\\u002F584\\\u002F39d477584b00e663434eb8885b830aa4.png\"]}","metaDescription":"Темой сегодняшней статьи будут классы типов, некоторые стандартные из них, синтаксический сахар с их использованием и класс монад.\r\nКлассы привносят динамический полиморфизм, как и интерфейсы в...","mainImageUrl":null,"amp":false},"polls":[],"commentsEnabled":true,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false},"578296":{"id":"578296","timePublished":"2021-09-26T14:00:02+00:00","isCorporative":true,"lang":"ru","titleHtml":"Вектор? Растр? А может — и то, и другое?","editorVersion":"1.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Zach Leatherman","originalUrl":"https:\u002F\u002Fwww.zachleat.com\u002Fweb\u002Fvector-raster-split\u002F"}}],"author":{"id":"1220775","alias":"ru_vds","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fe36\u002F812\u002Fd3d\u002Fe36812d3de38eb3d479d7a13228717ef.png","speciality":"Пользователь"},"statistics":{"commentsCount":8,"favoritesCount":29,"readingCount":2485,"score":23,"votesCount":25},"hubs":[{"relatedData":null,"id":"19791","alias":"ruvds","type":"corporative","title":"Блог компании RUVDS.com","titleHtml":"Блог компании RUVDS.com","isProfiled":false},{"relatedData":null,"id":"449","alias":"vector_graphics","type":"collective","title":"Работа с векторной графикой","titleHtml":"Работа с векторной графикой","isProfiled":true},{"relatedData":null,"id":"8880","alias":"server_side_optimization","type":"collective","title":"Серверная оптимизация","titleHtml":"Серверная оптимизация","isProfiled":true},{"relatedData":null,"id":"17175","alias":"image_processing","type":"collective","title":"Обработка изображений","titleHtml":"Обработка изображений","isProfiled":true},{"relatedData":null,"id":"19802","alias":"graph_design","type":"collective","title":"Графический дизайн","titleHtml":"Графический дизайн","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"2","alias":"design","title":"Дизайн"},{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"На этой неделе я столкнулся с интересным классом задач, для решения которых, как я теперь понимаю, можно было использовать гораздо более удачный подход и раньше. Но существует ли такой подход?\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F578296\u002F\"\u003E\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fge\u002Fkf\u002F1n\u002Fgekf1nauxn50imhrqyil4rlzj5m.jpeg\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fa\u003E\u003Cbr\u003E\r\n\u003Ci\u003E\u003Cfont color=\"#999999\"\u003EИзображение для верхней части сайта\u003C\u002Ffont\u003E\u003C\u002Fi\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nРечь идёт о подготовке изображения, рассчитанного на использовании в верхней правой части сайта \u003Ca href=\"https:\u002F\u002Fjamstackconf.com\" rel=\"nofollow noopener noreferrer\"\u003Ejamstackconf.com\u003C\u002Fa\u003E. Мы, в маркетинговой команде Netlify, используем Figma. Первая моя попытка экспорта этого изображения для использования его на сайте оказалась далеко не самой удачной.\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"графика"},{"titleHtml":"веб-разработка"},{"titleHtml":"ruvds_перевод"}]},"579542":{"id":"579542","timePublished":"2021-09-26T19:00:02+00:00","isCorporative":true,"lang":"ru","titleHtml":"Jetpack Compose — как легко построить UI на Android","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2713395","alias":"i15in","fullname":"Иван","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F25f\u002Fe4b\u002Ff94\u002F25fe4bf94867d9647a0ae809abf2e429.jpg","speciality":"Android developer"},"statistics":{"commentsCount":8,"favoritesCount":49,"readingCount":3341,"score":31,"votesCount":39},"hubs":[{"relatedData":null,"id":"18232","alias":"funcorp","type":"corporative","title":"Блог компании FUNCORP","titleHtml":"Блог компании FUNCORP","isProfiled":false},{"relatedData":null,"id":"6345","alias":"mobile_dev","type":"collective","title":"Разработка мобильных приложений","titleHtml":"Разработка мобильных приложений","isProfiled":true},{"relatedData":null,"id":"9188","alias":"ui","type":"collective","title":"Интерфейсы","titleHtml":"Интерфейсы","isProfiled":true},{"relatedData":null,"id":"17107","alias":"android_dev","type":"collective","title":"Разработка под Android","titleHtml":"Разработка под Android","isProfiled":true},{"relatedData":null,"id":"19441","alias":"kotlin","type":"collective","title":"Kotlin","titleHtml":"Kotlin","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"2","alias":"design","title":"Дизайн"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EВ июле этого года вместе с Android Studio Arctic Fox вышла одна из долгожданных библиотек — Jetpack Compose. Она позволяет создавать пользовательский интерфейс в декларативном стиле и обещает быть революцией в построении UI.\u003C\u002Fp\u003E\u003Cp\u003EРазбираемся, так ли это на самом деле, какие у библиотеки преимущества и недостатки. Подробности — в статье.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5da\u002F63d\u002F3cb\u002F5da63d3cbeb8e38de3dde2792d851722.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5da\u002F63d\u002F3cb\u002F5da63d3cbeb8e38de3dde2792d851722.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"разработка мобильных приложений"},{"titleHtml":"jetpack compose"},{"titleHtml":"ui"},{"titleHtml":"интерфейсы"},{"titleHtml":"android"},{"titleHtml":"kotlin"},{"titleHtml":"android studio"},{"titleHtml":"arctic fox"},{"titleHtml":"пользовательские интерфейсы"}]},"579654":{"id":"579654","timePublished":"2021-09-27T09:05:53+00:00","isCorporative":true,"lang":"ru","titleHtml":"Стажировка в ABBYY-2021: гибридный формат, больше машинного обучения и планы на будущее","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"56275","alias":"ABBYYTeam","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F246\u002F3ca\u002Fee9\u002F2463caee983f82739ca5421e1e6a163a.jpg","speciality":"Пользователь"},"statistics":{"commentsCount":0,"favoritesCount":1,"readingCount":383,"score":5,"votesCount":7},"hubs":[{"relatedData":null,"id":"5027","alias":"abbyy","type":"corporative","title":"Блог компании ABBYY","titleHtml":"Блог компании ABBYY","isProfiled":false},{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"20696","alias":"study","type":"collective","title":"Учебный процесс в IT","titleHtml":"Учебный процесс в IT","isProfiled":false},{"relatedData":null,"id":"20740","alias":"career","type":"collective","title":"Карьера в IT-индустрии","titleHtml":"Карьера в IT-индустрии","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"3","alias":"management","title":"Менеджмент"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EМы в ABBYY понимаем, как важно начинать строить карьеру в интересном для себя направлении еще в студенческие годы. Поэтому помогаем талантливым ребятам пробовать свои силы и развиваться уже на третьем курсе университета. Мы проводим летние стажировки, где даем ребятам настоящие «боевые» задачи. По итогам лучшие студенты получают предложения о работе. \u003C\u002Fp\u003E\u003Cp\u003EЛетняя стажировка помогает будущим сотрудникам не только получить опыт и проявить себя, но и изучить внутренние стандарты и процессы разработки компании. Кроме того, это еще и отличная возможность получить предложение о постоянной работе уже на четвертом курсе. Как правило, ABBYY предлагает стажерам частичную занятость для комфортного совмещения с учебой. \u003C\u002Fp\u003E\u003Cp\u003EМы уже не раз подводили итоги летних стажировок в ABBYY (\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fabbyy\u002Fblog\u002F421369\u002F\"\u003Eтут\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fabbyy\u002Fblog\u002F471664\u002F\"\u003Eтут\u003C\u002Fa\u003E и \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fabbyy\u002Fblog\u002F478004\u002F\"\u003Eтут\u003C\u002Fa\u003E), но еще никогда не рассказывали о том, как в целом это проходит в нашей компании, какие тестовые задания и задачи выполняли стажеры, и что думают о стажировке менторы. Все подробности – под катом.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F63b\u002F15c\u002Fe94\u002F63b15ce943783d9aab19e36e15b8e7e6.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F63b\u002F15c\u002Fe94\u002F63b15ce943783d9aab19e36e15b8e7e6.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"nlp (natural language processing)"},{"titleHtml":"abbyy"},{"titleHtml":"abbyy_nlp"},{"titleHtml":"стажировка"},{"titleHtml":"стажер"},{"titleHtml":"практика программирования"},{"titleHtml":"python"},{"titleHtml":"c++"}]},"579772":{"id":"579772","timePublished":"2021-09-27T05:32:01+00:00","isCorporative":true,"lang":"ru","titleHtml":"Сливы процветают. Эксперт-«параноик» Майкл Баззель о защите личных данных","editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Michael Bazzell","originalUrl":"https:\u002F\u002Finteltechniques.com\u002Fblog\u002F2021\u002F07\u002F23\u002Fpersonal-ransomware-exposure\u002F"}}],"author":{"id":"2297567","alias":"SearchInform_team","fullname":null,"avatarUrl":"","speciality":"Пользователь"},"statistics":{"commentsCount":0,"favoritesCount":4,"readingCount":1810,"score":9,"votesCount":9},"hubs":[{"relatedData":null,"id":"22418","alias":"searchinform","type":"corporative","title":"Блог компании SearchInform","titleHtml":"Блог компании SearchInform","isProfiled":false},{"relatedData":null,"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EНаш очередной пост из серии «интересное на иностранном языке» – рассказ Майкла Баззеля о том, как сберечь свои персональные данные от утечек. Майкл – знаковая фигура в сфере OSINT, работал в правительстве США и ФБР, его приглашали в качестве технического эксперта в сериал «Мистер Робот», который считают достойным с точки зрения достоверности. В личной жизни эксперт придерживается настолько жестких правил в отношении информационной гигиены, что некоторые считают его «неадекватом». Так ли это – может быть несколько мнений. \u003C\u002Fp\u003E\u003Cp\u003EОдин из факторов, который убеждает в правильном подходе Майкла, – что риски обнаружить свои данные в интернете стали существенно выше, потому что шифровальщики без разбору сливают в сеть все, до чего дотягиваются при атаках на бизнес. Приводим перевод \u003Ca href=\"https:\u002F\u002Finteltechniques.com\u002Fblog\u002F2021\u002F07\u002F23\u002Fpersonal-ransomware-exposure\u002F\"\u003Eпоста Майкла Баззеля\u003C\u002Fa\u003E. \u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EАтакуют корпорации, а страдают люди\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003EБольшинство людей не задумываются о том, как их касается проблема распространения вирусов-шифровальщиков. Логика такова: речь идет о проблемах компаний, это они вынуждены платить выкуп. При чем тут, казалось бы, обычные люди?! \u003C\u002Fp\u003E\u003Cp\u003EА при том, что преступники сменили тактику: сейчас они не просто шифруют данные, но и скачивают их, выкладывают в открытый доступ, если компании не платят им выкуп. Теперь давайте подумаем, что в этих слитых базах? Множество данных о сотрудниках, клиентах, контрагентах, с которыми компания-жертва работает.\u003C\u002Fp\u003E\u003Cp\u003EХочу сразу уточнить: я это пишу не потому что выступаю за уплату выкупа. Я за то, чтобы сопротивляться избыточному сбору данных там, где это не обязательно. Мы халатно относимся к своим ПДн, раздавая их по первому требованию.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe3b\u002F3e1\u002F2c2\u002Fe3b3e12c2036d90018b804276e31ebea.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe3b\u002F3e1\u002F2c2\u002Fe3b3e12c2036d90018b804276e31ebea.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"персональные данные"},{"titleHtml":"пдн"},{"titleHtml":"сёрчинформ"},{"titleHtml":"Майкл Баззел"},{"titleHtml":"утечки информации"}]},"579804":{"id":"579804","timePublished":"2021-09-26T12:06:13+00:00","isCorporative":true,"lang":"ru","titleHtml":"ОС для работы со звуком — что она умеет","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2691015","alias":"mirhifi","fullname":"«Мир Hi-Fi»","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fdfb\u002F713\u002Fedb\u002Fdfb713edbeed85de6588bd27d6c43229.jpg","speciality":"Пользователь"},"statistics":{"commentsCount":0,"favoritesCount":24,"readingCount":6136,"score":9,"votesCount":11},"hubs":[{"relatedData":null,"id":"18822","alias":"audiomania","type":"corporative","title":"Блог компании Аудиомания","titleHtml":"Блог компании Аудиомания","isProfiled":false},{"relatedData":null,"id":"21484","alias":"electronics","type":"collective","title":"Производство и разработка электроники","titleHtml":"Производство и разработка электроники","isProfiled":true},{"relatedData":null,"id":"21918","alias":"soft","type":"collective","title":"Софт","titleHtml":"Софт","isProfiled":false},{"relatedData":null,"id":"21988","alias":"sound","type":"collective","title":"Звук","titleHtml":"Звук","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EОдин из предыдущих материалов мы посвятили \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Faudiomania\u002Fblog\u002F575076\u002F\"\u003Eинструментам\u003C\u002Fa\u003E для сборки цифровой звуковой рабочей станции (DAW). Еще мы говорили об \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Faudiomania\u002Fblog\u002F575892\u002F\"\u003Eopen source проектах\u003C\u002Fa\u003E, в рамках которых можно сделать собственный синтезатор или педалборд.\u003C\u002Fp\u003E\u003Cp\u003EСегодня продолжим тему и расскажем об открытой ОС \u003Cstrong\u003EElk Audio\u003C\u002Fstrong\u003E, построенной на базе Linux. Она заточена под обработку звука на встраиваемых системах.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa15\u002Ffc8\u002F97f\u002Fa15fc897faa2b01e93257c9af08a6eaa.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa15\u002Ffc8\u002F97f\u002Fa15fc897faa2b01e93257c9af08a6eaa.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"аудиомания"},{"titleHtml":"звук"},{"titleHtml":"Elk Audio"},{"titleHtml":"операционные системы"},{"titleHtml":"DAW"}]},"579854":{"id":"579854","timePublished":"2021-09-27T06:03:01+00:00","isCorporative":true,"lang":"ru","titleHtml":"Видишь уязвимости? А они есть! Наше исследование популярных CMS-систем","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2684283","alias":"Solar_Pentest","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":7,"favoritesCount":11,"readingCount":2225,"score":19,"votesCount":21},"hubs":[{"relatedData":null,"id":"20826","alias":"solarsecurity","type":"corporative","title":"Блог компании Ростелеком-Солар","titleHtml":"Блог компании Ростелеком-Солар","isProfiled":false},{"relatedData":null,"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true},{"relatedData":null,"id":"260","alias":"php","type":"collective","title":"PHP","titleHtml":"PHP","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЛьвиная доля всех работ по анализу защищенности внешнего периметра – это тестирование веб-приложений. Здесь могут быть как корпоративные решения, так и «домашние» разработки на базе различных публичных систем управления контентом (CMS). Мы всегда проводим глубокий анализ подобных решений на тестовых стендах и зачастую находим уязвимости нулевого дня. Собственно, из опыта таких проектов и родилась идея собрать исследовательскую команду и провести глубокий анализ популярных CMS-систем и различных плагинов для них. В этом посте мы поделимся результатами нашего исследования, а также продемонстрируем примеры уязвимого кода наиболее интересных, на наш взгляд, уязвимостей и примеры их эксплуатации. Конечно все эти уязвимости уже исправлены и описываются здесь с разрешения владельцев систем.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6df\u002F317\u002F4e6\u002F6df3174e60bbe263a70bcafdf9e51e6b.jpg","buttonTextHtml":"Не всё то в безопасности, что с Bug Bounty","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6df\u002F317\u002F4e6\u002F6df3174e60bbe263a70bcafdf9e51e6b.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"cms"},{"titleHtml":"уязвимости"},{"titleHtml":"уязвимости и их эксплуатация"},{"titleHtml":"уязвимость нулевого дня"}]},"580008":{"id":"580008","timePublished":"2021-09-27T06:30:02+00:00","isCorporative":false,"lang":"ru","titleHtml":"Летний Магнитогорск","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2614609","alias":"city_scraper","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F8f8\u002Fd6c\u002F328\u002F8f8d6c328ec3a513103b6757c2c21610.png","speciality":"Пользователь"},"statistics":{"commentsCount":5,"favoritesCount":2,"readingCount":2511,"score":9,"votesCount":15},"hubs":[{"relatedData":null,"id":"22012","alias":"Ecology","type":"collective","title":"Экология","titleHtml":"Экология","isProfiled":false},{"relatedData":null,"id":"22024","alias":"urban","type":"collective","title":"Урбанизм","titleHtml":"Урбанизм","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EМагнитогорск Челябинской области – один из крупнейших мировых центров чёрной металлургии. В России это шестой из крупнейших городов, которые не являются центрами субъектов страны. \u003C\u002Fp\u003E\u003Cp\u003EСовсем недавно город был одним из наиболее неблагополучных с точки зрения загрязнения атмосферного воздуха, но в 2021 году был зафиксирован «повышенный» уровень – то есть не «высокий» или «очень высокий», как раньше. \u003C\u002Fp\u003E\u003Cp\u003EКак этот город выглядит летом? Где и как его жители могут проводить время?\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F030\u002F0d1\u002Fcff\u002F0300d1cff2029948d33d803000331724.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F030\u002F0d1\u002Fcff\u002F0300d1cff2029948d33d803000331724.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Магнитогорск"},{"titleHtml":"промышленность"},{"titleHtml":"промышленные города"},{"titleHtml":"урбанизм\u002Fурбания"},{"titleHtml":"урбанистика"},{"titleHtml":"города России"},{"titleHtml":"города"}]},"580038":{"id":"580038","timePublished":"2021-09-26T13:35:19+00:00","isCorporative":false,"lang":"ru","titleHtml":"KODI: собираем удобный и функциональный медиацентр для дома. Часть 9. Spotify","editorVersion":"2.0","postType":"article","postLabels":[{"type":"tutorial","data":null}],"author":{"id":"2644801","alias":"arboozof","fullname":"Роман","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Ff76\u002F452\u002F3d5\u002Ff764523d55be8ef6fc4307ea3158dadf.png","speciality":"IT\u002FRetail"},"statistics":{"commentsCount":15,"favoritesCount":37,"readingCount":5593,"score":10,"votesCount":10},"hubs":[{"relatedData":null,"id":"36","alias":"linux","type":"collective","title":"Настройка Linux","titleHtml":"Настройка Linux","isProfiled":true},{"relatedData":null,"id":"144","alias":"open_source","type":"collective","title":"Open source","titleHtml":"Open source","isProfiled":true},{"relatedData":null,"id":"21908","alias":"smartphones","type":"collective","title":"Смартфоны","titleHtml":"Смартфоны","isProfiled":false},{"relatedData":null,"id":"21946","alias":"video_tech","type":"collective","title":"Видеотехника","titleHtml":"Видеотехника","isProfiled":false},{"relatedData":null,"id":"21988","alias":"sound","type":"collective","title":"Звук","titleHtml":"Звук","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"6","alias":"admin","title":"Администрирование"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EПродолжаем тему интеграции в наш медиацентр онлайн-сервисов прослушивания музыки. Ранее мы уже «подружили» медиацентр KODI с сервисом Яндекс.Музыка. Сегодня на очереди не менее популярный сервис – Spotify.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd36\u002Fb76\u002Fd13\u002Fd36b76d13fccd166d952840d838d4997.png","buttonTextHtml":"Читать дальше &rarr;","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd36\u002Fb76\u002Fd13\u002Fd36b76d13fccd166d952840d838d4997.png","fit":"cover","positionY":0,"positionX":14.74358974359}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"kodi"},{"titleHtml":"xbmc"},{"titleHtml":"ubuntu"},{"titleHtml":"kubuntu"},{"titleHtml":"music"},{"titleHtml":"spotify"},{"titleHtml":"addons"},{"titleHtml":"дополнения"},{"titleHtml":"тв"}]},"580048":{"id":"580048","timePublished":"2021-09-26T14:22:36+00:00","isCorporative":false,"lang":"ru","titleHtml":"Будь строже к себе: как ограничения помогают сделать код лучше","editorVersion":"2.0","postType":"article","postLabels":[{"type":"sandbox","data":null}],"author":{"id":"2787821","alias":"ZeBrains_team","fullname":"Станислав Маслов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fae3\u002F3ee\u002F4f1\u002Fae33ee4f1a117aeeab42ec5a9e2eba25.jpg","speciality":"директор продакшена в IT-компании"},"statistics":{"commentsCount":10,"favoritesCount":48,"readingCount":4449,"score":8,"votesCount":16},"hubs":[{"relatedData":null,"id":"19583","alias":"dev_management","type":"collective","title":"Управление разработкой","titleHtml":"Управление разработкой","isProfiled":true},{"relatedData":null,"id":"20682","alias":"pm","type":"collective","title":"Управление проектами","titleHtml":"Управление проектами","isProfiled":true},{"relatedData":null,"id":"20726","alias":"productpm","type":"collective","title":"Управление продуктом","titleHtml":"Управление продуктом","isProfiled":true}],"flows":[{"id":"3","alias":"management","title":"Менеджмент"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003E\u003Cstrong\u003E\u003Cem\u003EЕсли вам приходилось задумываться о построении эффективной экосистемы проекта и определении ролей тимлида и разработчика — статья Артема Прозорова из ZeBrains для вас. \u003C\u002Fem\u003E\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003EПредлагаю вам задуматься над одним вопросом. Но не спешите с ответом, потому что он не так очевиден, как может показаться:\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EКакая из команд может реализовать более технически стабильный продукт?&nbsp;\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EКоманда №1:\u003C\u002Fstrong\u003E Проектный менеджер, аналитик, тестировщик и несколько разработчиков, у каждого из которых за плечами минимум три года опыта. Все работают в одном офисе, посвящая свое время одному проекту в режиме fulltime.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EКоманда №2:\u003C\u002Fstrong\u003E Один сильный разработчик. Ему помогают множество не знакомых между собой людей из разных часовых поясов. У каждого — свой набор компетенций и уровень опыта. Работой над проектом участники занимаются в свободном режиме, по несколько часов в неделю.\u003C\u002Fp\u003E\u003Cp\u003E* * *\u003C\u002Fp\u003E\u003Cp\u003EОтвет на этот вопрос получим к концу статьи.\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fefe\u002F413\u002Feb2\u002Fefe413eb27c391cfcfef0484e6997aab.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"управление проектами"},{"titleHtml":"управление продуктом"},{"titleHtml":"управление командой разработки"},{"titleHtml":"управление командами разработчиков"},{"titleHtml":"тимлид"},{"titleHtml":"тимлиды и разработчики"}]},"580052":{"id":"580052","timePublished":"2021-09-26T15:29:26+00:00","isCorporative":false,"lang":"ru","titleHtml":"Почему экология не может быть плохой?","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2568695","alias":"phanerozoi_evidence","fullname":"Фанерозой","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fdcc\u002F862\u002F561\u002Fdcc862561429f2ed85090ac53e39cf7d.jpg","speciality":"Биологи, врач, научный популяризатор, палеонтолог"},"statistics":{"commentsCount":46,"favoritesCount":26,"readingCount":4835,"score":8,"votesCount":28},"hubs":[{"relatedData":null,"id":"20742","alias":"read","type":"collective","title":"Читальный зал","titleHtml":"Читальный зал","isProfiled":false},{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"22012","alias":"Ecology","type":"collective","title":"Экология","titleHtml":"Экология","isProfiled":false},{"relatedData":null,"id":"22750","alias":"biology","type":"collective","title":"Биология","titleHtml":"Биология","isProfiled":false}],"flows":[{"id":"3","alias":"management","title":"Менеджмент"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003E\u003Cem\u003EСо второй половины ХХ в мы всё чаще слышим из средств массовой информации выражения «плохая экология», «сохранить экологию», «экология строительных материалов». Но, к сожалению, не многие знают, что такое «экология» на самом деле. Для разгадки тайн экологии нам предстоит окунуться в удивительный мир науки...\u003C\u002Fem\u003E\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F9a4\u002Fecf\u002Fd11\u002F9a4ecfd1144e299873622d45d23d2ce0.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F9a4\u002Fecf\u002Fd11\u002F9a4ecfd1144e299873622d45d23d2ce0.png","fit":"cover","positionY":29.545454545455,"positionX":1.4102564102564}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"виды"},{"titleHtml":"охрана окружающей среды"},{"titleHtml":"мифы"},{"titleHtml":"экосистема"},{"titleHtml":"биогеоценоз"},{"titleHtml":"экология"},{"titleHtml":"экосистемы"},{"titleHtml":"биоценозы"},{"titleHtml":"биология"},{"titleHtml":"вирусы"}]},"580060":{"id":"580060","timePublished":"2021-09-27T09:00:04+00:00","isCorporative":true,"lang":"ru","titleHtml":"Арракис, который мы заслужили","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"238277","alias":"Zelenyikot","fullname":"Виталий Егоров","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F22b\u002F2d7\u002F7a5\u002F22b2d77a57b687aae24784a3e53089c9.jpg","speciality":"Популяризатор космонавтики"},"statistics":{"commentsCount":10,"favoritesCount":21,"readingCount":6287,"score":61,"votesCount":67},"hubs":[{"relatedData":null,"id":"19791","alias":"ruvds","type":"corporative","title":"Блог компании RUVDS.com","titleHtml":"Блог компании RUVDS.com","isProfiled":false},{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"21962","alias":"space","type":"collective","title":"Космонавтика","titleHtml":"Космонавтика","isProfiled":false},{"relatedData":null,"id":"21984","alias":"sci-fi","type":"collective","title":"Научная фантастика","titleHtml":"Научная фантастика","isProfiled":false},{"relatedData":null,"id":"22014","alias":"futurenow","type":"collective","title":"Будущее здесь","titleHtml":"Будущее здесь","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F580060\u002F\"\u003E\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fk0\u002Fds\u002Fy5\u002Fk0dsy5npxclyjdytiroqga7-leu.jpeg\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fa\u003E\u003Cbr\u003E\r\nВо вселенной писателя-фантаста Фрэнка Герберта, Дюна, она же Арракис &mdash; это пустынная и маловодная планета с двумя лунами. По сюжету, она находится за пределами Солнечной системы, но если мы захотим поискать ближайшую схожую параллель,&nbsp;то больше всего подходит планета Марс. Предлагаю воспользоваться возможностями, которые даёт современная космонавтика, и совершить воображаемую прогулку на нашу Дюну.\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Марс"},{"titleHtml":"Дюна"},{"titleHtml":"MRO"},{"titleHtml":"Curiosity"},{"titleHtml":"марсоход"},{"titleHtml":"ruvds_статьи"}]},"580066":{"id":"580066","timePublished":"2021-09-26T18:12:37+00:00","isCorporative":false,"lang":"ru","titleHtml":"Сколько мы переплачиваем за сервера используя Ruby on Rails","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"941194","alias":"motoroller95","fullname":"Искандар Гохар","avatarUrl":"","speciality":"Ruby on Rails developer at IT-territory"},"statistics":{"commentsCount":48,"favoritesCount":6,"readingCount":4471,"score":7,"votesCount":13},"hubs":[{"relatedData":null,"id":"224","alias":"ruby","type":"collective","title":"Ruby","titleHtml":"Ruby","isProfiled":true},{"relatedData":null,"id":"8279","alias":"ror","type":"collective","title":"Ruby on Rails","titleHtml":"Ruby on Rails","isProfiled":true},{"relatedData":null,"id":"17822","alias":"parallel_programming","type":"collective","title":"Параллельное программирование","titleHtml":"Параллельное программирование","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EВ \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F577948\u002F\" rel=\"noopener noreferrer nofollow\"\u003Eпрошлой\u003C\u002Fa\u003E статье я разбирался с тем как работает GIL, а сегодня меня захватила идея узнать насколько дорого обходится этот GIL для кода, который исполняется у нас на бэкенде. Для этого я решил пропатчить MRI и добавить пару переменных, в которые буду засекать сколько времени поток реально выполнял код, а сколько ничего не делал и ждал пока ему удастся завладеть локом. \u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"ruby"},{"titleHtml":"gil"}]},"580080":{"id":"580080","timePublished":"2021-09-26T19:12:55+00:00","isCorporative":false,"lang":"ru","titleHtml":"Дайджест свежих материалов из мира фронтенда за последнюю неделю №486 (20 — 26 сентября 2021)","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"59347","alias":"alexzfort","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd2a\u002Fe8a\u002F5ac\u002Fd2ae8a5ac9876f838ebdd45f3ea3bc3b.png","speciality":""},"statistics":{"commentsCount":2,"favoritesCount":18,"readingCount":3150,"score":17,"votesCount":17},"hubs":[{"relatedData":null,"id":"91","alias":"webdev","type":"collective","title":"Разработка веб-сайтов","titleHtml":"Разработка веб-сайтов","isProfiled":true},{"relatedData":null,"id":"307","alias":"css","type":"collective","title":"CSS","titleHtml":"CSS","isProfiled":true},{"relatedData":null,"id":"357","alias":"javascript","type":"collective","title":"JavaScript","titleHtml":"JavaScript","isProfiled":true},{"relatedData":null,"id":"17103","alias":"html5","type":"collective","title":"HTML","titleHtml":"HTML","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"Предлагаем вашему вниманию подборку с ссылками на новые материалы из области фронтенда и около него.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fec\u002F0x\u002Fkx\u002Fec0xkxfr5jd-rci1wjo9bmr4cns.jpeg\"\u003E\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"дайджест"},{"titleHtml":"фронтенд"},{"titleHtml":"css"},{"titleHtml":"js"},{"titleHtml":"es6"},{"titleHtml":"vue"},{"titleHtml":"react"},{"titleHtml":"angular"},{"titleHtml":"ember"},{"titleHtml":"html5"},{"titleHtml":"браузеры"},{"titleHtml":"ссылки"}]},"580084":{"id":"580084","timePublished":"2021-09-26T19:30:13+00:00","isCorporative":false,"lang":"ru","titleHtml":"Telegram Bots vs Google Forms","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2705023","alias":"dm_aq","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":4,"favoritesCount":21,"readingCount":3725,"score":7,"votesCount":7},"hubs":[{"relatedData":null,"id":"144","alias":"open_source","type":"collective","title":"Open source","titleHtml":"Open source","isProfiled":true},{"relatedData":null,"id":"19441","alias":"kotlin","type":"collective","title":"Kotlin","titleHtml":"Kotlin","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EGoogle forms отличный инструмент для решения простых организационных задач, например, сбор информации для регистрации людей на небольшое мероприятие. Но что если мы попытаемся решить эту задачу по другому? Например через telegram.&nbsp;\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"telegrambot"},{"titleHtml":"telegram"},{"titleHtml":"kotlin"},{"titleHtml":"spring"}]},"580086":{"id":"580086","timePublished":"2021-09-26T19:37:10+00:00","isCorporative":false,"lang":"ru","titleHtml":"Термо принтер и JavaScript","editorVersion":"2.0","postType":"article","postLabels":[{"type":"recovery","data":null}],"author":{"id":"1709955","alias":"IIIarp","fullname":"Сергей Шарпов","avatarUrl":"","speciality":"Веб разработчик"},"statistics":{"commentsCount":46,"favoritesCount":33,"readingCount":7923,"score":38,"votesCount":40},"hubs":[{"relatedData":null,"id":"84","alias":"crazydev","type":"collective","title":"Ненормальное программирование","titleHtml":"Ненормальное программирование","isProfiled":true},{"relatedData":null,"id":"357","alias":"javascript","type":"collective","title":"JavaScript","titleHtml":"JavaScript","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EПриобрел я на днях термопринтер (кассовый аппарат, если изволите) жене для магазина и решил что смогу его обуздать как истинный программист и сделать свою веб кассу, вместо того, что-бы использовать платные решения, ведь задача простая, печатать чеки, но это оказалось не так то и просто...\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4f3\u002F259\u002Fe4e\u002F4f3259e4e73b5bfae82890fd3db512a0.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4f3\u002F259\u002Fe4e\u002F4f3259e4e73b5bfae82890fd3db512a0.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"термопринтер"},{"titleHtml":"javascript"},{"titleHtml":"webusb"}]},"580088":{"id":"580088","timePublished":"2021-09-26T21:17:27+00:00","isCorporative":false,"lang":"ru","titleHtml":"Запуск X-приложения в chroot на примере POSE (или «QEMU не нужен»)","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"1481597","alias":"edo1h","fullname":null,"avatarUrl":"","speciality":"немного программист, немного админ"},"statistics":{"commentsCount":5,"favoritesCount":8,"readingCount":956,"score":11,"votesCount":11},"hubs":[{"relatedData":null,"id":"221","alias":"sys_admin","type":"collective","title":"Системное администрирование","titleHtml":"Системное администрирование","isProfiled":true},{"relatedData":null,"id":"7289","alias":"nix","type":"collective","title":"*nix","titleHtml":"*nix","isProfiled":true}],"flows":[{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЭта мини-статья родилась как ответ на статью \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F579296\" rel=\"noopener noreferrer nofollow\"\u003EУпрощаем эмуляцию X86 с помощью Live CD\u003C\u002Fa\u003E, в которой для запуска старых 32-битных приложений на 64-битных дистрибутивах Linux предлагалось использовать QEMU + Live CD — по моему мнению «из пушки по воробьям». Опишу своё решение на \u003Ccode\u003Echroot\u003C\u002Fcode\u003E + \u003Ccode\u003Edebootstrap\u003C\u002Fcode\u003E. \u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"chroot"},{"titleHtml":"debootstrap"},{"titleHtml":"xwindow"}]},"580090":{"id":"580090","timePublished":"2021-09-26T21:19:11+00:00","isCorporative":false,"lang":"ru","titleHtml":"Сравнение подходов к реализации распределенных транзакций для микросервисов","editorVersion":"2.0","postType":"article","postLabels":[{"type":"sandbox","data":null},{"type":"translation","data":{"originalAuthorName":"Bilgin Ibryam","originalUrl":"https:\u002F\u002Fdevelopers.redhat.com\u002Farticles\u002F2021\u002F09\u002F21\u002Fdistributed-transaction-patterns-microservices-compared"}}],"author":{"id":"194270","alias":"sprosin","fullname":"Sergey Prosin","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd67\u002F5d8\u002F1d6\u002Fd675d81d6fe5bf69493735cef4910eb5.jpg","speciality":"Веду команды к релизам, пишу статьи, выступаю."},"statistics":{"commentsCount":6,"favoritesCount":76,"readingCount":3657,"score":14,"votesCount":14},"hubs":[{"relatedData":null,"id":"7504","alias":"refactoring","type":"collective","title":"Проектирование и рефакторинг","titleHtml":"Проектирование и рефакторинг","isProfiled":true},{"relatedData":null,"id":"21482","alias":"distributed_systems","type":"collective","title":"Распределённые системы","titleHtml":"Распределённые системы","isProfiled":true},{"relatedData":null,"id":"22115","alias":"microservices","type":"collective","title":"Микросервисы","titleHtml":"Микросервисы","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EКак архитектор-консультант в Red Hat, я имел возможность поработать над множеством проектов для наших клиентов. У каждого из них есть свои особенности, которые, однако, имеют некоторые общие черты. Большинство клиентов хотят знать, как скоординировать запись в несколько систем одновременно. Ответ на этот вопрос обычно включает подробное объяснение двойной записи, распределенных транзакций, современных альтернатив, а также возможных сценариев сбоев и недостатков каждого подхода. Как правило, именно в этот момент заказчик понимает, что разделение монолитного приложения на микросервисы - долгий и сложный путь, обычно требующий компромиссов.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbc4\u002F35d\u002Fff3\u002Fbc435dff35d09143dacf29bbc1e470a7.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbc4\u002F35d\u002Fff3\u002Fbc435dff35d09143dacf29bbc1e470a7.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"распределенные системы"},{"titleHtml":"микросервисы"},{"titleHtml":"транзакции"},{"titleHtml":"распределенные транзакции"},{"titleHtml":"оркестрация"},{"titleHtml":"оркестрация микросервисов"},{"titleHtml":"хореография"},{"titleHtml":"конвейеры"}]},"580092":{"id":"580092","timePublished":"2021-09-26T21:49:14+00:00","isCorporative":false,"lang":"ru","titleHtml":"30 сентября: Let's Encrypt и конец срока действия IdenTrust DST Root CA X3","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"805873","alias":"rantal","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":78,"favoritesCount":44,"readingCount":13971,"score":41,"votesCount":41},"hubs":[{"relatedData":null,"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true},{"relatedData":null,"id":"17350","alias":"s_admin","type":"collective","title":"Серверное администрирование","titleHtml":"Серверное администрирование","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003E30 сентября 2021 14:01:15  GMT оканчивается срок действия корневого сертификата IdenTrust DST Root CA X3.\u003C\u002Fp\u003E\u003Cp\u003EЭто событие достойно вашего внимания по той причине, что после наступления этого момента ряд устаревших систем перестанут доверять сертификатам,&nbsp;выпущенным центром сертификации Let’s Encrypt. С учётом того, что на текущий момент Let's Encrypt предоставляет бесплатные криптографические сертификаты примерно для \u003Ca href=\"https:\u002F\u002Fletsencrypt.org\u002Fstats\u002F\" rel=\"noopener noreferrer nofollow\"\u003E250 миллионов доменных имен\u003C\u002Fa\u003E, а \"устаревшие системы\" - это порой системы возрастом всего 5-6 лет, вряд ли окончание срока действия сертификата&nbsp;DST Root CA X3 пройдёт для всех гладко и незаметно. В чём причина, кого конкретно это затронет, и что можно сделать?\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"let's encrypt"},{"titleHtml":"DST Root CA X3"},{"titleHtml":"корневой сертификат"},{"titleHtml":"https"},{"titleHtml":"tls"},{"titleHtml":"openssl"}]},"580094":{"id":"580094","timePublished":"2021-09-26T22:35:26+00:00","isCorporative":false,"lang":"ru","titleHtml":"Блокчейн нас подвёл? Почему ДЭГ — это плохо и можем ли мы адекватно контролировать процесс подсчёта голосов?","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"206414","alias":"PoltoS","fullname":"Сергей Полторак","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F5cf\u002F03a\u002Fc7f\u002F5cf03ac7fe60ea8a6686bd4c57627ddc.png","speciality":""},"statistics":{"commentsCount":77,"favoritesCount":19,"readingCount":11111,"score":25,"votesCount":45},"hubs":[{"relatedData":null,"id":"118","alias":"crypto","type":"collective","title":"Криптография","titleHtml":"Криптография","isProfiled":true},{"relatedData":null,"id":"210","alias":"it_testing","type":"collective","title":"Тестирование IT-систем","titleHtml":"Тестирование IT-систем","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EИнтересно наблюдать, как дискредитируется термин блокчейна на выборах в госдуму. Вроде голосование было на блокчейне, но его якобы подделали. Т.е. блокчейн можно подделать или ЦИК и ДИТ нам подсунули какой-то лохчейн вместо блокчейна?!? И мало кто обсуждает происходящее по существу без эмоций, связанных с результатами партий и кандидатов.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6e5\u002F82b\u002F9d0\u002F6e582b9d062dd29fa41c7842a8b76495.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6e5\u002F82b\u002F9d0\u002F6e582b9d062dd29fa41c7842a8b76495.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Криптография"},{"titleHtml":"блокчейн"},{"titleHtml":"открытые данные"},{"titleHtml":"электронное голосование"},{"titleHtml":"выборы"},{"titleHtml":"выборы в госдуму"},{"titleHtml":"дэг"},{"titleHtml":"дэг 2021"}]},"580150":{"id":"580150","timePublished":"2021-09-27T10:50:03+00:00","isCorporative":true,"lang":"ru","titleHtml":"Топ-5 когнитивных искажений при планировании в IT","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2794469","alias":"KM_QA","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":0,"favoritesCount":13,"readingCount":992,"score":13,"votesCount":13},"hubs":[{"relatedData":null,"id":"14332","alias":"oleg-bunin","type":"corporative","title":"Блог компании Конференции Олега Бунина (Онтико)","titleHtml":"Блог компании Конференции Олега Бунина (Онтико)","isProfiled":false},{"relatedData":null,"id":"19583","alias":"dev_management","type":"collective","title":"Управление разработкой","titleHtml":"Управление разработкой","isProfiled":true},{"relatedData":null,"id":"20736","alias":"hr_management","type":"collective","title":"Управление персоналом","titleHtml":"Управление персоналом","isProfiled":true},{"relatedData":null,"id":"20754","alias":"tech_events","type":"collective","title":"Конференции","titleHtml":"Конференции","isProfiled":false},{"relatedData":null,"id":"21990","alias":"brain","type":"collective","title":"Мозг","titleHtml":"Мозг","isProfiled":false}],"flows":[{"id":"3","alias":"management","title":"Менеджмент"},{"id":"4","alias":"marketing","title":"Маркетинг"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЭта статья подходит для тимлидов и их подопечных, а также для всех, кто оценивает проекты и задачи. Я расскажу, как и почему мы делаем ошибки из-за когнитивных искажений. Попадаем в них мы почти все, просто потому что мы живые люди. И на примере одного дня из жизни тимлида я хочу показать, в какие искажения чаще всего влетают в IT, и&nbsp; — самое полезное&nbsp; —&nbsp; как из них можно выходить.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EЗамечу, что искать когнитивные искажения стоит, в первую очередь, у себя, а не у коллег. \u003C\u002Fstrong\u003EИ что рассказывать про искажения намного проще, чем не влетать в их на практике, однако, если этому научиться, то в перспективе это изрядно окупается, потому что экономит и время, и деньги, помогая и нам, и команде.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb78\u002F76f\u002F001\u002Fb7876f0010e85c328462a735df0b76e8.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb78\u002F76f\u002F001\u002Fb7876f0010e85c328462a735df0b76e8.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"когнитивные искажения"},{"titleHtml":"нейрофизиология"},{"titleHtml":"мозг"},{"titleHtml":"психология"},{"titleHtml":"тимлидство"},{"titleHtml":"тимлид"},{"titleHtml":"управление людьми"},{"titleHtml":"управление проектами и командой"},{"titleHtml":"управление командой"},{"titleHtml":"управление персоналом"}]}},"articlesIds":{"ARTICLES_LIST_TOP_PERIOD_DAILY":["580060","580092","580086","579542","580094","578296","579854","580080","580090","580150","580088","580038","580008","579772","579804","580052","580048","580084","580066","579654"]},"isLoading":false,"pagesCount":{"ARTICLES_LIST_TOP_PERIOD_DAILY":2},"route":{"name":"ARTICLES_LIST_TOP_PERIOD","params":{"period":"daily"},"query":{}},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":["133009","131998","74164"],"similarListRefs":{"74164":{"id":"74164","timePublished":"2009-11-03T09:16:01+00:00","isCorporative":false,"lang":"ru","titleHtml":"Изучай Haskell ради… Haskell'а","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"18255","alias":"vseloved","fullname":"vseloved","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F0fe\u002Fa1f\u002Fa69\u002F0fea1fa69e07e86bfbeffedd6c4732ca.jpg","speciality":null},"statistics":{"commentsCount":50,"favoritesCount":15,"readingCount":15868,"score":18,"votesCount":40},"hubs":[{"id":"8424","alias":"haskell","type":"collective","title":"Haskell","titleHtml":"Haskell","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"Я долго (несколько лет) не решался составить окончательное мнение о Haskell'e: слишком противоречивы были мысли. И вот, наконец, благодаря этой записи о \u003Ca href=\"http:\u002F\u002Flionet.livejournal.com\u002F44305.html\"\u003Eразборе программки определения двудольности графа\u003C\u002Fa\u003E я могу это сделать :)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЯ понял, что Haskell-программисты — в основном, нужно сказать, хобби-программисты — это те, кто программирует не решение задачи, алгоритм, систему, а Haskell! \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fblogs\u002FHaskell\u002F74164#h1\"\u003E[1]\u003C\u002Fa\u003E Посмотрите, какой простой алгоритм описан в заметке, а сколько вокруг него нагромождено языковых конструкций, объяснений и дискуссий. (Чтоб понять, насколько алгоритм прост, можете посмотреть в комментариях варианты на Lisp'е, Python'е).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nМне хорошо знакомо это умонастроение — когда в погоне за максимальным использованием мощи языка забываешь о самой задаче,— поскольку в Lisp-мире оно тоже часто встречается: есть языки, которые способны действительно увлечь. И выражение «это взорвало мне мозг» часто звучат и по поводу Lisp'а, и по поводу Haskell'а. Но это же — фигня! Конечно, не может не радовать узнать что-то новое, но не нужно же радоваться этому, как ребенок новой игрушке. Хороший язык программирования должен быть максимально понятен и прост, должен давать человеку свободу самовыражения. Честно говоря, именно этому я обрадовался, когда открыл для себя Lisp: что нашел то, что искал. А не тому, что увидел какую-то конструкцию или изворот, который не доводилось встречать раньше.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n","imageUrl":null,"buttonTextHtml":"Вывод","image":null},"status":"published","plannedPublishTime":null,"checked":null},"131998":{"id":"131998","timePublished":"2011-11-11T04:19:27+00:00","isCorporative":false,"lang":"ru","titleHtml":"Введение в Template Haskell. Часть 1. Необходимый минимум","editorVersion":"1.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Булат Зиганшин","originalUrl":"http:\u002F\u002Fdocs.google.com\u002Fuc?id=0B4BgTwf_ng_TM2MxZjJjZjctMTQ0OS00YzcwLWE5N2QtMDI0YzE4NGUwZDM3"}}],"author":{"id":"54319","alias":"laughedelic","fullname":"Алексей","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd60\u002F029\u002F6a4\u002Fd600296a4e51746b1a639f18da0e65cd.jpg","speciality":"Программист"},"statistics":{"commentsCount":7,"favoritesCount":47,"readingCount":7475,"score":19,"votesCount":19},"hubs":[{"id":"8424","alias":"haskell","type":"collective","title":"Haskell","titleHtml":"Haskell","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003E\u003Ci\u003EДанный текст является переводом \u003Ca href=\"http:\u002F\u002Fdocs.google.com\u002Fuc?id=0B4BgTwf_ng_TM2MxZjJjZjctMTQ0OS00YzcwLWE5N2QtMDI0YzE4NGUwZDM3\"\u003Eдокументации Template Haskell\u003C\u002Fa\u003E, написанной Булатом Зиганшиным. Перевод всего текста разбит на несколько логических частей для облегчения восприятия. Далее курсив в тексте — примечания переводчика.\u003C\u002Fi\u003E\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Ca href=\"http:\u002F\u002Fwww.haskell.org\u002Fhaskellwiki\u002FTemplate_Haskell\"\u003ETemplate Haskell\u003C\u002Fa\u003E (далее TH) — это расширение языка Haskell предназначенное для мета-программирования. Оно даёт возможность алгоритмического построения программы на стадии компиляции. Это позволяет разработчику использовать различные техники программирования, не доступные в самом Haskell’е, такие как, макро-подобные расширения, направляемые пользователем оптимизации (например inlining), обобщённое программирование (polytypic programming), генерация вспомогательных структур данных и функций из имеющихся. К примеру, код\u003Cbr\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"bash\"\u003Eyell file line = fail ($(printf \"Error in file %s line %d\") file line)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u003E\r\nможет быть преобразован с помощью TH в\u003Cpre\u003E\u003Ccode class=\"bash\"\u003Eyell file line = fail ((\\x1 x2 -&gt; \"Error in file \"++x1++\" line \"++show x2) file line)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u003E\r\nДругой пример, код\u003Cbr\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"bash\"\u003E\ndata T = A Int String | B Integer | C\n$(deriveShow ''T)\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u003E\r\nможет быть преобразован в\u003Cpre\u003E\u003Ccode class=\"bash\"\u003E\ndata T = A Int String | B Integer | C\ninstance Show T\n    show (A x1 x2) = \"A \"++show x1++\" \"++show x2\n    show (B x1)    = \"B \"++show x1\n    show C         = \"C\"\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u003E\r\nВ TH код на Haskell’е генерируется обычными Haskell’евскими функциями \u003Ci\u003E(которые я буду для ясности называть шаблонами)\u003C\u002Fi\u003E. Минимум того, что вам необходимо знать, чтобы использовать TH — это следующие темы:\u003Cbr\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003EКак Haskell-код представляется в шаблонах (TH-функциях)\u003C\u002Fli\u003E\r\n\u003Cli\u003EКак монада цитирования используется для унификации имён\u003C\u002Fli\u003E\r\n\u003Cli\u003EКак сгенерированный TH-код вставляется в программу\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше →","image":null},"status":"published","plannedPublishTime":null,"checked":null},"133009":{"id":"133009","timePublished":"2011-11-21T09:07:54+00:00","isCorporative":false,"lang":"ru","titleHtml":"Введение в Template Haskell. Часть 3. Прочие аспекты TH","editorVersion":"1.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Булат Зиганшин","originalUrl":"http:\u002F\u002Fdocs.google.com\u002Fuc?id=0B4BgTwf_ng_TM2MxZjJjZjctMTQ0OS00YzcwLWE5N2QtMDI0YzE4NGUwZDM3"}}],"author":{"id":"54319","alias":"laughedelic","fullname":"Алексей","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd60\u002F029\u002F6a4\u002Fd600296a4e51746b1a639f18da0e65cd.jpg","speciality":"Программист"},"statistics":{"commentsCount":1,"favoritesCount":27,"readingCount":2065,"score":11,"votesCount":15},"hubs":[{"id":"8424","alias":"haskell","type":"collective","title":"Haskell","titleHtml":"Haskell","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Ci\u003EДанный текст является переводом \u003Ca href=\"http:\u002F\u002Fdocs.google.com\u002Fuc?id=0B4BgTwf_ng_TM2MxZjJjZjctMTQ0OS00YzcwLWE5N2QtMDI0YzE4NGUwZDM3\"\u003Eдокументации Template Haskell\u003C\u002Fa\u003E, написанной Булатом Зиганшиным. Перевод всего текста разбит на несколько логических частей для облегчения восприятия. Далее курсив в тексте — примечания переводчика. Предыдущие части:\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003E\u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fblogs\u002FHaskell\u002F131998\u002F\"\u003EЧасть 1. Необходимый минимум\u003C\u002Fa\u003E\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fblogs\u002FHaskell\u002F132679\u002F\"\u003EЧасть 2. Инструменты цитирования кода\u003C\u002Fa\u003E\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EМатериализация\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nМатериализация (reification) — это средство Template Haskell, позволяющее программисту получить информацию из таблицы символов компилятора. Монадическая функция \u003Ca href=\"http:\u002F\u002Fwww.haskell.org\u002Fghc\u002Fdocs\u002Flatest\u002Fhtml\u002Flibraries\u002Ftemplate-haskell-2.6.0.0\u002FLanguage-Haskell-TH-Syntax.html#v:reify\"\u003E\u003Ccode\u003Ereify\u003C\u002Fcode\u003E\u003C\u002Fa\u003E \u003Ccode\u003E∷ Name → Q Info\u003C\u002Fcode\u003E возвращает информацию о данном имени: если это глобальный идентификатор (функция, константа, конструктор) – вы получите его тип, если это тип или класс – вы получите его структуру. Определение типа \u003Ca href=\"http:\u002F\u002Fwww.haskell.org\u002Fghc\u002Fdocs\u002Flatest\u002Fhtml\u002Flibraries\u002Ftemplate-haskell-2.6.0.0\u002FLanguage-Haskell-TH-Syntax.html#t:Info\"\u003E\u003Ccode\u003EInfo\u003C\u002Fcode\u003E\u003C\u002Fa\u003E можно найти в модуле \u003Ca href=\"http:\u002F\u002Fwww.haskell.org\u002Fghc\u002Fdocs\u002Flatest\u002Fhtml\u002Flibraries\u002Ftemplate-haskell-2.6.0.0\u002FLanguage-Haskell-TH-Syntax.html\"\u003E\u003Ccode\u003ELanguage.Haskell.TH.Syntax\u003C\u002Fcode\u003E\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\nМатериализация может быть использована для того, чтобы получить структуру типа, но таким образом нельзя получить тело функции. Если вам нужно материализовать тело функции, то определение функции нужно процитировать и дальше можно будет работать с этим определением с помощью другого шаблона. Например так:\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode\u003E$(optimize [d| fib = … |])\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nили так\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode\u003Efib = $(optimize [| … |])\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Ci\u003EНа самом деле, в оригинальной статье больше ничего не говорится про материализацию. Не знаю, насколько это содержательная тема – необходимый минимум знаний о ней ограничивается функцией \u003Ca href=\"http:\u002F\u002Fwww.haskell.org\u002Fghc\u002Fdocs\u002Flatest\u002Fhtml\u002Flibraries\u002Ftemplate-haskell-2.6.0.0\u002FLanguage-Haskell-TH-Syntax.html#v:reify\"\u003E\u003Ccode\u003Ereify\u003C\u002Fcode\u003E\u003C\u002Fa\u003E и типом \u003Ca href=\"http:\u002F\u002Fwww.haskell.org\u002Fghc\u002Fdocs\u002Flatest\u002Fhtml\u002Flibraries\u002Ftemplate-haskell-2.6.0.0\u002FLanguage-Haskell-TH-Syntax.html#t:Info\"\u003E\u003Ccode\u003EInfo\u003C\u002Fcode\u003E\u003C\u002Fa\u003E, но есть некоторые тонкости, связанные например с тем, что можно получить информацию не о любом имени. Если эта тема интересна, я могу собрать какую-нибудь информацию и написать об этом отдельную заметку (или вклеить сюда).\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EОблегчённое цитирование имён\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nЧтобы получить имя (\u003Ccode\u003E∷ Name\u003C\u002Fcode\u003E), соответствующее интересующему идентификатору, можно использовать функцию \u003Ca href=\"http:\u002F\u002Fwww.haskell.org\u002Fghc\u002Fdocs\u002Flatest\u002Fhtml\u002Flibraries\u002Ftemplate-haskell-2.6.0.0\u002FLanguage-Haskell-TH-Syntax.html#v:mkName\"\u003E\u003Ccode\u003EmkName\u003C\u002Fcode\u003E\u003C\u002Fa\u003E, но это не безопасное решение, потому что \u003Ccode\u003EmkName\u003C\u002Fcode\u003E возвращает не квалифицированное имя, которое может интерпретироваться по-разному в зависимости от контекста. А вот код \u003Ccode\u003EVarE id ← [| foo |]\u003C\u002Fcode\u003E безопасен в этом смысле, так как цитирование квалифицирует имена (получится что-то типа \u003Ccode\u003EMy.Own.Module.foo\u003C\u002Fcode\u003E), но этот код слишком многословный и требует монадический контекст для использования. К счастью, Template Haskell, имеет другую простую форму цитирования имён: \u003Ccode\u003E'foo\u003C\u002Fcode\u003E (одинарная кавычка перед \u003Ccode\u003Efoo\u003C\u002Fcode\u003E) имеет тип \u003Ccode\u003EName\u003C\u002Fcode\u003E и содержит квалифицированное имя, соответствующее идентификатору \u003Ccode\u003Efoo\u003C\u002Fcode\u003E, так что код \u003Ccode\u003Elet id = 'foo\u003C\u002Fcode\u003E эквивалентен по смыслу коду \u003Ccode\u003EVarE id ← [| foo |]\u003C\u002Fcode\u003E. Обратите внимание, что эта конструкция имеет простой тип \u003Ccode\u003EName\u003C\u002Fcode\u003E (а не \u003Ccode\u003EQ Exp\u003C\u002Fcode\u003E или \u003Ccode\u003EQ Name\u003C\u002Fcode\u003E), так что она может быть использована там, где не возможно использование монад, например:\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode\u003Ef ∷ Exp → Exp\nf (App (Var m) e) |  m == 'map  =  …\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nЭта новая форма тем не менее является цитированием и подчиняется тем же правилам, что и цитирующие скобки \u003Ccode\u003E[| … |]\u003C\u002Fcode\u003E. Например, она не может быть использована внутри этих скобок (так нельзя: \u003Ccode\u003E[| 'foo |]\u003C\u002Fcode\u003E), \u003Ci\u003Eно и вклеивание к ней не может быть применено (так тоже нельзя: \u003Ccode\u003E$( 'foo )\u003C\u002Fcode\u003E), потому что для вклейки нужен тип \u003Ccode\u003EQ …\u003C\u002Fcode\u003E\u003C\u002Fi\u003E. Более важно то, что эта форма определяется статически, возвращая полностью квалифицированное имя, с однозначной интерпретацией.\u003Cbr\u002F\u003E\r\nHaskell’евские пространства имён немного всё усложняют. Цитата \u003Ccode\u003E[| P |]\u003C\u002Fcode\u003E означает конструктор данных \u003Ccode\u003EP\u003C\u002Fcode\u003E, в то время как \u003Ccode\u003E[t| P |]\u003C\u002Fcode\u003E означает конструктор типа \u003Ccode\u003EP\u003C\u002Fcode\u003E. Поэтому для “облегчённого цитирования” необходим такой же способ разделения этих сущностей. Для контекста типов используется просто две одинарные кавычки:\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003E\u003Ccode\u003E'Foo\u003C\u002Fcode\u003E означает “конструктор данных \u003Ccode\u003EFoo\u003C\u002Fcode\u003E в контексте выражения”\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ccode\u003E'foo\u003C\u002Fcode\u003E означает “имя \u003Ccode\u003Efoo\u003C\u002Fcode\u003E в контексте выражения”\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ccode\u003E''Foo\u003C\u002Fcode\u003E означает “конструктор типа \u003Ccode\u003EFoo\u003C\u002Fcode\u003E в контексте типов”\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ccode\u003E''foo\u003C\u002Fcode\u003E означает “переменная типа \u003Ccode\u003Efoo\u003C\u002Fcode\u003E в контексте типов”\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E Облегчённая форма цитирования используется в примере генерации воплощений класса \u003Ccode\u003EShow\u003C\u002Fcode\u003E, который разбирается в конце.\u003Cbr\u002F\u003E\r\n","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null}}},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{"voidex":{"scoreStats":{"score":59.5,"votesCount":200},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"33916","alias":"VoidEx","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd5f\u002Fd69\u002Fbc4\u002Fd5fd69bc4f16d3a7a11b42c68549d070.jpg","speciality":"Пользователь"}},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.670ab961.js" defer></script><script src="https://assets.habr.com/habr-web/js/chunk-f458c7c4.6e221df6.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.76acc47b.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
