<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Декартово дерево: Часть 1. Описание, операции, применения / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.0f7bdd8f.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.670ab961.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.01bb2993.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.76acc47b.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-f458c7c4.e48e8f79.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-f458c7c4.6e221df6.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.0f7bdd8f.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.01bb2993.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-f458c7c4.e48e8f79.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.4f7c12b4e1b1b4c0e44ef6f9f33b1f9f.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/101818\/"},"headline":"Декартово дерево: Часть 1. Описание, операции, применения","datePublished":"2010-08-16T17:53:40+04:00","dateModified":"2013-07-20T03:30:46+04:00","author":{"@type":"Person","name":"Александр Полозов"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Оглавление (на данный момент) Часть 1. Описание, операции, применения. Часть 2. Ценная информация в дереве и множественные операции с ней. Часть 3. Декартово дер...","url":"https:\/\/habr.com\/ru\/post\/101818\/#post-content-body","about":["h_algorithms","f_develop"],"image":["https:\/\/habrastorage.org\/storage\/habraeffect\/f4\/8e\/f48e012bd2babdc5d90dd98fd7b880b6.png","https:\/\/habrastorage.org\/storage\/habraeffect\/2c\/f5\/2cf582dd0b73a4015d084a8587e27f7e.png","https:\/\/habrastorage.org\/storage\/habraeffect\/a1\/0a\/a10a744def8f325a1019502ecc175ef6.png","https:\/\/habrastorage.org\/storage\/habraeffect\/28\/2e\/282eb999908e6a2102d654a685f6483a.png","https:\/\/habrastorage.org\/storage\/habraeffect\/a9\/8f\/a98f52fd388745ea9be4b4681f780880.png","https:\/\/habrastorage.org\/storage\/habraeffect\/4c\/bd\/4cbde2feb466d25a36d4296ffb745450.png","https:\/\/habrastorage.org\/storage\/habraeffect\/35\/27\/35277f3277ac1bf837b7735f18066f58.png","https:\/\/habrastorage.org\/storage\/habraeffect\/d5\/91\/d591771892a5cf1fa80e71a91610e71f.png","https:\/\/habrastorage.org\/storage\/habraeffect\/b7\/25\/b72500a639cd03ed366994f2dbb44f05.png","https:\/\/habrastorage.org\/storage\/habraeffect\/d4\/14\/d414a774067989e32d38caa3fc2c9273.png","https:\/\/habrastorage.org\/storage\/habraeffect\/c4\/dc\/c4dc34aa95aa3d188896b92e8c4de1a5.png","https:\/\/habrastorage.org\/storage\/habraeffect\/af\/92\/af92745b00f14d074aadb1de242011d9.png"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.47.1">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Декартово дерево: Часть 1. Описание, операции, применения" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Декартово дерево: Часть 1. Описание, операции, применения" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Декартово дерево: Часть 1. Описание, операции, применения" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Оглавление (на данный момент)
Часть 1. Описание, операции, применения.
Часть 2. Ценная информация в дереве и множественные операции с ней.
Часть 3. Декартово дерево по неявному ключу.
To be..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Оглавление (на данный момент)
Часть 1. Описание, операции, применения.
Часть 2. Ценная информация в дереве и множественные операции с ней.
Часть 3. Декартово дерево по неявному ключу.
To be..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Оглавление (на данный момент)
Часть 1. Описание, операции, применения.
Часть 2. Ценная информация в дереве и множественные операции с ней.
Часть 3. Декартово дерево по неявному ключу.
To be..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Оглавление (на данный момент)
Часть 1. Описание, операции, применения.
Часть 2. Ценная информация в дереве и множественные операции с ней.
Часть 3. Декартово дерево по неявному ключу.
To be..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Оглавление (на данный момент)
Часть 1. Описание, операции, применения.
Часть 2. Ценная информация в дереве и множественные операции с ней.
Часть 3. Декартово дерево по неявному ключу.
To be..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/101818/222438df02817bc303c66be8989d6870/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/101818/222438df02817bc303c66be8989d6870/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/101818/222438df02817bc303c66be8989d6870/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/101818/222438df02817bc303c66be8989d6870/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/101818/222438df02817bc303c66be8989d6870/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="101818" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2010-08-16T13:53:40.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/101818/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/101818/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/101818/222438df02817bc303c66be8989d6870/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.cee85629.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
              Как стать автором
            </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.cee85629.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.cee85629.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.cee85629.svg#pull-arrow"></use></svg></div></div> <!----> <div class="tm-page-article__body"><article class="tm-page-article__content tm-page-article__content_inner"><div class="tm-page-article__head-wrapper"><!----> <div class="tm-article-snippet tm-page-article__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/Skiminok/" title="Skiminok" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" loading="lazy" src="//habrastorage.org/r/w32/getpro/habr/avatars/d23/ed4/4cf/d23ed44cf8d9f76e24a0a2a39616553a.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/Skiminok/" class="tm-user-info__username">
      Skiminok
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2010-08-16T13:53:40.000Z" title="2010-08-16, 17:53">16  августа  2010 в 17:53</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Декартово дерево: Часть 1. Описание, операции, применения</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/algorithms/" class="tm-article-snippet__hubs-item-link"><span>Алгоритмы</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <!----> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml"><h4>Оглавление (на данный момент)</h4><br/>
<b>Часть 1. Описание, операции, применения.</b><br/>
<a href="http://habrahabr.ru/post/102006/">Часть 2. Ценная информация в дереве и множественные операции с ней.</a><br/>
<a href="http://habrahabr.ru/post/102364/">Часть 3. Декартово дерево по неявному ключу.</a><br/>
<em>To be continued...</em><br/>
<br/>
<strong>Декартово дерево</strong> (cartesian tree, treap) — красивая и легко реализующаяся структура данных, которая с минимальными усилиями позволит вам производить многие скоростные операции над массивами ваших данных. Что характерно, на Хабрахабре единственное его упоминание я нашел в <a href="http://habrahabr.ru/post/66926/">обзорном посте</a> многоуважаемого <a href="https://habrahabr.ru/users/winger/" class="user_link">winger</a>, но тогда продолжение тому циклу так и не последовало. Обидно, кстати.<br/>
<br/>
Я постараюсь покрыть все, что мне известно по теме — несмотря на то, что известно мне сравнительно не так уж много, материала вполне хватит поста на два, а то и на три. Все алгоритмы иллюстрируются исходниками на C# (а так как я любитель функционального программирования, то где-нибудь в послесловии речь зайдет и о F# — но это читать не обязательно :). Итак, приступим.<br/>
<br/>
<h4>Введение</h4><br/>
В качестве введения рекомендую прочесть <a href="http://habrahabr.ru/post/65617/">пост про двоичные деревья поиска</a> того же <a href="https://habrahabr.ru/users/winger/" class="user_link">winger</a>, поскольку без понимания того, что такое дерево, дерево поиска, а так же без знания <a href="http://habrahabr.ru/post/78728/">оценок сложности алгоритма</a> многое из материала данной статьи останется для вас китайской грамотой. Обидно, правда?<br/>
<br/>
Следующий пункт нашей обязательной программы — <strong>куча</strong> (heap). Думаю, также многим известная структура данных, однако краткий обзор я все же приведу.<br/>
Представьте себе двоичное дерево с какими-то данными (ключами) в вершинах. И для каждой вершины мы в обязательном порядке требуем следующее: ее ключ строго больше, чем ключи ее непосредственных сыновей. Вот небольшой пример корректной кучи:<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/storage/habraeffect/f4/8e/f48e012bd2babdc5d90dd98fd7b880b6.png"/><br/>
<br/>
<blockquote>На заметку сразу скажу, что совершенно не обязательно думать про кучу исключительно как структуру, у которой родитель <em>больше</em>, чем его потомки. Никто не запрещает взять противоположный вариант и считать, что родитель <em>меньше</em> потомков — главное, выберите что-то одно для всего дерева. Для нужд этой статьи гораздо удобнее будет использовать вариант со знаком «больше».<br/>
</blockquote><br/>
Сейчас за кадром остается вопрос, каким образом в кучу можно добавлять и удалять из нее элементы. Во-первых, эти алгоритмы требуют отдельного места на осмотр, а во-вторых, нам они все равно не понадобятся.<br/>
<a name="habracut"></a><br/>
<h4>Проблемы</h4><br/>
Когда речь заходит о деревьях поиска (вы же уже прочитали рекомендуемую статью, правда?), основной вопрос, который ставится перед структурой — скорость выполнения операций, вне зависимости от данных, хранящихся в ней, и последовательности их поступления. Так, двоичное дерево поиска дает гарантию, что поиск конкретного ключа в этом дереве будет выполняться за O(H), где <strong>H</strong> — высота дерева. Но какой может быть эта высота — черт его знает. При неблагоприятных обстоятельствах высота дерева легко может стать <strong>N</strong> (количество элементов в нем), и тогда дерево поиска вырождается в обычный список — и зачем оно тогда нужно? Для достижения такой ситуации достаточно добавлять в дерево поиска элементы от 1 до N в очереди возрастания — при стандартном алгоритме добавления в дерево получим следующую картинку:<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/storage/habraeffect/2c/f5/2cf582dd0b73a4015d084a8587e27f7e.png"/><br/>
Было придумано огромное количество так называемых сбалансированных деревьев поиска — грубо говоря, тех, в которых по мере существования дерева при каждой операции над ним поддерживается оптимальность максимальной глубины дерева. Оптимальная глубина имеет порядок O(log<sub>2</sub> N) — тогда тот же порядок имеет время выполнения каждого поиска в дереве. Структур данных, поддерживающих такую глубину, много, самые известные тут красно-черное дерево или AВЛ-дерево. Их отличительная черта в большинстве — трудная реализация, основанная на размере чертовой кучи случаев, в которых можно и запутаться. Своей же простотой и красотой выгодно отличается, наоборот, декартово дерево, и даже дает нам в некотором роде то самое желанное логарифмическое время, но лишь с достаточно высокой вероятностью… впрочем, о таких деталях и тонкостях позже.<br/>
<br/>
<h4>Определение</h4><br/>
Итак у нас есть данные дерева — ключи <b>x</b> (здесь и далее предполагается, что ключ и является той самой информацией, которую мы храним в дереве; когда впоследствии потребуется отделять по смыслу пользовательскую информацию от ключей, я скажу особо). Давайте добавим к ним еще один параметр в пару — <b>y</b>, и назовем его <em>приоритетом</em>. Теперь построим такое волшебное дерево, которое хранит в каждой вершине по два параметра, и при этом <i>по ключам является деревом поиска, а по приоритетам — кучей</i>. Такое дерево и будем далее называть декартовым.<br/>
<br/>
<blockquote>Кстати говоря: в англоязычной литературе очень популярно название <em>treap</em>, которое наглядно показывает суть структуры: tree + heap. В русскоязычной же иногда можно встретить составленные по такому же принципу: <em>дерамида</em> (дерево + пирамида) или <em>дуча</em> (дерево + куча).<br/>
</blockquote><br/>
Почему дерево называется декартовым? Это сразу станет ясно, как только мы попробуем его нарисовать. Возьмем какой-нибудь набор пар «ключ-приоритет» и расставим на координатной сетке соответствующие точки (x, y). А потом соединим соответствующие вершины линиями, образуя дерево. Таким образом, декартово дерево отлично укладывается на плоскости благодаря своим ограничениям, а два его основных параметра — ключ и приоритет — в некотором смысле, координаты. Результат построения показан на рисунке: слева в стандартной нотации дерева, справа — на декартовой плоскости.<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/storage/habraeffect/a1/0a/a10a744def8f325a1019502ecc175ef6.png"/><br/>
<br/>
Пока что не очень понятно, зачем такое нужно. А разгадка проста, и кроется она в следующих утверждениях. Во-первых, пусть дано множество ключей: корректных деревьев поиска из них можно построить много различных, в том числе и спископодобное. А вот после добавления к ним приоритетов дерево из данных ключей можно построить уже лишь одно-единственное, вне зависимости от порядка поступления ключей. Это довольно очевидно.<br/>
А во-вторых, давайте теперь сделаем наши приоритеты случайными. То есть просто ассоциируем с каждым ключом случайное число из достаточно большого диапазона, и именно оно и будет служить соответствующим игреком. Тогда полученное декартово дерево с очень высокой, стремящейся к 100% вероятностью, будет иметь высоту, не превосходящую 4 log<sub>2</sub> N. (Оставлю этот факт здесь без доказательства.) А значит, хоть оно может и не быть идеально сбалансированным, время поиска ключа в таком дереве все равно будет порядка O(log<sub>2</sub> N), чего мы, собственно, и добивались.<br/>
<br/>
<blockquote>Еще один интересный подход — не делать приоритеты случайными, а вспомнить о том, что у нас есть огромное количество какой-то дополнительной пользовательской информации, которую, как правило, приходится хранить в вершинах дерева. Если есть основания считать, что эта информация по сути своей достаточно случайна (день рождения пользователя, к примеру), то можно попробовать ее использовать в корыстных целях. Взять в качестве приоритета либо непосредственно информацию, либо результат какой-то функции от нее (только тогда функция должна быть обратима, чтобы восстанавливать при необходимости информацию из приоритетов). Впрочем, тут действовать приходится на свой страх и риск — если дерево через какое-то время сильно разбалансируется и вся программа начнет ощутимо тормозить, придется срочно мудрить что-нибудь во спасение ситуации.<br/>
</blockquote><blockquote>Далее для простоты изложения предположим, что все ключи и все приоритеты в деревьях различны. На самом деле возможность равенства ключей не создает никаких особых проблем, вам просто нужно четко определиться, где будут находиться элементы, равные данному x — либо <em>только</em> в левом его поддереве, либо <em>только</em> в правом. Равенство приоритетов по идее тоже не составляет особой проблемы, кроме загрязнения доказательств и рассуждений особыми случаями, но на практике лучше его избегать. Случайная генерация целых приоритетов вполне подходит в большинстве случаев, вещественных между 0 и 1 — почти во всех случаях.<br/>
</blockquote><br/>
Перед началом рассказа об операциях приведу заготовку класса C#, который будет реализовывать наше декартово дерево.<br/>
<blockquote><pre><code class="cs">public class Treap
{
    public int x;
    public int y;

    public Treap Left;
    public Treap Right;    

    private Treap(int x, int y, Treap left = null, Treap right = null)
    {
        this.x = x;
        this.y = y;
        this.Left = left;
        this.Right = right;
    }
    
    // здесь будут операции...
}</code></pre></blockquote><br/>
<blockquote>Я сделал для простоты изложения x и y типа <code>int</code>, но понятно, что на их месте мог бы быть любой тип, экземпляры которого мы умеем сравнивать между собой — то есть любой, реализующий <code>IComparable </code>или <code>IComparable&lt;T></code> в терминах C#. В Haskell это мог бы быть любой тип из класса <code>Ord</code>, в F# — любой с ограничениями на оператор сравнения, в Java — реализующий интерфейс <code>Comparable&lt;T1></code>, и так далее.<br/>
</blockquote><br/>
<h4>Магия клея и ножниц</h4><br/>
На повестке дня насущные вопросы — как работать с декартовым деревом. Вопрос о том, как же его вообще строить из сырого набора ключей, я немного отложу, а пока что предположим, что какая-то добрая душа начальное дерево нам уже построила, и теперь нам требуется его по необходимости менять.<br/>
<br/>
Вся подноготная работы с декартовым деревом заключается в двух основных операциях: <strong>Merge</strong> и <strong>Split</strong>. С помощью них элементарно выражаются все остальные популярные операции, так что начнем с основ.<br/>
<br/>
Операция Merge принимает на вход два декартовых дерева <strong>L</strong> и <strong>R</strong>. От нее требуется слить их в одно, тоже корректное, декартово дерево <strong>T</strong>. Следует заметить, что работать операция Merge может не с любыми парами деревьев, а только с теми, у которых все ключи одного дерева ( L ) не превышают ключей второго ( R ). (Обратите особое внимание на это условие — оно нам еще не раз пригодится в будущем!)<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/storage/habraeffect/28/2e/282eb999908e6a2102d654a685f6483a.png"/><br/>
<br/>
Алгоритм работы Merge очень прост. Какой элемент станет корнем будущего дерева? Очевидно, с наибольшим приоритетом. Кандидатов на максимальный приоритет у нас два — только корни двух исходных деревьев. Сравним их приоритеты; пускай для однозначности приоритет y левого корня больше, а ключ в нем равен x. Новый корень определен, теперь стоит подумать, какие же элементы окажутся в его правом поддереве, а какие — в левом.<br/>
<br/>
Легко понять, что все дерево R окажется в правом поддереве нового корня, ведь ключи-то у него больше x по условию. Точно так же левое поддерево старого корня L.Left имеет все ключи, меньшие x, и должно остаться левым поддеревом, а правое поддерево L.Right… а вот правое должно по тем же соображениям оказаться справа, однако неясно, куда тогда ставить его элементы, а куда элементы дерева R?<br/>
<br/>
Стоп, почему неясно? У нас есть два дерева, ключи в одном меньше ключей в другом, и нам нужно их как-то объединить и полученный результат привесить к новому корню как правое поддерево. Просто рекурсивно вызываем Merge для L.Right и дерева R, и возвращенное ею дерево используем как новое правое поддерево. Результат налицо.<br/>
<br/>
На рисунке синим цветом показано правое поддерево результирующего дерева после операции Merge и связь от нового корня к этому поддереву.<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/storage/habraeffect/a9/8f/a98f52fd388745ea9be4b4681f780880.png"/><br/>
Симметричный случай — когда приоритет в корне дерева R выше — разбирается аналогично. И, конечно, надо не забыть про основу рекурсии, которая в нашем случае наступает, если какое-то из деревьев L и R, или сразу оба, являются пустыми.<br/>
<br/>
Исходный код Merge:<blockquote><pre><code class="cs">public static Treap Merge(Treap L, Treap R)
{
    if (L == null) return R;
    if (R == null) return L;

    if (L.y > R.y)
    {
        var newR = Merge(L.Right, R);
        return new Treap(L.x, L.y, L.Left, newR);
    }
    else
    {
        var newL = Merge(L, R.Left);
        return new Treap(R.x, R.y, newL, R.Right);
    }
}
</code></pre></blockquote><br/>
<br/>
Теперь об операции Split. На вход ей поступает корректное декартово дерево T и некий ключ <strong>x<sub>0</sub></strong>. Задача операции — разделить дерево на два так, чтобы в одном из них ( L ) оказались все элементы исходного дерева с ключами, меньшими x<sub>0</sub>, а в другом ( R ) — с большими. Никаких особых ограничений на дерево не накладывается.<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/storage/habraeffect/4c/bd/4cbde2feb466d25a36d4296ffb745450.png"/><br/>
<br/>
Рассуждаем похожим образом. Где окажется корень дерева T? Если его ключ меньше x<sub>0</sub>, то в L, иначе в R. Опять-таки, предположим для однозначности, что ключ корня оказался меньше x<sub>0</sub>.<br/>
<br/>
Тогда можно сразу сказать, что все элементы левого поддерева T также окажутся в L — их ключи ведь тоже все будут меньше x<sub>0</sub>. Более того, корень T будет и корнем L, поскольку его приоритет наибольший во всем дереве. Левое поддерево корня полностью сохранится без изменений, а вот правое уменьшится — из него придется убрать элементы с ключами, большими x<sub>0</sub>, и вынести в дерево R. А остаток ключей сохранить как новое правое поддерево L. Снова видим идентичную задачу, снова напрашивается рекурсия!<br/>
<br/>
Возьмем правое поддерево и рекурсивно разрежем его по тому же ключу x<sub>0</sub> на два дерева L' и R'. После чего становится ясно, что L' станет новым правым поддеревом дерева L, а R' и есть непосредственно дерево R — оно состоит из тех и только тех элементов, которые больше x<sub>0</sub>.<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/storage/habraeffect/35/27/35277f3277ac1bf837b7735f18066f58.png"/><br/>
Симметричный случай, при котором ключ корня больше, чем x<sub>0</sub>, тоже совершенно идентичен. Основа рекурсии здесь — случаи, когда какое-то из поддеревьев пустое. Ну и исходный код функции:<br/>
<blockquote><pre><code class="cs">public void Split(int x, out Treap L, out Treap R)
{
    Treap newTree = null;
    if (this.x &lt;= x)
    {
        if (Right == null)
            R = null;
        else
            Right.Split(x, out newTree, out R);
        L = new Treap(this.x, y, Left, newTree);
    }
    else
    {
        if (Left == null)
            L = null;
        else
            Left.Split(x, out L, out newTree);
        R = new Treap(this.x, y, newTree, Right);
    }
}
</code></pre></blockquote><br/>
Кстати, обратите внимание: деревья, выдаваемые на выход операцией Split, подходят как входные данные для операции Merge: все ключи левого дерева не превосходят ключей в правом. Это ценное обстоятельство пригодится нам уже через несколько абзацев.<br/>
<br/>
Последний вопрос — это время работы Merge и Split. Из описания алгоритма видно, что Merge за каждую итерацию рекурсии уменьшает суммарную высоту двух сливаемых деревьев как минимум на единицу, так что общее время работы не превосходит 2H, то есть O(H). А со Split все совсем просто — мы работаем с единственным деревом, его высота уменьшается с каждой итерацией тоже как минимум на единицу, и ассимптотика работы операции тоже O(H). А поскольку декартово дерево со случайными приоритетами, как уже говорилось, с высокой вероятностью имеет близкую к логарифмической высоту, то Merge и Split работают за желаемый O(log<sub>2</sub> N), и это дает нам потрясающий простор для их применения.<br/>
<br/>
<h4>Операции с деревом</h4><br/>
Теперь, когда мы с вами в совершенстве владеем клеем и ножницами, не составляет совершенно никакого труда только с помощью них реализовать самые необходимые действия с декартовым деревом: добавление элемента в дерево и удаление его. Я приведу самый простой вариант их реализации, основанный <em>целиком</em> на Merge и Split. Он будет работать за все то же логарифмическое время, однако отличаться, как говорят ACM-олимпийцы, большей константой: то есть порядок зависимости времени работы от размера дерева будет все так же O(log<sub>2</sub> N), но <em>точное</em> время работы отличаться в несколько раз — в константу раз. Скажем, 4 log<sub>2</sub> N против просто log<sub>2</sub> N. На практике это различие почти не ощущается, пока размер дерева не достигнет поистине галактических размеров.<br/>
<blockquote>Существуют и оптимальные реализации как добавления с удалением, так и прочих нужных операций дерамиды, константа у которых значительно меньше. Я обязательно приведу эти реализации в одной из следующих частей цикла, а также поговорю о подводных камнях, связанных с использованием более быстрого варианта. Подводные камни в первую очередь связаны с необходимостью поддержки дополнительных запросов к дереву и хранению в нем особой информации… впрочем, не буду сейчас забивать этим голову читателю, до множественных операций с деревом (чрезвычайно важной фичи!) время еще дойдет.<br/>
</blockquote><br/>
Итак, пускай нам дано декартово дерево и некий элемент <strong>x</strong>, который требуется в него вставить (как мы помним, в контексте статьи предполагается, что все элементы различны и икса в дереве еще нет). Хочется применить подход из двоичного дерева поиска: идти вниз по ключам, выбирая каждый раз путь влево или вправо, пока не найдем место, куда можно вставить наш x, и дописать его. Но это решение неправильное, ведь мы забыли о приоритетах. Место, куда алгоритм дерева поиска захочет добавить новую вершину, однозначно удовлетворяет ограничениям дерева поиска по x, однако может нарушить ограничение кучи по y. Значит, придется действовать немного выше и абстрактней. <br/>
<br/>
Второй вариант решения — представить новый ключ как дерево из единственной вершины (со случайным приоритетом y), и слить его с исходным с помощью Merge. Это опять неверно: в исходном дереве могут быть вершины с ключами, большими x, и тогда мы нарушаем обещание, данное функции Merge касательно взаимоотношения между ее входными деревьями.<br/>
<br/>
Проблему можно исправить. Помня универсальность операций Split/Merge, решение напрашивается практически сразу:<br/>
<ol>
<li>Разделим (split) дерево по ключу x на дерево L, с ключами меньше икса, и дерево R, с большими.</li>
<li>Создадим из данного ключа дерево M из единственной вершины (x, y), где y — только что сгенерированный случайный приоритет.</li>
<li>Объединим (merge) по очереди L с M, то что получилось — с R.</li>
</ol>Все шаги алгоритма можно и проиллюстрировать.<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/storage/habraeffect/d5/91/d591771892a5cf1fa80e71a91610e71f.png"/><br/>
У нас тут 1 применение Split, и 2 применения Merge — общее время работы O(log<sub>2</sub> N). Короткий исходный код прилагается.<br/>
<blockquote><pre><code class="cs">public Treap Add(int x)
{
    Treap l, r;
    Split(x, out l, out r);
    Treap m = new Treap(x, rand.Next());
    return Merge(Merge(l, m), r);
}
</code></pre></blockquote><br/>
<br/>
С удалением тоже не возникает никаких вопросов. Пускай нас просят удалить из декартова дерева элемент с ключем x. Сейчас я предполагаю, что вы разобрались с равенством ключей, отдав преимущество левой стороне: в правом поддереве вершины с ключем x другие элементы с тем же ключем не встречаются, а вот в левом могут. Тогда совершим следующую последовательность действий:<br/>
<ol>
<li>Разделим сначала дерево по ключу x-1. Все элементы, меньшие либо равные x-1, отправились в левый результат, значит, искомый элемент — в правом.</li>
<li>Разделим правый результат по ключу x (здесь стоит быть аккуратным с равенством!). В новый правый результат отправились все элементы с ключами, большими x, а в «средний» (левый от правого) — все меньшие либо равные x. Но поскольку строго меньшие после первого шага все были отсеяны, то среднее дерево и есть искомый элемент.</li>
<li>Теперь просто объединим снова левое дерево с правым, без среднего, и дерамида осталась без ключей x.</li>
</ol><br/>
Теперь понятно, почему я постоянно акцентировал внимание на том, как же все-таки необходимо учитывать равенство ключей. Скажем, если бы ваш компаратор считал, что элементы с равными ключами надо отправлять в правое поддерево, то на первом шаге вам пришлось бы делить по ключу x, а на втором — по x+1. А вот если бы конкретики в этом вопросе вообще не было, то процедура удаления в данном варианте вообще могла бы и не выполнить желаемое — после второго шага в качестве среднего дерева останется пустое, а искомый элемент куда-то ускользнул, либо влево, либо вправо, и ищи его теперь.<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/storage/habraeffect/b7/25/b72500a639cd03ed366994f2dbb44f05.png"/><br/>
Время работы операции все так же O(log<sub>2</sub> N), поскольку мы применили 2 раза Split и 1 раз Merge.<br/>
Исходный код:<br/>
<blockquote><pre><code class="cs">public Treap Remove(int x)
{
    Treap l, m, r;
    Split(x - 1, out l, out r);
    r.Split(x, out m, out r);
    return Merge(l, r);
}
</code></pre></blockquote><br/>
<h4>Акт творения</h4><br/>
Теперь, зная алгоритм добавления элемента в готовое декартово дерево, мы можем привести простейший способ построить дерево из поступающего набора ключей: просто добавлять их по очереди стандартным алгоритмом, начав с дерева из одной вершины — первого ключа. Помня, что операция добавления выполняется за логарифмическое время, мы получим общее время выполнения полного построения дерева — O(N log<sub>2</sub> N).<br/>
<br/>
Интересно, а быстрее можно?<br/>
<br/>
Как оказалось, в некоторых случаях — да. Давайте представим, что ключи нам на вход поступают в возрастающем порядке. Такое в принципе вполне может произойти, если это какие-то свежесоздающиеся идентификаторы с auto increment. Так вот, в таком случае существует несложный алгоритм построения дерева за O(N). Правда, нам придется заплатить за это временным overhead`ом по памяти: хранить для каждой вершины строящегося дерева ссылку на ее предка (на самом деле даже не обязательно для каждой, но это уже тонкости).<br/>
<br/>
Будем хранить ссылку на последнюю добавленную вершину в дереве. По совместимости она будет в нем самой правой — ведь ключ у нее наибольший из всех ключей дерева, построенного на данный момент. Теперь допустим, что на вход поступает следующий ключ <strong>x</strong> с каким-то приоритетом <strong>y</strong>. Куда его поместить?<br/>
<br/>
Последняя вершина суть самая правая, следовательно, правого сына у нее нет. Если ее приоритет больше, чем y добавляемой, то можно просто приписать новую вершину правым сыном и с чистой совестью переходить к следующему ключу на входе. В противном же случае надо подумать. У новой вершины все равно наибольший ключ, так что в конечном итоге она точно станет самой правой вершиной дерева. Стало быть, искать место для ее вставки где-либо, кроме как по самой правой ветви, смысла не имеет. Найти же нам нужно всего лишь место, где приоритет вершины больше, чем y. Итак, поднимемся от самой правой вверх по ветви, каждый раз проверяя приоритет текущей осматриваемой вершины. В конце концов мы либо придем в корень, либо остановимся где-то посреди ветви.<br/>
<br/>
Предположим, мы пришли в корень. Тогда оказывается, что y больше, чем все приоритеты в дереве. У нас не остается другого выбора, кроме как сделать (x, y) новым корнем и привесить к ней старое дерево левым сыном.<br/>
<br/>
Если же в корень мы не пришли — ситуация похожая. В некоторой вершине правой ветви (x<sub>0</sub>, y<sub>0</sub>) имеем <nobr>y<sub>0</sub> > y</nobr>. А у ее непосредственного правого потомка приоритет меньше y. Чтобы сохранить структуру дерева поиска по ключам, и сделать (x, y) самой правой в дереве, мы подвешиваем её как нового правого сына к <nobr>(x<sub>0</sub>, y<sub>0</sub>)</nobr>, а все старое правое поддерево становится левым поддеревом (x, y).<br/>
<br/>
Чтобы было понятнее, я проиллюстрирую на примерах. Возьмем некоторое декартово дерево и покажем, что произойдет, если в него пытаться добавлять те или иные вершины. Ключ везде тот же (22), а приоритет поварьируем.<br/>
y = 4:<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/storage/habraeffect/d4/14/d414a774067989e32d38caa3fc2c9273.png"/><br/>
y = 16:<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/storage/habraeffect/c4/dc/c4dc34aa95aa3d188896b92e8c4de1a5.png"/><br/>
y = 11:<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/storage/habraeffect/af/92/af92745b00f14d074aadb1de242011d9.png"/><br/>
<br/>
Почему этот алгоритм работает за O(N)? Заметьте, что каждую вершину дерева вы в ее жизни посетите максимум два раза:<ul>
<li>при ее непосредственном добавлении;</li>
<li>возможно, при добавлении какой-то другой, пока она будет оставаться в правой ветви. Сразу после этого из правой ветви она уйдет и более посещаться не будет.</li>
</ul>Таким образом, общее количество переходов не превосходит 2N, и ассимптотика построения — O(N).<br/>
<br/>
На закуску — исходный код построения по заданному массиву ключей и приоритетов. Здесь предполагается, что у каждой вершины дерева есть еще свойство <code>Parent</code>, а также что опциональный параметр с таким же именем есть у уже использовавшегося приватного конструктора вершины (пятый по счету).<br/>
<blockquote><pre><code class="cs">public static Treap Build(int[] xs, int[] ys)
{
    Debug.Assert(xs.Length == ys.Length);

    var tree = new Treap(xs[0], ys[0]);
    var last = tree;

    for (int i = 1; i &lt; xs.Length; ++i)
    {
        if (last.y > ys[i])
        {
            last.Right = new Treap(xs[i], ys[i], parent: last);
            last = last.Right;
        }
        else
        {
            Treap cur = last;
            while (cur.Parent != null &amp;&amp; cur.y &lt;= ys[i])
                cur = cur.Parent;
            if (cur.y &lt;= ys[i])
                last = new Treap(xs[i], ys[i], cur);
            else
            {
                last = new Treap(xs[i], ys[i], cur.Right, null, cur);
                cur.Right = last;
            }
        }
    }

    while (last.Parent != null)
        last = last.Parent;
    return last;
}
</code></pre></blockquote><br/>
<br/>
<h4>Резюме</h4><br/>
Мы с вами построили древовидную структуру данных с такими свойствами:<ul>
<li>обладает почти гарантированно логарифмической высотой относительно количества своих вершин;</li>
<li>позволяет за логарифмическое время искать любой ключ в дереве, добавлять его и удалять;</li>
<li>исходный код всех её методов не превышает 20 строк, они легко понимаются и в них крайне сложно ошибиться</li>
<li>содержит некоторый overhead по памяти, сравнительно с истинно самобалансирующимися деревьями, на хранение приоритетов.</li>
</ul><br/>
В принципе, результат довольно-таки мощный. Однако некоторым может быть все же неясно, стоило ли ради него городить настолько большой огород с такой кучей текста. Стоило. Фишка в том, что возможности декартового дерева и потенциал его применения далеко не ограничиваются функциями, описанными в этой статье. Это лишь предисловие.<br/>
<br/>
В следующих частях:<ol>
<li>Множественные операции над декартовым деревом (ищем за O(log<sub>2</sub> N) сумму, максимум и т.д.)</li>
<li>Декартово дерево по неявному ключу (или как усовершенствовать обычный массив)</li>
<li>Ускоренные реализации функций декартового дерева (и их проблемы)</li>
<li>Функциональная реализация декартового дерева на F#.</li>
</ol><br/>
<h4>Источники</h4><br/>
Источники указываю раз и навсегда, они одни и те же для всех планируемых статей.<br/>
<br/>
В первую очередь при написании этих статей я основываюсь на лекции Виталия Гольдштейна, рассказанной на Харьковской зимней школе по программированию ACM ICPC в 2010 году. Ее можно загрузить из видеогалереи <a href="http://olimp.sc170.kharkov.ua/">школы</a> (год 2010, день 2), как только она снова заработает, потому что в последние дни сервер что-то катастрофически барахлит.<br/>
<br/>
<a href="http://e-maxx.ru">Сайт</a> Максима «e-maxx» Иванова — богатый кладезь информации по разным алгоритмам и структурам данных, использующихся в спортивном программировании. В частности, есть на нем и <a href="http://e-maxx.ru/algo/treap">статья про декартово дерево</a>.<br/>
<br/>
В знаменитой книге Кормен, Лейзерсон, Ривест, Штайн «Алгоритмы: построение и анализ» можно найти доказательство того, что матожидание высоты случайного двоичного дерева поиска есть O(log<sub>2</sub> N), хотя его определение случайного дерева поиска и отличается от того, что мы здесь использовали.<br/>
<br/>
Впервые дерамиды были предложены в статье Seidel, Raimund; Aragon, Cecilia R. (1996), <a href="http://people.ischool.berkeley.edu/~aragon/pubs/rst96.pdf">«Randomized Search Trees»</a>. В принципе там можно найти полный объем информации по теме.<br/>
<br/>
Пока что все. Надеюсь, вам было интересно :)</div></div> <!----> <!----></div> <div class="tm-article-body__tags"><div class="tm-article-body__tags-links"><span class="tm-article-body__tags-title">Теги:</span> <span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B4%D0%B5%D0%BA%D0%B0%D1%80%D1%82%D0%BE%D0%B2%D0%BE%20%D0%B4%D0%B5%D1%80%D0%B5%D0%B2%D0%BE%5D" class="tm-article-body__tags-item-link">декартово дерево</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bcartesian%20tree%5D" class="tm-article-body__tags-item-link">cartesian tree</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Btreap%5D" class="tm-article-body__tags-item-link">treap</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B4%D0%B5%D1%80%D0%B0%D0%BC%D0%B8%D0%B4%D0%B0%5D" class="tm-article-body__tags-item-link">дерамида</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B4%D1%83%D1%87%D0%B0%5D" class="tm-article-body__tags-item-link">дуча</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%81%D1%82%D1%80%D1%83%D0%BA%D1%82%D1%83%D1%80%D1%8B%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85%5D" class="tm-article-body__tags-item-link">структуры данных</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B4%D0%B2%D0%BE%D0%B8%D1%87%D0%BD%D1%8B%D0%B5%20%D0%B4%D0%B5%D1%80%D0%B5%D0%B2%D1%8C%D1%8F%5D" class="tm-article-body__tags-item-link">двоичные деревья</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%82%D0%B5%D0%B3%20%D0%BA%D0%BE%D1%82%D0%BE%D1%80%D1%8B%D0%B9%20%D0%BD%D0%B8%D0%BA%D1%82%D0%BE%20%D0%BD%D0%B5%20%D1%87%D0%B8%D1%82%D0%B0%D0%B5%D1%82%5D" class="tm-article-body__tags-item-link">тег который никто не читает</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B1%D0%B8%D0%BD%D0%B0%D1%80%D0%BD%D1%8B%D0%B5%20%D0%B4%D0%B5%D1%80%D0%B5%D0%B2%D1%8C%D1%8F%5D" class="tm-article-body__tags-item-link">бинарные деревья</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%81%D0%B1%D0%B0%D0%BB%D0%B0%D0%BD%D1%81%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5%20%D0%B4%D0%B5%D1%80%D0%B5%D0%B2%D1%8C%D1%8F%5D" class="tm-article-body__tags-item-link">сбалансированные деревья</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BC%5D" class="tm-article-body__tags-item-link">C</a></span></div> <div class="tm-article-body__tags-links"><span class="tm-article-body__tags-title">Хабы:</span> <span class="tm-article-body__tags-item"><a href="/ru/hub/algorithms/" class="tm-article-body__tags-item-link">
                  Алгоритмы
                </a></span></div></div></article> <div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 166: ↑161 и ↓5</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 166: ↑161 и ↓5" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+156</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <!----> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    571
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/101818/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      30
    </span></a> <!----></div> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div></div> <!----></div> <!----> <div class="tm-page-article__additional-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body"><div class="tm-article-author tm-page-article__author"><!----> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-two-column"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/Skiminok/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/d23/ed4/4cf/d23ed44cf8d9f76e24a0a2a39616553a.jpg" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 369 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    279.2
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info"><div class="tm-user-card__title"><span class="tm-user-card__name">Александр Полозов</span> <a href="/ru/users/Skiminok/" class="tm-user-card__nickname">
          @Skiminok
        </a> <!----></div> <p class="tm-user-card__short-info">Пользователь</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-two-column"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div></div> <!----></section> <div class="tm-page-article__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/101818/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 30 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <section class="tm-block tm-block_spacing-around"><header class="tm-block__header"><h2 class="tm-block__title">Похожие публикации</h2> <!----></header> <div class="tm-block__body"><ul class="tm-article-list-block__list"><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-04T13:46:57.000Z" title="2021-09-04, 16:46">4  сентября   в 16:46</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/576304/" class="tm-article-title__link"><span>Как снизить зависимость кода от структуры данных?</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 12: ↑7 и ↓5</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 12: ↑7 и ↓5" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+2</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">7.4K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    60
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/576304/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      40
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2010-08-23T07:15:26.000Z" title="2010-08-23, 11:15">23  августа  2010 в 11:15</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/102364/" class="tm-article-title__link"><span>Декартово дерево: Часть 3. Декартово дерево по неявному ключу</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 81: ↑77 и ↓4</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 81: ↑77 и ↓4" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+73</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">44K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    237
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/102364/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      17
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2010-08-18T16:11:32.000Z" title="2010-08-18, 20:11">18  августа  2010 в 20:11</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/102006/" class="tm-article-title__link"><span>Декартово дерево: Часть 2. Ценная информация в дереве и множественные операции с ней</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 76: ↑72 и ↓4</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 76: ↑72 и ↓4" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+68</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">33K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    227
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/102006/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      14
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li> <!----></ul></div> <!----></section> <!----> <!----> <section class="tm-block tm-block_spacing-around"><header class="tm-block__header"><h2 class="tm-block__title">Лучшие публикации за сутки</h2> <!----></header> <div class="tm-block__body"><ul class="tm-article-list-block__list"><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-28T14:25:12.000Z" title="2021-09-28, 17:25">вчера в 17:25</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/580516/" class="tm-article-title__link"><span>Лучший язык программирования</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 80: ↑77 и ↓3</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 80: ↑77 и ↓3" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+74</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">13K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    87
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/580516/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      30
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-28T07:08:30.000Z" title="2021-09-28, 10:08">вчера в 10:08</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/nlmk/blog/580270/" class="tm-article-title__link"><span>Варим суп из стали: оптимизация логистики ковшей и как устроен цех КЦ № 2</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 73: ↑73 и ↓0</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 73: ↑73 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+73</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">6.2K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    25
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/nlmk/blog/580270/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      23
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-28T08:51:05.000Z" title="2021-09-28, 11:51">вчера в 11:51</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/yandex/blog/579778/" class="tm-article-title__link"><span>YARL: как Яндекс построил распределённый Rate Limiter с нулевым влиянием на время ответа сервисов</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 47: ↑47 и ↓0</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 47: ↑47 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+47</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">3.9K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    32
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/yandex/blog/579778/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      14
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-28T08:07:48.000Z" title="2021-09-28, 11:07">вчера в 11:07</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/domclick/blog/575686/" class="tm-article-title__link"><span>Когда сделаете доработку?</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 47: ↑46 и ↓1</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 47: ↑46 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+45</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">5.3K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    43
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/domclick/blog/575686/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      10
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-28T11:02:14.000Z" title="2021-09-28, 14:02">вчера в 14:02</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/580240/" class="tm-article-title__link"><span>SQLite-песочница в браузере</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 38: ↑38 и ↓0</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 38: ↑38 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+38</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">2.7K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    56
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/580240/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      1
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li> <!----></ul></div> <!----></section> <!----> <!----></div></div></div> <div class="tm-page__sidebar"><div hl="ru" id="101818" class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/101818/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/101818/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"101818":{"id":"101818","timePublished":"2010-08-16T13:53:40+00:00","isCorporative":false,"lang":"ru","titleHtml":"Декартово дерево: Часть 1. Описание, операции, применения","leadData":{"textHtml":"\u003Ch4\u003EОглавление (на данный момент)\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\n\u003Cb\u003EЧасть 1. Описание, операции, применения.\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fpost\u002F102006\u002F\"\u003EЧасть 2. Ценная информация в дереве и множественные операции с ней.\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fpost\u002F102364\u002F\"\u003EЧасть 3. Декартово дерево по неявному ключу.\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cem\u003ETo be continued...\u003C\u002Fem\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003EДекартово дерево\u003C\u002Fstrong\u003E (cartesian tree, treap) — красивая и легко реализующаяся структура данных, которая с минимальными усилиями позволит вам производить многие скоростные операции над массивами ваших данных. Что характерно, на Хабрахабре единственное его упоминание я нашел в \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fpost\u002F66926\u002F\"\u003Eобзорном посте\u003C\u002Fa\u003E многоуважаемого \u003Ca href=\"https:\u002F\u002Fhabrahabr.ru\u002Fusers\u002Fwinger\u002F\" class=\"user_link\"\u003Ewinger\u003C\u002Fa\u003E, но тогда продолжение тому циклу так и не последовало. Обидно, кстати.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЯ постараюсь покрыть все, что мне известно по теме — несмотря на то, что известно мне сравнительно не так уж много, материала вполне хватит поста на два, а то и на три. Все алгоритмы иллюстрируются исходниками на C# (а так как я любитель функционального программирования, то где-нибудь в послесловии речь зайдет и о F# — но это читать не обязательно :). Итак, приступим.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EВведение\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nВ качестве введения рекомендую прочесть \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fpost\u002F65617\u002F\"\u003Eпост про двоичные деревья поиска\u003C\u002Fa\u003E того же \u003Ca href=\"https:\u002F\u002Fhabrahabr.ru\u002Fusers\u002Fwinger\u002F\" class=\"user_link\"\u003Ewinger\u003C\u002Fa\u003E, поскольку без понимания того, что такое дерево, дерево поиска, а так же без знания \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fpost\u002F78728\u002F\"\u003Eоценок сложности алгоритма\u003C\u002Fa\u003E многое из материала данной статьи останется для вас китайской грамотой. Обидно, правда?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСледующий пункт нашей обязательной программы — \u003Cstrong\u003Eкуча\u003C\u002Fstrong\u003E (heap). Думаю, также многим известная структура данных, однако краткий обзор я все же приведу.\u003Cbr\u002F\u003E\r\nПредставьте себе двоичное дерево с какими-то данными (ключами) в вершинах. И для каждой вершины мы в обязательном порядке требуем следующее: ее ключ строго больше, чем ключи ее непосредственных сыновей. Вот небольшой пример корректной кучи:\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fstorage\u002Fhabraeffect\u002Ff4\u002F8e\u002Ff48e012bd2babdc5d90dd98fd7b880b6.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003EНа заметку сразу скажу, что совершенно не обязательно думать про кучу исключительно как структуру, у которой родитель \u003Cem\u003Eбольше\u003C\u002Fem\u003E, чем его потомки. Никто не запрещает взять противоположный вариант и считать, что родитель \u003Cem\u003Eменьше\u003C\u002Fem\u003E потомков — главное, выберите что-то одно для всего дерева. Для нужд этой статьи гораздо удобнее будет использовать вариант со знаком «больше».\u003Cbr\u002F\u003E\r\n\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nСейчас за кадром остается вопрос, каким образом в кучу можно добавлять и удалять из нее элементы. Во-первых, эти алгоритмы требуют отдельного места на осмотр, а во-вторых, нам они все равно не понадобятся.\u003Cbr\u002F\u003E\r\n","imageUrl":null,"buttonTextHtml":"А теперь собственно про декартово дерево","image":null},"editorVersion":"1.0","postType":"article","postLabels":[],"author":{"scoreStats":{"score":279.2,"votesCount":369},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"49109","alias":"Skiminok","fullname":"Александр Полозов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd23\u002Fed4\u002F4cf\u002Fd23ed44cf8d9f76e24a0a2a39616553a.jpg","speciality":null},"statistics":{"commentsCount":30,"favoritesCount":571,"readingCount":123179,"score":156,"votesCount":166},"hubs":[{"relatedData":null,"id":"8000","alias":"algorithms","type":"collective","title":"Алгоритмы","titleHtml":"Алгоритмы","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Ch4\u003EОглавление (на данный момент)\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\n\u003Cb\u003EЧасть 1. Описание, операции, применения.\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fpost\u002F102006\u002F\"\u003EЧасть 2. Ценная информация в дереве и множественные операции с ней.\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fpost\u002F102364\u002F\"\u003EЧасть 3. Декартово дерево по неявному ключу.\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cem\u003ETo be continued...\u003C\u002Fem\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003EДекартово дерево\u003C\u002Fstrong\u003E (cartesian tree, treap) — красивая и легко реализующаяся структура данных, которая с минимальными усилиями позволит вам производить многие скоростные операции над массивами ваших данных. Что характерно, на Хабрахабре единственное его упоминание я нашел в \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fpost\u002F66926\u002F\"\u003Eобзорном посте\u003C\u002Fa\u003E многоуважаемого \u003Ca href=\"https:\u002F\u002Fhabrahabr.ru\u002Fusers\u002Fwinger\u002F\" class=\"user_link\"\u003Ewinger\u003C\u002Fa\u003E, но тогда продолжение тому циклу так и не последовало. Обидно, кстати.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЯ постараюсь покрыть все, что мне известно по теме — несмотря на то, что известно мне сравнительно не так уж много, материала вполне хватит поста на два, а то и на три. Все алгоритмы иллюстрируются исходниками на C# (а так как я любитель функционального программирования, то где-нибудь в послесловии речь зайдет и о F# — но это читать не обязательно :). Итак, приступим.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EВведение\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nВ качестве введения рекомендую прочесть \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fpost\u002F65617\u002F\"\u003Eпост про двоичные деревья поиска\u003C\u002Fa\u003E того же \u003Ca href=\"https:\u002F\u002Fhabrahabr.ru\u002Fusers\u002Fwinger\u002F\" class=\"user_link\"\u003Ewinger\u003C\u002Fa\u003E, поскольку без понимания того, что такое дерево, дерево поиска, а так же без знания \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fpost\u002F78728\u002F\"\u003Eоценок сложности алгоритма\u003C\u002Fa\u003E многое из материала данной статьи останется для вас китайской грамотой. Обидно, правда?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСледующий пункт нашей обязательной программы — \u003Cstrong\u003Eкуча\u003C\u002Fstrong\u003E (heap). Думаю, также многим известная структура данных, однако краткий обзор я все же приведу.\u003Cbr\u002F\u003E\r\nПредставьте себе двоичное дерево с какими-то данными (ключами) в вершинах. И для каждой вершины мы в обязательном порядке требуем следующее: ее ключ строго больше, чем ключи ее непосредственных сыновей. Вот небольшой пример корректной кучи:\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fstorage\u002Fhabraeffect\u002Ff4\u002F8e\u002Ff48e012bd2babdc5d90dd98fd7b880b6.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003EНа заметку сразу скажу, что совершенно не обязательно думать про кучу исключительно как структуру, у которой родитель \u003Cem\u003Eбольше\u003C\u002Fem\u003E, чем его потомки. Никто не запрещает взять противоположный вариант и считать, что родитель \u003Cem\u003Eменьше\u003C\u002Fem\u003E потомков — главное, выберите что-то одно для всего дерева. Для нужд этой статьи гораздо удобнее будет использовать вариант со знаком «больше».\u003Cbr\u002F\u003E\r\n\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nСейчас за кадром остается вопрос, каким образом в кучу можно добавлять и удалять из нее элементы. Во-первых, эти алгоритмы требуют отдельного места на осмотр, а во-вторых, нам они все равно не понадобятся.\u003Cbr\u002F\u003E\r\n\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EПроблемы\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nКогда речь заходит о деревьях поиска (вы же уже прочитали рекомендуемую статью, правда?), основной вопрос, который ставится перед структурой — скорость выполнения операций, вне зависимости от данных, хранящихся в ней, и последовательности их поступления. Так, двоичное дерево поиска дает гарантию, что поиск конкретного ключа в этом дереве будет выполняться за O(H), где \u003Cstrong\u003EH\u003C\u002Fstrong\u003E — высота дерева. Но какой может быть эта высота — черт его знает. При неблагоприятных обстоятельствах высота дерева легко может стать \u003Cstrong\u003EN\u003C\u002Fstrong\u003E (количество элементов в нем), и тогда дерево поиска вырождается в обычный список — и зачем оно тогда нужно? Для достижения такой ситуации достаточно добавлять в дерево поиска элементы от 1 до N в очереди возрастания — при стандартном алгоритме добавления в дерево получим следующую картинку:\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fstorage\u002Fhabraeffect\u002F2c\u002Ff5\u002F2cf582dd0b73a4015d084a8587e27f7e.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\nБыло придумано огромное количество так называемых сбалансированных деревьев поиска — грубо говоря, тех, в которых по мере существования дерева при каждой операции над ним поддерживается оптимальность максимальной глубины дерева. Оптимальная глубина имеет порядок O(log\u003Csub\u003E2\u003C\u002Fsub\u003E N) — тогда тот же порядок имеет время выполнения каждого поиска в дереве. Структур данных, поддерживающих такую глубину, много, самые известные тут красно-черное дерево или AВЛ-дерево. Их отличительная черта в большинстве — трудная реализация, основанная на размере чертовой кучи случаев, в которых можно и запутаться. Своей же простотой и красотой выгодно отличается, наоборот, декартово дерево, и даже дает нам в некотором роде то самое желанное логарифмическое время, но лишь с достаточно высокой вероятностью… впрочем, о таких деталях и тонкостях позже.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EОпределение\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nИтак у нас есть данные дерева — ключи \u003Cb\u003Ex\u003C\u002Fb\u003E (здесь и далее предполагается, что ключ и является той самой информацией, которую мы храним в дереве; когда впоследствии потребуется отделять по смыслу пользовательскую информацию от ключей, я скажу особо). Давайте добавим к ним еще один параметр в пару — \u003Cb\u003Ey\u003C\u002Fb\u003E, и назовем его \u003Cem\u003Eприоритетом\u003C\u002Fem\u003E. Теперь построим такое волшебное дерево, которое хранит в каждой вершине по два параметра, и при этом \u003Ci\u003Eпо ключам является деревом поиска, а по приоритетам — кучей\u003C\u002Fi\u003E. Такое дерево и будем далее называть декартовым.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003EКстати говоря: в англоязычной литературе очень популярно название \u003Cem\u003Etreap\u003C\u002Fem\u003E, которое наглядно показывает суть структуры: tree + heap. В русскоязычной же иногда можно встретить составленные по такому же принципу: \u003Cem\u003Eдерамида\u003C\u002Fem\u003E (дерево + пирамида) или \u003Cem\u003Eдуча\u003C\u002Fem\u003E (дерево + куча).\u003Cbr\u002F\u003E\r\n\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nПочему дерево называется декартовым? Это сразу станет ясно, как только мы попробуем его нарисовать. Возьмем какой-нибудь набор пар «ключ-приоритет» и расставим на координатной сетке соответствующие точки (x, y). А потом соединим соответствующие вершины линиями, образуя дерево. Таким образом, декартово дерево отлично укладывается на плоскости благодаря своим ограничениям, а два его основных параметра — ключ и приоритет — в некотором смысле, координаты. Результат построения показан на рисунке: слева в стандартной нотации дерева, справа — на декартовой плоскости.\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fstorage\u002Fhabraeffect\u002Fa1\u002F0a\u002Fa10a744def8f325a1019502ecc175ef6.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПока что не очень понятно, зачем такое нужно. А разгадка проста, и кроется она в следующих утверждениях. Во-первых, пусть дано множество ключей: корректных деревьев поиска из них можно построить много различных, в том числе и спископодобное. А вот после добавления к ним приоритетов дерево из данных ключей можно построить уже лишь одно-единственное, вне зависимости от порядка поступления ключей. Это довольно очевидно.\u003Cbr\u002F\u003E\r\nА во-вторых, давайте теперь сделаем наши приоритеты случайными. То есть просто ассоциируем с каждым ключом случайное число из достаточно большого диапазона, и именно оно и будет служить соответствующим игреком. Тогда полученное декартово дерево с очень высокой, стремящейся к 100% вероятностью, будет иметь высоту, не превосходящую 4 log\u003Csub\u003E2\u003C\u002Fsub\u003E N. (Оставлю этот факт здесь без доказательства.) А значит, хоть оно может и не быть идеально сбалансированным, время поиска ключа в таком дереве все равно будет порядка O(log\u003Csub\u003E2\u003C\u002Fsub\u003E N), чего мы, собственно, и добивались.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003EЕще один интересный подход — не делать приоритеты случайными, а вспомнить о том, что у нас есть огромное количество какой-то дополнительной пользовательской информации, которую, как правило, приходится хранить в вершинах дерева. Если есть основания считать, что эта информация по сути своей достаточно случайна (день рождения пользователя, к примеру), то можно попробовать ее использовать в корыстных целях. Взять в качестве приоритета либо непосредственно информацию, либо результат какой-то функции от нее (только тогда функция должна быть обратима, чтобы восстанавливать при необходимости информацию из приоритетов). Впрочем, тут действовать приходится на свой страх и риск — если дерево через какое-то время сильно разбалансируется и вся программа начнет ощутимо тормозить, придется срочно мудрить что-нибудь во спасение ситуации.\u003Cbr\u002F\u003E\r\n\u003C\u002Fblockquote\u003E\u003Cblockquote\u003EДалее для простоты изложения предположим, что все ключи и все приоритеты в деревьях различны. На самом деле возможность равенства ключей не создает никаких особых проблем, вам просто нужно четко определиться, где будут находиться элементы, равные данному x — либо \u003Cem\u003Eтолько\u003C\u002Fem\u003E в левом его поддереве, либо \u003Cem\u003Eтолько\u003C\u002Fem\u003E в правом. Равенство приоритетов по идее тоже не составляет особой проблемы, кроме загрязнения доказательств и рассуждений особыми случаями, но на практике лучше его избегать. Случайная генерация целых приоритетов вполне подходит в большинстве случаев, вещественных между 0 и 1 — почти во всех случаях.\u003Cbr\u002F\u003E\r\n\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nПеред началом рассказа об операциях приведу заготовку класса C#, который будет реализовывать наше декартово дерево.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Cpre\u003E\u003Ccode class=\"cs\"\u003Epublic class Treap\n{\n    public int x;\n    public int y;\n\n    public Treap Left;\n    public Treap Right;    \n\n    private Treap(int x, int y, Treap left = null, Treap right = null)\n    {\n        this.x = x;\n        this.y = y;\n        this.Left = left;\n        this.Right = right;\n    }\n    \n    \u002F\u002F здесь будут операции...\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003EЯ сделал для простоты изложения x и y типа \u003Ccode\u003Eint\u003C\u002Fcode\u003E, но понятно, что на их месте мог бы быть любой тип, экземпляры которого мы умеем сравнивать между собой — то есть любой, реализующий \u003Ccode\u003EIComparable \u003C\u002Fcode\u003Eили \u003Ccode\u003EIComparable&lt;T\u003E\u003C\u002Fcode\u003E в терминах C#. В Haskell это мог бы быть любой тип из класса \u003Ccode\u003EOrd\u003C\u002Fcode\u003E, в F# — любой с ограничениями на оператор сравнения, в Java — реализующий интерфейс \u003Ccode\u003EComparable&lt;T1\u003E\u003C\u002Fcode\u003E, и так далее.\u003Cbr\u002F\u003E\r\n\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EМагия клея и ножниц\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nНа повестке дня насущные вопросы — как работать с декартовым деревом. Вопрос о том, как же его вообще строить из сырого набора ключей, я немного отложу, а пока что предположим, что какая-то добрая душа начальное дерево нам уже построила, и теперь нам требуется его по необходимости менять.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВся подноготная работы с декартовым деревом заключается в двух основных операциях: \u003Cstrong\u003EMerge\u003C\u002Fstrong\u003E и \u003Cstrong\u003ESplit\u003C\u002Fstrong\u003E. С помощью них элементарно выражаются все остальные популярные операции, так что начнем с основ.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОперация Merge принимает на вход два декартовых дерева \u003Cstrong\u003EL\u003C\u002Fstrong\u003E и \u003Cstrong\u003ER\u003C\u002Fstrong\u003E. От нее требуется слить их в одно, тоже корректное, декартово дерево \u003Cstrong\u003ET\u003C\u002Fstrong\u003E. Следует заметить, что работать операция Merge может не с любыми парами деревьев, а только с теми, у которых все ключи одного дерева ( L ) не превышают ключей второго ( R ). (Обратите особое внимание на это условие — оно нам еще не раз пригодится в будущем!)\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fstorage\u002Fhabraeffect\u002F28\u002F2e\u002F282eb999908e6a2102d654a685f6483a.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nАлгоритм работы Merge очень прост. Какой элемент станет корнем будущего дерева? Очевидно, с наибольшим приоритетом. Кандидатов на максимальный приоритет у нас два — только корни двух исходных деревьев. Сравним их приоритеты; пускай для однозначности приоритет y левого корня больше, а ключ в нем равен x. Новый корень определен, теперь стоит подумать, какие же элементы окажутся в его правом поддереве, а какие — в левом.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЛегко понять, что все дерево R окажется в правом поддереве нового корня, ведь ключи-то у него больше x по условию. Точно так же левое поддерево старого корня L.Left имеет все ключи, меньшие x, и должно остаться левым поддеревом, а правое поддерево L.Right… а вот правое должно по тем же соображениям оказаться справа, однако неясно, куда тогда ставить его элементы, а куда элементы дерева R?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСтоп, почему неясно? У нас есть два дерева, ключи в одном меньше ключей в другом, и нам нужно их как-то объединить и полученный результат привесить к новому корню как правое поддерево. Просто рекурсивно вызываем Merge для L.Right и дерева R, и возвращенное ею дерево используем как новое правое поддерево. Результат налицо.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа рисунке синим цветом показано правое поддерево результирующего дерева после операции Merge и связь от нового корня к этому поддереву.\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fstorage\u002Fhabraeffect\u002Fa9\u002F8f\u002Fa98f52fd388745ea9be4b4681f780880.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\nСимметричный случай — когда приоритет в корне дерева R выше — разбирается аналогично. И, конечно, надо не забыть про основу рекурсии, которая в нашем случае наступает, если какое-то из деревьев L и R, или сразу оба, являются пустыми.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nИсходный код Merge:\u003Cblockquote\u003E\u003Cpre\u003E\u003Ccode class=\"cs\"\u003Epublic static Treap Merge(Treap L, Treap R)\n{\n    if (L == null) return R;\n    if (R == null) return L;\n\n    if (L.y \u003E R.y)\n    {\n        var newR = Merge(L.Right, R);\n        return new Treap(L.x, L.y, L.Left, newR);\n    }\n    else\n    {\n        var newL = Merge(L, R.Left);\n        return new Treap(R.x, R.y, newL, R.Right);\n    }\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТеперь об операции Split. На вход ей поступает корректное декартово дерево T и некий ключ \u003Cstrong\u003Ex\u003Csub\u003E0\u003C\u002Fsub\u003E\u003C\u002Fstrong\u003E. Задача операции — разделить дерево на два так, чтобы в одном из них ( L ) оказались все элементы исходного дерева с ключами, меньшими x\u003Csub\u003E0\u003C\u002Fsub\u003E, а в другом ( R ) — с большими. Никаких особых ограничений на дерево не накладывается.\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fstorage\u002Fhabraeffect\u002F4c\u002Fbd\u002F4cbde2feb466d25a36d4296ffb745450.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nРассуждаем похожим образом. Где окажется корень дерева T? Если его ключ меньше x\u003Csub\u003E0\u003C\u002Fsub\u003E, то в L, иначе в R. Опять-таки, предположим для однозначности, что ключ корня оказался меньше x\u003Csub\u003E0\u003C\u002Fsub\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТогда можно сразу сказать, что все элементы левого поддерева T также окажутся в L — их ключи ведь тоже все будут меньше x\u003Csub\u003E0\u003C\u002Fsub\u003E. Более того, корень T будет и корнем L, поскольку его приоритет наибольший во всем дереве. Левое поддерево корня полностью сохранится без изменений, а вот правое уменьшится — из него придется убрать элементы с ключами, большими x\u003Csub\u003E0\u003C\u002Fsub\u003E, и вынести в дерево R. А остаток ключей сохранить как новое правое поддерево L. Снова видим идентичную задачу, снова напрашивается рекурсия!\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВозьмем правое поддерево и рекурсивно разрежем его по тому же ключу x\u003Csub\u003E0\u003C\u002Fsub\u003E на два дерева L' и R'. После чего становится ясно, что L' станет новым правым поддеревом дерева L, а R' и есть непосредственно дерево R — оно состоит из тех и только тех элементов, которые больше x\u003Csub\u003E0\u003C\u002Fsub\u003E.\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fstorage\u002Fhabraeffect\u002F35\u002F27\u002F35277f3277ac1bf837b7735f18066f58.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\nСимметричный случай, при котором ключ корня больше, чем x\u003Csub\u003E0\u003C\u002Fsub\u003E, тоже совершенно идентичен. Основа рекурсии здесь — случаи, когда какое-то из поддеревьев пустое. Ну и исходный код функции:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Cpre\u003E\u003Ccode class=\"cs\"\u003Epublic void Split(int x, out Treap L, out Treap R)\n{\n    Treap newTree = null;\n    if (this.x &lt;= x)\n    {\n        if (Right == null)\n            R = null;\n        else\n            Right.Split(x, out newTree, out R);\n        L = new Treap(this.x, y, Left, newTree);\n    }\n    else\n    {\n        if (Left == null)\n            L = null;\n        else\n            Left.Split(x, out L, out newTree);\n        R = new Treap(this.x, y, newTree, Right);\n    }\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nКстати, обратите внимание: деревья, выдаваемые на выход операцией Split, подходят как входные данные для операции Merge: все ключи левого дерева не превосходят ключей в правом. Это ценное обстоятельство пригодится нам уже через несколько абзацев.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПоследний вопрос — это время работы Merge и Split. Из описания алгоритма видно, что Merge за каждую итерацию рекурсии уменьшает суммарную высоту двух сливаемых деревьев как минимум на единицу, так что общее время работы не превосходит 2H, то есть O(H). А со Split все совсем просто — мы работаем с единственным деревом, его высота уменьшается с каждой итерацией тоже как минимум на единицу, и ассимптотика работы операции тоже O(H). А поскольку декартово дерево со случайными приоритетами, как уже говорилось, с высокой вероятностью имеет близкую к логарифмической высоту, то Merge и Split работают за желаемый O(log\u003Csub\u003E2\u003C\u002Fsub\u003E N), и это дает нам потрясающий простор для их применения.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EОперации с деревом\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nТеперь, когда мы с вами в совершенстве владеем клеем и ножницами, не составляет совершенно никакого труда только с помощью них реализовать самые необходимые действия с декартовым деревом: добавление элемента в дерево и удаление его. Я приведу самый простой вариант их реализации, основанный \u003Cem\u003Eцеликом\u003C\u002Fem\u003E на Merge и Split. Он будет работать за все то же логарифмическое время, однако отличаться, как говорят ACM-олимпийцы, большей константой: то есть порядок зависимости времени работы от размера дерева будет все так же O(log\u003Csub\u003E2\u003C\u002Fsub\u003E N), но \u003Cem\u003Eточное\u003C\u002Fem\u003E время работы отличаться в несколько раз — в константу раз. Скажем, 4 log\u003Csub\u003E2\u003C\u002Fsub\u003E N против просто log\u003Csub\u003E2\u003C\u002Fsub\u003E N. На практике это различие почти не ощущается, пока размер дерева не достигнет поистине галактических размеров.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003EСуществуют и оптимальные реализации как добавления с удалением, так и прочих нужных операций дерамиды, константа у которых значительно меньше. Я обязательно приведу эти реализации в одной из следующих частей цикла, а также поговорю о подводных камнях, связанных с использованием более быстрого варианта. Подводные камни в первую очередь связаны с необходимостью поддержки дополнительных запросов к дереву и хранению в нем особой информации… впрочем, не буду сейчас забивать этим голову читателю, до множественных операций с деревом (чрезвычайно важной фичи!) время еще дойдет.\u003Cbr\u002F\u003E\r\n\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nИтак, пускай нам дано декартово дерево и некий элемент \u003Cstrong\u003Ex\u003C\u002Fstrong\u003E, который требуется в него вставить (как мы помним, в контексте статьи предполагается, что все элементы различны и икса в дереве еще нет). Хочется применить подход из двоичного дерева поиска: идти вниз по ключам, выбирая каждый раз путь влево или вправо, пока не найдем место, куда можно вставить наш x, и дописать его. Но это решение неправильное, ведь мы забыли о приоритетах. Место, куда алгоритм дерева поиска захочет добавить новую вершину, однозначно удовлетворяет ограничениям дерева поиска по x, однако может нарушить ограничение кучи по y. Значит, придется действовать немного выше и абстрактней. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВторой вариант решения — представить новый ключ как дерево из единственной вершины (со случайным приоритетом y), и слить его с исходным с помощью Merge. Это опять неверно: в исходном дереве могут быть вершины с ключами, большими x, и тогда мы нарушаем обещание, данное функции Merge касательно взаимоотношения между ее входными деревьями.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПроблему можно исправить. Помня универсальность операций Split\u002FMerge, решение напрашивается практически сразу:\u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003EРазделим (split) дерево по ключу x на дерево L, с ключами меньше икса, и дерево R, с большими.\u003C\u002Fli\u003E\r\n\u003Cli\u003EСоздадим из данного ключа дерево M из единственной вершины (x, y), где y — только что сгенерированный случайный приоритет.\u003C\u002Fli\u003E\r\n\u003Cli\u003EОбъединим (merge) по очереди L с M, то что получилось — с R.\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003EВсе шаги алгоритма можно и проиллюстрировать.\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fstorage\u002Fhabraeffect\u002Fd5\u002F91\u002Fd591771892a5cf1fa80e71a91610e71f.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\nУ нас тут 1 применение Split, и 2 применения Merge — общее время работы O(log\u003Csub\u003E2\u003C\u002Fsub\u003E N). Короткий исходный код прилагается.\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Cpre\u003E\u003Ccode class=\"cs\"\u003Epublic Treap Add(int x)\n{\n    Treap l, r;\n    Split(x, out l, out r);\n    Treap m = new Treap(x, rand.Next());\n    return Merge(Merge(l, m), r);\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nС удалением тоже не возникает никаких вопросов. Пускай нас просят удалить из декартова дерева элемент с ключем x. Сейчас я предполагаю, что вы разобрались с равенством ключей, отдав преимущество левой стороне: в правом поддереве вершины с ключем x другие элементы с тем же ключем не встречаются, а вот в левом могут. Тогда совершим следующую последовательность действий:\u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003EРазделим сначала дерево по ключу x-1. Все элементы, меньшие либо равные x-1, отправились в левый результат, значит, искомый элемент — в правом.\u003C\u002Fli\u003E\r\n\u003Cli\u003EРазделим правый результат по ключу x (здесь стоит быть аккуратным с равенством!). В новый правый результат отправились все элементы с ключами, большими x, а в «средний» (левый от правого) — все меньшие либо равные x. Но поскольку строго меньшие после первого шага все были отсеяны, то среднее дерево и есть искомый элемент.\u003C\u002Fli\u003E\r\n\u003Cli\u003EТеперь просто объединим снова левое дерево с правым, без среднего, и дерамида осталась без ключей x.\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\r\nТеперь понятно, почему я постоянно акцентировал внимание на том, как же все-таки необходимо учитывать равенство ключей. Скажем, если бы ваш компаратор считал, что элементы с равными ключами надо отправлять в правое поддерево, то на первом шаге вам пришлось бы делить по ключу x, а на втором — по x+1. А вот если бы конкретики в этом вопросе вообще не было, то процедура удаления в данном варианте вообще могла бы и не выполнить желаемое — после второго шага в качестве среднего дерева останется пустое, а искомый элемент куда-то ускользнул, либо влево, либо вправо, и ищи его теперь.\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fstorage\u002Fhabraeffect\u002Fb7\u002F25\u002Fb72500a639cd03ed366994f2dbb44f05.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\nВремя работы операции все так же O(log\u003Csub\u003E2\u003C\u002Fsub\u003E N), поскольку мы применили 2 раза Split и 1 раз Merge.\u003Cbr\u002F\u003E\r\nИсходный код:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Cpre\u003E\u003Ccode class=\"cs\"\u003Epublic Treap Remove(int x)\n{\n    Treap l, m, r;\n    Split(x - 1, out l, out r);\n    r.Split(x, out m, out r);\n    return Merge(l, r);\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EАкт творения\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nТеперь, зная алгоритм добавления элемента в готовое декартово дерево, мы можем привести простейший способ построить дерево из поступающего набора ключей: просто добавлять их по очереди стандартным алгоритмом, начав с дерева из одной вершины — первого ключа. Помня, что операция добавления выполняется за логарифмическое время, мы получим общее время выполнения полного построения дерева — O(N log\u003Csub\u003E2\u003C\u002Fsub\u003E N).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nИнтересно, а быстрее можно?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nКак оказалось, в некоторых случаях — да. Давайте представим, что ключи нам на вход поступают в возрастающем порядке. Такое в принципе вполне может произойти, если это какие-то свежесоздающиеся идентификаторы с auto increment. Так вот, в таком случае существует несложный алгоритм построения дерева за O(N). Правда, нам придется заплатить за это временным overhead`ом по памяти: хранить для каждой вершины строящегося дерева ссылку на ее предка (на самом деле даже не обязательно для каждой, но это уже тонкости).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nБудем хранить ссылку на последнюю добавленную вершину в дереве. По совместимости она будет в нем самой правой — ведь ключ у нее наибольший из всех ключей дерева, построенного на данный момент. Теперь допустим, что на вход поступает следующий ключ \u003Cstrong\u003Ex\u003C\u002Fstrong\u003E с каким-то приоритетом \u003Cstrong\u003Ey\u003C\u002Fstrong\u003E. Куда его поместить?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПоследняя вершина суть самая правая, следовательно, правого сына у нее нет. Если ее приоритет больше, чем y добавляемой, то можно просто приписать новую вершину правым сыном и с чистой совестью переходить к следующему ключу на входе. В противном же случае надо подумать. У новой вершины все равно наибольший ключ, так что в конечном итоге она точно станет самой правой вершиной дерева. Стало быть, искать место для ее вставки где-либо, кроме как по самой правой ветви, смысла не имеет. Найти же нам нужно всего лишь место, где приоритет вершины больше, чем y. Итак, поднимемся от самой правой вверх по ветви, каждый раз проверяя приоритет текущей осматриваемой вершины. В конце концов мы либо придем в корень, либо остановимся где-то посреди ветви.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПредположим, мы пришли в корень. Тогда оказывается, что y больше, чем все приоритеты в дереве. У нас не остается другого выбора, кроме как сделать (x, y) новым корнем и привесить к ней старое дерево левым сыном.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли же в корень мы не пришли — ситуация похожая. В некоторой вершине правой ветви (x\u003Csub\u003E0\u003C\u002Fsub\u003E, y\u003Csub\u003E0\u003C\u002Fsub\u003E) имеем \u003Cnobr\u003Ey\u003Csub\u003E0\u003C\u002Fsub\u003E \u003E y\u003C\u002Fnobr\u003E. А у ее непосредственного правого потомка приоритет меньше y. Чтобы сохранить структуру дерева поиска по ключам, и сделать (x, y) самой правой в дереве, мы подвешиваем её как нового правого сына к \u003Cnobr\u003E(x\u003Csub\u003E0\u003C\u002Fsub\u003E, y\u003Csub\u003E0\u003C\u002Fsub\u003E)\u003C\u002Fnobr\u003E, а все старое правое поддерево становится левым поддеревом (x, y).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЧтобы было понятнее, я проиллюстрирую на примерах. Возьмем некоторое декартово дерево и покажем, что произойдет, если в него пытаться добавлять те или иные вершины. Ключ везде тот же (22), а приоритет поварьируем.\u003Cbr\u002F\u003E\r\ny = 4:\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fstorage\u002Fhabraeffect\u002Fd4\u002F14\u002Fd414a774067989e32d38caa3fc2c9273.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\ny = 16:\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fstorage\u002Fhabraeffect\u002Fc4\u002Fdc\u002Fc4dc34aa95aa3d188896b92e8c4de1a5.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\ny = 11:\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fstorage\u002Fhabraeffect\u002Faf\u002F92\u002Faf92745b00f14d074aadb1de242011d9.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПочему этот алгоритм работает за O(N)? Заметьте, что каждую вершину дерева вы в ее жизни посетите максимум два раза:\u003Cul\u003E\r\n\u003Cli\u003Eпри ее непосредственном добавлении;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eвозможно, при добавлении какой-то другой, пока она будет оставаться в правой ветви. Сразу после этого из правой ветви она уйдет и более посещаться не будет.\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003EТаким образом, общее количество переходов не превосходит 2N, и ассимптотика построения — O(N).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа закуску — исходный код построения по заданному массиву ключей и приоритетов. Здесь предполагается, что у каждой вершины дерева есть еще свойство \u003Ccode\u003EParent\u003C\u002Fcode\u003E, а также что опциональный параметр с таким же именем есть у уже использовавшегося приватного конструктора вершины (пятый по счету).\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Cpre\u003E\u003Ccode class=\"cs\"\u003Epublic static Treap Build(int[] xs, int[] ys)\n{\n    Debug.Assert(xs.Length == ys.Length);\n\n    var tree = new Treap(xs[0], ys[0]);\n    var last = tree;\n\n    for (int i = 1; i &lt; xs.Length; ++i)\n    {\n        if (last.y \u003E ys[i])\n        {\n            last.Right = new Treap(xs[i], ys[i], parent: last);\n            last = last.Right;\n        }\n        else\n        {\n            Treap cur = last;\n            while (cur.Parent != null &amp;&amp; cur.y &lt;= ys[i])\n                cur = cur.Parent;\n            if (cur.y &lt;= ys[i])\n                last = new Treap(xs[i], ys[i], cur);\n            else\n            {\n                last = new Treap(xs[i], ys[i], cur.Right, null, cur);\n                cur.Right = last;\n            }\n        }\n    }\n\n    while (last.Parent != null)\n        last = last.Parent;\n    return last;\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EРезюме\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nМы с вами построили древовидную структуру данных с такими свойствами:\u003Cul\u003E\r\n\u003Cli\u003Eобладает почти гарантированно логарифмической высотой относительно количества своих вершин;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eпозволяет за логарифмическое время искать любой ключ в дереве, добавлять его и удалять;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eисходный код всех её методов не превышает 20 строк, они легко понимаются и в них крайне сложно ошибиться\u003C\u002Fli\u003E\r\n\u003Cli\u003Eсодержит некоторый overhead по памяти, сравнительно с истинно самобалансирующимися деревьями, на хранение приоритетов.\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\nВ принципе, результат довольно-таки мощный. Однако некоторым может быть все же неясно, стоило ли ради него городить настолько большой огород с такой кучей текста. Стоило. Фишка в том, что возможности декартового дерева и потенциал его применения далеко не ограничиваются функциями, описанными в этой статье. Это лишь предисловие.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ следующих частях:\u003Col\u003E\r\n\u003Cli\u003EМножественные операции над декартовым деревом (ищем за O(log\u003Csub\u003E2\u003C\u002Fsub\u003E N) сумму, максимум и т.д.)\u003C\u002Fli\u003E\r\n\u003Cli\u003EДекартово дерево по неявному ключу (или как усовершенствовать обычный массив)\u003C\u002Fli\u003E\r\n\u003Cli\u003EУскоренные реализации функций декартового дерева (и их проблемы)\u003C\u002Fli\u003E\r\n\u003Cli\u003EФункциональная реализация декартового дерева на F#.\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EИсточники\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nИсточники указываю раз и навсегда, они одни и те же для всех планируемых статей.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ первую очередь при написании этих статей я основываюсь на лекции Виталия Гольдштейна, рассказанной на Харьковской зимней школе по программированию ACM ICPC в 2010 году. Ее можно загрузить из видеогалереи \u003Ca href=\"http:\u002F\u002Folimp.sc170.kharkov.ua\u002F\"\u003Eшколы\u003C\u002Fa\u003E (год 2010, день 2), как только она снова заработает, потому что в последние дни сервер что-то катастрофически барахлит.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fe-maxx.ru\"\u003EСайт\u003C\u002Fa\u003E Максима «e-maxx» Иванова — богатый кладезь информации по разным алгоритмам и структурам данных, использующихся в спортивном программировании. В частности, есть на нем и \u003Ca href=\"http:\u002F\u002Fe-maxx.ru\u002Falgo\u002Ftreap\"\u003Eстатья про декартово дерево\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ знаменитой книге Кормен, Лейзерсон, Ривест, Штайн «Алгоритмы: построение и анализ» можно найти доказательство того, что матожидание высоты случайного двоичного дерева поиска есть O(log\u003Csub\u003E2\u003C\u002Fsub\u003E N), хотя его определение случайного дерева поиска и отличается от того, что мы здесь использовали.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВпервые дерамиды были предложены в статье Seidel, Raimund; Aragon, Cecilia R. (1996), \u003Ca href=\"http:\u002F\u002Fpeople.ischool.berkeley.edu\u002F~aragon\u002Fpubs\u002Frst96.pdf\"\u003E«Randomized Search Trees»\u003C\u002Fa\u003E. В принципе там можно найти полный объем информации по теме.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПока что все. Надеюсь, вам было интересно :)\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"декартово дерево"},{"titleHtml":"cartesian tree"},{"titleHtml":"treap"},{"titleHtml":"дерамида"},{"titleHtml":"дуча"},{"titleHtml":"структуры данных"},{"titleHtml":"двоичные деревья"},{"titleHtml":"тег который никто не читает"},{"titleHtml":"бинарные деревья"},{"titleHtml":"сбалансированные деревья"},{"titleHtml":"C"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F101818\u002F222438df02817bc303c66be8989d6870\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F101818\u002F222438df02817bc303c66be8989d6870\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F101818\\\u002F\"},\"headline\":\"Декартово дерево: Часть 1. Описание, операции, применения\",\"datePublished\":\"2010-08-16T17:53:40+04:00\",\"dateModified\":\"2013-07-20T03:30:46+04:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Александр Полозов\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Оглавление (на данный момент) Часть 1. Описание, операции, применения. Часть 2. Ценная информация в дереве и множественные операции с ней. Часть 3. Декартово дер...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F101818\\\u002F#post-content-body\",\"about\":[\"h_algorithms\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fstorage\\\u002Fhabraeffect\\\u002Ff4\\\u002F8e\\\u002Ff48e012bd2babdc5d90dd98fd7b880b6.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fstorage\\\u002Fhabraeffect\\\u002F2c\\\u002Ff5\\\u002F2cf582dd0b73a4015d084a8587e27f7e.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fstorage\\\u002Fhabraeffect\\\u002Fa1\\\u002F0a\\\u002Fa10a744def8f325a1019502ecc175ef6.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fstorage\\\u002Fhabraeffect\\\u002F28\\\u002F2e\\\u002F282eb999908e6a2102d654a685f6483a.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fstorage\\\u002Fhabraeffect\\\u002Fa9\\\u002F8f\\\u002Fa98f52fd388745ea9be4b4681f780880.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fstorage\\\u002Fhabraeffect\\\u002F4c\\\u002Fbd\\\u002F4cbde2feb466d25a36d4296ffb745450.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fstorage\\\u002Fhabraeffect\\\u002F35\\\u002F27\\\u002F35277f3277ac1bf837b7735f18066f58.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fstorage\\\u002Fhabraeffect\\\u002Fd5\\\u002F91\\\u002Fd591771892a5cf1fa80e71a91610e71f.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fstorage\\\u002Fhabraeffect\\\u002Fb7\\\u002F25\\\u002Fb72500a639cd03ed366994f2dbb44f05.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fstorage\\\u002Fhabraeffect\\\u002Fd4\\\u002F14\\\u002Fd414a774067989e32d38caa3fc2c9273.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fstorage\\\u002Fhabraeffect\\\u002Fc4\\\u002Fdc\\\u002Fc4dc34aa95aa3d188896b92e8c4de1a5.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fstorage\\\u002Fhabraeffect\\\u002Faf\\\u002F92\\\u002Faf92745b00f14d074aadb1de242011d9.png\"]}","metaDescription":"Оглавление (на данный момент)\r\nЧасть 1. Описание, операции, применения.\r\nЧасть 2. Ценная информация в дереве и множественные операции с ней.\r\nЧасть 3. Декартово дерево по неявному ключу.\r\nTo be...","mainImageUrl":null,"amp":false},"polls":[],"commentsEnabled":true,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false},"575686":{"id":"575686","timePublished":"2021-09-28T08:07:48+00:00","isCorporative":true,"lang":"ru","titleHtml":"Когда сделаете доработку?","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"1097452","alias":"Turundur","fullname":"Станислав Малышев","avatarUrl":"","speciality":"Разработчик"},"statistics":{"commentsCount":10,"favoritesCount":43,"readingCount":5316,"score":45,"votesCount":47},"hubs":[{"relatedData":null,"id":"22422","alias":"domclick","type":"corporative","title":"Блог компании ДомКлик","titleHtml":"Блог компании ДомКлик","isProfiled":false},{"relatedData":null,"id":"91","alias":"webdev","type":"collective","title":"Разработка веб-сайтов","titleHtml":"Разработка веб-сайтов","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EДовольно часто я попадаю в ситуацию, когда мне нужно в моменте оценить длительность реализации реализации бизнес-фичи. Обычно это какая-нибудь рядовая встреча, на которой инициатор бизнес-идеи, резво размахивая руками в воздухе, рассказывает о своем предложении. В конце своего выступления, в котором часто много слов (но не цифр) сказано о том, зачем это фича нужна и какой эффект она даст, всегда звучит сакральный вопрос: «Когда сделаете эту великолепную доработку?»\u003C\u002Fp\u003E\u003Cp\u003EЯ хотел бы поделиться с читателем ходом своих рассуждений, которые позволяют мне довольно точно оценивать сроки реализации даже в самых запущенных случаях.\u003C\u002Fp\u003E\u003Cp\u003EРазумеется, я не смогу предусмотреть и учесть все нюансы и специфики, принятые в различных компаниях в процессе разработки и вывода новой функциональности в эксплуатацию. Однако я верю, что описанные ниже практики будут полезны и вы сможете их адаптировать под свою ситуацию.\u003C\u002Fp\u003E\u003Cp\u003EСразу упомяну, что речь идет в первую очередь о продуктовых компаниях, где нет жесткого учета рабочего времени и можно подумать о качестве и поддерживаемости новой функциональности. В случае заказной разработки всё обычно гораздо сложнее и требует более детальной проработки.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb36\u002F6f1\u002Fe84\u002Fb366f1e845d886daf41be0f315b7c9a6.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb36\u002F6f1\u002Fe84\u002Fb366f1e845d886daf41be0f315b7c9a6.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"разработка"},{"titleHtml":"оценка"},{"titleHtml":"заказчик"}]},"579778":{"id":"579778","timePublished":"2021-09-28T08:51:05+00:00","isCorporative":true,"lang":"ru","titleHtml":"YARL: как Яндекс построил распределённый Rate Limiter с нулевым влиянием на время ответа сервисов","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"91003","alias":"DenKoren","fullname":"Кореневский Денис","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F1a3\u002F2cd\u002F706\u002F1a32cd706b2d50526638707e3d3cdacc.png","speciality":"Release Engineer"},"statistics":{"commentsCount":14,"favoritesCount":32,"readingCount":3937,"score":47,"votesCount":47},"hubs":[{"relatedData":null,"id":"4991","alias":"yandex","type":"corporative","title":"Блог компании Яндекс","titleHtml":"Блог компании Яндекс","isProfiled":false},{"relatedData":null,"id":"4","alias":"hi","type":"collective","title":"Высокая производительность","titleHtml":"Высокая производительность","isProfiled":true},{"relatedData":null,"id":"7504","alias":"refactoring","type":"collective","title":"Проектирование и рефакторинг","titleHtml":"Проектирование и рефакторинг","isProfiled":true},{"relatedData":null,"id":"8880","alias":"server_side_optimization","type":"collective","title":"Серверная оптимизация","titleHtml":"Серверная оптимизация","isProfiled":true},{"relatedData":null,"id":"17350","alias":"s_admin","type":"collective","title":"Серверное администрирование","titleHtml":"Серверное администрирование","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EYandex Rate Limiter (далее просто YARL) — это сервис лимитирования нагрузки для распределённых сервисов. Его особенность в том, что он способен работать с миллионами квот, имея при этом очень низкие накладные расходы на проверку квоты. Если совсем кратко, это система распределённых \u003Ca href=\"https:\u002F\u002Fwww.wikiwand.com\u002Fen\u002FLeaky_bucket\" rel=\"nofollow noopener noreferrer\"\u003ELeaky Bucket'ов\u003C\u002Fa\u003E, с помощью которых можно ограничивать разные величины, связанные со временем: скорость передачи данных по сети, запросы в секунду и т. п.\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fdg\u002Fte\u002F--\u002Fdgte--d9wm8qyawhplaw4c87mky.jpeg\"\u003E\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003EМеня зовут Денис Кореневский, я работаю в службе разработки внутреннего хранилища Яндекса, и сегодня я расскажу, как YARL устроен внутри, почему мы вообще написали своё решение и с какими трудностями нам пришлось столкнуться в процессе создания. Добро пожаловать под кат.\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"rate limiter"},{"titleHtml":"балансировка нагрузки"}]},"579780":{"id":"579780","timePublished":"2021-09-28T08:46:27+00:00","isCorporative":true,"lang":"ru","titleHtml":"Упала связь, обрыв на линии и при чем тут собака","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2788341","alias":"fregatmf","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":6,"favoritesCount":6,"readingCount":1955,"score":15,"votesCount":17},"hubs":[{"relatedData":null,"id":"5160","alias":"megafon","type":"corporative","title":"Блог компании МегаФон","titleHtml":"Блог компании МегаФон","isProfiled":false},{"relatedData":null,"id":"6398","alias":"it-infrastructure","type":"collective","title":"IT-инфраструктура","titleHtml":"IT-инфраструктура","isProfiled":true},{"relatedData":null,"id":"17201","alias":"wireless","type":"collective","title":"Беспроводные технологии","titleHtml":"Беспроводные технологии","isProfiled":true},{"relatedData":null,"id":"19429","alias":"network_standarts","type":"collective","title":"Стандарты связи","titleHtml":"Стандарты связи","isProfiled":false},{"relatedData":null,"id":"22008","alias":"cellular","type":"collective","title":"Сотовая связь","titleHtml":"Сотовая связь","isProfiled":false}],"flows":[{"id":"6","alias":"admin","title":"Администрирование"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EИнсайты телекома. Легкий и позитивный контент для тех, кому интересно погрузиться в будни инженеров МегаФона и узнать, как работает связь. Почему LTE становится EDGE, когда очень нужно.\u003C\u002Fp\u003E\u003Cp\u003EСпойлер: любишь истории со счастливым концом - дочитай до конца :) \u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc16\u002F434\u002F175\u002Fc16434175e01aaecb6ca80e709c31f3c.jpg","buttonTextHtml":"Читать","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc16\u002F434\u002F175\u002Fc16434175e01aaecb6ca80e709c31f3c.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"волс"},{"titleHtml":"волс проектирование"},{"titleHtml":"связь"},{"titleHtml":"мегафон"},{"titleHtml":"собака"}]},"579814":{"id":"579814","timePublished":"2021-09-28T08:18:35+00:00","isCorporative":true,"lang":"ru","titleHtml":"World of Tanks Blitz — как мы сделали для танков динамическую подвеску","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2793863","alias":"alexbabey","fullname":"Alexander Babey","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Ffbd\u002Fb5f\u002F74d\u002Ffbdb5f74ddb6dab8c23878b6bdfc06ca.jpg","speciality":"Render Developer"},"statistics":{"commentsCount":7,"favoritesCount":14,"readingCount":3417,"score":15,"votesCount":15},"hubs":[{"relatedData":null,"id":"18218","alias":"wargaming","type":"corporative","title":"Блог компании Wargaming","titleHtml":"Блог компании Wargaming","isProfiled":false},{"relatedData":null,"id":"643","alias":"3d_graphics","type":"collective","title":"Работа с 3D-графикой","titleHtml":"Работа с 3D-графикой","isProfiled":true},{"relatedData":null,"id":"21980","alias":"games","type":"collective","title":"Игры и игровые приставки","titleHtml":"Игры и игровые приставки","isProfiled":false}],"flows":[{"id":"2","alias":"design","title":"Дизайн"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EБольшой World of Tanks продолжает активно развиваться — игра часто получает обновления, включая как что-то, связанное с игровым процессом (новые карты и танки, режимы игры и сезонные события, умения экипажа и полевая модернизация), так и что-то чисто техническое. Например, использование новых графических технологий. Если мы говорим о ПК, то здесь есть множество гибких настроек, чтобы и комфортно поиграть с красивой картинкой, и сам ПК при этом не спалить.\u003C\u002Fp\u003E\u003Cp\u003EВ случае с мобильными устройствами все немного сложнее, и апдейты графики проводятся не так часто.&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EВ этом посте рендер-разработчики студии мобильной разработки Wargaming MS-1 Рамиль Кудашев и Александр Бабей расскажут о том, что нового (и красивого) появилось в летнем релизе World of Tanks Blitz.&nbsp;\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EОсторожно, внутри тяжелые гифки.\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F3a7\u002F9aa\u002Fc59\u002F3a79aac597c683f1a440fae3061a2296.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F3a7\u002F9aa\u002Fc59\u002F3a79aac597c683f1a440fae3061a2296.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"mobile games"},{"titleHtml":"wot blitz"},{"titleHtml":"render"},{"titleHtml":"suspension"},{"titleHtml":"pbr"}]},"580034":{"id":"580034","timePublished":"2021-09-28T17:18:57+00:00","isCorporative":false,"lang":"ru","titleHtml":"Пыль, пылевые клещи и их аллергены. Профилактика и защита","editorVersion":"1.0","postType":"article","postLabels":[{"type":"tutorial","data":null}],"author":{"id":"1841275","alias":"steanlab","fullname":"Cергей Бесараб (Siarhei Besarab) EU1AEY","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F2d8\u002Fb91\u002F145\u002F2d8b911451a45b7d469e3eead16f750d.jpg","speciality":"Хабра-химик, турист, авантюрист и радиолюбитель :)"},"statistics":{"commentsCount":25,"favoritesCount":24,"readingCount":3607,"score":23,"votesCount":31},"hubs":[{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"21996","alias":"health","type":"collective","title":"Здоровье","titleHtml":"Здоровье","isProfiled":false},{"relatedData":null,"id":"22010","alias":"Chemistry","type":"collective","title":"Химия","titleHtml":"Химия","isProfiled":false},{"relatedData":null,"id":"22012","alias":"Ecology","type":"collective","title":"Экология","titleHtml":"Экология","isProfiled":false},{"relatedData":null,"id":"22750","alias":"biology","type":"collective","title":"Биология","titleHtml":"Биология","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"Пыль и пылевые клещи в ней есть практически везде и всегда. Уничтожить их удается возможно только в условиях «чистых комнат» на производстве полупроводников. Приходится с этим мириться, и жить допуская, что все что нам под силу — уменьшить их количество. Считается, что если концентрация клещей &lt; 100 штук на грамм пыли — аллергия у большинства не возникает. После того как пришлось пару тройку минут чихать без остановки — у меня накопилось достаточно злобы, чтобы \u003Ca href=\"https:\u002F\u002Ft.me\u002Fjoinchat\u002FAAAAAFFhzPKyiLO85pRxUA\" rel=\"nofollow noopener noreferrer\"\u003Eрассмотреть\u003C\u002Fa\u003E, что же представляет из себя пыль в квартире и что и кто в этой пыли живет. А теперь вот нашлось время, чтобы познакомить с «нашими маленькими друзьями» и читателей Хабра. В заметке рассуждения о некоторых особенностях биологии вездесущего домашнего паразита и методикам его контроля. То, что под катом можешь смело давать почитать жене, %username%!\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fw0\u002F9u\u002Fzv\u002Fw09uzvckqowxlqadjnpx414mf6y.jpeg\"\u003E\u003C\u002Fdiv\u003E\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Дружно скажем НЕТ пыли и ее обитателям","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"пыль"},{"titleHtml":"пыль это"},{"titleHtml":"пыль под микроскопом"},{"titleHtml":"пыль аллергия"},{"titleHtml":"пыль бытовая"},{"titleHtml":"мебельные клещи"},{"titleHtml":"пыль в воздухе"},{"titleHtml":"пыль текстура"},{"titleHtml":"из чего состоит пыль"},{"titleHtml":"пыль откуда берется"},{"titleHtml":"пыль от постельного белья"},{"titleHtml":"пыль обветшания"},{"titleHtml":"пыль размер частиц"},{"titleHtml":"пыль уборка"},{"titleHtml":"пыль химический состав"},{"titleHtml":"пыль что это"},{"titleHtml":"что такое пыль"},{"titleHtml":"откуда берется пыль"},{"titleHtml":"пыль это кожа"},{"titleHtml":"пылевые клещи как избавиться"},{"titleHtml":"пылевые клещи аллергия"},{"titleHtml":"пылевые клещи размер"},{"titleHtml":"где живут пылевые клещи"},{"titleHtml":"пылевые клещи борьба с ними"},{"titleHtml":"пылевые клещи борьба"},{"titleHtml":"пылевые клещи боятся холода"},{"titleHtml":"клещи пылевые"},{"titleHtml":"пылевые клещи в подушках"},{"titleHtml":"в постели"},{"titleHtml":"в матрасе"},{"titleHtml":"в постельном белье"},{"titleHtml":"в мягких игрушках"},{"titleHtml":"в одежде"},{"titleHtml":"в каждом доме"},{"titleHtml":"в диване"},{"titleHtml":"в ковре"},{"titleHtml":"пылевые клещи вред"},{"titleHtml":"пылевые клещи дезинфекция"},{"titleHtml":"пылевые клещи и ультрафиолет"},{"titleHtml":"пылевые клещи избавление"},{"titleHtml":"пыль и пылевые клещи"},{"titleHtml":"пылевые клещи мороз"},{"titleHtml":"пылевые клещи обработка"},{"titleHtml":"пылевые клещи профилактика"},{"titleHtml":"клещи при стирке"},{"titleHtml":"средства от клещей"},{"titleHtml":"пылевые клещи температура"},{"titleHtml":"клещи озон"},{"titleHtml":"аллергия на пыль"},{"titleHtml":"плесень"},{"titleHtml":"Валлемия"},{"titleHtml":"микотоксины"},{"titleHtml":"никто не читает тэги"}]},"580104":{"id":"580104","timePublished":"2021-09-28T09:41:42+00:00","isCorporative":true,"lang":"ru","titleHtml":"«Рост зарплат в IT это плохо? Вы же шутите, да?»","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2294597","alias":"Svetlana_get-it","fullname":"Светлана Петровичева","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F911\u002Fccf\u002Fb06\u002F911ccfb06379afc9647fcc9d45656e72.jpg","speciality":"HR tech Entrepreneur, основатель сервиса headz.io"},"statistics":{"commentsCount":185,"favoritesCount":44,"readingCount":24601,"score":30,"votesCount":56},"hubs":[{"relatedData":null,"id":"22550","alias":"headzio","type":"corporative","title":"Блог компании Headz.io","titleHtml":"Блог компании Headz.io","isProfiled":false},{"relatedData":null,"id":"20688","alias":"research","type":"collective","title":"Исследования и прогнозы в IT","titleHtml":"Исследования и прогнозы в IT","isProfiled":false},{"relatedData":null,"id":"20740","alias":"career","type":"collective","title":"Карьера в IT-индустрии","titleHtml":"Карьера в IT-индустрии","isProfiled":false},{"relatedData":null,"id":"21890","alias":"statistics","type":"collective","title":"Статистика в IT","titleHtml":"Статистика в IT","isProfiled":false}],"flows":[{"id":"3","alias":"management","title":"Менеджмент"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EНедавно мы выпустили статью «\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fheadzio\u002Fblog\u002F578792\u002F\"\u003E\u003Cu\u003EДефицит в IT: платите больше\u003C\u002Fu\u003E\u003C\u002Fa\u003E» о росте зарплат. Совпадение или нет, но чуть позже вышла \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F578820\u002F\"\u003E\u003Cu\u003Eстатья о минусах большого заработка у российских айтишников\u003C\u002Fu\u003E\u003C\u002Fa\u003E. Автор рассуждал о том, как высокие зарплаты могут навредить IT-отрасли. На первый взгляд аргументы выглядят логично. Но это только на первый взгляд.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7a3\u002F36d\u002F860\u002F7a336d8606f7ceb93d3322caea8419cb.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7a3\u002F36d\u002F860\u002F7a336d8606f7ceb93d3322caea8419cb.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"рост зарплат"},{"titleHtml":"карьера программиста"},{"titleHtml":"карьера ит-специалиста"},{"titleHtml":"ответ"},{"titleHtml":"прогнозы"},{"titleHtml":"статистика"}]},"580168":{"id":"580168","timePublished":"2021-09-28T11:03:01+00:00","isCorporative":true,"lang":"ru","titleHtml":"Как вообще Интернет приходит в ЦОД","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"1919391","alias":"ntsaplin","fullname":"Никита Цаплин","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F3a9\u002Fa0c\u002F722\u002F3a9a0c722ab0b73193e60b9f84f9a2c0.png","speciality":"010501.65 Прикладная математика и информатика"},"statistics":{"commentsCount":11,"favoritesCount":33,"readingCount":4046,"score":28,"votesCount":28},"hubs":[{"relatedData":null,"id":"19791","alias":"ruvds","type":"corporative","title":"Блог компании RUVDS.com","titleHtml":"Блог компании RUVDS.com","isProfiled":false},{"relatedData":null,"id":"20","alias":"hosting","type":"collective","title":"Хостинг","titleHtml":"Хостинг","isProfiled":false},{"relatedData":null,"id":"20682","alias":"pm","type":"collective","title":"Управление проектами","titleHtml":"Управление проектами","isProfiled":true}],"flows":[{"id":"3","alias":"management","title":"Менеджмент"},{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"Пользователь VDS-хостинга задал нам вопрос о том, откуда берётся Интернет. И тут мы поняли, что это тот самый детский вопрос, на который не так-то просто нормально ответить. \u003Cbr\u003E\r\n\u003Cbr\u003E\r\nДумаю, что 99 % людей ответят: берёт и приходит, а потом задумаются. Это настолько естественно и очевидно, что обычно просто не обсуждается. Ну там, знаете, оптика, она приходит в домик, в домике стоит коробка, а из коробки идёт медь. Вот примерно так оно и работает. \u003Cbr\u003E\r\n\u003Cbr\u003E\r\nВ теории всё так и есть, но на практике это выглядит немного иначе. И есть нюансы. Давайте покажу, откуда к нам приходит Интернет и в чём. А заодно поговорим про то, где фильтруется трафик и как это устроено в хостинге. \u003Cbr\u003E\r\n\u003Cbr\u003E\r\nДля нас всё начинается вот с этой ракеты в Королёве:\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F580168\u002F\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fwl\u002Fkl\u002Fqf\u002Fwlklqfzn9is5zcsqlww90dwdqfc.jpeg\"\u003E\u003C\u002Fa\u003E\u003Cbr\u003E\r\n\u003Ci\u003E\u003Ca href=\"https:\u002F\u002Fcommons.wikimedia.org\u002Fwiki\u002FFile:Vostok-2M_(8A292M)_in_Korolyov,_Moscow_Oblast.jpg\" rel=\"nofollow noopener noreferrer\"\u003EИсточник\u003C\u002Fa\u003E\u003C\u002Fi\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nЭто памятник «Восток-2М» (8А292М), стоящий в Королёве примерно на том месте, где вообще был разработан «Восток». Перед ним находится люк, где одна трасса оптики разделяется на три к M9, или \u003Ca href=\"https:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002FMSK-IX\" rel=\"nofollow noopener noreferrer\"\u003EMSK-IX \u003C\u002Fa\u003E— московской международной телефонной станции № 9, где когда-то появился самый крупный узел обмена трафика. Сейчас это главное место, откуда Интернет поставляется в Москву. Из-за некоторых особенностей нашей территории бомбоубежища именно в этом люке под ракетой находится уязвимое место оптики, где все три канала идут вместе, и их легко перерубить экскаватором на протяжении примерно 120 метров. В других местах до и после ракеты такого нет. \u003Cbr\u003E\r\n\u003Cbr\u003E\r\nСоответственно один луч идёт через наш ЦОД в Ивантеевку, поворачивает в Щёлково и заканчивается на M9-IX. Второй подземный ввод идёт через Ярославское шоссе, третий ввод — дополнительный, он скачет по столбам от коллектора до ЦОДа в одну сторону и до местного провайдера в другую, а провайдер уже врезается в кольцо оптики по городу и тоже попадает в девятку.","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"хостинг"},{"titleHtml":"VDS-хостинг"},{"titleHtml":"Интернет"},{"titleHtml":"ЦОД"},{"titleHtml":"ruvds_статьи"}]},"580170":{"id":"580170","timePublished":"2021-09-28T10:36:25+00:00","isCorporative":true,"lang":"ru","titleHtml":"Дитя конверсии: обзор ноутбука IBM ThinkPad iSeries 1400","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"154372","alias":"ereinion","fullname":"Виталий Прокофьев","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F53d\u002F8ec\u002F1fb\u002F53d8ec1fb1d65d37bb85b94c51b17167.jpg","speciality":"Руководитель отдела услуг администрирования"},"statistics":{"commentsCount":0,"favoritesCount":6,"readingCount":4286,"score":27,"votesCount":27},"hubs":[{"relatedData":null,"id":"14740","alias":"selectel","type":"corporative","title":"Блог компании Selectel","titleHtml":"Блог компании Selectel","isProfiled":false},{"relatedData":null,"id":"21898","alias":"hardware","type":"collective","title":"Компьютерное железо","titleHtml":"Компьютерное железо","isProfiled":false},{"relatedData":null,"id":"21906","alias":"history","type":"collective","title":"История IT","titleHtml":"История IT","isProfiled":false},{"relatedData":null,"id":"21930","alias":"antikvariat","type":"collective","title":"Старое железо","titleHtml":"Старое железо","isProfiled":false},{"relatedData":null,"id":"21952","alias":"notebooks","type":"collective","title":"Ноутбуки","titleHtml":"Ноутбуки","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fsn\u002Fs4\u002F4f\u002Fsns44fybis21deyqyx_mrkwrkie.png\"\u003E\u003C\u002Fdiv\u003E\u003Cbr\u003E\r\nКогда компания пытается войти в новый для себя сегмент рынка, часто получаются очень необычные и забавные девайсы. Яркие примеры — почти электромобиль BMW i3, самолет HondaJet, постсоветские мясорубки и соковыжималки, которые после обработки напильником требовали лицензии на ношение, и ноутбуки IBM ThinkPad iSeries. \u003Cbr\u003E\r\n\u003Cbr\u003E\r\nЗадуманные как недорогие машины для домашнего применения и крайне малого бизнеса, эти машины стали примером неоднозначных решений и странного дизайна. Но со временем превратились в большую редкость, не сразу понятую и принятую коллекционерами, но теперь — очень желанную.\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"ноутбук"},{"titleHtml":"лэптоп"},{"titleHtml":"старое железо"},{"titleHtml":"история ИТ"},{"titleHtml":"celeron"},{"titleHtml":"intel"},{"titleHtml":"thinkpad"},{"titleHtml":"ibm"},{"titleHtml":"lenovo"}]},"580214":{"id":"580214","timePublished":"2021-09-28T03:06:01+00:00","isCorporative":false,"lang":"ru","titleHtml":"Как выбрать подложку для СВЧ плат?","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2759195","alias":"Leka_engineer","fullname":"Олеся","avatarUrl":"","speciality":"инженер-разработчик СВЧ устройств"},"statistics":{"commentsCount":28,"favoritesCount":16,"readingCount":1413,"score":18,"votesCount":24},"hubs":[{"relatedData":null,"id":"19395","alias":"netdev","type":"collective","title":"Разработка систем связи","titleHtml":"Разработка систем связи","isProfiled":true},{"relatedData":null,"id":"21484","alias":"electronics","type":"collective","title":"Производство и разработка электроники","titleHtml":"Производство и разработка электроники","isProfiled":true},{"relatedData":null,"id":"22016","alias":"easyelectronics","type":"collective","title":"Электроника для начинающих","titleHtml":"Электроника для начинающих","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЭтой статьёй я продолжаю цикл (надеюсь, что получится несколько) статей про особенности проектирования и изготовления СВЧ-плат. Эта  статья очень простая, так что, скорее всего, большинство читателей-СВЧшников не найдёт в ней ничего нового. Однако, я надеюсь, что статья будет полезна начинающим разработчикам.\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"далее","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"свч"},{"titleHtml":"свч-техника"},{"titleHtml":"печатная плата"},{"titleHtml":"производство электроники"},{"titleHtml":"разработка электроники"},{"titleHtml":"приложения для android"}]},"580222":{"id":"580222","timePublished":"2021-09-28T13:07:07+00:00","isCorporative":true,"lang":"ru","titleHtml":"Ортодонтия во взрослом возрасте: зачем вам это надо и что лучше знать до начала лечения","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"2793023","alias":"magomedovazuzu","fullname":"Магомедова Зузу","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd25\u002Fd7f\u002Fc69\u002Fd25d7fc697c903cbe6dfdf1423b5b7ba.jpg","speciality":"Врач стоматолог-ортопед"},"statistics":{"commentsCount":7,"favoritesCount":20,"readingCount":3801,"score":18,"votesCount":28},"hubs":[{"relatedData":null,"id":"22616","alias":"belayaraduga","type":"corporative","title":"Блог компании Белая Радуга","titleHtml":"Блог компании Белая Радуга","isProfiled":false},{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"21996","alias":"health","type":"collective","title":"Здоровье","titleHtml":"Здоровье","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fph\u002Fy_\u002Fys\u002Fphy_ysqfi51itdfzul5g9ujtcpe.png\" alt=\"image\"\u003E\u003Cbr\u003E\r\n\u003Ci\u003E\u003Ca href=\"https:\u002F\u002Forthodonticassoc.com\u002Fblog\u002Fthe-evolution-of-orthodontic-braces\u002F\" rel=\"nofollow noopener noreferrer\"\u003EПримерно \u003C\u002Fa\u003Eтак в конце XIX века выпрямляли зубы\u003C\u002Fi\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nВ современном мире не принято умирать от кривых зубов. Максимум, что с вами случится, — станет не очень приятно широко открывать рот, вылетит челюстной сустав, вырастут амортизационные издержки на периодонт зубов, да и со стоматологом вы начнёте видеться чаще. \u003Cbr\u003E\r\n\u003Cbr\u003E\r\nВ принципе 99% проблем с расположением зубов сегодня можно исправить без проблем. Для этого есть опоры, создающие давление на зубы и кости, двигающие их. Брекеты несъёмные фиксируются с внешней или внутренней стороны зубов, ими можно решить много проблем, но они требуют постоянного ухода и посещения клиники раз в месяц. Альтернатива — элайнеры, прозрачные капы. Их можно снимать, чистить зубы как обычно и есть всё подряд. \u003Cbr\u003E\r\n\u003Cbr\u003E\r\nВ большинстве случаев ортодонтическое лечение требует от 8 месяцев до 2 лет в зависимости от сложности случая. На масштабные изменения вроде перемещения соседнего седьмого зуба на место отсутствующего шестого может уйти и 3 года. Плюс есть вероятность неуспеха, потому что нужно много считать.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nСмоделировать возможную ситуацию можно на основе данных КТ, телерентгенограммы и 3D-моделирования (это после съёмки полости рта сканером). Это более-менее страхует от скрытых кист, сверхкомплектных зубов и прочих радостей, которые могут вылезти в процессе лечения. \u003Cbr\u003E\r\n\u003Cbr\u003E\r\nИтак, сегодня: \u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003E Что умеет современная ортодонтия и сколько она стоит.\u003C\u002Fli\u003E\r\n\u003Cli\u003E Как мы корректируем прикус с помощью брекетов и элайнеров. \u003C\u002Fli\u003E\r\n\u003Cli\u003E Зачем используем в дополнение минивинты (импланты) и нёбные расширители.\u003C\u002Fli\u003E\r\n\u003Cli\u003E Когда будет результат. И что мы делаем, чтобы его закрепить. \u003C\u002Fli\u003E\r\n\u003Cli\u003E Что может пойти не так при установке брекетов или элайнеров.\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"зуб"},{"titleHtml":"ортодонтия"},{"titleHtml":"лечение"},{"titleHtml":"элайнеры"},{"titleHtml":"брекеты"},{"titleHtml":"стоматология"}]},"580240":{"id":"580240","timePublished":"2021-09-28T11:02:14+00:00","isCorporative":false,"lang":"ru","titleHtml":"SQLite-песочница в браузере","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"5634","alias":"nalgeon","fullname":"Антон Жиянов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F031\u002F537\u002F2ce\u002F0315372ce4ec69d2b80b64771b54b5a2.png","speciality":"Python, SQL и открытые данные"},"statistics":{"commentsCount":1,"favoritesCount":56,"readingCount":2681,"score":38,"votesCount":38},"hubs":[{"relatedData":null,"id":"144","alias":"open_source","type":"collective","title":"Open source","titleHtml":"Open source","isProfiled":true},{"relatedData":null,"id":"357","alias":"javascript","type":"collective","title":"JavaScript","titleHtml":"JavaScript","isProfiled":true},{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"594","alias":"sql","type":"collective","title":"SQL","titleHtml":"SQL","isProfiled":true},{"relatedData":null,"id":"18554","alias":"sqlite","type":"collective","title":"SQLite","titleHtml":"SQLite","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЧего мне всегда не хватало, так это аналога JSFiddle для SQLite. Онлайн-песочницы, в которой можно быстро проверить SQL-запрос и поделиться с другими.\u003C\u002Fp\u003E\u003Cp\u003EВот чего хотелось:\u003C\u002Fp\u003E\u003Cp\u003E— Возможность загрузить готовую базу, а не писать SQL для создания таблиц.\u003Cbr\u003E— Подключать как локальные базы, так и удаленные (по url).\u003Cbr\u003E— Сохранять базу и запросы в облаке.\u003Cbr\u003E— Бесплатно и без регистрации.\u003Cbr\u003E— Свежайшая версия SQLite.\u003Cbr\u003E— Минимализм.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd46\u002F816\u002Fde0\u002Fd46816de0e7cacdab5b8e27a6b48d6d0.png","buttonTextHtml":"В итоге сделал сам","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd46\u002F816\u002Fde0\u002Fd46816de0e7cacdab5b8e27a6b48d6d0.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"песочница"},{"titleHtml":"gist"},{"titleHtml":"sql.js"},{"titleHtml":"sqlime"}]},"580270":{"id":"580270","timePublished":"2021-09-28T07:08:30+00:00","isCorporative":true,"lang":"ru","titleHtml":"Варим суп из стали: оптимизация логистики ковшей и как устроен цех КЦ № 2","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"2790193","alias":"AlexanderSkorniakov","fullname":"Александр Скорняков","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fcbf\u002F737\u002F072\u002Fcbf737072762c9fe82994575e36e0c25.jpg","speciality":"Руководитель цифровых продуктов"},"statistics":{"commentsCount":23,"favoritesCount":25,"readingCount":6241,"score":73,"votesCount":73},"hubs":[{"relatedData":null,"id":"22816","alias":"nlmk","type":"corporative","title":"Блог компании Блог компании Группа НЛМК","titleHtml":"Блог компании Блог компании Группа НЛМК","isProfiled":false},{"relatedData":null,"id":"397","alias":"analysis_design","type":"collective","title":"Анализ и проектирование систем","titleHtml":"Анализ и проектирование систем","isProfiled":true},{"relatedData":null,"id":"18816","alias":"industrial_control_system","type":"collective","title":"Промышленное программирование","titleHtml":"Промышленное программирование","isProfiled":true},{"relatedData":null,"id":"20682","alias":"pm","type":"collective","title":"Управление проектами","titleHtml":"Управление проектами","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"3","alias":"management","title":"Менеджмент"}],"relatedData":null,"leadData":{"textHtml":"Привет из конвертерного цеха металлургического комбината! Смотрите, у нас тут есть вот такой суп в ковше, стоящем на сталевозе:\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fdh\u002F3m\u002Fmn\u002Fdh3mmn_3v_fbdyt4k2hs3fhfnjm.jpeg\" alt=\"image\"\u003E\u003Cbr\u003E\r\n\u003Ci\u003EТаких ковшей на 320 тонн стали в цехе 40 штук, и они медленно остывают. Этой стали грустно и одиноко, она подмерзает. Через эти ковши проходит 10 миллионов тонн стали в год, это 14% стали России\u003C\u002Fi\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nНа входе в цех у нас жидкий чугун и металлолом, на выходе надо получить сляб — большой слиток стали. Контур системы диспетчеризации «Гефест» начинается с конвертера, где мы продуваем чугун кислородом, таким образом окисляем и удаляем ненужные нам примеси. После конвертера получается «стальной бульон» для супа, в который уже можно добавлять основные ингредиенты, чтобы получались разные марки стали. За смену мы выплавляем несколько заказов, и каждая сталь требует своего рецепта — это разные добавки, разные техпроцессы, разные температуры и разные последовательности действий. \u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fiv\u002Fmh\u002Fdj\u002Fivmhdjdffezd6k7p1kmw38_akcu.jpeg\" alt=\"image\"\u003E\u003Cbr\u003E\r\n\u003Ci\u003EНа участке аргонной установки\u003C\u002Fi\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nУзким местом, в зависимости от сорта стали, может стать любой технологический узел на пути плавки от конвертера до разливки — агрегаты внепечной обработки, мостовые краны или сталевозы для перемещения ковшей могут оказаться в какой-то конкретный момент перегружены. Раньше графики последовательности действий составлялись в блокноте человеком и были недостаточно оптимизированы. Плюс непредсказуемость: графики с довольно широкими временными границами дают большие потери производительности, а графики с узкими границами — не дают прореагировать на возможную поломку, задержку в процессе или вынужденную остановку. Не знаю, сколько стоит у вас простой прода, но у нас один остывший не к месту ковш запросто может нанести ущерба на несколько миллионов рублей. \u003Cbr\u003E\r\n\u003Cbr\u003E\r\nВ общем, мы написали систему, которая не только оптимизирует загрузку этого участка производства, но и регулярно (во время смены) пересчитывает всю логистику ковшей.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nНо давайте начну с, собственно, рассказа про то, что же именно оптимизируется в цехе.","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"сталь"},{"titleHtml":"производство"},{"titleHtml":"оптимизация"},{"titleHtml":"металл"},{"titleHtml":"металлургия"},{"titleHtml":"диспетчеризация"}]},"580336":{"id":"580336","timePublished":"2021-09-28T05:40:43+00:00","isCorporative":false,"lang":"ru","titleHtml":"DOM, который построил Chrome. Или не построил? Или не Chrome? Или не DOM?","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2671923","alias":"Maxim_from_HW","fullname":"Максим","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F33e\u002F1a0\u002F5ba\u002F33e1a05ba0d2d651cc292ce76ad45ee1.png","speciality":"CEO"},"statistics":{"commentsCount":23,"favoritesCount":63,"readingCount":5326,"score":19,"votesCount":23},"hubs":[{"relatedData":null,"id":"91","alias":"webdev","type":"collective","title":"Разработка веб-сайтов","titleHtml":"Разработка веб-сайтов","isProfiled":true},{"relatedData":null,"id":"357","alias":"javascript","type":"collective","title":"JavaScript","titleHtml":"JavaScript","isProfiled":true},{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"524","alias":"complete_code","type":"collective","title":"Совершенный код","titleHtml":"Совершенный код","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EОбычный, теневой, виртуальный, инкрементальный… Как получилось, что простой программный интерфейс доступа к элементам веб-страниц обзавелся таким количеством «родственников»? Чем современные фреймворки не устраивает стандартная объектная модель документа или просто DOM? Что и как на самом деле отрисовывает браузер в процессе рендера веб-страницы?\u003C\u002Fp\u003E\u003Cp\u003EВсем привет, это \u003Ca href=\"https:\u002F\u002Fwww.facebook.com\u002Fmy.kravets\" rel=\"noopener noreferrer nofollow\"\u003EМакс Кравец\u003C\u002Fa\u003E из Holyweb. Помните сцену из Матрицы, в которой один из юных кандидатов в Избранные наставляет Нео: «Не пытайся согнуть ложку. Первое, что ты должен понять — ложки не существует!»? Давайте переформулирую: «Не пытайся изменить DOM...». А вот о том, что прячется под многоточием, мы сегодня и поговорим.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5c9\u002F1cb\u002Fe9b\u002F5c91cbe9b4674ea479fed0a55f81fb7c.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5c9\u002F1cb\u002Fe9b\u002F5c91cbe9b4674ea479fed0a55f81fb7c.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"dom"},{"titleHtml":"google chrome"},{"titleHtml":"javascript"},{"titleHtml":"css"}]},"580348":{"id":"580348","timePublished":"2021-09-28T08:18:27+00:00","isCorporative":true,"lang":"ru","titleHtml":"Самый большой космический телескоп Джеймс Уэбб должен изменить наши представления о космосе","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"64252","alias":"Cloud4Y","fullname":"Cloud4Y","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fc2d\u002Fd0d\u002Fc05\u002Fc2dd0dc05834aebeb86bb76e35caeaab.png","speciality":"Корпоративный облачный провайдер"},"statistics":{"commentsCount":28,"favoritesCount":8,"readingCount":5149,"score":28,"votesCount":32},"hubs":[{"relatedData":null,"id":"17352","alias":"cloud4y","type":"corporative","title":"Блог компании Cloud4Y","titleHtml":"Блог компании Cloud4Y","isProfiled":false},{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"21962","alias":"space","type":"collective","title":"Космонавтика","titleHtml":"Космонавтика","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EИзучение новых миров,  понимание происхождения Вселенной, поиск жизни вне Земли. Всё это — задачи космического телескопа \"Джеймс Уэбб\", долгожданного преемника Хаббла.  Телескоп больше и легче Хаббла, зато в 100 раз мощнее,  а приборы — в семь раз чувствительнее. \u003C\u002Fp\u003E\u003Cp\u003EДжеймс Уэбб — это устройство для поиска ответов на неотвеченные вопросы о Вселенной, для изучения того, что до сих пор оставалось неизведанным. Что же такого в этом телескопе?\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F0ed\u002F24e\u002Fd75\u002F0ed24ed759f6e945b81c1ce1beedd228.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F0ed\u002F24e\u002Fd75\u002F0ed24ed759f6e945b81c1ce1beedd228.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Телескоп"},{"titleHtml":"уэбб"},{"titleHtml":"космос"},{"titleHtml":"технологии"}]},"580360":{"id":"580360","timePublished":"2021-09-28T07:27:40+00:00","isCorporative":true,"lang":"ru","titleHtml":"Вы используете больше Open Source-софта, чем думаете","editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Klint Finley","originalUrl":"https:\u002F\u002Fgithub.com\u002Freadme\u002Ffeatured\u002Funseen-oss"}}],"author":{"id":"16172","alias":"shurup","fullname":"Дмитрий Шурупов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F062\u002Fc85\u002F607\u002F062c85607fbe4aaa29e1ad2076cd13a0.jpg","speciality":"Open Source geek"},"statistics":{"commentsCount":1,"favoritesCount":8,"readingCount":4358,"score":28,"votesCount":32},"hubs":[{"relatedData":null,"id":"20940","alias":"flant","type":"corporative","title":"Блог компании Флант","titleHtml":"Блог компании Флант","isProfiled":false},{"relatedData":null,"id":"144","alias":"open_source","type":"collective","title":"Open source","titleHtml":"Open source","isProfiled":true},{"relatedData":null,"id":"20688","alias":"research","type":"collective","title":"Исследования и прогнозы в IT","titleHtml":"Исследования и прогнозы в IT","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"3","alias":"management","title":"Менеджмент"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003E\u003Cstrong\u003E\u003Cem\u003EПрим. перев.\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E\u003Cem\u003E: оригинал этой статьи был опубликован минувшим летом в рамках проекта ReadME. Он создан в GitHub с целью стать своеобразной трибуной для многочисленных Open Source-разработчиков, предоставив им возможность поделиться с широким сообществом актуальными для них проблемами. Данный материал несет в себе призыв «перестать воспринимать Open Source как должное» и раскрывает те сложности, с которыми сталкиваются многие авторы свободного ПО, применяемого буквально повсеместно.\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cp\u003EТобиас Копперс (Tobias Koppers) не работает в Instagram. И никогда не работал. Но с 2014 года он отвечает за поддержку важного компонента веб-версии Instagram. Копперс является создателем webpack — Open Source-инструмента для сборки (или «бандлинга») кода JavaScript.\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"open source"}]},"580382":{"id":"580382","timePublished":"2021-09-28T10:30:17+00:00","isCorporative":true,"lang":"ru","titleHtml":"Советский «Мерседес» или как в Минске строили спортпрототип","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"2776555","alias":"turbovagon","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":4,"favoritesCount":4,"readingCount":2316,"score":19,"votesCount":23},"hubs":[{"relatedData":null,"id":"17357","alias":"timeweb","type":"corporative","title":"Блог компании Timeweb","titleHtml":"Блог компании Timeweb","isProfiled":false},{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"22004","alias":"transport","type":"collective","title":"Транспорт","titleHtml":"Транспорт","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"Во второй половине 50-х годов в Советском Союзе начал набирать популярность автоспорт. Появляются всё новые соревнования, усложняется их регламент, растут требования и к гонщикам, и к машинам. На старт шоссейно-кольцевых начали выходить уже не слегка «обработанные напильником» серийные легковушки, а вполне гоночные штучные поделки, напоминающие современные спортпрототипы.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fz7\u002Fgs\u002Fzg\u002Fz7gszgbo8pc-ogtvjgvjd6vpaga.jpeg\"\u003E\u003Cbr\u003E\r\n\u003Ci\u003EВот, например, некоторые участники заезда 1956 года. Штучное поделие МАЗа с двигателем «Москвич-402» в первом ряду. Дальше будет лучше.\u003C\u002Fi\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nОдним из них стал МАЗ-1500, детище, как нетрудно догадаться, специалистов Минского автозавода. Да, профильным направлением предприятия были грузовики. Однако от кульманов конструкторов до воплощения в металле доходила и разного рода автоэкзотика. Посему, когда в Минавтопроме БССР возникла идея создать команду для участия в чемпионате Советского Союза по шоссейно-кольцевым гонкам, работу по новому проекту возглавил руководитель Конструкторского отдела МАЗа, автогонщик Владимир Майборода.\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"ссср"},{"titleHtml":"спорткар"},{"titleHtml":"автогонки"},{"titleHtml":"гараж"},{"titleHtml":"МАЗ"},{"titleHtml":"автомобили"}]},"580428":{"id":"580428","timePublished":"2021-09-28T10:57:35+00:00","isCorporative":true,"lang":"ru","titleHtml":"«Понаехавший» в Чехию: как купить квартиру в столице и стать «своим» с акцентом","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2581359","alias":"annesina","fullname":"Анна Есина","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F5d1\u002Fc94\u002F326\u002F5d1c943260bd153cf9263a6b59e7be21.png","speciality":"Пользователь"},"statistics":{"commentsCount":3,"favoritesCount":30,"readingCount":4777,"score":17,"votesCount":21},"hubs":[{"relatedData":null,"id":"22506","alias":"gms","type":"corporative","title":"Блог компании gms & g-mate","titleHtml":"Блог компании gms & g-mate","isProfiled":false},{"relatedData":null,"id":"20734","alias":"it_immigration","type":"collective","title":"IT-эмиграция","titleHtml":"IT-эмиграция","isProfiled":false},{"relatedData":null,"id":"20740","alias":"career","type":"collective","title":"Карьера в IT-индустрии","titleHtml":"Карьера в IT-индустрии","isProfiled":false},{"relatedData":null,"id":"20742","alias":"read","type":"collective","title":"Читальный зал","titleHtml":"Читальный зал","isProfiled":false},{"relatedData":null,"id":"22024","alias":"urban","type":"collective","title":"Урбанизм","titleHtml":"Урбанизм","isProfiled":false}],"flows":[{"id":"3","alias":"management","title":"Менеджмент"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EБольшое количество компаний и стартапов приглашают в Чехию IT-специалистов из стран СНГ. Почему они приезжают сюда? Разработчик из Омска ответил на популярные вопросы о переезде программиста в Прагу: какие нужны документы, как проходит адаптация, нужен ли диплом и как приобрести свое жилье. Передаем ему слово.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F995\u002F1b1\u002F45c\u002F9951b145c95413abb6f46ba5649b52f2.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F995\u002F1b1\u002F45c\u002F9951b145c95413abb6f46ba5649b52f2.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"g-mate"},{"titleHtml":"прага"},{"titleHtml":"чехия"},{"titleHtml":"переезд"},{"titleHtml":"IT-эмиграция"},{"titleHtml":"релокейт"},{"titleHtml":"релокация"}]},"580468":{"id":"580468","timePublished":"2021-09-28T12:04:47+00:00","isCorporative":true,"lang":"ru","titleHtml":"Проект «Горирожа»: про двойной подбородок","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"1588913","alias":"elena_pastukhova","fullname":"Елена Пастухова","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F1dc\u002F879\u002Fc33\u002F1dc879c33e39127162333771dba2137a.jpg","speciality":"Пользователь"},"statistics":{"commentsCount":28,"favoritesCount":21,"readingCount":4123,"score":20,"votesCount":50},"hubs":[{"relatedData":null,"id":"21848","alias":"geltek","type":"corporative","title":"Блог компании Гельтек-Медика","titleHtml":"Блог компании Гельтек-Медика","isProfiled":false},{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"21996","alias":"health","type":"collective","title":"Здоровье","titleHtml":"Здоровье","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"Борода у мужчин — это самый действенный способ скрыть жир. \u003Cbr\u003E\r\n\u003Cbr\u003E\r\nЕсть люди, которым повезло с квадратной челюстью: тогда всё прямо натянуто, и когда у обычного человека уже был бы тройной подбородок, у них — только двойной. Но если у вас славянский тип лица, то это не про вас. У нас прекрасный профиль, но в профиль будет видно даже минимальное количество жира. У азиатского типа — высокие скулы, которые тянут жир в другую сторону, а у нас нет никаких подобных генетических конструкций, поэтому при деформационном типе старения всё это ползёт вниз. Формируется либо второй подбородок, либо жировой компартмент располагается на щеках, и появляются так называемые «бульдожьи щёки». \u003Cbr\u003E\r\n\u003Cbr\u003E\r\nПоскольку жир там точно такой же, как на пузе и боках у мальчиков и на попе у девочек, то бороться с ним можно дефицитом калорий и физической нагрузкой. Ещё можно уменьшить склонность к отёчности и поднять тонус кожи через увлажнение. \u003Cbr\u003E\r\n\u003Cbr\u003E\r\nСюрпризом стало то, что испытуемые из тестовой группы проекта Thermo Intensive (более известного вам как «\u003Ca href=\"https:\u002F\u002Fgeltek-medica.ru\u002Fcatalog\u002Fkosmetika\u002Fseriya-body-care\u002Fanticellyulitnyj-gel-thermo-intensive\u002F\u002F\" rel=\"nofollow noopener noreferrer\"\u003EГорижопа\u003C\u002Fa\u003E» ) начали мазать средство не в целевую область, а ещё и на лицо, рассчитывая, что жир там будет убираться так же быстро. Мы сразу запретили им это делать (потому что щитовидка рядом, а мажут они широко) и сразу задумались про новое средство. \u003Cbr\u003E\r\n \u003Cbr\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fbk\u002Fsd\u002Ffy\u002Fbksdfyfl8jwg3mvvmrjs4xzibz4.png\" alt=\"image\"\u003E\u003Cbr\u003E\r\n\u003Ci\u003EПервая стадия, когда борода ещё не особо нужна. \u003Ca href=\"https:\u002F\u002Fmelmagazine.com\u002Fwp-content\u002Fuploads\u002F2018\u002F08\u002F1SmLNcqJD9Ao7TSeV1MwobA.png\" rel=\"nofollow noopener noreferrer\"\u003EИсточник\u003C\u002Fa\u003E\u003C\u002Fi\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nПотому что бета-тестеры обозначили нам рыночную нишу. \u003Cbr\u003E\r\n\u003Cbr\u003E\r\nСобственно, вы его тогда спрашивали и в комментариях, сразу раскусив, как можно неправильно использовать состав. И вот теперь у меня есть что показать.","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"горирожа"},{"titleHtml":"второй подбородок"},{"titleHtml":"жир"},{"titleHtml":"артикулярная гимнастика"},{"titleHtml":"средство"},{"titleHtml":"гель"}]},"580500":{"id":"580500","timePublished":"2021-09-28T13:43:38+00:00","isCorporative":false,"lang":"ru","titleHtml":"Поколение, выросшее вместе с Google, заставляет учителей менять структуру преподавания","editorVersion":"1.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Monica Chin","originalUrl":"https:\u002F\u002Fwww.theverge.com\u002F22684730\u002Fstudents-file-folder-directory-structure-education-gen-z"}}],"author":{"id":"60351","alias":"SLY_G","fullname":"Вячеслав Голованов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F329\u002Ffc8\u002F9e5\u002F329fc89e55a9132bf200ff315065f3f7.jpg","speciality":"Научпоп. Проповедую в храме науки."},"statistics":{"commentsCount":78,"favoritesCount":24,"readingCount":7800,"score":14,"votesCount":24},"hubs":[{"relatedData":null,"id":"20696","alias":"study","type":"collective","title":"Учебный процесс в IT","titleHtml":"Учебный процесс в IT","isProfiled":false},{"relatedData":null,"id":"21906","alias":"history","type":"collective","title":"История IT","titleHtml":"История IT","isProfiled":false}],"flows":[{"id":"3","alias":"management","title":"Менеджмент"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F357\u002F1b9\u002F4ee\u002F3571b94eea301ce372e5b22d5d882b80.webp\"\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nАстрофизик Кэтрин Гарланд впервые столкнулась с этой проблемой в 2017-м. Она преподавала инженерное дело, а её ученики использовали симуляторы для моделирования турбин реактивных самолётов. Она чётко сформулировала задачу, но один за другим студенты просили её помочь им. Все они получали одно и тоже сообщение об ошибке: программа не могла найти файлы.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nГарланд думала, что это легко исправить. Она спрашивала каждого из этих учеников, где они сохранили свой проект. На рабочем столе? На общем диске? Но каждый раз её встречало непонимание. «О чём вы говорите?» – недоумевали студенты. Они не только не знали, где сохранили свои файлы – они просто не понимали вопроса.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nПостепенно Гарланд начала понимать то, к чему её коллеги-преподаватели приходили в последние четыре года. Концепция папок, директорий, файлов, необходимая предыдущему поколению пользователей для понимания работы компьютера, современным ученикам кажется тарабарщиной.\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"файлы"},{"titleHtml":"каталоги"},{"titleHtml":"папки"},{"titleHtml":"директории"},{"titleHtml":"компьютерная грамотность"}]},"580516":{"id":"580516","timePublished":"2021-09-28T14:25:12+00:00","isCorporative":false,"lang":"ru","titleHtml":"Лучший язык программирования","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"8114","alias":"markshevchenko","fullname":"Марк Шевченко","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fb16\u002F6c1\u002Fc82\u002Fb166c1c82387bf9406fcd39f40dc264e.jpg","speciality":"программист"},"statistics":{"commentsCount":30,"favoritesCount":87,"readingCount":12944,"score":74,"votesCount":80},"hubs":[{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EВопрос, который часто задают начинающие программисты&nbsp;— какой язык программирования изучать? Вопрос звучит разумно. Хочется выбрать самый лучший, чтобы потом не пришлось переучиваться.\u003C\u002Fp\u003E\u003Cp\u003EМожно ли на него ответить?\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"образование"},{"titleHtml":"языки программирования"}]}},"articlesIds":{"ARTICLES_LIST_TOP_PERIOD_DAILY":["580516","580270","579778","575686","580240","580104","580168","580348","580360","580170","580034","580468","580382","580336","580222","580214","580428","579780","579814","580500"]},"isLoading":false,"pagesCount":{"ARTICLES_LIST_TOP_PERIOD_DAILY":4},"route":{"name":"ARTICLES_LIST_TOP_PERIOD","params":{"period":"daily"},"query":{}},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":["576304","102364","102006"],"similarListRefs":{"102006":{"id":"102006","timePublished":"2010-08-18T16:11:32+00:00","isCorporative":false,"lang":"ru","titleHtml":"Декартово дерево: Часть 2. Ценная информация в дереве и множественные операции с ней","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"49109","alias":"Skiminok","fullname":"Александр Полозов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd23\u002Fed4\u002F4cf\u002Fd23ed44cf8d9f76e24a0a2a39616553a.jpg","speciality":null},"statistics":{"commentsCount":14,"favoritesCount":227,"readingCount":32832,"score":68,"votesCount":76},"hubs":[{"id":"8000","alias":"algorithms","type":"collective","title":"Алгоритмы","titleHtml":"Алгоритмы","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Ch4\u003EОглавление (на данный момент)\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fblogs\u002Falgorithm\u002F101818\u002F\"\u003EЧасть 1. Описание, операции, применения.\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003EЧасть 2. Ценная информация в дереве и множественные операции с ней.\u003C\u002Fstrong\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fblogs\u002Falgorithm\u002F102364\u002F\"\u003EЧасть 3. Декартово дерево по неявному ключу.\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cem\u003ETo be continued...\u003C\u002Fem\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EТема сегодняшней лекции\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nВ прошлый раз мы с вами познакомились — скажем прямо, очень обширно познакомились — с понятием декартового дерева и основным его функционалом. Только до сих мы с вами использовали его одним-единственным образом: как «квази-сбалансированное» дерево поиска. То есть пускай нам дан массив ключей, добавим к ним случайно сгенерированные приоритеты, и получим дерево, в котором каждый ключ можно искать, добавлять и удалять за логарифмическое время и минимум усилий. Звучит неплохо, но мало.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nК счастью (или к сожалению?), реальная жизнь такими пустяковыми задачами не ограничивается. О чем сегодня и пойдет речь. Первый вопрос на повестке дня — это так называемая K-я порядковая статистика, или индекс в дереве, которая плавно подведет нас к хранению пользовательской информации в вершинах, и наконец — к бесчисленному множеству манипуляций, которые с этой информацией может потребоваться выполнять. Поехали.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EИщем индекс\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nВ математике, \u003Ci\u003EK-я порядковая статистика\u003C\u002Fi\u003E — это случайная величина, которая соответствует K-му по величине элементу случайной выборки из вероятностного пространства. Слишком умно. Вернемся к дереву: в каждый момент времени у нас есть декартово дерево, которое с момента его начального построения могло уже значительно измениться. От нас требуется очень быстро находить в этом дереве K-й по порядку возрастания ключ — фактически, если представить наше дерево как постоянно поддерживающийся отсортированным массив, то это просто доступ к элементу под индексом K. На первый взгляд не очень понятно, как это организовать: ключей-то у нас в дереве N, и раскиданы они по структуре как попало.\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fstorage\u002Fhabraeffect\u002Fd3\u002Ff9\u002Fd3f9076dbe0cdfaae3f3b26f57fb2010.png\" \u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n","imageUrl":null,"buttonTextHtml":"Решение и вся статья - под катом","image":null},"status":"published","plannedPublishTime":null,"checked":null},"102364":{"id":"102364","timePublished":"2010-08-23T07:15:26+00:00","isCorporative":false,"lang":"ru","titleHtml":"Декартово дерево: Часть 3. Декартово дерево по неявному ключу","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"49109","alias":"Skiminok","fullname":"Александр Полозов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd23\u002Fed4\u002F4cf\u002Fd23ed44cf8d9f76e24a0a2a39616553a.jpg","speciality":null},"statistics":{"commentsCount":17,"favoritesCount":237,"readingCount":44338,"score":73,"votesCount":81},"hubs":[{"id":"8000","alias":"algorithms","type":"collective","title":"Алгоритмы","titleHtml":"Алгоритмы","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Ch4\u003EОглавление (на данный момент)\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fblogs\u002Falgorithm\u002F101818\u002F\"\u003EЧасть 1. Описание, операции, применения.\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fblogs\u002Falgorithm\u002F102006\u002F\"\u003EЧасть 2. Ценная информация в дереве и множественные операции с ней.\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cb\u003EЧасть 3. Декартово дерево по неявному ключу.\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n\u003Cem\u003ETo be continued...\u003C\u002Fem\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EОчень сильное колдунство\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nПосле всей кучи возможностей, которые нам предоставило декартово дерево в предыдущих двух частях, сегодня я совершу с ним нечто странное и кощунственное. Тем не менее, это действие позволит рассматривать дерево в совершенно новой ипостаси — как некий усовершенствованный и мощный массив с дополнительными фичами. Я покажу, как с ним работать, покажу, что все операции с данными из второй части сохраняются и для модифицированного дерева, а потом приведу несколько новых и полезных.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВспомним-ка еще раз структуру дерамиды. В ней есть ключ \u003Cstrong\u003Ex\u003C\u002Fstrong\u003E, по которому дерамида есть дерево поиска, случайный ключ \u003Cstrong\u003Ey\u003C\u002Fstrong\u003E, по которому дерамида есть куча, а также, возможно, какая-то пользовательская информация \u003Cstrong\u003Eс\u003C\u002Fstrong\u003E (cost). Давайте совершим невозможное и рассмотрим дерамиду… без ключей x. То есть у нас будет дерево, в котором ключа x нет вообще, а ключи y — случайные. Соответственно, зачем оно нужно — вообще непонятно :)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа самом деле расценивать такую структуру стоит как декартово дерево, в котором ключи x все так же где-то имеются, но нам их не сообщили. Однако клянутся, что для них, как полагается, выполняется условие двоичного дерева поиска. Тогда можно представить, что эти неизвестные иксы суть числа от 0 до \u003Cnobr\u003EN-1\u003C\u002Fnobr\u003E и \u003Cem\u003Eнеявно\u003C\u002Fem\u003E расставить их по структуре дерева:\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fstorage\u002Fhabraeffect\u002F81\u002F57\u002F815702b5f5d49c63c470caa3c21f2def.png\" \u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nПолучается, что в дереве будто бы не ключи в вершинах проставлены, а сами вершины пронумерованы. Причем пронумерованы в уже знакомом с прошлой части порядке in-order обхода. Дерево с четко пронумерованными вершинами можно рассматривать как массив, в котором индекс — это тот самый неявный ключ, а содержимое — пользовательская информация \u003Ccode\u003Ec\u003C\u002Fcode\u003E. Игреки нужны только для балансировки, это внутренние детали структуры данных, ненужные пользователю. Иксов \u003Cem\u003Eна самом деле\u003C\u002Fem\u003E нет в принципе, их хранить не нужно.\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fstorage\u002Fhabraeffect\u002Ffd\u002F70\u002Ffd703b2ff9679b5a8c2ec8fa195e0765.png\" \u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nВ отличие от прошлой части, этот массив не приобретает автоматически никаких свойств, вроде отсортированности. Ведь на информацию-то у нас нет никаких структурных ограничений, и она может храниться в вершинах как попало.\u003Cbr\u002F\u003E\r\n","imageUrl":null,"buttonTextHtml":"Если интересно - под кат","image":null},"status":"published","plannedPublishTime":null,"checked":null},"576304":{"id":"576304","timePublished":"2021-09-04T13:46:57+00:00","isCorporative":false,"lang":"ru","titleHtml":"Как снизить зависимость кода от структуры данных?","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"269735","alias":"SergeIndex","fullname":"Сергей Горшков","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F2e3\u002Fbb5\u002F8d6\u002F2e3bb58d68694c6d883b75a8237f9fda.jpg","speciality":"Пользователь"},"statistics":{"commentsCount":40,"favoritesCount":60,"readingCount":7426,"score":2,"votesCount":12},"hubs":[{"id":"345","alias":"sw","type":"collective","title":"Семантика","titleHtml":"Семантика","isProfiled":true},{"id":"397","alias":"analysis_design","type":"collective","title":"Анализ и проектирование систем","titleHtml":"Анализ и проектирование систем","isProfiled":true},{"id":"7504","alias":"refactoring","type":"collective","title":"Проектирование и рефакторинг","titleHtml":"Проектирование и рефакторинг","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EСтруктура данных часто пронизывает насквозь все слои приложения. При ее изменении приходится модифицировать структуру базы данных, логику работы с ними в программном коде, спецификации сервисов, интерфейс приложения. А если данные, описание их структуры и значительную часть логики обработки поместить в виртуализированное хранилище, и работать с ними как с единой онтологической моделью? Это сместит фокус с кода на данные и сделает приложения дата-центричными. Мы считаем, что такая трансформация позволит повысить скорость доставки полезных функций бизнес-пользователям и сэкономить ресурсы, требуемые на внесение изменений в приложения, открыть путь перехода к дата-центричной ИТ-архитектуре всего предприятия.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fca4\u002F2f6\u002F0c2\u002Fca42f60c2be0768f69e26d2e838b9559.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fca4\u002F2f6\u002F0c2\u002Fca42f60c2be0768f69e26d2e838b9559.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null}}},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{"skiminok":{"scoreStats":{"score":279.2,"votesCount":369},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"49109","alias":"Skiminok","fullname":"Александр Полозов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd23\u002Fed4\u002F4cf\u002Fd23ed44cf8d9f76e24a0a2a39616553a.jpg","speciality":null}},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.670ab961.js" defer></script><script src="https://assets.habr.com/habr-web/js/chunk-f458c7c4.6e221df6.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.76acc47b.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
