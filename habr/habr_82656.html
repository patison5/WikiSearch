<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Отказоустойчивый узел передачи данных / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.0f7bdd8f.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.670ab961.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.01bb2993.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.76acc47b.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-f458c7c4.e48e8f79.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-f458c7c4.6e221df6.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.0f7bdd8f.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.01bb2993.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-f458c7c4.e48e8f79.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.4f7c12b4e1b1b4c0e44ef6f9f33b1f9f.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/82656\/"},"headline":"Отказоустойчивый узел передачи данных","datePublished":"2010-01-31T15:39:22+03:00","dateModified":"2010-01-31T21:37:47+03:00","author":{"@type":"Person","name":"DenJS"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Каждый оператор ШПД думает о том, как выпускать пользователей в сеть интернет и грамотно ограничивать скорость работы в сети по имеющимся тарифным планам и иметь...","url":"https:\/\/habr.com\/ru\/post\/82656\/#post-content-body","about":["h_closet","f_popsci"],"image":["http:\/\/www.4picture.ru\/pictures\/0f288217f95456f6e5076663bacd1876.jpg","http:\/\/www.4picture.ru\/pictures\/0f288217f95456f6e5076663bacd1876.jpg"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.47.1">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Отказоустойчивый узел передачи данных" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Отказоустойчивый узел передачи данных" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Отказоустойчивый узел передачи данных" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Каждый оператор ШПД думает о том, как выпускать пользователей в сеть интернет и грамотно ограничивать скорость работы в сети по имеющимся тарифным планам и иметь резерв на случай отказа оборудования..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Каждый оператор ШПД думает о том, как выпускать пользователей в сеть интернет и грамотно ограничивать скорость работы в сети по имеющимся тарифным планам и иметь резерв на случай отказа оборудования..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Каждый оператор ШПД думает о том, как выпускать пользователей в сеть интернет и грамотно ограничивать скорость работы в сети по имеющимся тарифным планам и иметь резерв на случай отказа оборудования..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Каждый оператор ШПД думает о том, как выпускать пользователей в сеть интернет и грамотно ограничивать скорость работы в сети по имеющимся тарифным планам и иметь резерв на случай отказа оборудования..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Каждый оператор ШПД думает о том, как выпускать пользователей в сеть интернет и грамотно ограничивать скорость работы в сети по имеющимся тарифным планам и иметь резерв на случай отказа оборудования..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/82656/9bfb67f3fdb53e10b8b0d1cc0ae61bfb/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/82656/9bfb67f3fdb53e10b8b0d1cc0ae61bfb/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/82656/9bfb67f3fdb53e10b8b0d1cc0ae61bfb/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/82656/9bfb67f3fdb53e10b8b0d1cc0ae61bfb/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/82656/9bfb67f3fdb53e10b8b0d1cc0ae61bfb/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="82656" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2010-01-31T12:39:22.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/82656/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/82656/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/82656/9bfb67f3fdb53e10b8b0d1cc0ae61bfb/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.cee85629.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
              Как стать автором
            </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.cee85629.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.cee85629.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.cee85629.svg#pull-arrow"></use></svg></div></div> <!----> <div class="tm-page-article__body"><article class="tm-page-article__content tm-page-article__content_inner"><div class="tm-page-article__head-wrapper"><!----> <div class="tm-article-snippet tm-page-article__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/DenJS/" title="DenJS" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_blue"><!----> <use xlink:href="/img/megazord-v24.cee85629.svg#placeholder-user"></use></svg></div></a> <span class="tm-user-info__user"><a href="/ru/users/DenJS/" class="tm-user-info__username">
      DenJS
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2010-01-31T12:39:22.000Z" title="2010-01-31, 15:39">31  января  2010 в 15:39</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Отказоустойчивый узел передачи данных</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/closet/" class="tm-article-snippet__hubs-item-link"><span>Чулан</span> <!----></a></span></div> <!----> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml">Каждый оператор ШПД думает о том, как выпускать пользователей в сеть интернет и грамотно ограничивать скорость работы в сети по имеющимся тарифным планам и иметь резерв на случай отказа оборудования или работ связанных с отключением оборудования. Попытаюсь рассказать и показать на примере то, как это реализовано у нас (к нам подключены более 3х тысяч пользователей и описанный мною вариант работает очень даже неплохо)<br/>
<a name="habracut"></a><br/>
<br/>
Для начала нам дано:<br/>
1) 1U rack mount сервер (Intel Xeon E5335, 1GB Ram, двухпортовый NIC Intel PRO/1000 EB), у нас таких используется два. Для чего – расскажу в тексте статьи<br/>
2) Пограничный маршрутизатор (в моем случае Juniper j4350, 2 штуки)<br/>
3) L3 коммутатор поддерживающий протокол BGP или OSPF<br/>
4) А также задачу: A) Имея все это хозяйство выпустить пользователей в Интернет.<br/>
 Б) сделать резерв, который в случае аварии будет задействован <br/>
 автоматически и без нашего участия<br/>
<br/>
Пограничный маршрутизатор (рекомендации)<br/>
<br/>
Начнем с с настройки пограничного маршрутизатора.<br/>
Он может быть любой, хоть PC под FreeBSD/Linux со всем известным пакетом Quagga, а может быть оборудованием производителей Cisco или Juniper. Как настроить пограничный маршрутизатор на PC c пакетом quagga или cisco очень много статей в интернете и много подробной документации (да, конфиг кваги идентичен конфигу cisco). По джуниперу тоже есть информация, не так много, но есть. Да и тема статьи не про настройку пограничного маршрутизатора и протокола BGP на нем, а немного про другое.<br/>
<br/>
В моем случае в качестве пограничных маршрутизаторов используются два Juniper j4350, железка не очень мощная, но под текущие задачи и бюджет подходит как раз.<br/>
Каждый из этих маршрутизаторов установлен на своем узле (узлы в разных местах) и к каждому из них подключен свой аплинк. Со стороны аплинков по bgp протоколу мы принимаем full-view и анонсируем им свои сети. А на шейперы мы отдаем по внутреннему bgp, в специально отведенном для этого vlan-e только маршрут по умолчанию (default route)<br/>
Для джунипера это строчки в конфиге:<br/>
<code>Вprotocols bgp<br/>
 neighbor 195.xxx.xxx.226 { export [ default-originate reject ];<br/>
<br/>
В policy options<br/>
 policy-statement default-originate {<br/>
 from {<br/>
 route-filter 0.0.0.0/0 exact;<br/>
 }<br/>
 then accept;<br/>
 }, это чтобы отдать только маршрут по умолчанию<br/>
 policy-statement reject {<br/>
 then reject;<br/>
 } , а это чтобы отбросить все остальные маршруты.</code><br/>
<br/>
Пограничные маршрутизаторы настроили, каждый принимает full-view от аплинков и отдает наши сети. Теперь настраиваем vlan для внутреннего bgp, внутри него подымаем связь по протоколу bgp между пограничными маршрутизаторами для обмена маршрутами между ними. Выделяем IP адреса будущим шейперами, но желательно не один, а несколько, для пула внешних IP адресов используемых для NAT. В моем случае по 4-ре адреса на каждый шейпер, но вы можете больше или меньше. В зависимости от размера сети и количества абонентов.<br/>
<br/>
Настройка сервера для шейпирования и NAT на FreeBSD<br/>
<br/>
Достаем сервер из коробки, и начинаем устанавливать на него FreeBSD, лучше последней стабильной версии. Устанавливать FreeBSD желательно в самой минимальной комплектации, не забыв отметить порты и дерево исходных кодов ядра (после настройки можно удалить)<br/>
<br/>
После того как поставили FreeBSD, начинаем настраивать на ней сеть. В /etc/resolv.conf задаем адреса dns серверов и прописываем маршрут по умолчанию и IP адреса в файл /etc/rc.conf (не смотря на наличие bgp маршрут по умолчанию лишним никогда не будет, на случай проблем с квагой которую мы будем ставить далее)<br/>
------/etc/rc.conf----<br/>
<code>defaultrouter="195.xxx.xxx.225" #маршрут по умолчанию<br/>
gateway_enable="YES" #включаем режим пересылке пакетов между интерфейсами<br/>
hostname="gw2.xxx.ru" #задаем имя маршрутизатора<br/>
# em0 – внешний интерфейс в влане c внутренним bgp<br/>
ifconfig_em0="up"<br/>
ifconfig_em0="inet 195.xxx.xx.231 netmask 255.255.255.240" #освновной IP адрес<br/>
ifconfig_em0_alias0="inet 195.xxx.xxx.232 netmask 255.255.255.255" #дополнительные IP.<br/>
ifconfig_em0_alias1="inet 195.xxx.xxx.233 netmask 255.255.255.255" #алиасы<br/>
ifconfig_em0_alias2="inet 195.xxx.xxx.234 netmask 255.255.255.255"<br/>
#em1 – внутренняя сеть, в моем случае это vlan между шейперами и l3 коммутаторами<br/>
ifconfig_em1="up"<br/>
ifconfig_em1="inet 195.xxx.xxx.193 netmask 255.255.255.248"</code><br/>
 — Сеть поднялась, яндекс запинговался. Теперь обновляем дерево портов<br/>
Дерево портов можно обновить с использованием утилиты portsnap или csup<br/>
В нашем случае будем обновлять через portsnap. Для этого пишем команды:<br/>
portsnap fetch, это загрузит полное дерево портов в каталог /var/db/portsnap<br/>
portsnap extract, этой командой мы распакуем новое дерево портов в каталог /usr/ports<br/>
<br/>
После обновления портов имеет смысл заняться сборкой своего собственного ядра, хотя делать это не обязательно, ipfw, dummynet и pf можно подгрузить модулями, а на производительность пересобранное ядро особо не влияет. В нашем случае пересборка ядра нужна из за опции HZ, это интервал таймера. По умолчанию там стоит 100, что не очень подходит для больших скоростей, поэтому будем менять его на 2000<br/>
<br/>
Копируем дистрибутивный конфиг ядра в другой файл<br/>
cp /usr/src/sys/i386/conf/GENERIC /usr/src/sys/i386/conf/router-001<br/>
открываем файл router-001 текстовым редактором (vi, nano) и начинаем его править. После правки ядра под ваши нужды надо не забыть добавить в конфиг ядра следующие параметры:<br/>
<br/>
<code>#ipfw firewall , этим мы будем шейпить пользователей<br/>
options IPFIREWALL<br/>
options IPFIREWALL_VERBOSE<br/>
options IPFIREWALL_VERBOSE_LIMIT=100<br/>
options IPFIREWALL_FORWARD<br/>
options DUMMYNET<br/>
options HZ=2000<br/>
<br/>
# pf, а этим мы будем NAT-ить локальные IP<br/>
device pf<br/>
device pflog<br/>
device pfsync</code><br/>
<br/>
Далее командами make buildkernel и make installkernel мы собираем и устанавливаем ядро<br/>
<br/>
После сборки ядра переходим к настройке нашего файрвола ipfw<br/>
В файл /etc/rc.conf добавляем следующие строки:<br/>
<code>firewall_enable="YES"<br/>
pf_enable="YES"<br/>
pf_rules="/etc/pf.conf"<br/>
</code><br/>
полностью очищаем файл /etc/rc.firewall и начинаем писать в него свои правила, ничего сложного нету так-так rc.firewall представляет собой самый обычный shell скрипт который запускается при старте ipfw<br/>
<br/>
строки которые добавляем в новый /etc/rc.firewall<br/>
<code>#!/bin/sh , указываем путь к командному интерпретатору<br/>
<br/>
/sbin/ipfw -q flush<br/>
/sbin/ipfw -q pipe flush , очищаем правила файрвола и очереди dummynet при старте<br/>
fwcmd="/sbin/ipfw -q" , Задаем путь к ipfw и опцию с которой запускаться. –q говорит файрволу о том, чтобы он не спрашивал подтверждения<br/>
<br/>
WAN_IP = 195.xxx.xxx.231, указываем основной IP адрес внешнего интерфейса<br/>
IBGP_NET = 195.xx.xx.224/xx<br/>
LAN_IP = 10.249.0.0/16 , указываем диапазон наших внутренних сетей<br/>
<br/>
${fwcmd} add 10 allow ip from any to any via lo0 , задаем правило разрешающее все на <br/>
 loopback интерфейсe<br/>
 <br/>
 ${fwcmd} add 11 allow ip from me to me , разрешаем пакеты с этого хоста на этот хост<br/>
 <br/>
 ${fwcmd} add 12 allow icmp from any to me, разрешаем icmp на этот хост<br/>
<br/>
${fwcmd} add 20 allow tcp from table(1) to me dst-port 22 , разрешаем подключаться к шейперу <br/>
 по протоколу ssh с IP адресов указанных в таблице 1. Занести адрес в эту таблицу можно <br/>
 командой ipfw table 1 add &lt;ip_address><br/>
 <br/>
 ${fwcmd} add 21 deny tcp from any to me dst-port 22 , окончательно запрещаем ssh. Под это <br/>
 правило попадут все, кто не в таблице 1<br/>
<br/>
${fwcmd} add 30 pipe tablearg ip from any to table(2) out via em1<br/>
 ${fwcmd} add 31 pipe tablearg ip from table(3) to any in via em1 , выпускаем пользователей из таблиц 2 и 3 в интернет и указываем им конкретный пайп дамминета для шейпинга. Номер пайпа указываем при добавлении пользователя в таблицу, каждая таблица для определенного типа трафика (2 для входящего к клиенту, 3 – для исходящего). Добавление пользователя в таблицу происходит командами ipfw table 2 add &lt;ip клиента> &lt;номер пайпа> и ipfw table 2 add &lt;ip клиента> &lt;номер пайпа><br/>
<br/>
Если вы хотите редиректить заблокированных пользователей, то необходимо будет добавить редирект на <br/>
 локальный веб-сервер (например nginx)<br/>
 ${fwcmd} add 38 fwd 127.0.0.1,3128 tcp $LAN_NET to not me dst-port 80<br/>
 ${fwcmd} add 39 allow tcp from any $LAN_NET src-port 80<br/>
 <br/>
${fwcmd} add 40 deny all from $LAN_NET to not me<br/>
${fwcmd} add 41 deny all from not me to $LAN_NET , блокируем пакеты к нашим сетям. Под эти правила попадут те пользователи которые отстутствут в таблице 2 и таблице 3<br/>
<br/>
${fwcmd} add 50 allow ip from me to any keep-state , разрешаем полный доступ исходящим соединениям с этого сервера и сохраняем их состояние.<br/>
<br/>
${fwcmd} add 51 allow tcp from $IBGP_NET to $WAN_IP dst-port 179 , разрешаем хостам находяшимся в vlan со внутренним BGP устанавливать с нами соединение на 179 порт (bgp протокол)<br/>
<br/>
${fwcmd} add 52 allow ospf from 195.xxx.xxx.192/29 to any , разрешаем ospf с определенной сети<br/>
Теперь мы задаем пайпы дамминета, собственно сам шейпинг<br/>
Примерно вот так:<br/>
#Speed 15Mbps, Для игр<br/>
${fwcmd} pipe 1 config mask dst-ip 0xffffffff bw 16000Kbit/s<br/>
${fwcmd} pipe 101 config mask src-ip 0xffffffff bw 16000Kbit/s<br/>
<br/>
#Speed 20Mbps, Для отдыха<br/>
${fwcmd} pipe 2 config mask dst-ip 0xffffffff bw 21000Kbit/s<br/>
${fwcmd} pipe 102 config mask src-ip 0xffffffff bw 21000Kbit/s<br/>
<br/>
#Speed 3Mbps, Для новичков<br/>
${fwcmd} pipe 3 config mask dst-ip 0xffffffff bw 3500Kbit/s<br/>
${fwcmd} pipe 103 config mask src-ip 0xffffffff bw 3500Kbit/s<br/>
</code><br/>
В любом случае правим все под себя (не забыва что пакет сначала попадет под действие ipfw, а только потом перейдет на обработку pf) в соответствии с данными рекомендациями, на этом файрвол считаем настроенным. В принципе если вы не хотите использовать tablearg, то можно и не использовать. Есть еще варианты по pipe на клиента или по отдельной таблице на тариф. Эти варианты я не рассматриваю, в связи с высокой нагрузкой на оборудование (pipe на клиента) и неудобством (таблица на тариф)<br/>
<br/>
Для полноты картины осталось только настроить NAT, который мы будем делать через pf.<br/>
Создаем файл /etc/pf.conf и вписываем в него следующие строки<br/>
<br/>
WAN_IF=«em0», это наш внешний интерфейс в влане со внутренним bgp. Именно на нем мы будем производить NAT<br/>
<br/>
LOCAL_NET=«10.249.0.0/16», это диапазон нашей локальной сети который будем NATить<br/>
<br/>
nat on $WAN_IF from $LOCAL_NET to! $LOCAL_NET -> ($WAN_IF) round-robin sticky-address, а это само правило для NATа из внутренней сети на вшеншний интерфейс <br/>
параметр round-robin означает использование адресов пула по кругу. <br/>
параметр sticky-address используется для гарантии назаначения всегда одного и того же адреса источника в адрес пула.<br/>
<br/>
Теперь приступаем к настройке пакета quagga<br/>
От него нам нужна поддержка bgp и поддержка ospf в моем случае<br/>
<br/>
Zebra.conf я публиковать не буду, в нем все просто и однотипно. Описываем интерфейсы и статические маршруты, вот вырезка из него:<br/>
<br/>
i<code>nterface em0<br/>
ip address 195.xx.xxx.231/xxx<br/>
description ibgp<br/>
!<br/>
interface em1<br/>
ip address 195.xxx.xxx.193/29<br/>
description ospf<br/>
!<br/>
! Static routes.<br/>
!<br/>
ip route 10.0.0.0/8 Null0 254<br/>
ip route 79.142.80.132/30 195.xxx.xxx.238<br/>
ip route 94.124.180.57/30 195.xxx.xxx.225</code><br/>
<br/>
Приводим конфиг bgp примерно вот к такому виду. Т.е принимаем маршрут по умолчанию от пограничных маршрутизаторов и отдаем ему какие-либо специфичные маршруты<br/>
<br/>
<code>hostname gw2.xxx.ru<br/>
password rxxxx<br/>
enable password rxxxxx<br/>
log file /var/log/quagga/bgpd.log<br/>
!<br/>
router bgp 3333<br/>
 bgp router-id 195.xxx.xxx.231<br/>
 bgp log-neighbor-changes<br/>
 network 195.xxx.xxx.192/29<br/>
 neighbor 195.xxx.xxx.225 remote-as 3333<br/>
 neighbor 195.xxx.xxx.225 description j4350-1<br/>
 neighbor 195.xxx.xxx.225 next-hop-self<br/>
 neighbor 195.xxx.xxx.238 remote-as 3333<br/>
 neighbor 195.xxx.xxx.238 description j4350-2<br/>
 neighbor 195.xxx.xxx.238 next-hop-self<br/>
! <br/>
</code><br/>
Далее мы настраиваем протокол OSPF (используется в моем случае, так-как параллельно Cisco Catalyst 3560 установлен Dlink DGS-3612)<br/>
<br/>
<code>Hostname gw2.xxx.ru<br/>
password xxx<br/>
enable password xxxx<br/>
log file /var/log/quagga/ospfd.log<br/>
!<br/>
interface em1<br/>
!<br/>
router ospf<br/>
 ospf router-id 195.xxx.xxx.193<br/>
 network 195.xxx.xxx.192/29 area 0.0.0.0<br/>
 default-information originate metric 100<br/>
!<br/>
line vty</code><br/>
<br/>
Если у вас стоит коммутатор который умеет работать с BGP, то лучше отказаться от использования OSPF и использовать для этих целей протокол BGP. В таком случае в<br/>
bgpd.conf надо внести следующие строки<br/>
<br/>
<code>neighbor 195.xxx.xxx.195 remote-as 3333<br/>
neighbor 195.xxx.xxx.195 description sw-c3560-xxx.ru<br/>
neighbor 195.xxx.xxx.195 default-originate</code><br/>
<br/>
Вроде все настроили, теперь главное не забыть небольшой тюнинг sysctl<br/>
Добавляем в существующий /etc/sysctl.conf следующие строки<br/>
<code>net.inet.ip.forwarding=1 #разрешаем пересылку пакетов между интерфейсами<br/>
net.inet.ip.fw.one_pass=1 #разрешаем однопроходный режим ipfw<br/>
net.inet.icmp.bmcastecho=0 #не отвечаем на пинг на широковещательный адрес<br/>
net.inet.tcp.blackhole=2 #отбрасываем пакеты на закрытый порт (не слушаемый никем)<br/>
net.inet.udp.blackhole=1 # отбрасываем пакеты на закрытый порт (не слушаемый никем)<br/>
net.inet.ip.dummynet.io_fast=1 #новое поведение dummynet( шейпирование канала)<br/>
net.inet.icmp.drop_redirect=1 #дропаем icmp редиректы<br/>
net.inet.icmp.log_redirect=1 #пишем icmp редиректы в log, бывает полезно<br/>
net.inet.ip.redirect=0 # если 0, то нет реакции на ICMP REDIRECT пакеты<br/>
net.inet.ip.dummynet.expire=0 # в случае кратковременного прекращения трафика пользователя не <br/>
 #выносим его из очереди<br/>
net.inet.ip.dummynet.hash_size=16384 # размер хэш-таблицы, используемой dummynet для <br/>
 #хранения очередей. Увеличение этого значение ускоряет работу <br/>
 #dummynet при большом #количестве очередей, естественно в <br/>
 # обмен на оперативную память</code><br/>
<br/>
На этом наш шейпер считаем законченным, я заранее опустил интеграцию его с биллинговой системой, так как у каждого свое и свои методы<br/>
Можно смело писать команду reboot и если все было верно настроено то можно приступать к настройке коммутатора 3-го уровня (l3)<br/>
<br/>
А если мы еще хотим переадресовывать пользователей которым не разрешен доступ в интернет на определенную страницу с информацией о блокировке, то ставим веб сервер nginx и пишем ему в конфиг (nginx.conf) следующий текст<br/>
<br/>
<code><a href="http://blocked.wktnet.ru/index.htm"></a>user nobody;<br/>
worker_processes 2;<br/>
events {<br/>
 worker_connections 1024;<br/>
}<br/>
http {<br/>
 include mime.types;<br/>
 default_type application/octet-stream;<br/>
 sendfile on;<br/>
 keepalive_timeout 35;<br/>
 server {<br/>
 listen 3128;<br/>
 server_name wkt_router;<br/>
 charset windows-1251;<br/>
 access_log /dev/null;<br/>
 rewrite ^(.*) blocked.wktnet.ru/index.htm permanent;<br/>
 }<br/>
}<br/>
</code><br/>
Настройка коммутатора 3-го уровня<br/>
<br/>
В моей сети используется Cisco WS-C3560G-24-TS-S, там все просто<br/>
Заходим в режим конфигурирования: conf t<br/>
Присваиваем IP адрес интерфейсу vlan-а внутри которого бегает ospf, (та-же сеть что на шейпере на интерфейсе em1)<br/>
И настраиваем ospf<br/>
<br/>
<code>router ospf 1<br/>
 router-id 195.xxx.xxx.195<br/>
 log-adjacency-changes<br/>
network 10.249.33.0 0.0.0.255 area 0.0.0.0<br/>
 network 10.249.42.0 0.0.0.255 area 0.0.0.0<br/>
 network 10.249.51.0 0.0.0.255 area 0.0.0.0<br/>
 network 10.249.55.0 0.0.0.255 area 0.0.0.0</code><br/>
<br/>
сохраняем конфиг командой wr и радуемся достигнутому результату<br/>
<br/>
если вместо протокола ospf вы решили использовать bgp то в конфиг коммутатора необходимо добавить следующие строки<br/>
<br/>
<code>router bgp 3333<br/>
 bgp log-neighbor-changes<br/>
 network 10.249.33.0 255.255.255.0<br/>
 redistribute ospf 1<br/>
 neighbor 195.xxx.xxx.193 remote-as 3333<br/>
 neighbor 195.xxx.xxx.193 description gw<br/>
<br/>
</code><br/>
Если у вас используется l3 коммутатор D-link, то на нем настраиваем OSPF следующими командами<br/>
<br/>
enable ospf, включаем ospf на коммутаторе<br/>
config ospf router_id 195.xxx.xxx.196, указываем id роутера<br/>
config ospf ipif &lt;интерфейс> area 0.0.0.0 state enable, включаем ospf на интерфейсе<br/>
<br/>
и сохраняем конфиг командой save<br/>
<br/>
Настройка резервного сервера<br/>
<br/>
На соседнем (резервном шейпере) мы производим аналогичную настройку, за исключением конфига ospf и IP адресов<br/>
Отличие в том, что default-information originate мы задаем метрику 200, тогда он становится резервным. Хотя можем оставить метрику 100 и получить балансировку нагрузки между шейперами, но в своей сети я этот вариант не использую так как при такой настройке клиенты получат двойную скорость (по тарифной скорости на каждом шейпере). <br/>
<br/>
Заключение<br/>
<br/>
В итоге мы получаем систему с динамической маршрутизацией (в случае отказа одного из шейперов или пограничных маршрутизаторов мы автоматически начинаем использовать соседний, все маршруты сети прописанные на коммутаторах 3-го уровня автоматически появляются в таблице маршрутизации на наших шейперах). Если вас пугает мысль о простаивающем сервере, то можете поиграться с настройками, сменить ospf на bgp, поставить еще один L3 коммутатор и выпускать часть сети через него.<br/>
<br/>
Схема получившегося узла:<br/>
<img src="http://www.4picture.ru/pictures/0f288217f95456f6e5076663bacd1876.jpg" alt="image" data-src="http://www.4picture.ru/pictures/0f288217f95456f6e5076663bacd1876.jpg" data-blurred="true"/><br/>
<br/>
Для примера приведу свой rc.firewall<br/>
<br/>
<code>cat /etc/rc.firewall<br/>
#!/bin/sh<br/>
#Flush all firewall rules<br/>
/sbin/ipfw -q flush<br/>
/sbin/ipfw -q pipe flush<br/>
#Setting firewall path and options for working with rules<br/>
fwcmd="/sbin/ipfw -q"<br/>
#variables<br/>
IBGP_NET="195.93.xxx.xxx/28" #iBGP network (vlan9)<br/>
WAN_IP="195.93.xxx.xxx" #Primary WAN ip address<br/>
LAN_IP="195.93.xxx.xxx" #Primary LAN ip address<br/>
<br/>
###System rules<br/>
${fwcmd} add 10 allow ip from any to any via lo0 #do not filter loobpack<br/>
${fwcmd} add 11 allow ip from me to me #allow packets from this host to this host<br/>
${fwcmd} add 12 allow icmp from any to me #allow ICMP<br/>
<br/>
#allow ssh connections<br/>
${fwcmd} add 20 allow tcp from table\(6\) to me dst-port 22 #Allow SSH connections (table 6)<br/>
${fwcmd} add 29 deny tcp from any to me dst-port 22<br/>
<br/>
#allowing users and add his ip to shaping pipe<br/>
${fwcmd} add 30 pipe tablearg ip from any to table\(1\) out via em1<br/>
${fwcmd} add 31 pipe tablearg ip from table\(2\) to any in via em1<br/>
<br/>
#Block spammerss<br/>
${fwcmd} add 34 deny ip from table\(3\) to any dst-port 25 #for auto block spammers<br/>
<br/>
#allow connections to this networsk<br/>
${fwcmd} add 40 allow all from table\(7\) to any<br/>
${fwcmd} add 41 allow all from any to table\(7\)<br/>
<br/>
#allow active users<br/>
${fwcmd} add 45 allow all from not me to table\(1\)<br/>
${fwcmd} add 46 allow all from table\(2\) to not me<br/>
<br/>
#By default block users<br/>
${fwcmd} add 48 fwd 127.0.0.1,3128 tcp from table\(8\) to not me dst-port 80<br/>
${fwcmd} add 49 allow tcp from any to table\(8\) src-port 80<br/>
${fwcmd} add 50 deny all from table\(8\) to not me<br/>
${fwcmd} add 51 deny all from not me to table\(8\)<br/>
<br/>
###Access rules<br/>
#allow outgoing connections<br/>
${fwcmd} add 60 allow ip from me to any keep-state #allow all ougoing packets and keep state<br/>
<br/>
#Rules allowing SNMP<br/>
${fwcmd} add 61 allow udp from table\(6\) to $WAN_IP dst-port 161 #Allow SNMP<br/>
<br/>
#Rules allowing bgp<br/>
${fwcmd} add 64 allow tcp from $IBGP_NET to $WAN_IP dst-port 179 #Allow BGP from iBGP network (vlan 9)<br/>
<br/>
###############################################заполняем таблицы<br/>
#таблица 6 - это те кто имеют доступ к маршрутизатору по ssh,telnet и snmp<br/>
${fwcmd} table 6 add 195.93.xxx.xxx #wkt office<br/>
${fwcmd} table 6 add 89.xxx.xxx.1 #<br/>
 ${fwcmd} table 6 add 93.xx.xxx.xxx #<br/>
<br/>
#таблица 7 - IP адреса и сети с доступом при выключенном интернете<br/>
${fwcmd} table 7 add 195.xxx.xx.0/25 #binat<br/>
${fwcmd} table 7 add 195.xx.xx.0/26 #servers dmz<br/>
${fwcmd} table 7 add 195.xx3.xx.192/29 #int net<br/>
${fwcmd} table 7 add 195.xx.xxx.xxx #c3560-b51<br/>
${fwcmd} table 7 add 10.88.88.1<br/>
#таблица 8 - это наши локальные сети внутри которых пользователи<br/>
${fwcmd} table 8 add 10.87.0.0/16<br/>
${fwcmd} table 8 add 10.88.0.0/16<br/>
${fwcmd} table 8 add 10.249.0.0/16<br/>
${fwcmd} table 8 add 10.90.0.0/16<br/>
${fwcmd} table 8 add 195.93.xxx.0/25<br/>
${fwcmd} table 8 add 195.93.xxx.128/25<br/>
${fwcmd} table 8 add 195.93.xxx.64/26<br/>
${fwcmd} table 8 add 195.93.xxx.200/28<br/>
<br/>
#таблицы 1 и 2 - это пользователи и их тариф<br/>
##WKT tech<br/>
${fwcmd} table 1 add 10.87.xx.250/32 55<br/>
${fwcmd} table 2 add 10.87.xx.250/32 255<br/>
${fwcmd} table 1 add 10.87.xx.251/32 55<br/>
${fwcmd} table 2 add 10.87.xx.251/32 255</code><br/>
<br/>
И bgpd.conf<br/>
<br/>
<code>hostname gw2.xxxx<br/>
password rxxxx<br/>
enable password xxx<br/>
log file /var/log/quagga/bgpd.log<br/>
!<br/>
router bgp 44xxx<br/>
 bgp router-id 195.93.xxx.xxx<br/>
 bgp log-neighbor-changes<br/>
 network 195.93.2xx.xxx/29<br/>
 neighbor 195.93.206.xx remote-as 44380<br/>
 neighbor 195.93.206.xx description j4350-b51<br/>
 neighbor 195.93.206.xx next-hop-self<br/>
 neighbor 195.93.206.xx remote-as 44380<br/>
 neighbor 195.93.206.xx description j4350-k18<br/>
 neighbor 195.93.206.xx next-hop-self<br/>
 neighbor 195.93.206.xx remote-as 65000<br/>
 neighbor 195.93.206.xxdefault-originate<br/>
 neighbor 195.93.206.xx description sw-c3560g-24ts-b51<br/>
 neighbor 195.93.206.xx route-map c3560g-b51-in in<br/>
 neighbor 195.93.206.xx remote-as 65001<br/>
 neighbor 195.93.206.xx default-originate<br/>
 neighbor 195.93.206.xx description sw-c3560g-24ts-k18<br/>
 neighbor 195.93.206.xx route-map c3560g-k18-in in<br/>
!<br/>
 route-map c3560g-k18-in permit 10<br/>
 set local-preference 200<br/>
!<br/>
 route-map c3560g-b51-in permit 10<br/>
 set local-preference 300<br/>
</code><br/>
<br/>
UPD: для того чтобы прописать в /boot/loader.conf kern.hz=«2000» не обязательно пересобирать ядро.</div></div> <!----> <!----></div> <div class="tm-article-body__tags"><div class="tm-article-body__tags-links"><span class="tm-article-body__tags-title">Теги:</span> <span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bfreebsd%5D" class="tm-article-body__tags-item-link">freebsd</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%88%D0%B5%D0%B9%D0%BF%D0%B8%D0%BD%D0%B3%5D" class="tm-article-body__tags-item-link">шейпинг</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bbgp%5D" class="tm-article-body__tags-item-link">bgp</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bospf%5D" class="tm-article-body__tags-item-link">ospf</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BC%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82%D0%B8%D0%B7%D0%B0%D1%82%D0%BE%D1%80%5D" class="tm-article-body__tags-item-link">маршрутизатор</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%82%D0%B5%D0%BB%D0%B5%D0%BA%D0%BE%D0%BC%5D" class="tm-article-body__tags-item-link">телеком</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%BD%D0%B5%D1%82%5D" class="tm-article-body__tags-item-link">интернет</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%83%D0%B7%D0%B5%D0%BB%20%D0%BF%D0%B5%D1%80%D0%B5%D0%B4%D0%B0%D1%87%D0%B8%5D" class="tm-article-body__tags-item-link">узел передачи</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BF%D1%80%D0%BE%D0%B2%D0%B0%D0%B9%D0%B4%D0%B5%D1%80%5D" class="tm-article-body__tags-item-link">провайдер</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%80%D0%BE%D1%83%D1%82%D0%B5%D1%80%5D" class="tm-article-body__tags-item-link">роутер</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bdummynet%5D" class="tm-article-body__tags-item-link">dummynet</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bipfw%5D" class="tm-article-body__tags-item-link">ipfw</a></span></div> <div class="tm-article-body__tags-links"><span class="tm-article-body__tags-title">Хабы:</span> <span class="tm-article-body__tags-item"><a href="/ru/hub/closet/" class="tm-article-body__tags-item-link">
                  Чулан
                </a></span></div></div></article> <div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 53: ↑41 и ↓12</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 53: ↑41 и ↓12" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+29</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <!----> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    104
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/82656/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      78
    </span></a> <!----></div> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div></div> <!----></div> <!----> <div class="tm-page-article__additional-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body"><div class="tm-article-author tm-page-article__author"><!----> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-two-column"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/DenJS/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><svg class="tm-svg-img tm-image-placeholder tm-image-placeholder_blue"><!----> <use xlink:href="/img/megazord-v24.cee85629.svg#placeholder-user"></use></svg></div></a> <div class="tm-user-card__meta"><div title=" 58 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    28
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info"><div class="tm-user-card__title"><span class="tm-user-card__name">DenJS</span> <a href="/ru/users/DenJS/" class="tm-user-card__nickname">
          @DenJS
        </a> <!----></div> <p class="tm-user-card__short-info">Пользователь</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-two-column"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div></div> <!----></section> <div class="tm-page-article__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/82656/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 78 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <section class="tm-block tm-block_spacing-around"><header class="tm-block__header"><h2 class="tm-block__title">Похожие публикации</h2> <!----></header> <div class="tm-block__body"><ul class="tm-article-list-block__list"><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-08-27T13:00:01.000Z" title="2021-08-27, 16:00">27  августа   в 16:00</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/573616/" class="tm-article-title__link"><span>BGP Synchronization и OSPF</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 2: ↑2 и ↓0</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 2: ↑2 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+2</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">2.5K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    19
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/573616/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      0
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2020-12-26T05:24:56.000Z" title="2020-12-26, 08:24">26  декабря  2020 в 08:24</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/535100/" class="tm-article-title__link"><span>Активное внедрение стандарта Интернета RPKI — полезно ли?</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 12: ↑10 и ↓2</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 12: ↑10 и ↓2" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+8</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">5.2K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    15
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/535100/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      15
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2020-09-18T11:13:55.000Z" title="2020-09-18, 14:13">18  сентября  2020 в 14:13</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/news/t/519708/" class="tm-article-title__link"><span>Роскомнадзор грозит мелким провайдерам штрафами за неустановку оборудования для «суверенного интернета»</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 15: ↑13 и ↓2</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 15: ↑13 и ↓2" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+11</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">4.8K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    0
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/news/t/519708/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      17
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li> <!----></ul></div> <!----></section> <!----> <!----> <section class="tm-block tm-block_spacing-around"><header class="tm-block__header"><h2 class="tm-block__title">Лучшие публикации за сутки</h2> <!----></header> <div class="tm-block__body"><ul class="tm-article-list-block__list"><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-27T09:00:04.000Z" title="2021-09-27, 12:00">вчера в 12:00</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/ruvds/blog/580060/" class="tm-article-title__link"><span>Арракис, который мы заслужили</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 145: ↑139 и ↓6</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 145: ↑139 и ↓6" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+133</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">22K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    40
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/ruvds/blog/580060/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      113
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-27T16:41:21.000Z" title="2021-09-27, 19:41">вчера в 19:41</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/lamptest/blog/580228/" class="tm-article-title__link"><span>Идеальная светодиодная лампа за 21 рубль</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 82: ↑80 и ↓2</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 82: ↑80 и ↓2" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+78</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">11K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    45
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/lamptest/blog/580228/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      29
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-27T13:03:14.000Z" title="2021-09-27, 16:03">вчера в 16:03</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/ruvds/blog/580124/" class="tm-article-title__link"><span>Электролюминесцентные индикаторы из прошлого</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 75: ↑75 и ↓0</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 75: ↑75 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+75</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">5.2K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    37
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/ruvds/blog/580124/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      13
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-27T12:53:02.000Z" title="2021-09-27, 15:53">вчера в 15:53</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/580210/" class="tm-article-title__link"><span>PHP Дайджест № 212 (13 – 27 сентября 2021)</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 41: ↑41 и ↓0</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 41: ↑41 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+41</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">3.6K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    14
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/580210/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      1
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-27T10:50:03.000Z" title="2021-09-27, 13:50">вчера в 13:50</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/oleg-bunin/blog/580150/" class="tm-article-title__link"><span>Топ-5 когнитивных искажений при планировании в IT</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 40: ↑39 и ↓1</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 40: ↑39 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+38</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">6K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    54
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/oleg-bunin/blog/580150/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      7
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li> <!----></ul></div> <!----></section> <!----> <!----></div></div></div> <div class="tm-page__sidebar"><div hl="ru" id="82656" class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/82656/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/82656/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"82656":{"id":"82656","timePublished":"2010-01-31T12:39:22+00:00","isCorporative":false,"lang":"ru","titleHtml":"Отказоустойчивый узел передачи данных","leadData":{"textHtml":"Каждый оператор ШПД думает о том, как выпускать пользователей в сеть интернет и грамотно ограничивать скорость работы в сети по имеющимся тарифным планам и иметь резерв на случай отказа оборудования или работ связанных с отключением оборудования. Попытаюсь рассказать и показать на примере то, как это реализовано у нас (к нам подключены более 3х тысяч пользователей и описанный мною вариант работает очень даже неплохо)\u003Cbr\u002F\u003E\r\n","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"editorVersion":"1.0","postType":"article","postLabels":[],"author":{"scoreStats":{"score":28,"votesCount":58},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"37927","alias":"DenJS","fullname":"DenJS","avatarUrl":null,"speciality":null},"statistics":{"commentsCount":78,"favoritesCount":104,"readingCount":14757,"score":29,"votesCount":53},"hubs":[{"relatedData":null,"id":"19259","alias":"closet","type":"collective","title":"Чулан","titleHtml":"Чулан","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EКаждый оператор ШПД думает о том, как выпускать пользователей в сеть интернет и грамотно ограничивать скорость работы в сети по имеющимся тарифным планам и иметь резерв на случай отказа оборудования или работ связанных с отключением оборудования. Попытаюсь рассказать и показать на примере то, как это реализовано у нас (к нам подключены более 3х тысяч пользователей и описанный мною вариант работает очень даже неплохо)\u003Cbr\u002F\u003E\r\n\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля начала нам дано:\u003Cbr\u002F\u003E\r\n1) 1U rack mount сервер (Intel Xeon E5335, 1GB Ram, двухпортовый NIC Intel PRO\u002F1000 EB), у нас таких используется два. Для чего – расскажу в тексте статьи\u003Cbr\u002F\u003E\r\n2) Пограничный маршрутизатор (в моем случае Juniper j4350, 2 штуки)\u003Cbr\u002F\u003E\r\n3) L3 коммутатор поддерживающий протокол BGP или OSPF\u003Cbr\u002F\u003E\r\n4) А также задачу: A) Имея все это хозяйство выпустить пользователей в Интернет.\u003Cbr\u002F\u003E\r\n Б) сделать резерв, который в случае аварии будет задействован \u003Cbr\u002F\u003E\r\n автоматически и без нашего участия\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПограничный маршрутизатор (рекомендации)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНачнем с с настройки пограничного маршрутизатора.\u003Cbr\u002F\u003E\r\nОн может быть любой, хоть PC под FreeBSD\u002FLinux со всем известным пакетом Quagga, а может быть оборудованием производителей Cisco или Juniper. Как настроить пограничный маршрутизатор на PC c пакетом quagga или cisco очень много статей в интернете и много подробной документации (да, конфиг кваги идентичен конфигу cisco). По джуниперу тоже есть информация, не так много, но есть. Да и тема статьи не про настройку пограничного маршрутизатора и протокола BGP на нем, а немного про другое.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ моем случае в качестве пограничных маршрутизаторов используются два Juniper j4350, железка не очень мощная, но под текущие задачи и бюджет подходит как раз.\u003Cbr\u002F\u003E\r\nКаждый из этих маршрутизаторов установлен на своем узле (узлы в разных местах) и к каждому из них подключен свой аплинк. Со стороны аплинков по bgp протоколу мы принимаем full-view и анонсируем им свои сети. А на шейперы мы отдаем по внутреннему bgp, в специально отведенном для этого vlan-e только маршрут по умолчанию (default route)\u003Cbr\u002F\u003E\r\nДля джунипера это строчки в конфиге:\u003Cbr\u002F\u003E\r\n\u003Ccode\u003EВprotocols bgp\u003Cbr\u002F\u003E\r\n neighbor 195.xxx.xxx.226 { export [ default-originate reject ];\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ policy options\u003Cbr\u002F\u003E\r\n policy-statement default-originate {\u003Cbr\u002F\u003E\r\n from {\u003Cbr\u002F\u003E\r\n route-filter 0.0.0.0\u002F0 exact;\u003Cbr\u002F\u003E\r\n }\u003Cbr\u002F\u003E\r\n then accept;\u003Cbr\u002F\u003E\r\n }, это чтобы отдать только маршрут по умолчанию\u003Cbr\u002F\u003E\r\n policy-statement reject {\u003Cbr\u002F\u003E\r\n then reject;\u003Cbr\u002F\u003E\r\n } , а это чтобы отбросить все остальные маршруты.\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПограничные маршрутизаторы настроили, каждый принимает full-view от аплинков и отдает наши сети. Теперь настраиваем vlan для внутреннего bgp, внутри него подымаем связь по протоколу bgp между пограничными маршрутизаторами для обмена маршрутами между ними. Выделяем IP адреса будущим шейперами, но желательно не один, а несколько, для пула внешних IP адресов используемых для NAT. В моем случае по 4-ре адреса на каждый шейпер, но вы можете больше или меньше. В зависимости от размера сети и количества абонентов.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНастройка сервера для шейпирования и NAT на FreeBSD\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДостаем сервер из коробки, и начинаем устанавливать на него FreeBSD, лучше последней стабильной версии. Устанавливать FreeBSD желательно в самой минимальной комплектации, не забыв отметить порты и дерево исходных кодов ядра (после настройки можно удалить)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПосле того как поставили FreeBSD, начинаем настраивать на ней сеть. В \u002Fetc\u002Fresolv.conf задаем адреса dns серверов и прописываем маршрут по умолчанию и IP адреса в файл \u002Fetc\u002Frc.conf (не смотря на наличие bgp маршрут по умолчанию лишним никогда не будет, на случай проблем с квагой которую мы будем ставить далее)\u003Cbr\u002F\u003E\r\n------\u002Fetc\u002Frc.conf----\u003Cbr\u002F\u003E\r\n\u003Ccode\u003Edefaultrouter=\"195.xxx.xxx.225\" #маршрут по умолчанию\u003Cbr\u002F\u003E\r\ngateway_enable=\"YES\" #включаем режим пересылке пакетов между интерфейсами\u003Cbr\u002F\u003E\r\nhostname=\"gw2.xxx.ru\" #задаем имя маршрутизатора\u003Cbr\u002F\u003E\r\n# em0 – внешний интерфейс в влане c внутренним bgp\u003Cbr\u002F\u003E\r\nifconfig_em0=\"up\"\u003Cbr\u002F\u003E\r\nifconfig_em0=\"inet 195.xxx.xx.231 netmask 255.255.255.240\" #освновной IP адрес\u003Cbr\u002F\u003E\r\nifconfig_em0_alias0=\"inet 195.xxx.xxx.232 netmask 255.255.255.255\" #дополнительные IP.\u003Cbr\u002F\u003E\r\nifconfig_em0_alias1=\"inet 195.xxx.xxx.233 netmask 255.255.255.255\" #алиасы\u003Cbr\u002F\u003E\r\nifconfig_em0_alias2=\"inet 195.xxx.xxx.234 netmask 255.255.255.255\"\u003Cbr\u002F\u003E\r\n#em1 – внутренняя сеть, в моем случае это vlan между шейперами и l3 коммутаторами\u003Cbr\u002F\u003E\r\nifconfig_em1=\"up\"\u003Cbr\u002F\u003E\r\nifconfig_em1=\"inet 195.xxx.xxx.193 netmask 255.255.255.248\"\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n — Сеть поднялась, яндекс запинговался. Теперь обновляем дерево портов\u003Cbr\u002F\u003E\r\nДерево портов можно обновить с использованием утилиты portsnap или csup\u003Cbr\u002F\u003E\r\nВ нашем случае будем обновлять через portsnap. Для этого пишем команды:\u003Cbr\u002F\u003E\r\nportsnap fetch, это загрузит полное дерево портов в каталог \u002Fvar\u002Fdb\u002Fportsnap\u003Cbr\u002F\u003E\r\nportsnap extract, этой командой мы распакуем новое дерево портов в каталог \u002Fusr\u002Fports\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПосле обновления портов имеет смысл заняться сборкой своего собственного ядра, хотя делать это не обязательно, ipfw, dummynet и pf можно подгрузить модулями, а на производительность пересобранное ядро особо не влияет. В нашем случае пересборка ядра нужна из за опции HZ, это интервал таймера. По умолчанию там стоит 100, что не очень подходит для больших скоростей, поэтому будем менять его на 2000\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nКопируем дистрибутивный конфиг ядра в другой файл\u003Cbr\u002F\u003E\r\ncp \u002Fusr\u002Fsrc\u002Fsys\u002Fi386\u002Fconf\u002FGENERIC \u002Fusr\u002Fsrc\u002Fsys\u002Fi386\u002Fconf\u002Frouter-001\u003Cbr\u002F\u003E\r\nоткрываем файл router-001 текстовым редактором (vi, nano) и начинаем его править. После правки ядра под ваши нужды надо не забыть добавить в конфиг ядра следующие параметры:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003E#ipfw firewall , этим мы будем шейпить пользователей\u003Cbr\u002F\u003E\r\noptions IPFIREWALL\u003Cbr\u002F\u003E\r\noptions IPFIREWALL_VERBOSE\u003Cbr\u002F\u003E\r\noptions IPFIREWALL_VERBOSE_LIMIT=100\u003Cbr\u002F\u003E\r\noptions IPFIREWALL_FORWARD\u003Cbr\u002F\u003E\r\noptions DUMMYNET\u003Cbr\u002F\u003E\r\noptions HZ=2000\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n# pf, а этим мы будем NAT-ить локальные IP\u003Cbr\u002F\u003E\r\ndevice pf\u003Cbr\u002F\u003E\r\ndevice pflog\u003Cbr\u002F\u003E\r\ndevice pfsync\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДалее командами make buildkernel и make installkernel мы собираем и устанавливаем ядро\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПосле сборки ядра переходим к настройке нашего файрвола ipfw\u003Cbr\u002F\u003E\r\nВ файл \u002Fetc\u002Frc.conf добавляем следующие строки:\u003Cbr\u002F\u003E\r\n\u003Ccode\u003Efirewall_enable=\"YES\"\u003Cbr\u002F\u003E\r\npf_enable=\"YES\"\u003Cbr\u002F\u003E\r\npf_rules=\"\u002Fetc\u002Fpf.conf\"\u003Cbr\u002F\u003E\r\n\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\nполностью очищаем файл \u002Fetc\u002Frc.firewall и начинаем писать в него свои правила, ничего сложного нету так-так rc.firewall представляет собой самый обычный shell скрипт который запускается при старте ipfw\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nстроки которые добавляем в новый \u002Fetc\u002Frc.firewall\u003Cbr\u002F\u003E\r\n\u003Ccode\u003E#!\u002Fbin\u002Fsh , указываем путь к командному интерпретатору\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u002Fsbin\u002Fipfw -q flush\u003Cbr\u002F\u003E\r\n\u002Fsbin\u002Fipfw -q pipe flush , очищаем правила файрвола и очереди dummynet при старте\u003Cbr\u002F\u003E\r\nfwcmd=\"\u002Fsbin\u002Fipfw -q\" , Задаем путь к ipfw и опцию с которой запускаться. –q говорит файрволу о том, чтобы он не спрашивал подтверждения\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nWAN_IP = 195.xxx.xxx.231, указываем основной IP адрес внешнего интерфейса\u003Cbr\u002F\u003E\r\nIBGP_NET = 195.xx.xx.224\u002Fxx\u003Cbr\u002F\u003E\r\nLAN_IP = 10.249.0.0\u002F16 , указываем диапазон наших внутренних сетей\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n${fwcmd} add 10 allow ip from any to any via lo0 , задаем правило разрешающее все на \u003Cbr\u002F\u003E\r\n loopback интерфейсe\u003Cbr\u002F\u003E\r\n \u003Cbr\u002F\u003E\r\n ${fwcmd} add 11 allow ip from me to me , разрешаем пакеты с этого хоста на этот хост\u003Cbr\u002F\u003E\r\n \u003Cbr\u002F\u003E\r\n ${fwcmd} add 12 allow icmp from any to me, разрешаем icmp на этот хост\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n${fwcmd} add 20 allow tcp from table(1) to me dst-port 22 , разрешаем подключаться к шейперу \u003Cbr\u002F\u003E\r\n по протоколу ssh с IP адресов указанных в таблице 1. Занести адрес в эту таблицу можно \u003Cbr\u002F\u003E\r\n командой ipfw table 1 add &lt;ip_address\u003E\u003Cbr\u002F\u003E\r\n \u003Cbr\u002F\u003E\r\n ${fwcmd} add 21 deny tcp from any to me dst-port 22 , окончательно запрещаем ssh. Под это \u003Cbr\u002F\u003E\r\n правило попадут все, кто не в таблице 1\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n${fwcmd} add 30 pipe tablearg ip from any to table(2) out via em1\u003Cbr\u002F\u003E\r\n ${fwcmd} add 31 pipe tablearg ip from table(3) to any in via em1 , выпускаем пользователей из таблиц 2 и 3 в интернет и указываем им конкретный пайп дамминета для шейпинга. Номер пайпа указываем при добавлении пользователя в таблицу, каждая таблица для определенного типа трафика (2 для входящего к клиенту, 3 – для исходящего). Добавление пользователя в таблицу происходит командами ipfw table 2 add &lt;ip клиента\u003E &lt;номер пайпа\u003E и ipfw table 2 add &lt;ip клиента\u003E &lt;номер пайпа\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли вы хотите редиректить заблокированных пользователей, то необходимо будет добавить редирект на \u003Cbr\u002F\u003E\r\n локальный веб-сервер (например nginx)\u003Cbr\u002F\u003E\r\n ${fwcmd} add 38 fwd 127.0.0.1,3128 tcp $LAN_NET to not me dst-port 80\u003Cbr\u002F\u003E\r\n ${fwcmd} add 39 allow tcp from any $LAN_NET src-port 80\u003Cbr\u002F\u003E\r\n \u003Cbr\u002F\u003E\r\n${fwcmd} add 40 deny all from $LAN_NET to not me\u003Cbr\u002F\u003E\r\n${fwcmd} add 41 deny all from not me to $LAN_NET , блокируем пакеты к нашим сетям. Под эти правила попадут те пользователи которые отстутствут в таблице 2 и таблице 3\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n${fwcmd} add 50 allow ip from me to any keep-state , разрешаем полный доступ исходящим соединениям с этого сервера и сохраняем их состояние.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n${fwcmd} add 51 allow tcp from $IBGP_NET to $WAN_IP dst-port 179 , разрешаем хостам находяшимся в vlan со внутренним BGP устанавливать с нами соединение на 179 порт (bgp протокол)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n${fwcmd} add 52 allow ospf from 195.xxx.xxx.192\u002F29 to any , разрешаем ospf с определенной сети\u003Cbr\u002F\u003E\r\nТеперь мы задаем пайпы дамминета, собственно сам шейпинг\u003Cbr\u002F\u003E\r\nПримерно вот так:\u003Cbr\u002F\u003E\r\n#Speed 15Mbps, Для игр\u003Cbr\u002F\u003E\r\n${fwcmd} pipe 1 config mask dst-ip 0xffffffff bw 16000Kbit\u002Fs\u003Cbr\u002F\u003E\r\n${fwcmd} pipe 101 config mask src-ip 0xffffffff bw 16000Kbit\u002Fs\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n#Speed 20Mbps, Для отдыха\u003Cbr\u002F\u003E\r\n${fwcmd} pipe 2 config mask dst-ip 0xffffffff bw 21000Kbit\u002Fs\u003Cbr\u002F\u003E\r\n${fwcmd} pipe 102 config mask src-ip 0xffffffff bw 21000Kbit\u002Fs\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n#Speed 3Mbps, Для новичков\u003Cbr\u002F\u003E\r\n${fwcmd} pipe 3 config mask dst-ip 0xffffffff bw 3500Kbit\u002Fs\u003Cbr\u002F\u003E\r\n${fwcmd} pipe 103 config mask src-ip 0xffffffff bw 3500Kbit\u002Fs\u003Cbr\u002F\u003E\r\n\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\nВ любом случае правим все под себя (не забыва что пакет сначала попадет под действие ipfw, а только потом перейдет на обработку pf) в соответствии с данными рекомендациями, на этом файрвол считаем настроенным. В принципе если вы не хотите использовать tablearg, то можно и не использовать. Есть еще варианты по pipe на клиента или по отдельной таблице на тариф. Эти варианты я не рассматриваю, в связи с высокой нагрузкой на оборудование (pipe на клиента) и неудобством (таблица на тариф)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля полноты картины осталось только настроить NAT, который мы будем делать через pf.\u003Cbr\u002F\u003E\r\nСоздаем файл \u002Fetc\u002Fpf.conf и вписываем в него следующие строки\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nWAN_IF=«em0», это наш внешний интерфейс в влане со внутренним bgp. Именно на нем мы будем производить NAT\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nLOCAL_NET=«10.249.0.0\u002F16», это диапазон нашей локальной сети который будем NATить\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nnat on $WAN_IF from $LOCAL_NET to! $LOCAL_NET -\u003E ($WAN_IF) round-robin sticky-address, а это само правило для NATа из внутренней сети на вшеншний интерфейс \u003Cbr\u002F\u003E\r\nпараметр round-robin означает использование адресов пула по кругу. \u003Cbr\u002F\u003E\r\nпараметр sticky-address используется для гарантии назаначения всегда одного и того же адреса источника в адрес пула.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТеперь приступаем к настройке пакета quagga\u003Cbr\u002F\u003E\r\nОт него нам нужна поддержка bgp и поддержка ospf в моем случае\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nZebra.conf я публиковать не буду, в нем все просто и однотипно. Описываем интерфейсы и статические маршруты, вот вырезка из него:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\ni\u003Ccode\u003Enterface em0\u003Cbr\u002F\u003E\r\nip address 195.xx.xxx.231\u002Fxxx\u003Cbr\u002F\u003E\r\ndescription ibgp\u003Cbr\u002F\u003E\r\n!\u003Cbr\u002F\u003E\r\ninterface em1\u003Cbr\u002F\u003E\r\nip address 195.xxx.xxx.193\u002F29\u003Cbr\u002F\u003E\r\ndescription ospf\u003Cbr\u002F\u003E\r\n!\u003Cbr\u002F\u003E\r\n! Static routes.\u003Cbr\u002F\u003E\r\n!\u003Cbr\u002F\u003E\r\nip route 10.0.0.0\u002F8 Null0 254\u003Cbr\u002F\u003E\r\nip route 79.142.80.132\u002F30 195.xxx.xxx.238\u003Cbr\u002F\u003E\r\nip route 94.124.180.57\u002F30 195.xxx.xxx.225\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПриводим конфиг bgp примерно вот к такому виду. Т.е принимаем маршрут по умолчанию от пограничных маршрутизаторов и отдаем ему какие-либо специфичные маршруты\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003Ehostname gw2.xxx.ru\u003Cbr\u002F\u003E\r\npassword rxxxx\u003Cbr\u002F\u003E\r\nenable password rxxxxx\u003Cbr\u002F\u003E\r\nlog file \u002Fvar\u002Flog\u002Fquagga\u002Fbgpd.log\u003Cbr\u002F\u003E\r\n!\u003Cbr\u002F\u003E\r\nrouter bgp 3333\u003Cbr\u002F\u003E\r\n bgp router-id 195.xxx.xxx.231\u003Cbr\u002F\u003E\r\n bgp log-neighbor-changes\u003Cbr\u002F\u003E\r\n network 195.xxx.xxx.192\u002F29\u003Cbr\u002F\u003E\r\n neighbor 195.xxx.xxx.225 remote-as 3333\u003Cbr\u002F\u003E\r\n neighbor 195.xxx.xxx.225 description j4350-1\u003Cbr\u002F\u003E\r\n neighbor 195.xxx.xxx.225 next-hop-self\u003Cbr\u002F\u003E\r\n neighbor 195.xxx.xxx.238 remote-as 3333\u003Cbr\u002F\u003E\r\n neighbor 195.xxx.xxx.238 description j4350-2\u003Cbr\u002F\u003E\r\n neighbor 195.xxx.xxx.238 next-hop-self\u003Cbr\u002F\u003E\r\n! \u003Cbr\u002F\u003E\r\n\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\nДалее мы настраиваем протокол OSPF (используется в моем случае, так-как параллельно Cisco Catalyst 3560 установлен Dlink DGS-3612)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003EHostname gw2.xxx.ru\u003Cbr\u002F\u003E\r\npassword xxx\u003Cbr\u002F\u003E\r\nenable password xxxx\u003Cbr\u002F\u003E\r\nlog file \u002Fvar\u002Flog\u002Fquagga\u002Fospfd.log\u003Cbr\u002F\u003E\r\n!\u003Cbr\u002F\u003E\r\ninterface em1\u003Cbr\u002F\u003E\r\n!\u003Cbr\u002F\u003E\r\nrouter ospf\u003Cbr\u002F\u003E\r\n ospf router-id 195.xxx.xxx.193\u003Cbr\u002F\u003E\r\n network 195.xxx.xxx.192\u002F29 area 0.0.0.0\u003Cbr\u002F\u003E\r\n default-information originate metric 100\u003Cbr\u002F\u003E\r\n!\u003Cbr\u002F\u003E\r\nline vty\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли у вас стоит коммутатор который умеет работать с BGP, то лучше отказаться от использования OSPF и использовать для этих целей протокол BGP. В таком случае в\u003Cbr\u002F\u003E\r\nbgpd.conf надо внести следующие строки\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003Eneighbor 195.xxx.xxx.195 remote-as 3333\u003Cbr\u002F\u003E\r\nneighbor 195.xxx.xxx.195 description sw-c3560-xxx.ru\u003Cbr\u002F\u003E\r\nneighbor 195.xxx.xxx.195 default-originate\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВроде все настроили, теперь главное не забыть небольшой тюнинг sysctl\u003Cbr\u002F\u003E\r\nДобавляем в существующий \u002Fetc\u002Fsysctl.conf следующие строки\u003Cbr\u002F\u003E\r\n\u003Ccode\u003Enet.inet.ip.forwarding=1 #разрешаем пересылку пакетов между интерфейсами\u003Cbr\u002F\u003E\r\nnet.inet.ip.fw.one_pass=1 #разрешаем однопроходный режим ipfw\u003Cbr\u002F\u003E\r\nnet.inet.icmp.bmcastecho=0 #не отвечаем на пинг на широковещательный адрес\u003Cbr\u002F\u003E\r\nnet.inet.tcp.blackhole=2 #отбрасываем пакеты на закрытый порт (не слушаемый никем)\u003Cbr\u002F\u003E\r\nnet.inet.udp.blackhole=1 # отбрасываем пакеты на закрытый порт (не слушаемый никем)\u003Cbr\u002F\u003E\r\nnet.inet.ip.dummynet.io_fast=1 #новое поведение dummynet( шейпирование канала)\u003Cbr\u002F\u003E\r\nnet.inet.icmp.drop_redirect=1 #дропаем icmp редиректы\u003Cbr\u002F\u003E\r\nnet.inet.icmp.log_redirect=1 #пишем icmp редиректы в log, бывает полезно\u003Cbr\u002F\u003E\r\nnet.inet.ip.redirect=0 # если 0, то нет реакции на ICMP REDIRECT пакеты\u003Cbr\u002F\u003E\r\nnet.inet.ip.dummynet.expire=0 # в случае кратковременного прекращения трафика пользователя не \u003Cbr\u002F\u003E\r\n #выносим его из очереди\u003Cbr\u002F\u003E\r\nnet.inet.ip.dummynet.hash_size=16384 # размер хэш-таблицы, используемой dummynet для \u003Cbr\u002F\u003E\r\n #хранения очередей. Увеличение этого значение ускоряет работу \u003Cbr\u002F\u003E\r\n #dummynet при большом #количестве очередей, естественно в \u003Cbr\u002F\u003E\r\n # обмен на оперативную память\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа этом наш шейпер считаем законченным, я заранее опустил интеграцию его с биллинговой системой, так как у каждого свое и свои методы\u003Cbr\u002F\u003E\r\nМожно смело писать команду reboot и если все было верно настроено то можно приступать к настройке коммутатора 3-го уровня (l3)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nА если мы еще хотим переадресовывать пользователей которым не разрешен доступ в интернет на определенную страницу с информацией о блокировке, то ставим веб сервер nginx и пишем ему в конфиг (nginx.conf) следующий текст\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003E\u003Ca href=\"http:\u002F\u002Fblocked.wktnet.ru\u002Findex.htm\"\u003E\u003C\u002Fa\u003Euser nobody;\u003Cbr\u002F\u003E\r\nworker_processes 2;\u003Cbr\u002F\u003E\r\nevents {\u003Cbr\u002F\u003E\r\n worker_connections 1024;\u003Cbr\u002F\u003E\r\n}\u003Cbr\u002F\u003E\r\nhttp {\u003Cbr\u002F\u003E\r\n include mime.types;\u003Cbr\u002F\u003E\r\n default_type application\u002Foctet-stream;\u003Cbr\u002F\u003E\r\n sendfile on;\u003Cbr\u002F\u003E\r\n keepalive_timeout 35;\u003Cbr\u002F\u003E\r\n server {\u003Cbr\u002F\u003E\r\n listen 3128;\u003Cbr\u002F\u003E\r\n server_name wkt_router;\u003Cbr\u002F\u003E\r\n charset windows-1251;\u003Cbr\u002F\u003E\r\n access_log \u002Fdev\u002Fnull;\u003Cbr\u002F\u003E\r\n rewrite ^(.*) blocked.wktnet.ru\u002Findex.htm permanent;\u003Cbr\u002F\u003E\r\n }\u003Cbr\u002F\u003E\r\n}\u003Cbr\u002F\u003E\r\n\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\nНастройка коммутатора 3-го уровня\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ моей сети используется Cisco WS-C3560G-24-TS-S, там все просто\u003Cbr\u002F\u003E\r\nЗаходим в режим конфигурирования: conf t\u003Cbr\u002F\u003E\r\nПрисваиваем IP адрес интерфейсу vlan-а внутри которого бегает ospf, (та-же сеть что на шейпере на интерфейсе em1)\u003Cbr\u002F\u003E\r\nИ настраиваем ospf\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003Erouter ospf 1\u003Cbr\u002F\u003E\r\n router-id 195.xxx.xxx.195\u003Cbr\u002F\u003E\r\n log-adjacency-changes\u003Cbr\u002F\u003E\r\nnetwork 10.249.33.0 0.0.0.255 area 0.0.0.0\u003Cbr\u002F\u003E\r\n network 10.249.42.0 0.0.0.255 area 0.0.0.0\u003Cbr\u002F\u003E\r\n network 10.249.51.0 0.0.0.255 area 0.0.0.0\u003Cbr\u002F\u003E\r\n network 10.249.55.0 0.0.0.255 area 0.0.0.0\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nсохраняем конфиг командой wr и радуемся достигнутому результату\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nесли вместо протокола ospf вы решили использовать bgp то в конфиг коммутатора необходимо добавить следующие строки\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003Erouter bgp 3333\u003Cbr\u002F\u003E\r\n bgp log-neighbor-changes\u003Cbr\u002F\u003E\r\n network 10.249.33.0 255.255.255.0\u003Cbr\u002F\u003E\r\n redistribute ospf 1\u003Cbr\u002F\u003E\r\n neighbor 195.xxx.xxx.193 remote-as 3333\u003Cbr\u002F\u003E\r\n neighbor 195.xxx.xxx.193 description gw\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\nЕсли у вас используется l3 коммутатор D-link, то на нем настраиваем OSPF следующими командами\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nenable ospf, включаем ospf на коммутаторе\u003Cbr\u002F\u003E\r\nconfig ospf router_id 195.xxx.xxx.196, указываем id роутера\u003Cbr\u002F\u003E\r\nconfig ospf ipif &lt;интерфейс\u003E area 0.0.0.0 state enable, включаем ospf на интерфейсе\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nи сохраняем конфиг командой save\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНастройка резервного сервера\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа соседнем (резервном шейпере) мы производим аналогичную настройку, за исключением конфига ospf и IP адресов\u003Cbr\u002F\u003E\r\nОтличие в том, что default-information originate мы задаем метрику 200, тогда он становится резервным. Хотя можем оставить метрику 100 и получить балансировку нагрузки между шейперами, но в своей сети я этот вариант не использую так как при такой настройке клиенты получат двойную скорость (по тарифной скорости на каждом шейпере). \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЗаключение\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ итоге мы получаем систему с динамической маршрутизацией (в случае отказа одного из шейперов или пограничных маршрутизаторов мы автоматически начинаем использовать соседний, все маршруты сети прописанные на коммутаторах 3-го уровня автоматически появляются в таблице маршрутизации на наших шейперах). Если вас пугает мысль о простаивающем сервере, то можете поиграться с настройками, сменить ospf на bgp, поставить еще один L3 коммутатор и выпускать часть сети через него.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСхема получившегося узла:\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"http:\u002F\u002Fwww.4picture.ru\u002Fpictures\u002F0f288217f95456f6e5076663bacd1876.jpg\" alt=\"image\" data-src=\"http:\u002F\u002Fwww.4picture.ru\u002Fpictures\u002F0f288217f95456f6e5076663bacd1876.jpg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля примера приведу свой rc.firewall\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003Ecat \u002Fetc\u002Frc.firewall\u003Cbr\u002F\u003E\r\n#!\u002Fbin\u002Fsh\u003Cbr\u002F\u003E\r\n#Flush all firewall rules\u003Cbr\u002F\u003E\r\n\u002Fsbin\u002Fipfw -q flush\u003Cbr\u002F\u003E\r\n\u002Fsbin\u002Fipfw -q pipe flush\u003Cbr\u002F\u003E\r\n#Setting firewall path and options for working with rules\u003Cbr\u002F\u003E\r\nfwcmd=\"\u002Fsbin\u002Fipfw -q\"\u003Cbr\u002F\u003E\r\n#variables\u003Cbr\u002F\u003E\r\nIBGP_NET=\"195.93.xxx.xxx\u002F28\" #iBGP network (vlan9)\u003Cbr\u002F\u003E\r\nWAN_IP=\"195.93.xxx.xxx\" #Primary WAN ip address\u003Cbr\u002F\u003E\r\nLAN_IP=\"195.93.xxx.xxx\" #Primary LAN ip address\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n###System rules\u003Cbr\u002F\u003E\r\n${fwcmd} add 10 allow ip from any to any via lo0 #do not filter loobpack\u003Cbr\u002F\u003E\r\n${fwcmd} add 11 allow ip from me to me #allow packets from this host to this host\u003Cbr\u002F\u003E\r\n${fwcmd} add 12 allow icmp from any to me #allow ICMP\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n#allow ssh connections\u003Cbr\u002F\u003E\r\n${fwcmd} add 20 allow tcp from table\\(6\\) to me dst-port 22 #Allow SSH connections (table 6)\u003Cbr\u002F\u003E\r\n${fwcmd} add 29 deny tcp from any to me dst-port 22\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n#allowing users and add his ip to shaping pipe\u003Cbr\u002F\u003E\r\n${fwcmd} add 30 pipe tablearg ip from any to table\\(1\\) out via em1\u003Cbr\u002F\u003E\r\n${fwcmd} add 31 pipe tablearg ip from table\\(2\\) to any in via em1\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n#Block spammerss\u003Cbr\u002F\u003E\r\n${fwcmd} add 34 deny ip from table\\(3\\) to any dst-port 25 #for auto block spammers\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n#allow connections to this networsk\u003Cbr\u002F\u003E\r\n${fwcmd} add 40 allow all from table\\(7\\) to any\u003Cbr\u002F\u003E\r\n${fwcmd} add 41 allow all from any to table\\(7\\)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n#allow active users\u003Cbr\u002F\u003E\r\n${fwcmd} add 45 allow all from not me to table\\(1\\)\u003Cbr\u002F\u003E\r\n${fwcmd} add 46 allow all from table\\(2\\) to not me\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n#By default block users\u003Cbr\u002F\u003E\r\n${fwcmd} add 48 fwd 127.0.0.1,3128 tcp from table\\(8\\) to not me dst-port 80\u003Cbr\u002F\u003E\r\n${fwcmd} add 49 allow tcp from any to table\\(8\\) src-port 80\u003Cbr\u002F\u003E\r\n${fwcmd} add 50 deny all from table\\(8\\) to not me\u003Cbr\u002F\u003E\r\n${fwcmd} add 51 deny all from not me to table\\(8\\)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n###Access rules\u003Cbr\u002F\u003E\r\n#allow outgoing connections\u003Cbr\u002F\u003E\r\n${fwcmd} add 60 allow ip from me to any keep-state #allow all ougoing packets and keep state\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n#Rules allowing SNMP\u003Cbr\u002F\u003E\r\n${fwcmd} add 61 allow udp from table\\(6\\) to $WAN_IP dst-port 161 #Allow SNMP\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n#Rules allowing bgp\u003Cbr\u002F\u003E\r\n${fwcmd} add 64 allow tcp from $IBGP_NET to $WAN_IP dst-port 179 #Allow BGP from iBGP network (vlan 9)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n###############################################заполняем таблицы\u003Cbr\u002F\u003E\r\n#таблица 6 - это те кто имеют доступ к маршрутизатору по ssh,telnet и snmp\u003Cbr\u002F\u003E\r\n${fwcmd} table 6 add 195.93.xxx.xxx #wkt office\u003Cbr\u002F\u003E\r\n${fwcmd} table 6 add 89.xxx.xxx.1 #\u003Cbr\u002F\u003E\r\n ${fwcmd} table 6 add 93.xx.xxx.xxx #\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n#таблица 7 - IP адреса и сети с доступом при выключенном интернете\u003Cbr\u002F\u003E\r\n${fwcmd} table 7 add 195.xxx.xx.0\u002F25 #binat\u003Cbr\u002F\u003E\r\n${fwcmd} table 7 add 195.xx.xx.0\u002F26 #servers dmz\u003Cbr\u002F\u003E\r\n${fwcmd} table 7 add 195.xx3.xx.192\u002F29 #int net\u003Cbr\u002F\u003E\r\n${fwcmd} table 7 add 195.xx.xxx.xxx #c3560-b51\u003Cbr\u002F\u003E\r\n${fwcmd} table 7 add 10.88.88.1\u003Cbr\u002F\u003E\r\n#таблица 8 - это наши локальные сети внутри которых пользователи\u003Cbr\u002F\u003E\r\n${fwcmd} table 8 add 10.87.0.0\u002F16\u003Cbr\u002F\u003E\r\n${fwcmd} table 8 add 10.88.0.0\u002F16\u003Cbr\u002F\u003E\r\n${fwcmd} table 8 add 10.249.0.0\u002F16\u003Cbr\u002F\u003E\r\n${fwcmd} table 8 add 10.90.0.0\u002F16\u003Cbr\u002F\u003E\r\n${fwcmd} table 8 add 195.93.xxx.0\u002F25\u003Cbr\u002F\u003E\r\n${fwcmd} table 8 add 195.93.xxx.128\u002F25\u003Cbr\u002F\u003E\r\n${fwcmd} table 8 add 195.93.xxx.64\u002F26\u003Cbr\u002F\u003E\r\n${fwcmd} table 8 add 195.93.xxx.200\u002F28\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n#таблицы 1 и 2 - это пользователи и их тариф\u003Cbr\u002F\u003E\r\n##WKT tech\u003Cbr\u002F\u003E\r\n${fwcmd} table 1 add 10.87.xx.250\u002F32 55\u003Cbr\u002F\u003E\r\n${fwcmd} table 2 add 10.87.xx.250\u002F32 255\u003Cbr\u002F\u003E\r\n${fwcmd} table 1 add 10.87.xx.251\u002F32 55\u003Cbr\u002F\u003E\r\n${fwcmd} table 2 add 10.87.xx.251\u002F32 255\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nИ bgpd.conf\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ccode\u003Ehostname gw2.xxxx\u003Cbr\u002F\u003E\r\npassword rxxxx\u003Cbr\u002F\u003E\r\nenable password xxx\u003Cbr\u002F\u003E\r\nlog file \u002Fvar\u002Flog\u002Fquagga\u002Fbgpd.log\u003Cbr\u002F\u003E\r\n!\u003Cbr\u002F\u003E\r\nrouter bgp 44xxx\u003Cbr\u002F\u003E\r\n bgp router-id 195.93.xxx.xxx\u003Cbr\u002F\u003E\r\n bgp log-neighbor-changes\u003Cbr\u002F\u003E\r\n network 195.93.2xx.xxx\u002F29\u003Cbr\u002F\u003E\r\n neighbor 195.93.206.xx remote-as 44380\u003Cbr\u002F\u003E\r\n neighbor 195.93.206.xx description j4350-b51\u003Cbr\u002F\u003E\r\n neighbor 195.93.206.xx next-hop-self\u003Cbr\u002F\u003E\r\n neighbor 195.93.206.xx remote-as 44380\u003Cbr\u002F\u003E\r\n neighbor 195.93.206.xx description j4350-k18\u003Cbr\u002F\u003E\r\n neighbor 195.93.206.xx next-hop-self\u003Cbr\u002F\u003E\r\n neighbor 195.93.206.xx remote-as 65000\u003Cbr\u002F\u003E\r\n neighbor 195.93.206.xxdefault-originate\u003Cbr\u002F\u003E\r\n neighbor 195.93.206.xx description sw-c3560g-24ts-b51\u003Cbr\u002F\u003E\r\n neighbor 195.93.206.xx route-map c3560g-b51-in in\u003Cbr\u002F\u003E\r\n neighbor 195.93.206.xx remote-as 65001\u003Cbr\u002F\u003E\r\n neighbor 195.93.206.xx default-originate\u003Cbr\u002F\u003E\r\n neighbor 195.93.206.xx description sw-c3560g-24ts-k18\u003Cbr\u002F\u003E\r\n neighbor 195.93.206.xx route-map c3560g-k18-in in\u003Cbr\u002F\u003E\r\n!\u003Cbr\u002F\u003E\r\n route-map c3560g-k18-in permit 10\u003Cbr\u002F\u003E\r\n set local-preference 200\u003Cbr\u002F\u003E\r\n!\u003Cbr\u002F\u003E\r\n route-map c3560g-b51-in permit 10\u003Cbr\u002F\u003E\r\n set local-preference 300\u003Cbr\u002F\u003E\r\n\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nUPD: для того чтобы прописать в \u002Fboot\u002Floader.conf kern.hz=«2000» не обязательно пересобирать ядро.\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"freebsd"},{"titleHtml":"шейпинг"},{"titleHtml":"bgp"},{"titleHtml":"ospf"},{"titleHtml":"маршрутизатор"},{"titleHtml":"телеком"},{"titleHtml":"интернет"},{"titleHtml":"узел передачи"},{"titleHtml":"провайдер"},{"titleHtml":"роутер"},{"titleHtml":"dummynet"},{"titleHtml":"ipfw"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F82656\u002F9bfb67f3fdb53e10b8b0d1cc0ae61bfb\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F82656\u002F9bfb67f3fdb53e10b8b0d1cc0ae61bfb\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F82656\\\u002F\"},\"headline\":\"Отказоустойчивый узел передачи данных\",\"datePublished\":\"2010-01-31T15:39:22+03:00\",\"dateModified\":\"2010-01-31T21:37:47+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"DenJS\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Каждый оператор ШПД думает о том, как выпускать пользователей в сеть интернет и грамотно ограничивать скорость работы в сети по имеющимся тарифным планам и иметь...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F82656\\\u002F#post-content-body\",\"about\":[\"h_closet\",\"f_popsci\"],\"image\":[\"http:\\\u002F\\\u002Fwww.4picture.ru\\\u002Fpictures\\\u002F0f288217f95456f6e5076663bacd1876.jpg\",\"http:\\\u002F\\\u002Fwww.4picture.ru\\\u002Fpictures\\\u002F0f288217f95456f6e5076663bacd1876.jpg\"]}","metaDescription":"Каждый оператор ШПД думает о том, как выпускать пользователей в сеть интернет и грамотно ограничивать скорость работы в сети по имеющимся тарифным планам и иметь резерв на случай отказа оборудования...","mainImageUrl":null,"amp":false},"polls":[],"commentsEnabled":true,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false},"572164":{"id":"572164","timePublished":"2021-09-27T11:37:23+00:00","isCorporative":false,"lang":"ru","titleHtml":"Первые шаги в ОТО: прецессия орбиты Меркурия","editorVersion":"2.0","postType":"article","postLabels":[{"type":"tutorial","data":null}],"author":{"id":"1832999","alias":"Yermack","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F690\u002F140\u002F823\u002F690140823f555d03574a59d46f648d24.jpg","speciality":"Пользователь"},"statistics":{"commentsCount":2,"favoritesCount":26,"readingCount":3206,"score":18,"votesCount":18},"hubs":[{"relatedData":null,"id":"18840","alias":"julia","type":"collective","title":"Julia","titleHtml":"Julia","isProfiled":true},{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"21968","alias":"physics","type":"collective","title":"Физика","titleHtml":"Физика","isProfiled":false},{"relatedData":null,"id":"22022","alias":"astronomy","type":"collective","title":"Астрономия","titleHtml":"Астрономия","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EКогда речь заходит о теории относительности, частенько на ровном месте разрастаются споры, которые были занесены в почву непонимания и обильно удобрены мифами, недосказанностью и недостаточной математической подготовкой. Даже на лекциях от некоторых профессоров можно услышать, что детище гения Эйнштейна не имеет практической пользы, а на робкие попытки пролепетать что-то про спутниковые системы навигации они пренебрежительно отмахиваются, дескать, там все сложно и двояко. \u003C\u002Fp\u003E\u003Cp\u003EТак что совершенно естественно желание попробовать провести некоторые расчеты самолично, потрогать формулы, покрутить параметры, чтобы постепенно заложить интуицию в столь горячей теме.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa9f\u002Ff59\u002Fb65\u002Fa9ff59b65da6e8b1e6f59314aadb8e3d.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa9f\u002Ff59\u002Fb65\u002Fa9ff59b65da6e8b1e6f59314aadb8e3d.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"прецессия"},{"titleHtml":"меркурий"},{"titleHtml":"теория относительности"},{"titleHtml":"уравнения эйнштейна"},{"titleHtml":"метрики"},{"titleHtml":"спасибо scihub"},{"titleHtml":"спасибо mathpix"},{"titleHtml":"астрология_точная_наука"}]},"579772":{"id":"579772","timePublished":"2021-09-27T05:32:01+00:00","isCorporative":true,"lang":"ru","titleHtml":"Сливы процветают. Эксперт-«параноик» Майкл Баззель о защите личных данных","editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Michael Bazzell","originalUrl":"https:\u002F\u002Finteltechniques.com\u002Fblog\u002F2021\u002F07\u002F23\u002Fpersonal-ransomware-exposure\u002F"}}],"author":{"id":"2297567","alias":"SearchInform_team","fullname":null,"avatarUrl":"","speciality":"Пользователь"},"statistics":{"commentsCount":0,"favoritesCount":8,"readingCount":2430,"score":9,"votesCount":9},"hubs":[{"relatedData":null,"id":"22418","alias":"searchinform","type":"corporative","title":"Блог компании SearchInform","titleHtml":"Блог компании SearchInform","isProfiled":false},{"relatedData":null,"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EНаш очередной пост из серии «интересное на иностранном языке» – рассказ Майкла Баззеля о том, как сберечь свои персональные данные от утечек. Майкл – знаковая фигура в сфере OSINT, работал в правительстве США и ФБР, его приглашали в качестве технического эксперта в сериал «Мистер Робот», который считают достойным с точки зрения достоверности. В личной жизни эксперт придерживается настолько жестких правил в отношении информационной гигиены, что некоторые считают его «неадекватом». Так ли это – может быть несколько мнений. \u003C\u002Fp\u003E\u003Cp\u003EОдин из факторов, который убеждает в правильном подходе Майкла, – что риски обнаружить свои данные в интернете стали существенно выше, потому что шифровальщики без разбору сливают в сеть все, до чего дотягиваются при атаках на бизнес. Приводим перевод \u003Ca href=\"https:\u002F\u002Finteltechniques.com\u002Fblog\u002F2021\u002F07\u002F23\u002Fpersonal-ransomware-exposure\u002F\"\u003Eпоста Майкла Баззеля\u003C\u002Fa\u003E. \u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EАтакуют корпорации, а страдают люди\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003EБольшинство людей не задумываются о том, как их касается проблема распространения вирусов-шифровальщиков. Логика такова: речь идет о проблемах компаний, это они вынуждены платить выкуп. При чем тут, казалось бы, обычные люди?! \u003C\u002Fp\u003E\u003Cp\u003EА при том, что преступники сменили тактику: сейчас они не просто шифруют данные, но и скачивают их, выкладывают в открытый доступ, если компании не платят им выкуп. Теперь давайте подумаем, что в этих слитых базах? Множество данных о сотрудниках, клиентах, контрагентах, с которыми компания-жертва работает.\u003C\u002Fp\u003E\u003Cp\u003EХочу сразу уточнить: я это пишу не потому что выступаю за уплату выкупа. Я за то, чтобы сопротивляться избыточному сбору данных там, где это не обязательно. Мы халатно относимся к своим ПДн, раздавая их по первому требованию.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe3b\u002F3e1\u002F2c2\u002Fe3b3e12c2036d90018b804276e31ebea.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe3b\u002F3e1\u002F2c2\u002Fe3b3e12c2036d90018b804276e31ebea.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"персональные данные"},{"titleHtml":"пдн"},{"titleHtml":"сёрчинформ"},{"titleHtml":"Майкл Баззел"},{"titleHtml":"утечки информации"}]},"579854":{"id":"579854","timePublished":"2021-09-27T06:03:01+00:00","isCorporative":true,"lang":"ru","titleHtml":"Видишь уязвимости? А они есть! Наше исследование популярных CMS-систем","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2684283","alias":"Solar_Pentest","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":8,"favoritesCount":25,"readingCount":4076,"score":27,"votesCount":29},"hubs":[{"relatedData":null,"id":"20826","alias":"solarsecurity","type":"corporative","title":"Блог компании Ростелеком-Солар","titleHtml":"Блог компании Ростелеком-Солар","isProfiled":false},{"relatedData":null,"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true},{"relatedData":null,"id":"260","alias":"php","type":"collective","title":"PHP","titleHtml":"PHP","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЛьвиная доля всех работ по анализу защищенности внешнего периметра – это тестирование веб-приложений. Здесь могут быть как корпоративные решения, так и «домашние» разработки на базе различных публичных систем управления контентом (CMS). Мы всегда проводим глубокий анализ подобных решений на тестовых стендах и зачастую находим уязвимости нулевого дня. Собственно, из опыта таких проектов и родилась идея собрать исследовательскую команду и провести глубокий анализ популярных CMS-систем и различных плагинов для них. В этом посте мы поделимся результатами нашего исследования, а также продемонстрируем примеры уязвимого кода наиболее интересных, на наш взгляд, уязвимостей и примеры их эксплуатации. Конечно все эти уязвимости уже исправлены и описываются здесь с разрешения владельцев систем.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6df\u002F317\u002F4e6\u002F6df3174e60bbe263a70bcafdf9e51e6b.jpg","buttonTextHtml":"Не всё то в безопасности, что с Bug Bounty","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6df\u002F317\u002F4e6\u002F6df3174e60bbe263a70bcafdf9e51e6b.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"cms"},{"titleHtml":"уязвимости"},{"titleHtml":"уязвимости и их эксплуатация"},{"titleHtml":"уязвимость нулевого дня"}]},"580008":{"id":"580008","timePublished":"2021-09-27T06:30:02+00:00","isCorporative":false,"lang":"ru","titleHtml":"Летний Магнитогорск","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2614609","alias":"city_scraper","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F8f8\u002Fd6c\u002F328\u002F8f8d6c328ec3a513103b6757c2c21610.png","speciality":"Пользователь"},"statistics":{"commentsCount":6,"favoritesCount":3,"readingCount":3835,"score":14,"votesCount":20},"hubs":[{"relatedData":null,"id":"22012","alias":"Ecology","type":"collective","title":"Экология","titleHtml":"Экология","isProfiled":false},{"relatedData":null,"id":"22024","alias":"urban","type":"collective","title":"Урбанизм","titleHtml":"Урбанизм","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EМагнитогорск Челябинской области – один из крупнейших мировых центров чёрной металлургии. В России это шестой из крупнейших городов, которые не являются центрами субъектов страны. \u003C\u002Fp\u003E\u003Cp\u003EСовсем недавно город был одним из наиболее неблагополучных с точки зрения загрязнения атмосферного воздуха, но в 2021 году был зафиксирован «повышенный» уровень – то есть не «высокий» или «очень высокий», как раньше. \u003C\u002Fp\u003E\u003Cp\u003EКак этот город выглядит летом? Где и как его жители могут проводить время?\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F030\u002F0d1\u002Fcff\u002F0300d1cff2029948d33d803000331724.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F030\u002F0d1\u002Fcff\u002F0300d1cff2029948d33d803000331724.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Магнитогорск"},{"titleHtml":"промышленность"},{"titleHtml":"промышленные города"},{"titleHtml":"урбанизм\u002Fурбания"},{"titleHtml":"урбанистика"},{"titleHtml":"города России"},{"titleHtml":"города"}]},"580050":{"id":"580050","timePublished":"2021-09-27T10:23:25+00:00","isCorporative":false,"lang":"ru","titleHtml":"Один человек ответил на 85+ тысяч вопросов на Stack Overflow (24,1 ответа в день)","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"1585037","alias":"sahsAGU","fullname":"Александр Гуреев","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F43c\u002F6c7\u002F0ab\u002F43c6c70ab024d45474e6abe8db797573.jpg","speciality":"Автор"},"statistics":{"commentsCount":36,"favoritesCount":10,"readingCount":11160,"score":12,"votesCount":20},"hubs":[{"relatedData":null,"id":"260","alias":"php","type":"collective","title":"PHP","titleHtml":"PHP","isProfiled":true},{"relatedData":null,"id":"306","alias":"mysql","type":"collective","title":"MySQL","titleHtml":"MySQL","isProfiled":true},{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"594","alias":"sql","type":"collective","title":"SQL","titleHtml":"SQL","isProfiled":true},{"relatedData":null,"id":"7152","alias":"data_mining","type":"collective","title":"Data Mining","titleHtml":"Data Mining","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003E\u003Cstrong\u003EВ среднем 24,1 ответа в день (если все 365 дней в году считать рабочими) на протяжении почти 10 лет.\u003C\u002Fstrong\u003E \u003C\u002Fp\u003E\u003Cp\u003EНесколько дней назад на некоторых англоязычных ресурсах началось обсуждение одного очень необычного пользователя Stack Overflow. Его зовут Гордон Линофф (Gordon Linoff), он из Нью-Йорка, и за 9 лет и 8 месяцев своего присутствия на платформе он дал 85,201 ответов на различные вопросы, в основном связанные с SQL и дата-майнингом (цифра актуальна на 27.09.2021). \u003C\u002Fp\u003E\u003Cp\u003EЧто это за маг?\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F396\u002F5ac\u002Fef4\u002F3965acef48ae14917c514fa091f60d1a.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F396\u002F5ac\u002Fef4\u002F3965acef48ae14917c514fa091f60d1a.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"sql"},{"titleHtml":"mysql"},{"titleHtml":"stackoverflow"},{"titleHtml":"базы данных"},{"titleHtml":"дата майнинг"},{"titleHtml":"data mining"}]},"580060":{"id":"580060","timePublished":"2021-09-27T09:00:04+00:00","isCorporative":true,"lang":"ru","titleHtml":"Арракис, который мы заслужили","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"238277","alias":"Zelenyikot","fullname":"Виталий Егоров","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F22b\u002F2d7\u002F7a5\u002F22b2d77a57b687aae24784a3e53089c9.jpg","speciality":"Популяризатор космонавтики"},"statistics":{"commentsCount":113,"favoritesCount":40,"readingCount":22322,"score":133,"votesCount":145},"hubs":[{"relatedData":null,"id":"19791","alias":"ruvds","type":"corporative","title":"Блог компании RUVDS.com","titleHtml":"Блог компании RUVDS.com","isProfiled":false},{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"21962","alias":"space","type":"collective","title":"Космонавтика","titleHtml":"Космонавтика","isProfiled":false},{"relatedData":null,"id":"21984","alias":"sci-fi","type":"collective","title":"Научная фантастика","titleHtml":"Научная фантастика","isProfiled":false},{"relatedData":null,"id":"22014","alias":"futurenow","type":"collective","title":"Будущее здесь","titleHtml":"Будущее здесь","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F580060\u002F\"\u003E\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fk0\u002Fds\u002Fy5\u002Fk0dsy5npxclyjdytiroqga7-leu.jpeg\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fa\u003E\u003Cbr\u003E\r\nВо вселенной писателя-фантаста Фрэнка Герберта, Дюна, она же Арракис &mdash; это пустынная и маловодная планета с двумя лунами. По сюжету, она находится за пределами Солнечной системы, но если мы захотим поискать ближайшую схожую параллель,&nbsp;то больше всего подходит планета Марс. Предлагаю воспользоваться возможностями, которые даёт современная космонавтика, и совершить воображаемую прогулку на нашу Дюну.\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Марс"},{"titleHtml":"Дюна"},{"titleHtml":"MRO"},{"titleHtml":"Curiosity"},{"titleHtml":"марсоход"},{"titleHtml":"ruvds_статьи"}]},"580124":{"id":"580124","timePublished":"2021-09-27T13:03:14+00:00","isCorporative":true,"lang":"ru","titleHtml":"Электролюминесцентные индикаторы из прошлого","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"146371","alias":"radiolok","fullname":"Артем Кашканов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fa46\u002Fc6a\u002F151\u002Fa46c6a15193f7c0cac79d2736b107358.jpg","speciality":"Релейно-декатронный маньяк"},"statistics":{"commentsCount":13,"favoritesCount":37,"readingCount":5169,"score":75,"votesCount":75},"hubs":[{"relatedData":null,"id":"19791","alias":"ruvds","type":"corporative","title":"Блог компании RUVDS.com","titleHtml":"Блог компании RUVDS.com","isProfiled":false},{"relatedData":null,"id":"21484","alias":"electronics","type":"collective","title":"Производство и разработка электроники","titleHtml":"Производство и разработка электроники","isProfiled":true},{"relatedData":null,"id":"21906","alias":"history","type":"collective","title":"История IT","titleHtml":"История IT","isProfiled":false},{"relatedData":null,"id":"21930","alias":"antikvariat","type":"collective","title":"Старое железо","titleHtml":"Старое железо","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"Сегодня речь пойдёт об электролюминесцентных индикаторах. Но, не о тех, которые окружают вас повсюду и к которым вы привыкли, а о других — получивших огромную популярность в 60-е годы прошлого века, и так же стремительно канувших в небытие. Заодно запущу свою коллекцию индикаторов, как серийно выпускавшихся, так и уникальных опытных и даже — лабораторных образцов.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F523004\u002F\"\u003E\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F94e\u002F51f\u002F459\u002F94e51f459ae59c9d2fe6c448cb07bcca.gif\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fa\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Индикатор"},{"titleHtml":"электролюминесцентность"},{"titleHtml":"ruvds_статьи"}]},"580150":{"id":"580150","timePublished":"2021-09-27T10:50:03+00:00","isCorporative":true,"lang":"ru","titleHtml":"Топ-5 когнитивных искажений при планировании в IT","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2794469","alias":"KM_QA","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":7,"favoritesCount":54,"readingCount":6008,"score":38,"votesCount":40},"hubs":[{"relatedData":null,"id":"14332","alias":"oleg-bunin","type":"corporative","title":"Блог компании Конференции Олега Бунина (Онтико)","titleHtml":"Блог компании Конференции Олега Бунина (Онтико)","isProfiled":false},{"relatedData":null,"id":"19583","alias":"dev_management","type":"collective","title":"Управление разработкой","titleHtml":"Управление разработкой","isProfiled":true},{"relatedData":null,"id":"20736","alias":"hr_management","type":"collective","title":"Управление персоналом","titleHtml":"Управление персоналом","isProfiled":true},{"relatedData":null,"id":"20754","alias":"tech_events","type":"collective","title":"Конференции","titleHtml":"Конференции","isProfiled":false},{"relatedData":null,"id":"21990","alias":"brain","type":"collective","title":"Мозг","titleHtml":"Мозг","isProfiled":false}],"flows":[{"id":"3","alias":"management","title":"Менеджмент"},{"id":"4","alias":"marketing","title":"Маркетинг"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЭта статья подходит для тимлидов и их подопечных, а также для всех, кто оценивает проекты и задачи. Я расскажу, как и почему мы делаем ошибки из-за когнитивных искажений. Попадаем в них мы почти все, просто потому что мы живые люди. И на примере одного дня из жизни тимлида я хочу показать, в какие искажения чаще всего влетают в IT, и&nbsp; — самое полезное&nbsp; —&nbsp; как из них можно выходить.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EЗамечу, что искать когнитивные искажения стоит, в первую очередь, у себя, а не у коллег. \u003C\u002Fstrong\u003EИ что рассказывать про искажения намного проще, чем не влетать в их на практике, однако, если этому научиться, то в перспективе это изрядно окупается, потому что экономит и время, и деньги, помогая и нам, и команде.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb78\u002F76f\u002F001\u002Fb7876f0010e85c328462a735df0b76e8.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb78\u002F76f\u002F001\u002Fb7876f0010e85c328462a735df0b76e8.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"когнитивные искажения"},{"titleHtml":"нейрофизиология"},{"titleHtml":"мозг"},{"titleHtml":"психология"},{"titleHtml":"тимлидство"},{"titleHtml":"тимлид"},{"titleHtml":"управление людьми"},{"titleHtml":"управление проектами и командой"},{"titleHtml":"управление командой"},{"titleHtml":"управление персоналом"}]},"580164":{"id":"580164","timePublished":"2021-09-27T11:17:58+00:00","isCorporative":true,"lang":"ru","titleHtml":"Измеряем производительность String.format() в Java","editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"@cowtowncoder","originalUrl":"https:\u002F\u002Fcowtowncoder.medium.com\u002Fmeasuring-performance-of-java-string-format-or-lack-thereof-2e1c6a13362c"}}],"author":{"id":"2571061","alias":"GolovinDS","fullname":"Дмитрий Головин","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd27\u002Fccd\u002F743\u002Fd27ccd743d8bccbf1a885e5dadaa7ffe.jpg","speciality":"Контент-маркетолог"},"statistics":{"commentsCount":0,"favoritesCount":16,"readingCount":1743,"score":9,"votesCount":11},"hubs":[{"relatedData":null,"id":"21052","alias":"otus","type":"corporative","title":"Блог компании OTUS","titleHtml":"Блог компании OTUS","isProfiled":false},{"relatedData":null,"id":"4","alias":"hi","type":"collective","title":"Высокая производительность","titleHtml":"Высокая производительность","isProfiled":true},{"relatedData":null,"id":"375","alias":"java","type":"collective","title":"Java","titleHtml":"Java","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЯ раньше считал, что JDK в целом хорошо оптимизирована, и если в JDK есть простой способ решения какой-то задачи, то он вполне подойдет для большинства ситуаций и будет работать хорошо.\u003C\u002Fp\u003E\u003Cp\u003EНо я обнаружил, что иногда некоторые классы или методы работают на удивление плохо. Знание таких аномалий полезно при работе с требовательным к производительности кодом.\u003C\u002Fp\u003E\u003Cp\u003EВ этом посте рассмотрим один из подобных кейсов: поразительно низкая производительность \u003Ccode\u003EString.format()\u003C\u002Fcode\u003E при простой конкатенации строк.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fed4\u002F612\u002F7ef\u002Fed46127ef6d1b8f8d650482dfd335220.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fed4\u002F612\u002F7ef\u002Fed46127ef6d1b8f8d650482dfd335220.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"java"},{"titleHtml":"performance"},{"titleHtml":"jdk"}]},"580166":{"id":"580166","timePublished":"2021-09-27T11:22:03+00:00","isCorporative":false,"lang":"ru","titleHtml":"Новости из жизни Haiku за август-сентябрь 2021","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"375413","alias":"petr97","fullname":"Ахламов Петр","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fadf\u002F830\u002F79c\u002Fadf83079c33fd56935b929935559572a.jpg","speciality":"Пользователь"},"statistics":{"commentsCount":2,"favoritesCount":3,"readingCount":1756,"score":8,"votesCount":8},"hubs":[{"relatedData":null,"id":"144","alias":"open_source","type":"collective","title":"Open source","titleHtml":"Open source","isProfiled":true},{"relatedData":null,"id":"559","alias":"cpp","type":"collective","title":"C++","titleHtml":"C++","isProfiled":true},{"relatedData":null,"id":"7330","alias":"qt_software","type":"collective","title":"Qt","titleHtml":"Qt","isProfiled":true},{"relatedData":null,"id":"21918","alias":"soft","type":"collective","title":"Софт","titleHtml":"Софт","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЗдравствуйте, дорогие друзья. Продолжаю Вас знакомить на Хабре с новостями проекта Haiku.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F877\u002Fa0f\u002Fc9c\u002F877a0fc9c92663d8cd2acc965493dacc.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F877\u002Fa0f\u002Fc9c\u002F877a0fc9c92663d8cd2acc965493dacc.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Haiku"},{"titleHtml":"Intel"},{"titleHtml":"VESA"},{"titleHtml":"RISC-V"},{"titleHtml":"Веб-камера"},{"titleHtml":"Превью"},{"titleHtml":"Куба"},{"titleHtml":"Wine"},{"titleHtml":"Менеджер окон"}]},"580172":{"id":"580172","timePublished":"2021-09-27T11:45:49+00:00","isCorporative":true,"lang":"ru","titleHtml":"Небинарный ngIf*","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"1050218","alias":"Waterplea","fullname":"Александр Инкин","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fa70\u002F569\u002Ff31\u002Fa70569f31346559ce2b8b875e7f97480.jpg","speciality":"Google Developer Expert | Angular"},"statistics":{"commentsCount":1,"favoritesCount":13,"readingCount":940,"score":15,"votesCount":15},"hubs":[{"relatedData":null,"id":"17420","alias":"tinkoff","type":"corporative","title":"Блог компании TINKOFF","titleHtml":"Блог компании TINKOFF","isProfiled":false},{"relatedData":null,"id":"91","alias":"webdev","type":"collective","title":"Разработка веб-сайтов","titleHtml":"Разработка веб-сайтов","isProfiled":true},{"relatedData":null,"id":"18109","alias":"angular","type":"collective","title":"Angular","titleHtml":"Angular","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EВам когда-нибудь хотелось отобразить состояние загрузки, пока \u003Ccode\u003EngIf\u003C\u002Fcode\u003E ждет ответа от \u003Ccode\u003Easync\u003C\u002Fcode\u003E-пайпа? Или, может, вы мечтали передать в \u003Ccode\u003EngFor\u003C\u002Fcode\u003E шаблон для пустого массива? Возможно, вы бросили это, потому что вам не хотелось реализовывать базовую логику этих директив самому. На самом деле в этом нет нужды! Один и тот же селектор может подцепить несколько директив, что позволяет расширить функциональность встроенных директив дополнительной логикой.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F846\u002F786\u002F3e2\u002F8467863e2df65db32cb31f4b16c822ef.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F846\u002F786\u002F3e2\u002F8467863e2df65db32cb31f4b16c822ef.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"template"},{"titleHtml":"directive"},{"titleHtml":"angular"},{"titleHtml":"structural"}]},"580194":{"id":"580194","timePublished":"2021-09-27T12:36:12+00:00","isCorporative":true,"lang":"ru","titleHtml":"Сотрудники на карте: отвечаем на 10 важных вопросов о трекинге","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"1254716","alias":"Axelus","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F118\u002Fc4f\u002F08f\u002F118c4f08ffa66438ad6be22e205d563d.png","speciality":"Разработчик"},"statistics":{"commentsCount":0,"favoritesCount":7,"readingCount":1092,"score":13,"votesCount":15},"hubs":[{"relatedData":null,"id":"20758","alias":"regionsoft","type":"corporative","title":"Блог компании RegionSoft","titleHtml":"Блог компании RegionSoft","isProfiled":false},{"relatedData":null,"id":"6398","alias":"it-infrastructure","type":"collective","title":"IT-инфраструктура","titleHtml":"IT-инфраструктура","isProfiled":true},{"relatedData":null,"id":"12365","alias":"saas","type":"collective","title":"SaaS \u002F S+S","titleHtml":"SaaS \u002F S+S","isProfiled":true},{"relatedData":null,"id":"17783","alias":"geo","type":"collective","title":"Геоинформационные сервисы","titleHtml":"Геоинформационные сервисы","isProfiled":true},{"relatedData":null,"id":"20736","alias":"hr_management","type":"collective","title":"Управление персоналом","titleHtml":"Управление персоналом","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"3","alias":"management","title":"Менеджмент"},{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЛюбой контроль сотрудников — опасный и болезненный вопрос, особенно в небольших компаниях. Часто в дружеские и открытые отношения компании не вписывается ни одна из форм контроля, рассчитывать можно только на доверие. Но пресловутый ковид и здесь внёс свои коррективы: расширение удалённой работы, увеличение штата мобильных сотрудников, частичная занятость пополнили ряды полевых сисадминов, аутсорсеров поддержки и остальных «разъездных» работников. Увы, люди разные и вслед за приятными плодами и бонусами удалёнки пришли негативные истории про поведение курьеров, опоздания и откровенные нарушения сотрудников на территории клиентов, неявки на работу или к заказчику и т.д. С этим столкнулись и ритейл, и ИТ, и любая сфера с мобильными сотрудниками. Очень хочется верить в лучшее, но без минимального контроля можно просто потерять бизнес — и тогда пострадают коллеги нерадивых сотрудников.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe4a\u002F5b9\u002Fa9d\u002Fe4a5b9a9d62c342fa897f4531ec9301b.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe4a\u002F5b9\u002Fa9d\u002Fe4a5b9a9d62c342fa897f4531ec9301b.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"geomonitor"},{"titleHtml":"геолокация"},{"titleHtml":"геозона"},{"titleHtml":"трекинг"}]},"580196":{"id":"580196","timePublished":"2021-09-27T12:28:15+00:00","isCorporative":true,"lang":"ru","titleHtml":"Зачем нужен динамический анализ кода, на примере проекта PVS-Studio","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"2302295","alias":"MrROBUST","fullname":"Алексей Говоров","avatarUrl":"","speciality":"Пользователь"},"statistics":{"commentsCount":0,"favoritesCount":4,"readingCount":706,"score":9,"votesCount":9},"hubs":[{"relatedData":null,"id":"18095","alias":"pvs-studio","type":"corporative","title":"Блог компании PVS-Studio","titleHtml":"Блог компании PVS-Studio","isProfiled":false},{"relatedData":null,"id":"559","alias":"cpp","type":"collective","title":"C++","titleHtml":"C++","isProfiled":true},{"relatedData":null,"id":"11606","alias":"vs","type":"collective","title":"Visual Studio","titleHtml":"Visual Studio","isProfiled":true},{"relatedData":null,"id":"21456","alias":"win_dev","type":"collective","title":"Разработка под Windows","titleHtml":"Разработка под Windows","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EВ разговоре с Маршаллом Клоу на подкасте CppCast #300 ABI Stability была затронута достаточно давняя новость о поддержке компиляторами Visual Studio инструмента AddressSanitizer (ASan). Мы уже достаточно давно внедрили ASan в свою систему тестирования и хотим рассказать о паре интересных ошибок, которые он помог найти.\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F7ef\u002F2db\u002F210\u002F7ef2db210d677f9a8c07026d4361d3ba.png\" alt=\"0868_PVS-Studio_ASan_ru\u002Fimage2.png\"\u003E\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"pvs-studio"},{"titleHtml":"clang"},{"titleHtml":"asan"},{"titleHtml":"sanitizer"},{"titleHtml":"динамический анализ кода"}]},"580204":{"id":"580204","timePublished":"2021-09-27T12:31:54+00:00","isCorporative":false,"lang":"ru","titleHtml":"Почему using namespace std; это плохо","editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"sbi, Greg Hewgill","originalUrl":"https:\u002F\u002Fstackoverflow.com\u002Fquestions\u002F1452721\u002Fwhy-is-using-namespace-std-considered-bad-practice"}}],"author":{"id":"936030","alias":"F0iL","fullname":"K. just K.","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fbcd\u002F9c7\u002F270\u002Fbcd9c7270c0727e164ac404a7f929971.jpg","speciality":"Разработчик"},"statistics":{"commentsCount":12,"favoritesCount":13,"readingCount":4833,"score":16,"votesCount":24},"hubs":[{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"524","alias":"complete_code","type":"collective","title":"Совершенный код","titleHtml":"Совершенный код","isProfiled":true},{"relatedData":null,"id":"559","alias":"cpp","type":"collective","title":"C++","titleHtml":"C++","isProfiled":true},{"relatedData":null,"id":"17188","alias":"compilers","type":"collective","title":"Компиляторы","titleHtml":"Компиляторы","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EТо, что написано ниже, для многих квалифицированных C++ разработчиков будет прекрасно известной и очевидной вещью, но тем не менее, я периодически встречаю using namespace std; в коде различных проектов, а недавно в \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F579998\" rel=\"noopener noreferrer nofollow\"\u003Eнашумевшей статье про впечатления от высшего образования\u003C\u002Fa\u003E было упомянуто, что студентов так учат писать код в вузах, поэтому давайте повторим очевидное еще раз.\u003C\u002Fp\u003E\u003Cp\u003EИтак... многие слышали, что \u003Cstrong\u003Eusing namespace std;\u003C\u002Fstrong\u003E в C++ считается плохой практикой. Касательно недопустимости использования using namespace в header-файлах вопросов обычно не возникает, если мы хоть немного понимаем, как работает препроцессор компилятора: .hpp-файлы при использовании директивы #include вставляются в код \"как есть\", и соответственно using автоматически распространится на все затронутые  .hpp- и .cpp-файлы, если файл с ним был заинклюден хоть в одном звене цепочки (на одном из сайтов это метко обозвали как \"заболевание, передающеемя половым путем\"). Но вот про .cpp-файлы все не так очевидно, так что давайте еще раз разберем, что же именно здесь не так.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F662\u002F8a9\u002Fe33\u002F6628a9e3322ab1dbca4e4976098da83d.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F662\u002F8a9\u002Fe33\u002F6628a9e3322ab1dbca4e4976098da83d.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"с++"},{"titleHtml":"namespace"},{"titleHtml":"namespaces"},{"titleHtml":"best practices"},{"titleHtml":"антипаттерны"}]},"580206":{"id":"580206","timePublished":"2021-09-27T12:51:03+00:00","isCorporative":false,"lang":"ru","titleHtml":"МТС отказался от скрытых мобильных подписок?","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2467147","alias":"Plusodin","fullname":"Владимир","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F343\u002Fb77\u002Fd12\u002F343b77d12f047368849a9880276f936e.jpg","speciality":"Пользователь"},"statistics":{"commentsCount":11,"favoritesCount":4,"readingCount":5129,"score":14,"votesCount":14},"hubs":[{"relatedData":null,"id":"22008","alias":"cellular","type":"collective","title":"Сотовая связь","titleHtml":"Сотовая связь","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EПривет, Хабр!\u003C\u002Fp\u003E\u003Cp\u003EНу что, подходит к концу первый сезон сериала «О скрытых мобильных подписках и операторах связи». Предыдущие три серии: \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F550448\u002F\" rel=\"noopener noreferrer nofollow\"\u003EМегафон\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F563260\u002F\" rel=\"noopener noreferrer nofollow\"\u003EБилайн\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F571256\u002F\" rel=\"noopener noreferrer nofollow\"\u003ETele2\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cp\u003EНу и вишенка на этом торте – МТС.\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"мтс"},{"titleHtml":"мобильные подписки"},{"titleHtml":"подписки"},{"titleHtml":"оператор связи"},{"titleHtml":"теле2"},{"titleHtml":"мегафон"},{"titleHtml":"билайн"}]},"580208":{"id":"580208","timePublished":"2021-09-27T12:52:27+00:00","isCorporative":false,"lang":"ru","titleHtml":"Основная проблема образования","editorVersion":"2.0","postType":"article","postLabels":[{"type":"recovery","data":null}],"author":{"id":"2270142","alias":"Chronicler","fullname":"Пушиз де Хрониклер","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Faa3\u002F149\u002Fdb0\u002Faa3149db0de5f6c071dfade7285fcb99.jpg","speciality":"Исследователь ближнего заполярья, почетный манул"},"statistics":{"commentsCount":17,"favoritesCount":15,"readingCount":2533,"score":8,"votesCount":20},"hubs":[{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"17189","alias":"itstandarts","type":"collective","title":"IT-стандарты","titleHtml":"IT-стандарты","isProfiled":true},{"relatedData":null,"id":"20682","alias":"pm","type":"collective","title":"Управление проектами","titleHtml":"Управление проектами","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"3","alias":"management","title":"Менеджмент"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EНа днях на Хабре появилась \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F579998\u002F\" rel=\"noopener noreferrer nofollow\"\u003Eкритическая статья\u003C\u002Fa\u003E о бакалавриате, что называется \"из первых уст\", от очередного первохода. Статья далеко не лишена смысла, однако главная проблема не была в ней затронута. А заключается она вовсе не в обилии посторонних дисциплин и даже не в том, что в учебных заведениях так мало разъясняют суровую конкретику жизни \"научиться штамповать JavaScript сайты за месяц\".  Да, эти проблемы присутствуют, наряду с плохой подготовкой педагогов и отношением к студентам, но не они на корню обесценивают нынешнее образование.\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Что же на самом деле не так?","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"программирование"},{"titleHtml":"образование"},{"titleHtml":"курсы не нужны"},{"titleHtml":"вуз"}]},"580210":{"id":"580210","timePublished":"2021-09-27T12:53:02+00:00","isCorporative":false,"lang":"ru","titleHtml":"PHP Дайджест № 212 (13 – 27 сентября 2021)","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"100489","alias":"pronskiy","fullname":"Роман Пронский","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F27f\u002Fb99\u002Feb3\u002F27fb99eb3e30e3221c5839e88be02395.jpg","speciality":"PHP"},"statistics":{"commentsCount":1,"favoritesCount":14,"readingCount":3648,"score":41,"votesCount":41},"hubs":[{"relatedData":null,"id":"91","alias":"webdev","type":"collective","title":"Разработка веб-сайтов","titleHtml":"Разработка веб-сайтов","isProfiled":true},{"relatedData":null,"id":"260","alias":"php","type":"collective","title":"PHP","titleHtml":"PHP","isProfiled":true},{"relatedData":null,"id":"477","alias":"symfony","type":"collective","title":"Symfony","titleHtml":"Symfony","isProfiled":true},{"relatedData":null,"id":"9554","alias":"yii","type":"collective","title":"Yii","titleHtml":"Yii","isProfiled":true},{"relatedData":null,"id":"18812","alias":"laravel","type":"collective","title":"Laravel","titleHtml":"Laravel","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fek\u002F6r\u002Fr1\u002Fek6rr1odvyzb89tfv0lq4cmfxi4.jpeg\"\u003E\u003C\u002Fdiv\u003E\u003Cbr\u003E\r\nПодборка свежих новостей и материалов из мира PHP.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nВышел PHP 8.1 RC2 и уже доступен первый пакет с использованием перечислений, будет сделан форк Magento, новый тип стандартов PER в дополнение к PSR, стартовала PhpStorm 2021.3 EAP, Symfony 6 будет полностью типизирован — как обновляться?\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nДля PHP 8.2 предложены новые оптимизированные структуры данных.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nТакже в выпуске порция инструментов, полезные статьи, видео и анонсы двух митапов.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nПриятного чтения!\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"дайджест"},{"titleHtml":"php-дайджест"},{"titleHtml":"PHP"},{"titleHtml":"Symfony"},{"titleHtml":"Laravel"},{"titleHtml":"Magento"},{"titleHtml":"PHPUnit"},{"titleHtml":"PHP 8.1"},{"titleHtml":"PHP 8.2"}]},"580228":{"id":"580228","timePublished":"2021-09-27T16:41:21+00:00","isCorporative":true,"lang":"ru","titleHtml":"Идеальная светодиодная лампа за 21 рубль","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"108988","alias":"AlexeyNadezhin","fullname":"Алексей Надежин","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Ffdc\u002F3ac\u002F9a2\u002Ffdc3ac9a2dc0107cc956f1bd0cf5fc2b.jpg","speciality":"Блогер"},"statistics":{"commentsCount":29,"favoritesCount":45,"readingCount":10690,"score":78,"votesCount":82},"hubs":[{"relatedData":null,"id":"21646","alias":"lamptest","type":"corporative","title":"Блог компании LampTest","titleHtml":"Блог компании LampTest","isProfiled":false},{"relatedData":null,"id":"21894","alias":"gadgets","type":"collective","title":"Гаджеты","titleHtml":"Гаджеты","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"Удивительно осознавать, что достаточно сложное электронное устройство, которым является светодиодная лампочка, может стоить 21 рубль. \u003Cbr\u003E\r\n\u003Cbr\u003E\r\nЕщё сложнее поверить, что эта лампочка безукоризненна по всем параметрам.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F20f\u002F849\u002Ffcd\u002F20f849fcd6a3891f506676fc87223bdf.jpg\"\u003E\u003C\u002Fdiv\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"led"},{"titleHtml":"светодиодные лампы"},{"titleHtml":"тест"}]},"580304":{"id":"580304","timePublished":"2021-09-27T18:31:25+00:00","isCorporative":true,"lang":"ru","titleHtml":"Как сделать 248MP фотографию Солнца","editorVersion":"1.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Simon Tang","originalUrl":"https:\u002F\u002Fpetapixel.com\u002F2021\u002F09\u002F15\u002Fa-closer-look-how-i-created-a-248mp-photo-of-the-sun\u002F"}}],"author":{"id":"2192534","alias":"Itelma","fullname":"T-800","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fc3a\u002Fd1e\u002F43d\u002Fc3ad1e43d500046c3228c9494b510912.jpg","speciality":"Пользователь"},"statistics":{"commentsCount":4,"favoritesCount":4,"readingCount":1428,"score":13,"votesCount":13},"hubs":[{"relatedData":null,"id":"22356","alias":"itelma","type":"corporative","title":"Блог компании НПП ИТЭЛМА","titleHtml":"Блог компании НПП ИТЭЛМА","isProfiled":false},{"relatedData":null,"id":"17175","alias":"image_processing","type":"collective","title":"Обработка изображений","titleHtml":"Обработка изображений","isProfiled":true},{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"21932","alias":"photo","type":"collective","title":"Фототехника","titleHtml":"Фототехника","isProfiled":false},{"relatedData":null,"id":"22022","alias":"astronomy","type":"collective","title":"Астрономия","titleHtml":"Астрономия","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fe02\u002F643\u002Fa55\u002Fe02643a550e20aa10c366e20956e4b40.jpg\" alt=\"image\"\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Ci\u003EЭто изображение диска нашего Солнца создано с помощью большого рефракторного (линзового) телескопа и высокоскоростной монохромной CMOS-камеры.\u003C\u002Fi\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nКаждый день над нашими головами висит большой шар света. Он там всегда, и никто не обращает на него внимания. Разумеется, мы не советуем вам долго смотреть на него и при этом ослепнуть, тем не менее, наука дала нам возможность смотреть прямо на солнце совершенно безопасно.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nПоскольку техника стала более доступной, обычный человек может заглянуть в многочисленные слои Солнца с помощью специального оборудования, которое может купить в любом хорошем магазине телескопов.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nВ этой статье мы подробно рассмотрим слой, известный как хромосфера: область Солнца, видимая в оранжево-красном спектре. При помощи специального фильтра это устройство блокирует весь нежелательный свет, пропуская при этом определенный диапазон частот, который нас интересует.\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"обработка изображений"},{"titleHtml":"фототехника"}]},"580326":{"id":"580326","timePublished":"2021-09-27T22:44:08+00:00","isCorporative":false,"lang":"ru","titleHtml":"Почему инженеры презирают Agile","editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Stefan Wolpers","originalUrl":"https:\u002F\u002Fage-of-product.com\u002Fengineers-despise-agile\u002F"}}],"author":{"id":"2015227","alias":"kantocoder","fullname":null,"avatarUrl":"","speciality":"C++"},"statistics":{"commentsCount":21,"favoritesCount":3,"readingCount":1288,"score":8,"votesCount":16},"hubs":[{"relatedData":null,"id":"19583","alias":"dev_management","type":"collective","title":"Управление разработкой","titleHtml":"Управление разработкой","isProfiled":true},{"relatedData":null,"id":"20692","alias":"agile","type":"collective","title":"Agile","titleHtml":"Agile","isProfiled":true}],"flows":[{"id":"3","alias":"management","title":"Менеджмент"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EМы продолжаем цикл публикаций о недостатках Аgile методологии.  Сегодня перевод статьи о том, почему инженеры презирают Agile (много новых удивительных наблюдений!)\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F34a\u002Ffbe\u002F0e8\u002F34afbe0e8166313ff883d59e59da0785.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F34a\u002Ffbe\u002F0e8\u002F34afbe0e8166313ff883d59e59da0785.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"agile development"},{"titleHtml":"микроменеджмент"},{"titleHtml":"agile"}]}},"articlesIds":{"ARTICLES_LIST_TOP_PERIOD_DAILY":["580060","580228","580124","580210","580150","579854","572164","580204","580172","580008","580206","580304","580194","580050","580196","580164","579772","580326","580208","580166"]},"isLoading":false,"pagesCount":{"ARTICLES_LIST_TOP_PERIOD_DAILY":3},"route":{"name":"ARTICLES_LIST_TOP_PERIOD","params":{"period":"daily"},"query":{}},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":["573616","535100","519708"],"similarListRefs":{"519708":{"id":"519708","timePublished":"2020-09-18T11:13:55+00:00","isCorporative":false,"lang":"ru","titleHtml":"Роскомнадзор грозит мелким провайдерам штрафами за неустановку оборудования для «суверенного интернета»","editorVersion":"2.0","postType":"news","postLabels":[],"author":{"id":"2288880","alias":"avouner","fullname":"Александр Тернавский","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F5b8\u002F689\u002F12b\u002F5b868912b9569a8e0a05986ea44b9e1c.jpg","speciality":"Редактор Хабра"},"statistics":{"commentsCount":17,"favoritesCount":0,"readingCount":4815,"score":11,"votesCount":15},"hubs":[{"id":"20738","alias":"business-laws","type":"collective","title":"Законодательство в IT","titleHtml":"Законодательство в IT","isProfiled":false}],"flows":[{"id":"3","alias":"management","title":"Менеджмент","titleHtml":"Менеджмент"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EРоскомнадзор начал требовать от интернет-провайдеров устанавливать оборудование для «суверенного интернета» в рамках закона о нём, \u003Ca href=\"https:\u002F\u002Fwww.kommersant.ru\u002Fdoc\u002F4494156\" rel=\"noopener noreferrer nofollow\"\u003Eпишет\u003C\u002Fa\u003E «Коммерсантъ». При этом ранее допускалось, что установка «технических средств противодействия угрозам» будет оплачена государством, однако с начала сентября Роскомнадзор угрожает провайдером штрафами за «несоблюдение требований к сетям связи».&nbsp;\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"status":"published","plannedPublishTime":null,"checked":null},"535100":{"id":"535100","timePublished":"2020-12-26T05:24:56+00:00","isCorporative":false,"lang":"ru","titleHtml":"Активное внедрение стандарта Интернета RPKI — полезно ли?","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"123464","alias":"mahairod","fullname":null,"avatarUrl":null,"speciality":"Пользователь"},"statistics":{"commentsCount":15,"favoritesCount":15,"readingCount":5195,"score":8,"votesCount":12},"hubs":[{"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true},{"id":"6398","alias":"it-infrastructure","type":"collective","title":"IT-инфраструктура","titleHtml":"IT-инфраструктура","isProfiled":true},{"id":"17123","alias":"network_technologies","type":"collective","title":"Сетевые технологии","titleHtml":"Сетевые технологии","isProfiled":true},{"id":"20688","alias":"research","type":"collective","title":"Исследования и прогнозы в IT","titleHtml":"Исследования и прогнозы в IT","isProfiled":false},{"id":"21890","alias":"statistics","type":"collective","title":"Статистика в IT","titleHtml":"Статистика в IT","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"},{"id":"6","alias":"admin","title":"Администрирование","titleHtml":"Администрирование"},{"id":"3","alias":"management","title":"Менеджмент","titleHtml":"Менеджмент"},{"id":"7","alias":"popsci","title":"Научпоп","titleHtml":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003E  Сейчас почитал, поразмыслил и начал понимать, что, возможно, я рано сегодня порадовался отличной статистике внедрения \u003Cstrong\u003E\u003Cem\u003ERPKI \u003C\u002Fem\u003E\u003C\u002Fstrong\u003Eв массы в этом году.\u003C\u002Fp\u003E\u003Cp\u003EТекущий год, помимо известных всем событий и увеличенной нагрузки на сеть, отметился ещё одним немаловажным движением. В течение этого года происходило ускоренное внедрение названного протокола у большинства крупнейших интернет-провайдеров. Даже хэштег на эту тему запустили в твиттере.\u003C\u002Fp\u003E\u003Cp\u003E Да, внедрение RPKI безусловно можно назвать достижением, но только для определённого круга заинтересованных организаций. Для российского телекома это может стать началом конца. \u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F0df\u002F740\u002F7df\u002F0df7407df2ca3629ff2a1d000022d4da.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F0df\u002F740\u002F7df\u002F0df7407df2ca3629ff2a1d000022d4da.jpg","fit":"cover","positionY":0,"positionX":20.769230769231}},"status":"published","plannedPublishTime":null,"checked":null},"573616":{"id":"573616","timePublished":"2021-08-27T13:00:01+00:00","isCorporative":false,"lang":"ru","titleHtml":"BGP Synchronization и OSPF","editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Iaroslav Bondarenko","originalUrl":"https:\u002F\u002Fbraonle.wordpress.com\u002F2021\u002F08\u002F18\u002Fbgp-synchronization-with-ospf\u002F"}}],"author":{"id":"2638797","alias":"braonle","fullname":"Ярослав Бондаренко","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fdd3\u002F012\u002Fc1f\u002Fdd3012c1f1f30f8ceffd158800dfd2e9.jpg","speciality":"Системный инженер"},"statistics":{"commentsCount":0,"favoritesCount":19,"readingCount":2513,"score":2,"votesCount":2},"hubs":[{"id":"6398","alias":"it-infrastructure","type":"collective","title":"IT-инфраструктура","titleHtml":"IT-инфраструктура","isProfiled":true},{"id":"6900","alias":"cisconetworks","type":"collective","title":"Cisco","titleHtml":"Cisco","isProfiled":true},{"id":"17123","alias":"network_technologies","type":"collective","title":"Сетевые технологии","titleHtml":"Сетевые технологии","isProfiled":true}],"flows":[{"id":"6","alias":"admin","title":"Администрирование","titleHtml":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EDisclaimer: только для гиков; устаревшая технология; статья в режиме “just for fun”.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8c4\u002F7cb\u002Fa3b\u002F8c47cba3b638045928a03b665df88fd3.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8c4\u002F7cb\u002Fa3b\u002F8c47cba3b638045928a03b665df88fd3.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null}}},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{"denjs":{"scoreStats":{"score":28,"votesCount":58},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"37927","alias":"DenJS","fullname":"DenJS","avatarUrl":null,"speciality":null}},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.670ab961.js" defer></script><script src="https://assets.habr.com/habr-web/js/chunk-f458c7c4.6e221df6.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.76acc47b.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
