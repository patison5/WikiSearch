<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Comet для ASP.NET своими руками / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.0f7bdd8f.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.670ab961.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.01bb2993.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.76acc47b.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-f458c7c4.e48e8f79.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-f458c7c4.6e221df6.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.0f7bdd8f.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.01bb2993.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-f458c7c4.e48e8f79.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.4f7c12b4e1b1b4c0e44ef6f9f33b1f9f.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/82015\/"},"headline":"Comet для ASP.NET своими руками","datePublished":"2010-01-26T10:10:06+03:00","dateModified":"2010-01-26T11:50:25+03:00","author":{"@type":"Person","name":"Сергей Прокопенко"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Не так давно в рамках разработки крупного ASP.NET проекта возникла следующая подзадача: реализовать визуальное отображение табличных данных, обновляющихся в режи...","url":"https:\/\/habr.com\/ru\/post\/82015\/#post-content-body","about":["h_net","f_develop"],"image":["https:\/\/habr.com\/share\/publication\/82015\/15e5b999166c898d3dfeac29f5bba6cc\/"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.47.1">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Comet для ASP.NET своими руками" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Comet для ASP.NET своими руками" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Comet для ASP.NET своими руками" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Не так давно в рамках разработки крупного ASP.NET проекта возникла следующая подзадача: реализовать визуальное отображение табличных данных, обновляющихся в режиме real-time. Схема обновления довольно..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Не так давно в рамках разработки крупного ASP.NET проекта возникла следующая подзадача: реализовать визуальное отображение табличных данных, обновляющихся в режиме real-time. Схема обновления довольно..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Не так давно в рамках разработки крупного ASP.NET проекта возникла следующая подзадача: реализовать визуальное отображение табличных данных, обновляющихся в режиме real-time. Схема обновления довольно..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Не так давно в рамках разработки крупного ASP.NET проекта возникла следующая подзадача: реализовать визуальное отображение табличных данных, обновляющихся в режиме real-time. Схема обновления довольно..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Не так давно в рамках разработки крупного ASP.NET проекта возникла следующая подзадача: реализовать визуальное отображение табличных данных, обновляющихся в режиме real-time. Схема обновления довольно..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/82015/15e5b999166c898d3dfeac29f5bba6cc/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/82015/15e5b999166c898d3dfeac29f5bba6cc/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/82015/15e5b999166c898d3dfeac29f5bba6cc/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/82015/15e5b999166c898d3dfeac29f5bba6cc/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/82015/15e5b999166c898d3dfeac29f5bba6cc/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="82015" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2010-01-26T07:10:06.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/82015/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/82015/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/82015/15e5b999166c898d3dfeac29f5bba6cc/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.cee85629.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
              Как стать автором
            </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.cee85629.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.cee85629.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.cee85629.svg#pull-arrow"></use></svg></div></div> <!----> <div class="tm-page-article__body"><article class="tm-page-article__content tm-page-article__content_inner"><div class="tm-page-article__head-wrapper"><!----> <div class="tm-article-snippet tm-page-article__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/Cromathaar/" title="Cromathaar" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" loading="lazy" src="//habrastorage.org/r/w32/getpro/habr/avatars/392/a18/2cb/392a182cb77f8a238b4b40cd64e3a860.png" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/Cromathaar/" class="tm-user-info__username">
      Cromathaar
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2010-01-26T07:10:06.000Z" title="2010-01-26, 10:10">26  января  2010 в 10:10</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Comet для ASP.NET своими руками</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/net/" class="tm-article-snippet__hubs-item-link"><span>.NET</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <!----> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml">Не так давно в рамках разработки крупного ASP.NET проекта возникла следующая подзадача: реализовать визуальное отображение табличных данных, обновляющихся в режиме real-time. Схема обновления довольно проста, а именно: на сервер посредством QueryString присылаются данные, которые должны как можно быстрее заменить собой устаревшие данные на странице, причем без необходимости страницу эту рефрешить. Первым решением, которое сразу же пришло мне в голову, было использовать ставшую уже общепринятой технику AJAX-запросов по таймеру, скажем, каждые 5 секунд. Однако сразу же выявились очевидные недостатки применения такого подхода: во-первых, довольно внушительное число потенциальных клиентов, дергающих сервер каждые 5 секунд с созданием каждый раз нового соединения, а во-вторых, это все-таки довольно грубая эмуляция real-time'а, ведь данные на сервер гипотетически могут приходить даже по несоколько раз в секунду (а могут не приходить и по несколько минут, и это уже больше относится к «во-первых»).<br/>
<br/>
Идея решения пришла довольно неожиданно от коллеги по работе, поделившегося линком на <a href="http://habrahabr.ru/blogs/webdev/76144/">статью на Хабре</a>, описывающую реализацию технологии Comet на Perl в целях создания веб-чата. "<i>Comet — это то что нужно!</i>", — подумали мы, и я начал разбираться, как же эту штуку можно прикрутить к ASP.NET. О чем, собственно, и пойдет речь под катом.<br/>
<br/>
<a name="habracut"></a><br/>
<br/>
Прежде всего, разберемся, что же такое Comet. Вот что говорит нам по этому поводу Википедия:<br/>
<br/>
<b>Comet</b> (в веб-разработке) — неологизм, описывающий модель работы веб-приложения, при которой постоянное HTTP-соединение позволяет веб-серверу отправлять (push) данные браузеру, без дополнительного запроса со стороны браузера. Comet — это гипероним, используемый для обозначения множества техник, позволяющих достичь такого взаимодействия. Общее у этих методов то, что они основаны на технологиях, непосредственно поддерживаемых браузером, таких как JavaScript, а не на проприетарных плагинах. Теоретически подход Comet отличается от изначальной концепции всемирной паутины, при которой браузер запрашивает страницу полностью или частично для того, чтобы обновить страницу. Однако на практике приложения Comet обычно используют <b>Ajax c long polling</b> для проверки наличия новой информации на сервере.<br/>
<br/>
Итак, ключевые слова, которые мы можем вынести для себя из этого определения, — это «Ajax с long polling». Что же это такое, и с чем его едят? При использовании технологии «long polling» клиент посылает на сервер запрос и… ждет. Ждет, когда на сервере появятся новые данные. Как только данные пришли, сервер отправляет их клиенту, после чего оный посылает новый запрос и снова ждет. Альтернативная технология «бесконечного запроса», реализуемая, например, через т.н. «forever iframe» (немного подробнее можно почитать <a href="http://habrahabr.ru/blogs/webdev/80466/">здесь</a>), далеко не всегда применима, т.к. такую штуку, как таймаут пока никто не отменял.<br/>
<br/>
Что ж, задача предельно ясна — нужно реализовать подручными средствами (AJAX + ASP.NET) вышеупомянутый long polling. Отсюда вытекает и первая проблема: как законсервировать входящие реквесты и не выдавать респонсы, пока на сервере нет свежих данных, которые можно было бы отдать клиентам (а клиент у нас, очевидно, не один). И здесь на помощь нам приходит асинхронный HTTP Handler.<br/>
<br/>
<blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a><font color="black"><font color="#0000ff">public</font> <font color="#0000ff">interface</font> IHttpAsyncHandler : IHttpHandler<br/>
{<br/>
 IAsyncResult BeginProcessRequest(<font color="#2B91AF">HttpContext</font> ctx,<br/>
                  AsyncCallback cb, <br/>
                  <font color="#0000ff">object</font> obj);<br/>
 <font color="#0000ff">void</font> EndProcessRequest(IAsyncResult ar);<br/>
}</font><br/>
<br/>
<font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font>.</font></code></blockquote><br/>
<br/>
Заметьте, что наш класс мы будем наследовать не от интерфейса IHttpHandler, а от IHttpAsyncHandler, который привнесет в нашу реализацию наряду со знакомым методом ProcessRequest два новых: BeginProcessRequest и EndProcessRequest. Интересовать нас, в частности, будет первый из них, т.к. иммено при начале обработки реквеста нам этот реквест нужно схватить за руку и не отпускать до тех пор, пока не придет час икс. Как видим, BeginProcessRequest возвращает объект, реализующий интерфейс IAsyncResult.<br/>
<br/>
<blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a><font color="black"><font color="#0000ff">public</font> <font color="#0000ff">interface</font> IAsyncResult<br/>
{<br/>
 <font color="#0000ff">public</font> <font color="#0000ff">object</font>   AsyncState            { <font color="#0000ff">get</font>; }<br/>
 <font color="#0000ff">public</font> <font color="#0000ff">bool</font>    CompletedSynchronously { <font color="#0000ff">get</font>; }<br/>
 <font color="#0000ff">public</font> <font color="#0000ff">bool</font>    IsCompleted            { <font color="#0000ff">get</font>; }<br/>
 <font color="#0000ff">public</font> WaitHandle AsyncWaitHandle     { <font color="#0000ff">get</font>; }<br/>
}</font><br/>
<br/>
<font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font>.</font></code></blockquote><br/>
<br/>
Создадим новый класс, который будет реализовывать указанный интерфейс, а также послужит хранилищем для передаваемых в BeginProcessRequest данных запроса и нашего собственного параметра clientGuid, который мы будем использовать в дальнейшем в качестве уникального идентификатора приконнектившегося к серверу клиента, дабы как-то идентифицировать его запросы.<br/>
<br/>
<blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a><font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> CometAsyncRequestState : IAsyncResult<br/>
{<br/>
  <font color="#0000ff">private</font> <font color="#2B91AF">HttpContext</font> _currentContext;<br/>
  <font color="#0000ff">private</font> AsyncCallback _asyncCallback;<br/>
  <font color="#0000ff">private</font> Object _extraData;<br/>
<br/>
  <font color="#0000ff">private</font> Boolean _isCompleted;<br/>
  <font color="#0000ff">private</font> <font color="#2B91AF">Guid</font> _clientGuid;<br/>
  <font color="#0000ff">private</font> ManualResetEvent _callCompleteEvent = <font color="#0000ff">null</font>;<br/>
<br/>
  <font color="#0000ff">public</font> CometAsyncRequestState(<font color="#2B91AF">HttpContext</font> currentContext, AsyncCallback asyncCallback, Object extraData)<br/>
  {<br/>
    _currentContext = currentContext;<br/>
    _asyncCallback = asyncCallback;<br/>
    _extraData = extraData;<br/>
<br/>
    _isCompleted = <font color="#0000ff">false</font>;<br/>
  }<br/>
<br/>
  <font color="#0000ff">public</font> <font color="#0000ff">void</font> CompleteRequest()<br/>
  {<br/>
    _isCompleted = <font color="#0000ff">true</font>;<br/>
<br/>
    <font color="#0000ff">lock</font> (<font color="#0000ff">this</font>)<br/>
    {<br/>
      <font color="#0000ff">if</font> (_callCompleteEvent != <font color="#0000ff">null</font>)<br/>
        _callCompleteEvent.Set();<br/>
    }<br/>
<br/>
    <font color="#0000ff">if</font> (_asyncCallback != <font color="#0000ff">null</font>)<br/>
    {<br/>
      _asyncCallback(<font color="#0000ff">this</font>);<br/>
    }<br/>
  }<br/>
<br/>
  <font color="#0000ff">public</font> <font color="#2B91AF">HttpContext</font> CurrentContext<br/>
  {<br/>
    <font color="#0000ff">get</font><br/>
    {<br/>
      <font color="#0000ff">return</font> _currentContext;<br/>
    }<br/>
    <font color="#0000ff">set</font><br/>
    {<br/>
      _currentContext = <font color="#0000ff">value</font>;<br/>
    }<br/>
  }<br/>
<br/>
  <font color="#0000ff">public</font> AsyncCallback AsyncCallback<br/>
  {<br/>
    <font color="#0000ff">get</font><br/>
    {<br/>
      <font color="#0000ff">return</font> _asyncCallback;<br/>
    }<br/>
    <font color="#0000ff">set</font><br/>
    {<br/>
      _asyncCallback = <font color="#0000ff">value</font>;<br/>
    }<br/>
  }<br/>
<br/>
  <font color="#0000ff">public</font> Object ExtraData<br/>
  {<br/>
    <font color="#0000ff">get</font><br/>
    {<br/>
      <font color="#0000ff">return</font> _extraData;<br/>
    }<br/>
    <font color="#0000ff">set</font><br/>
    {<br/>
      _extraData = <font color="#0000ff">value</font>;<br/>
    }<br/>
  }<br/>
<br/>
  <font color="#0000ff">public</font> <font color="#2B91AF">Guid</font> ClientGuid<br/>
  {<br/>
    <font color="#0000ff">get</font><br/>
    {<br/>
      <font color="#0000ff">return</font> _clientGuid;<br/>
    }<br/>
    <font color="#0000ff">set</font><br/>
    {<br/>
      _clientGuid = <font color="#0000ff">value</font>;<br/>
    }<br/>
  }<br/>
<br/>
  <font color="#008000">// IAsyncResult implementations</font><br/>
  <font color="#0000ff">public</font> Boolean CompletedSynchronously<br/>
  {<br/>
    <font color="#0000ff">get</font><br/>
    {<br/>
      <font color="#0000ff">return</font> <font color="#0000ff">false</font>;<br/>
    }<br/>
  }<br/>
<br/>
  <font color="#0000ff">public</font> Boolean IsCompleted<br/>
  {<br/>
    <font color="#0000ff">get</font><br/>
    {<br/>
      <font color="#0000ff">return</font> _isCompleted;<br/>
    }<br/>
  }<br/>
<br/>
  <font color="#0000ff">public</font> Object AsyncState<br/>
  {<br/>
    <font color="#0000ff">get</font><br/>
    {<br/>
      <font color="#0000ff">return</font> _extraData;<br/>
    }<br/>
  }<br/>
<br/>
  <font color="#0000ff">public</font> WaitHandle AsyncWaitHandle<br/>
  {<br/>
    <font color="#0000ff">get</font><br/>
    {<br/>
      <font color="#0000ff">lock</font> (<font color="#0000ff">this</font>)<br/>
      {<br/>
        <font color="#0000ff">if</font> (_callCompleteEvent == <font color="#0000ff">null</font>)<br/>
          _callCompleteEvent = <font color="#0000ff">new</font> ManualResetEvent(<font color="#0000ff">false</font>);<br/>
<br/>
        <font color="#0000ff">return</font> _callCompleteEvent;<br/>
      }<br/>
    }<br/>
  }<br/>
}</font><br/>
<br/>
<font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font>.</font></code></blockquote><br/>
<br/>
Как видим, пока мы сами не вызовем функцию CompleteRequest, запрос не будет считаться завершенным. Замечательно — то, что нам и надо. Осталось только где-то эти входящие реквесты хранить. Для этой функции, а также для функции обработки запросов создадим статический класс CometClientProcessor:<br/>
<br/>
<blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a><font color="black"><font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CometClientProcessor<br/>
{<br/>
  <font color="#0000ff">private</font> <font color="#0000ff">static</font> Object _lockObj;<br/>
  <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#2B91AF">List</font>&lt;CometAsyncRequestState> _clientStateList;<br/>
<br/>
  <font color="#0000ff">static</font> CometClientProcessor()<br/>
  {<br/>
    _lockObj = <font color="#0000ff">new</font> Object();<br/>
    _clientStateList = <font color="#0000ff">new</font> <font color="#2B91AF">List</font>&lt;CometAsyncRequestState>();<br/>
  }<br/>
<br/>
  <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> PushData(<font color="#2B91AF">String</font> pushedData)<br/>
  {<br/>
    <font color="#2B91AF">List</font>&lt;CometAsyncRequestState> currentStateList = <font color="#0000ff">new</font> <font color="#2B91AF">List</font>&lt;CometAsyncRequestState>();<br/>
<br/>
    <font color="#0000ff">lock</font> (_lockObj)<br/>
    {<br/>
      <font color="#0000ff">foreach</font> (CometAsyncRequestState clientState <font color="#0000ff">in</font> _clientStateList)<br/>
      {<br/>
        currentStateList.Add(clientState);<br/>
      }<br/>
    }<br/>
<br/>
    <font color="#0000ff">foreach</font> (CometAsyncRequestState clientState <font color="#0000ff">in</font> currentStateList)<br/>
    {<br/>
      <font color="#0000ff">if</font> (clientState.CurrentContext.Session != <font color="#0000ff">null</font>)<br/>
      {<br/>
        clientState.CurrentContext.Response.Write(pushedData);<br/>
        clientState.CompleteRequest();<br/>
      }<br/>
    }<br/>
  }<br/>
<br/>
  <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> AddClient(CometAsyncRequestState state)<br/>
  {<br/>
    <font color="#2B91AF">Guid</font> newGuid;<br/>
<br/>
    <font color="#0000ff">lock</font> (_lockObj)<br/>
    {<br/>
      <font color="#0000ff">while</font> (<font color="#0000ff">true</font>)<br/>
      {<br/>
        newGuid = <font color="#2B91AF">Guid</font>.NewGuid();<br/>
        <font color="#0000ff">if</font> (_clientStateList.Find(s => s.ClientGuid == newGuid) == <font color="#0000ff">null</font>)<br/>
        {<br/>
          state.ClientGuid = newGuid;<br/>
          <font color="#0000ff">break</font>;<br/>
        }<br/>
      }<br/>
<br/>
      _clientStateList.Add(state);<br/>
    }<br/>
  }<br/>
<br/>
  <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> UpdateClient(CometAsyncRequestState state, <font color="#2B91AF">String</font> clientGuidKey)<br/>
  {<br/>
    <font color="#2B91AF">Guid</font> clientGuid = <font color="#0000ff">new</font> <font color="#2B91AF">Guid</font>(clientGuidKey);<br/>
<br/>
    <font color="#0000ff">lock</font> (_lockObj)<br/>
    {<br/>
      CometAsyncRequestState foundState = _clientStateList.Find(s => s.ClientGuid == clientGuid);<br/>
<br/>
      <font color="#0000ff">if</font> (foundState != <font color="#0000ff">null</font>)<br/>
      {<br/>
        foundState.CurrentContext = state.CurrentContext;<br/>
        foundState.ExtraData = state.ExtraData;<br/>
        foundState.AsyncCallback = state.AsyncCallback;<br/>
      }<br/>
    }<br/>
  }<br/>
<br/>
  <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> RemoveClient(CometAsyncRequestState state)<br/>
  {<br/>
    <font color="#0000ff">lock</font> (_lockObj)<br/>
    {<br/>
      _clientStateList.Remove(state);<br/>
    }<br/>
  }<br/>
}</font><br/>
<br/>
<font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font>.</font></code></blockquote><br/>
<br/>
CometClientProcessor содержит в себе список удерживаемых на данный момент реквестов, функции AddClient для добавления реквестов (при коннекте нового клиента), UpdateClient для обновления реквестов (когда уже приконнектившийся клиент послает новый запрос) и RemoveClient для удаления реквестов (когда клиент дисконнектится), а также основной метод PushData. «Пушить» для наглядности мы будем простейшие данные, а именно строку, которая приходит на сервер через параметр в URL. Как видим, все предельно просто — пробегаем по текущим удерживаемым реквестам, записываем в респонс данные, пришедшие с сервера, и вызываем функцию CompleteRequest, которая освобождает запрос, и отправляет клиенту ответ. Вызов PushData осуществляется в данном примере из функции Page_Load нашей единственной страницы:<br/>
<br/>
<blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a><font color="black"><font color="#0000ff">protected</font> <font color="#0000ff">void</font> Page_Load(<font color="#0000ff">object</font> sender, <font color="#2B91AF">EventArgs</font> e)<br/>
  {<br/>
    <font color="#0000ff">if</font> (!IsPostBack)<br/>
    {<br/>
      <font color="#0000ff">if</font> (Request.QueryString[<font color="#A31515">"x"</font>] != <font color="#0000ff">null</font>)<br/>
      {<br/>
        CometClientProcessor.PushData(Request.QueryString[<font color="#A31515">"x"</font>].ToString());<br/>
      }<br/>
    }<br/>
  }</font><br/>
<br/>
<font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font>.</font></code></blockquote><br/>
<br/>
Как уже говорилось выше, данные к нам приходят через параметр в URL, в данном случае для наглядности он носит имя «x». В серверной части осталось только реализовать, собственно, сам асинхронный хэндлер. Но сперва обратимся к части клиентской и напишем (не без помощи библиотеки jQuery) несколько довольно банальных JavaScript-овых функций:<br/>
<br/>
<blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a><font color="black"><font color="#0000ff">var</font> clientGuid<br/>
<br/>
$(<font color="#0000ff">document</font>).ready(<font color="#0000ff">function</font>() {<br/>
  <font color="#0000ff">var</font> str = window.location.href;<br/>
  <font color="#0000ff">if</font> (str.indexOf(<font color="#A31515">"?"</font>) &lt; 0)<br/>
    Connect();<br/>
});<br/>
<br/>
$(window).unload(<font color="#0000ff">function</font>() {<br/>
  <font color="#0000ff">var</font> str = window.location.href;<br/>
  <font color="#0000ff">if</font> (str.indexOf(<font color="#A31515">"?"</font>) &lt; 0)<br/>
    Disconnect();<br/>
});<br/>
<br/>
<font color="#0000ff">function</font> SendRequest() {<br/>
  <font color="#0000ff">var</font> url = <font color="#A31515">'./CometAsyncHandler.ashx?cid='</font> + clientGuid;<br/>
  $.ajax({<br/>
    type: <font color="#A31515">"POST"</font>,<br/>
    url: url,<br/>
    success: ProcessResponse,<br/>
    error: SendRequest<br/>
  });<br/>
}<br/>
<br/>
<font color="#0000ff">function</font> Connect() {<br/>
  <font color="#0000ff">var</font> url = <font color="#A31515">'./CometAsyncHandler.ashx?cpsp=CONNECT'</font>;<br/>
  $.ajax({<br/>
    type: <font color="#A31515">"POST"</font>,<br/>
    url: url,<br/>
    success: OnConnected,<br/>
    error: ConnectionRefused<br/>
  });<br/>
}<br/>
<br/>
<font color="#0000ff">function</font> Disconnect() {<br/>
  <font color="#0000ff">var</font> url = <font color="#A31515">'./CometAsyncHandler.ashx?cpsp=DISCONNECT'</font>;<br/>
  $.ajax({<br/>
    type: <font color="#A31515">"POST"</font>,<br/>
    url: url<br/>
  });<br/>
}<br/>
<br/>
<font color="#0000ff">function</font> ProcessResponse(transport) {<br/>
  $(<font color="#A31515">"#contentWrapper"</font>).html(transport);<br/>
  SendRequest();<br/>
}<br/>
<br/>
<font color="#0000ff">function</font> OnConnected(transport) {<br/>
  clientGuid = transport;<br/>
  SendRequest();<br/>
}<br/>
<br/>
<font color="#0000ff">function</font> ConnectionRefused() {<br/>
  $(<font color="#A31515">"#contentWrapper"</font>).html(<font color="#A31515">"Unable to connect to Comet server. Reconnecting in 5 seconds..."</font>);<br/>
  setTimeout(Connect(), 5000);<br/>
}</font><br/>
<br/>
<font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font>.</font></code></blockquote><br/>
<br/>
Как только документ загружается, мы проверяем URL на наличие параметров в нем (параметризованный URL, еще раз позволю себе напомнить — это передача данных серверу для «пушинга») и вызываем функцию Connect. Та, в свою очередь, уже начинает общаться с нашим хэндлером. Служебные слова, определяющие действие (CONNECT/DISCONNECT), как видим, для простоты, передаются через параметр cpsp. Соответственно, Connect должен инициировать на сервере вызов AddClient, а Disconnect — RemoveClient. Когда соединение установлено и клиент получил свой clientGuid, вызывается функция SendRequest, которая и будет «лонгполлить» сервер, пока клиент не решит от него отсоединиться. Каждый вызов SendRequest будет инициировать выполнение на сервере функции UpdateClient, которая для данного клиента обновит контекст и точку возврата (callback).<br/>
<br/>
Что-ж, практически все готово, настало время для реализации ядра всего вышепредставленного механизма — асинхронного хэндлера.<br/>
<br/>
<blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a><font color="black"><font color="#0000ff">public</font> <font color="#0000ff">enum</font> ConnectionCommand<br/>
{<br/>
  CONNECT,<br/>
  DISCONNECT<br/>
}<br/>
<br/>
<font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> ConnectionProtocol<br/>
{<br/>
  <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#2B91AF">String</font> PROTOCOL_GET_PARAMETER_NAME = <font color="#A31515">"cpsp"</font>;<br/>
  <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#2B91AF">String</font> CLIENT_GUID_PARAMETER_NAME = <font color="#A31515">"cid"</font>;<br/>
}</font><br/>
<br/>
<font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font>.</font></code></blockquote><br/>
<br/>
<blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a><font color="black">&lt;%@ WebHandler Language=<font color="#A31515">"C#"</font> Class=<font color="#A31515">"CometAsyncHandler"</font> %><br/>
<br/>
<font color="#0000ff">using</font> System;<br/>
<font color="#0000ff">using</font> System.Web;<br/>
<br/>
<font color="#0000ff">using</font> DevelopMentor;<br/>
<br/>
<font color="#0000ff">public</font> <font color="#0000ff">class</font> CometAsyncHandler : IHttpAsyncHandler, System.Web.SessionState.IRequiresSessionState<br/>
{<br/>
  <font color="#0000ff">static</font> <font color="#0000ff">private</font> ThreadPool _threadPool;<br/>
<br/>
  <font color="#0000ff">static</font> CometAsyncHandler()<br/>
  {<br/>
    _threadPool = <font color="#0000ff">new</font> ThreadPool(2, 50, <font color="#A31515">"Comet Pool"</font>);<br/>
    _threadPool.PropogateCallContext = <font color="#0000ff">true</font>;<br/>
    _threadPool.PropogateThreadPrincipal = <font color="#0000ff">true</font>;<br/>
    _threadPool.PropogateHttpContext = <font color="#0000ff">true</font>;<br/>
    _threadPool.Start();<br/>
  }<br/>
<br/>
  <font color="#0000ff">public</font> IAsyncResult BeginProcessRequest(<font color="#2B91AF">HttpContext</font> ctx, AsyncCallback cb, Object obj)<br/>
  {<br/>
    CometAsyncRequestState currentAsyncRequestState = <font color="#0000ff">new</font> CometAsyncRequestState(ctx, cb, obj);<br/>
    _threadPool.PostRequest(<font color="#0000ff">new</font> WorkRequestDelegate(ProcessServiceRequest), currentAsyncRequestState);<br/>
<br/>
    <font color="#0000ff">return</font> currentAsyncRequestState;<br/>
  }<br/>
<br/>
  <font color="#0000ff">private</font> <font color="#0000ff">void</font> ProcessServiceRequest(Object state, <font color="#2B91AF">DateTime</font> requestTime)<br/>
  {<br/>
    CometAsyncRequestState currentAsyncRequestState = state <font color="#0000ff">as</font> CometAsyncRequestState;<br/>
<br/>
    <font color="#0000ff">if</font> (currentAsyncRequestState.CurrentContext.Request.QueryString[ConnectionProtocol.PROTOCOL_GET_PARAMETER_NAME] ==<br/>
      ConnectionCommand.CONNECT.ToString())<br/>
    {<br/>
      CometClientProcessor.AddClient(currentAsyncRequestState);<br/>
      currentAsyncRequestState.CurrentContext.Response.Write(currentAsyncRequestState.ClientGuid.ToString());<br/>
      currentAsyncRequestState.CompleteRequest();<br/>
    }<br/>
    <font color="#0000ff">else</font> <font color="#0000ff">if</font> (currentAsyncRequestState.CurrentContext.Request.QueryString[ConnectionProtocol.PROTOCOL_GET_PARAMETER_NAME] ==<br/>
      ConnectionCommand.DISCONNECT.ToString())<br/>
    {<br/>
      CometClientProcessor.RemoveClient(currentAsyncRequestState);<br/>
      currentAsyncRequestState.CompleteRequest();<br/>
    }<br/>
    <font color="#0000ff">else</font><br/>
    {<br/>
      <font color="#0000ff">if</font> (currentAsyncRequestState.CurrentContext.Request.QueryString[ConnectionProtocol.CLIENT_GUID_PARAMETER_NAME] != <font color="#0000ff">null</font>)<br/>
      {<br/>
        CometClientProcessor.UpdateClient(currentAsyncRequestState, <br/>
          currentAsyncRequestState.CurrentContext.Request.QueryString[ConnectionProtocol.CLIENT_GUID_PARAMETER_NAME].ToString());<br/>
      }<br/>
    }<br/>
  }<br/>
<br/>
  <font color="#0000ff">public</font> <font color="#0000ff">void</font> EndProcessRequest(IAsyncResult ar)<br/>
  {<br/>
  }<br/>
<br/>
  <font color="#0000ff">public</font> <font color="#0000ff">void</font> ProcessRequest(<font color="#2B91AF">HttpContext</font> context)<br/>
  {<br/>
  }<br/>
<br/>
  <font color="#0000ff">public</font> <font color="#0000ff">bool</font> IsReusable<br/>
  {<br/>
    <font color="#0000ff">get</font><br/>
    {<br/>
      <font color="#0000ff">return</font> <font color="#0000ff">true</font>;<br/>
    }<br/>
  }<br/>
}<br/>
</font><br/>
<font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font>.</font></code></blockquote><br/>
После всего вышесказанного, единственный вопрос, который может возникнуть у внимательного читателя — «зачем использовать кастом тредпул»? Ответ довольно прост, хоть и не совсем очевиден: чтобы как можно быстрее «отпустить» рабочий поток тредпула ASP.NET, дабы он мог продолжить обрабатывать входящие реквесты, а непосредственную обработку запроса передать «внутреннему» потоку. Если этого не сделать, то при достаточно большом количестве входящих реквестов, может произойти банальный «затык» по довольно смешной на первый взгляд причине: «у ASP.NET кончились рабочие потоки». По этой же причине не получится использовать ни асинхронный делегат, возбуждаемый методом BeginInvoke, ни метод стандартного тредпула ThreadPool.QueueUserWorkItem, т.к. в обоих этих случая поток будет изыматься из того же тредпула ASP.NET, что приводит нас к ситуации «шило на мыло». В данном примере используется кастом тредпул, реализованный Майком Вудрингом (Mike Woodring); эту и многие другие из его наработок можно посмотреть <a href="http://www.bearcanyon.com/dotnet/">здесь</a>.<br/>
<br/>
Вот, в общем-то и все. Не так уж и сложно, как казалось вначале. Клиенты коннектятся к нашему Comet-серверу посредством вызова Default.aspx, а данные мы пушим передавая той же странице GET-параметр аля Default.aspx?x=Happy_New_Year. К сожелению провести массирование тестирование масштабируемости такого подхода пока не было возможности, однако если у кого-то есть идеи по этому поводу — пишите, не стесняйтесь.<br/>
<br/>
Спасибо за внимание.<br/>
<br/>
<b>UPD</b> Добавляю ссылку на <a href="http://www.filefront.com/15428329/CometSkeleton.zip/">архив с сэмпловым проектом</a> (~30 KB). Как посмотреть: в VS ставим стартовой страницей CometPage.aspx, запускаем, открываем в браузере/браузерах несколько вкладок с тем же URL (только помним про ограничение в оных браузерах количества одновременных подключений), затем в одном из табов к URL дописываем параметр <i>?x=[любой_текст]</i> и наблюдаем, как значение параметра появится во всех открытых вкладках.</div></div> <!----> <!----></div> <div class="tm-article-body__tags"><div class="tm-article-body__tags-links"><span class="tm-article-body__tags-title">Теги:</span> <span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BComet%5D" class="tm-article-body__tags-item-link">Comet</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BASP.NET%5D" class="tm-article-body__tags-item-link">ASP.NET</a></span><span class="tm-article-body__tags-item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BAJAX%5D" class="tm-article-body__tags-item-link">AJAX</a></span></div> <div class="tm-article-body__tags-links"><span class="tm-article-body__tags-title">Хабы:</span> <span class="tm-article-body__tags-item"><a href="/ru/hub/net/" class="tm-article-body__tags-item-link">
                  .NET
                </a></span></div></div></article> <div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 63: ↑50 и ↓13</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 63: ↑50 и ↓13" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+37</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <!----> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    92
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/82015/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      45
    </span></a> <!----></div> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div></div> <!----></div> <!----> <div class="tm-page-article__additional-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body"><div class="tm-article-author tm-page-article__author"><!----> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-two-column"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/Cromathaar/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/392/a18/2cb/392a182cb77f8a238b4b40cd64e3a860.png" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 68 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    43
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info"><div class="tm-user-card__title"><span class="tm-user-card__name">Сергей Прокопенко</span> <a href="/ru/users/Cromathaar/" class="tm-user-card__nickname">
          @Cromathaar
        </a> <!----></div> <p class="tm-user-card__short-info">Пользователь</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-two-column"><!----> <!----> <!----> <!----> <!----></div></div> <div class="tm-article-author__user-contacts"><a href="https://vk.com/cromathaar" rel="noopener" target="_blank" class="tm-article-author__contact">
      ВКонтакте
    </a></div></div></div> <!----></section> <div class="tm-page-article__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/82015/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 45 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <section class="tm-block tm-block_spacing-around"><header class="tm-block__header"><h2 class="tm-block__title">Похожие публикации</h2> <!----></header> <div class="tm-block__body"><ul class="tm-article-list-block__list"><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2011-05-12T06:41:32.000Z" title="2011-05-12, 10:41">12  мая  2011 в 10:41</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/microsoft/blog/119128/" class="tm-article-title__link"><span>Очередное обновление ASP.NET AJAX Control Toolkit</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 31: ↑20 и ↓11</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 31: ↑20 и ↓11" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+9</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">3.6K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    3
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/microsoft/blog/119128/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      5
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2011-04-05T08:50:03.000Z" title="2011-04-05, 12:50">5  апреля  2011 в 12:50</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/microsoft/blog/116870/" class="tm-article-title__link"><span>Выпущена новая версия ASP.NET AJAX Control Toolkit</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 37: ↑23 и ↓14</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 37: ↑23 и ↓14" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+9</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">3.6K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    7
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/microsoft/blog/116870/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      6
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2010-02-05T08:46:35.000Z" title="2010-02-05, 11:46">5  февраля  2010 в 11:46</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/83196/" class="tm-article-title__link"><span>Создание ASP.NET AJAX контрола с возможностью обмена данными с сервером</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 16: ↑13 и ↓3</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 16: ↑13 и ↓3" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+10</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">4.5K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    6
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/83196/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      2
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li> <!----></ul></div> <!----></section> <!----> <!----> <section class="tm-block tm-block_spacing-around"><header class="tm-block__header"><h2 class="tm-block__title">Лучшие публикации за сутки</h2> <!----></header> <div class="tm-block__body"><ul class="tm-article-list-block__list"><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-27T09:00:04.000Z" title="2021-09-27, 12:00">вчера в 12:00</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/ruvds/blog/580060/" class="tm-article-title__link"><span>Арракис, который мы заслужили</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 145: ↑139 и ↓6</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 145: ↑139 и ↓6" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+133</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">22K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    40
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/ruvds/blog/580060/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      112
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-27T16:41:21.000Z" title="2021-09-27, 19:41">вчера в 19:41</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/lamptest/blog/580228/" class="tm-article-title__link"><span>Идеальная светодиодная лампа за 21 рубль</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 80: ↑78 и ↓2</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 80: ↑78 и ↓2" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+76</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">11K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    44
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/lamptest/blog/580228/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      29
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-27T13:03:14.000Z" title="2021-09-27, 16:03">вчера в 16:03</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/ruvds/blog/580124/" class="tm-article-title__link"><span>Электролюминесцентные индикаторы из прошлого</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 74: ↑74 и ↓0</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 74: ↑74 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+74</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">5.1K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    37
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/ruvds/blog/580124/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      13
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-27T12:53:02.000Z" title="2021-09-27, 15:53">вчера в 15:53</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/post/580210/" class="tm-article-title__link"><span>PHP Дайджест № 212 (13 – 27 сентября 2021)</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 41: ↑41 и ↓0</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 41: ↑41 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+41</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">3.6K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    14
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/post/580210/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      1
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-block tm-article-snippet-block-block_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2021-09-27T10:50:03.000Z" title="2021-09-27, 13:50">вчера в 13:50</time></div></div> <h2 class="tm-article-title tm-article-title_block"><a href="/ru/company/oleg-bunin/blog/580150/" class="tm-article-title__link"><span>Топ-5 когнитивных искажений при планировании в IT</span></a></h2> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_small"><title>Всего голосов 40: ↑39 и ↓1</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-rating"></use></svg> <span title="Всего голосов 40: ↑39 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_small">+38</span></div> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">6K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    54
  </span></button> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/company/oleg-bunin/blog/580150/comments/" class="tm-article-comments-counter-link__link"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.cee85629.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      7
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></article></li> <!----></ul></div> <!----></section> <!----> <!----></div></div></div> <div class="tm-page__sidebar"><div hl="ru" id="82015" class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/82015/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/82015/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"82015":{"id":"82015","timePublished":"2010-01-26T07:10:06+00:00","isCorporative":false,"lang":"ru","titleHtml":"Comet для ASP.NET своими руками","leadData":{"textHtml":"Не так давно в рамках разработки крупного ASP.NET проекта возникла следующая подзадача: реализовать визуальное отображение табличных данных, обновляющихся в режиме real-time. Схема обновления довольно проста, а именно: на сервер посредством QueryString присылаются данные, которые должны как можно быстрее заменить собой устаревшие данные на странице, причем без необходимости страницу эту рефрешить. Первым решением, которое сразу же пришло мне в голову, было использовать ставшую уже общепринятой технику AJAX-запросов по таймеру, скажем, каждые 5 секунд. Однако сразу же выявились очевидные недостатки применения такого подхода: во-первых, довольно внушительное число потенциальных клиентов, дергающих сервер каждые 5 секунд с созданием каждый раз нового соединения, а во-вторых, это все-таки довольно грубая эмуляция real-time'а, ведь данные на сервер гипотетически могут приходить даже по несоколько раз в секунду (а могут не приходить и по несколько минут, и это уже больше относится к «во-первых»).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nИдея решения пришла довольно неожиданно от коллеги по работе, поделившегося линком на \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fblogs\u002Fwebdev\u002F76144\u002F\"\u003Eстатью на Хабре\u003C\u002Fa\u003E, описывающую реализацию технологии Comet на Perl в целях создания веб-чата. &quot;\u003Ci\u003EComet — это то что нужно!\u003C\u002Fi\u003E&quot;, — подумали мы, и я начал разбираться, как же эту штуку можно прикрутить к ASP.NET. О чем, собственно, и пойдет речь под катом.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"editorVersion":"1.0","postType":"article","postLabels":[],"author":{"scoreStats":{"score":43,"votesCount":68},"rating":0,"relatedData":null,"contacts":[{"title":"ВКонтакте","url":"https:\u002F\u002Fvk.com\u002Fcromathaar","value":"cromathaar"}],"authorContacts":[{"title":"ВКонтакте","url":"https:\u002F\u002Fvk.com\u002Fcromathaar","value":"cromathaar"}],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"53875","alias":"Cromathaar","fullname":"Сергей Прокопенко","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F392\u002Fa18\u002F2cb\u002F392a182cb77f8a238b4b40cd64e3a860.png","speciality":"Пользователь"},"statistics":{"commentsCount":45,"favoritesCount":92,"readingCount":10328,"score":37,"votesCount":63},"hubs":[{"relatedData":null,"id":"546","alias":"net","type":"collective","title":".NET","titleHtml":".NET","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EНе так давно в рамках разработки крупного ASP.NET проекта возникла следующая подзадача: реализовать визуальное отображение табличных данных, обновляющихся в режиме real-time. Схема обновления довольно проста, а именно: на сервер посредством QueryString присылаются данные, которые должны как можно быстрее заменить собой устаревшие данные на странице, причем без необходимости страницу эту рефрешить. Первым решением, которое сразу же пришло мне в голову, было использовать ставшую уже общепринятой технику AJAX-запросов по таймеру, скажем, каждые 5 секунд. Однако сразу же выявились очевидные недостатки применения такого подхода: во-первых, довольно внушительное число потенциальных клиентов, дергающих сервер каждые 5 секунд с созданием каждый раз нового соединения, а во-вторых, это все-таки довольно грубая эмуляция real-time'а, ведь данные на сервер гипотетически могут приходить даже по несоколько раз в секунду (а могут не приходить и по несколько минут, и это уже больше относится к «во-первых»).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nИдея решения пришла довольно неожиданно от коллеги по работе, поделившегося линком на \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fblogs\u002Fwebdev\u002F76144\u002F\"\u003Eстатью на Хабре\u003C\u002Fa\u003E, описывающую реализацию технологии Comet на Perl в целях создания веб-чата. \"\u003Ci\u003EComet — это то что нужно!\u003C\u002Fi\u003E\", — подумали мы, и я начал разбираться, как же эту штуку можно прикрутить к ASP.NET. О чем, собственно, и пойдет речь под катом.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПрежде всего, разберемся, что же такое Comet. Вот что говорит нам по этому поводу Википедия:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EComet\u003C\u002Fb\u003E (в веб-разработке) — неологизм, описывающий модель работы веб-приложения, при которой постоянное HTTP-соединение позволяет веб-серверу отправлять (push) данные браузеру, без дополнительного запроса со стороны браузера. Comet — это гипероним, используемый для обозначения множества техник, позволяющих достичь такого взаимодействия. Общее у этих методов то, что они основаны на технологиях, непосредственно поддерживаемых браузером, таких как JavaScript, а не на проприетарных плагинах. Теоретически подход Comet отличается от изначальной концепции всемирной паутины, при которой браузер запрашивает страницу полностью или частично для того, чтобы обновить страницу. Однако на практике приложения Comet обычно используют \u003Cb\u003EAjax c long polling\u003C\u002Fb\u003E для проверки наличия новой информации на сервере.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nИтак, ключевые слова, которые мы можем вынести для себя из этого определения, — это «Ajax с long polling». Что же это такое, и с чем его едят? При использовании технологии «long polling» клиент посылает на сервер запрос и… ждет. Ждет, когда на сервере появятся новые данные. Как только данные пришли, сервер отправляет их клиенту, после чего оный посылает новый запрос и снова ждет. Альтернативная технология «бесконечного запроса», реализуемая, например, через т.н. «forever iframe» (немного подробнее можно почитать \u003Ca href=\"http:\u002F\u002Fhabrahabr.ru\u002Fblogs\u002Fwebdev\u002F80466\u002F\"\u003Eздесь\u003C\u002Fa\u003E), далеко не всегда применима, т.к. такую штуку, как таймаут пока никто не отменял.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЧто ж, задача предельно ясна — нужно реализовать подручными средствами (AJAX + ASP.NET) вышеупомянутый long polling. Отсюда вытекает и первая проблема: как законсервировать входящие реквесты и не выдавать респонсы, пока на сервере нет свежих данных, которые можно было бы отдать клиентам (а клиент у нас, очевидно, не один). И здесь на помощь нам приходит асинхронный HTTP Handler.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Ca href=\"http:\u002F\u002Fvirtser.net\u002Fblog\u002Fpost\u002Fsource-code-highlighter.aspx\"\u003E\u003C\u002Fa\u003E\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Einterface\u003C\u002Ffont\u003E IHttpAsyncHandler : IHttpHandler\u003Cbr\u002F\u003E\r\n{\u003Cbr\u002F\u003E\r\n IAsyncResult BeginProcessRequest(\u003Cfont color=\"#2B91AF\"\u003EHttpContext\u003C\u002Ffont\u003E ctx,\u003Cbr\u002F\u003E\r\n                  AsyncCallback cb, \u003Cbr\u002F\u003E\r\n                  \u003Cfont color=\"#0000ff\"\u003Eobject\u003C\u002Ffont\u003E obj);\u003Cbr\u002F\u003E\r\n \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E EndProcessRequest(IAsyncResult ar);\u003Cbr\u002F\u003E\r\n}\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"gray\"\u003E* This source code was highlighted with \u003Cfont color=\"gray\"\u003ESource Code Highlighter\u003C\u002Ffont\u003E.\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЗаметьте, что наш класс мы будем наследовать не от интерфейса IHttpHandler, а от IHttpAsyncHandler, который привнесет в нашу реализацию наряду со знакомым методом ProcessRequest два новых: BeginProcessRequest и EndProcessRequest. Интересовать нас, в частности, будет первый из них, т.к. иммено при начале обработки реквеста нам этот реквест нужно схватить за руку и не отпускать до тех пор, пока не придет час икс. Как видим, BeginProcessRequest возвращает объект, реализующий интерфейс IAsyncResult.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Ca href=\"http:\u002F\u002Fvirtser.net\u002Fblog\u002Fpost\u002Fsource-code-highlighter.aspx\"\u003E\u003C\u002Fa\u003E\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Einterface\u003C\u002Ffont\u003E IAsyncResult\u003Cbr\u002F\u003E\r\n{\u003Cbr\u002F\u003E\r\n \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Eobject\u003C\u002Ffont\u003E   AsyncState            { \u003Cfont color=\"#0000ff\"\u003Eget\u003C\u002Ffont\u003E; }\u003Cbr\u002F\u003E\r\n \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Ebool\u003C\u002Ffont\u003E    CompletedSynchronously { \u003Cfont color=\"#0000ff\"\u003Eget\u003C\u002Ffont\u003E; }\u003Cbr\u002F\u003E\r\n \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Ebool\u003C\u002Ffont\u003E    IsCompleted            { \u003Cfont color=\"#0000ff\"\u003Eget\u003C\u002Ffont\u003E; }\u003Cbr\u002F\u003E\r\n \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E WaitHandle AsyncWaitHandle     { \u003Cfont color=\"#0000ff\"\u003Eget\u003C\u002Ffont\u003E; }\u003Cbr\u002F\u003E\r\n}\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"gray\"\u003E* This source code was highlighted with \u003Cfont color=\"gray\"\u003ESource Code Highlighter\u003C\u002Ffont\u003E.\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСоздадим новый класс, который будет реализовывать указанный интерфейс, а также послужит хранилищем для передаваемых в BeginProcessRequest данных запроса и нашего собственного параметра clientGuid, который мы будем использовать в дальнейшем в качестве уникального идентификатора приконнектившегося к серверу клиента, дабы как-то идентифицировать его запросы.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Ca href=\"http:\u002F\u002Fvirtser.net\u002Fblog\u002Fpost\u002Fsource-code-highlighter.aspx\"\u003E\u003C\u002Fa\u003E\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Eclass\u003C\u002Ffont\u003E CometAsyncRequestState : IAsyncResult\u003Cbr\u002F\u003E\r\n{\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E \u003Cfont color=\"#2B91AF\"\u003EHttpContext\u003C\u002Ffont\u003E _currentContext;\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E AsyncCallback _asyncCallback;\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E Object _extraData;\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E Boolean _isCompleted;\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E \u003Cfont color=\"#2B91AF\"\u003EGuid\u003C\u002Ffont\u003E _clientGuid;\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E ManualResetEvent _callCompleteEvent = \u003Cfont color=\"#0000ff\"\u003Enull\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E CometAsyncRequestState(\u003Cfont color=\"#2B91AF\"\u003EHttpContext\u003C\u002Ffont\u003E currentContext, AsyncCallback asyncCallback, Object extraData)\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    _currentContext = currentContext;\u003Cbr\u002F\u003E\r\n    _asyncCallback = asyncCallback;\u003Cbr\u002F\u003E\r\n    _extraData = extraData;\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    _isCompleted = \u003Cfont color=\"#0000ff\"\u003Efalse\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E CompleteRequest()\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    _isCompleted = \u003Cfont color=\"#0000ff\"\u003Etrue\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Elock\u003C\u002Ffont\u003E (\u003Cfont color=\"#0000ff\"\u003Ethis\u003C\u002Ffont\u003E)\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E (_callCompleteEvent != \u003Cfont color=\"#0000ff\"\u003Enull\u003C\u002Ffont\u003E)\u003Cbr\u002F\u003E\r\n        _callCompleteEvent.Set();\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E (_asyncCallback != \u003Cfont color=\"#0000ff\"\u003Enull\u003C\u002Ffont\u003E)\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      _asyncCallback(\u003Cfont color=\"#0000ff\"\u003Ethis\u003C\u002Ffont\u003E);\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#2B91AF\"\u003EHttpContext\u003C\u002Ffont\u003E CurrentContext\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eget\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E _currentContext;\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eset\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      _currentContext = \u003Cfont color=\"#0000ff\"\u003Evalue\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E AsyncCallback AsyncCallback\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eget\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E _asyncCallback;\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eset\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      _asyncCallback = \u003Cfont color=\"#0000ff\"\u003Evalue\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E Object ExtraData\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eget\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E _extraData;\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eset\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      _extraData = \u003Cfont color=\"#0000ff\"\u003Evalue\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#2B91AF\"\u003EGuid\u003C\u002Ffont\u003E ClientGuid\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eget\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E _clientGuid;\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eset\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      _clientGuid = \u003Cfont color=\"#0000ff\"\u003Evalue\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#008000\"\u003E\u002F\u002F IAsyncResult implementations\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E Boolean CompletedSynchronously\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eget\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Efalse\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E Boolean IsCompleted\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eget\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E _isCompleted;\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E Object AsyncState\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eget\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E _extraData;\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E WaitHandle AsyncWaitHandle\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eget\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Elock\u003C\u002Ffont\u003E (\u003Cfont color=\"#0000ff\"\u003Ethis\u003C\u002Ffont\u003E)\u003Cbr\u002F\u003E\r\n      {\u003Cbr\u002F\u003E\r\n        \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E (_callCompleteEvent == \u003Cfont color=\"#0000ff\"\u003Enull\u003C\u002Ffont\u003E)\u003Cbr\u002F\u003E\r\n          _callCompleteEvent = \u003Cfont color=\"#0000ff\"\u003Enew\u003C\u002Ffont\u003E ManualResetEvent(\u003Cfont color=\"#0000ff\"\u003Efalse\u003C\u002Ffont\u003E);\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n        \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E _callCompleteEvent;\u003Cbr\u002F\u003E\r\n      }\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n}\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"gray\"\u003E* This source code was highlighted with \u003Cfont color=\"gray\"\u003ESource Code Highlighter\u003C\u002Ffont\u003E.\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nКак видим, пока мы сами не вызовем функцию CompleteRequest, запрос не будет считаться завершенным. Замечательно — то, что нам и надо. Осталось только где-то эти входящие реквесты хранить. Для этой функции, а также для функции обработки запросов создадим статический класс CometClientProcessor:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Ca href=\"http:\u002F\u002Fvirtser.net\u002Fblog\u002Fpost\u002Fsource-code-highlighter.aspx\"\u003E\u003C\u002Fa\u003E\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Estatic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Eclass\u003C\u002Ffont\u003E CometClientProcessor\u003Cbr\u002F\u003E\r\n{\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Estatic\u003C\u002Ffont\u003E Object _lockObj;\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Estatic\u003C\u002Ffont\u003E \u003Cfont color=\"#2B91AF\"\u003EList\u003C\u002Ffont\u003E&lt;CometAsyncRequestState\u003E _clientStateList;\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Estatic\u003C\u002Ffont\u003E CometClientProcessor()\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    _lockObj = \u003Cfont color=\"#0000ff\"\u003Enew\u003C\u002Ffont\u003E Object();\u003Cbr\u002F\u003E\r\n    _clientStateList = \u003Cfont color=\"#0000ff\"\u003Enew\u003C\u002Ffont\u003E \u003Cfont color=\"#2B91AF\"\u003EList\u003C\u002Ffont\u003E&lt;CometAsyncRequestState\u003E();\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Estatic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E PushData(\u003Cfont color=\"#2B91AF\"\u003EString\u003C\u002Ffont\u003E pushedData)\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#2B91AF\"\u003EList\u003C\u002Ffont\u003E&lt;CometAsyncRequestState\u003E currentStateList = \u003Cfont color=\"#0000ff\"\u003Enew\u003C\u002Ffont\u003E \u003Cfont color=\"#2B91AF\"\u003EList\u003C\u002Ffont\u003E&lt;CometAsyncRequestState\u003E();\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Elock\u003C\u002Ffont\u003E (_lockObj)\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Eforeach\u003C\u002Ffont\u003E (CometAsyncRequestState clientState \u003Cfont color=\"#0000ff\"\u003Ein\u003C\u002Ffont\u003E _clientStateList)\u003Cbr\u002F\u003E\r\n      {\u003Cbr\u002F\u003E\r\n        currentStateList.Add(clientState);\u003Cbr\u002F\u003E\r\n      }\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eforeach\u003C\u002Ffont\u003E (CometAsyncRequestState clientState \u003Cfont color=\"#0000ff\"\u003Ein\u003C\u002Ffont\u003E currentStateList)\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E (clientState.CurrentContext.Session != \u003Cfont color=\"#0000ff\"\u003Enull\u003C\u002Ffont\u003E)\u003Cbr\u002F\u003E\r\n      {\u003Cbr\u002F\u003E\r\n        clientState.CurrentContext.Response.Write(pushedData);\u003Cbr\u002F\u003E\r\n        clientState.CompleteRequest();\u003Cbr\u002F\u003E\r\n      }\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Estatic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E AddClient(CometAsyncRequestState state)\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#2B91AF\"\u003EGuid\u003C\u002Ffont\u003E newGuid;\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Elock\u003C\u002Ffont\u003E (_lockObj)\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Ewhile\u003C\u002Ffont\u003E (\u003Cfont color=\"#0000ff\"\u003Etrue\u003C\u002Ffont\u003E)\u003Cbr\u002F\u003E\r\n      {\u003Cbr\u002F\u003E\r\n        newGuid = \u003Cfont color=\"#2B91AF\"\u003EGuid\u003C\u002Ffont\u003E.NewGuid();\u003Cbr\u002F\u003E\r\n        \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E (_clientStateList.Find(s =\u003E s.ClientGuid == newGuid) == \u003Cfont color=\"#0000ff\"\u003Enull\u003C\u002Ffont\u003E)\u003Cbr\u002F\u003E\r\n        {\u003Cbr\u002F\u003E\r\n          state.ClientGuid = newGuid;\u003Cbr\u002F\u003E\r\n          \u003Cfont color=\"#0000ff\"\u003Ebreak\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n        }\u003Cbr\u002F\u003E\r\n      }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n      _clientStateList.Add(state);\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Estatic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E UpdateClient(CometAsyncRequestState state, \u003Cfont color=\"#2B91AF\"\u003EString\u003C\u002Ffont\u003E clientGuidKey)\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#2B91AF\"\u003EGuid\u003C\u002Ffont\u003E clientGuid = \u003Cfont color=\"#0000ff\"\u003Enew\u003C\u002Ffont\u003E \u003Cfont color=\"#2B91AF\"\u003EGuid\u003C\u002Ffont\u003E(clientGuidKey);\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Elock\u003C\u002Ffont\u003E (_lockObj)\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      CometAsyncRequestState foundState = _clientStateList.Find(s =\u003E s.ClientGuid == clientGuid);\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E (foundState != \u003Cfont color=\"#0000ff\"\u003Enull\u003C\u002Ffont\u003E)\u003Cbr\u002F\u003E\r\n      {\u003Cbr\u002F\u003E\r\n        foundState.CurrentContext = state.CurrentContext;\u003Cbr\u002F\u003E\r\n        foundState.ExtraData = state.ExtraData;\u003Cbr\u002F\u003E\r\n        foundState.AsyncCallback = state.AsyncCallback;\u003Cbr\u002F\u003E\r\n      }\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Estatic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E RemoveClient(CometAsyncRequestState state)\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Elock\u003C\u002Ffont\u003E (_lockObj)\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      _clientStateList.Remove(state);\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n}\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"gray\"\u003E* This source code was highlighted with \u003Cfont color=\"gray\"\u003ESource Code Highlighter\u003C\u002Ffont\u003E.\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nCometClientProcessor содержит в себе список удерживаемых на данный момент реквестов, функции AddClient для добавления реквестов (при коннекте нового клиента), UpdateClient для обновления реквестов (когда уже приконнектившийся клиент послает новый запрос) и RemoveClient для удаления реквестов (когда клиент дисконнектится), а также основной метод PushData. «Пушить» для наглядности мы будем простейшие данные, а именно строку, которая приходит на сервер через параметр в URL. Как видим, все предельно просто — пробегаем по текущим удерживаемым реквестам, записываем в респонс данные, пришедшие с сервера, и вызываем функцию CompleteRequest, которая освобождает запрос, и отправляет клиенту ответ. Вызов PushData осуществляется в данном примере из функции Page_Load нашей единственной страницы:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Ca href=\"http:\u002F\u002Fvirtser.net\u002Fblog\u002Fpost\u002Fsource-code-highlighter.aspx\"\u003E\u003C\u002Fa\u003E\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003Eprotected\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E Page_Load(\u003Cfont color=\"#0000ff\"\u003Eobject\u003C\u002Ffont\u003E sender, \u003Cfont color=\"#2B91AF\"\u003EEventArgs\u003C\u002Ffont\u003E e)\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E (!IsPostBack)\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E (Request.QueryString[\u003Cfont color=\"#A31515\"\u003E\"x\"\u003C\u002Ffont\u003E] != \u003Cfont color=\"#0000ff\"\u003Enull\u003C\u002Ffont\u003E)\u003Cbr\u002F\u003E\r\n      {\u003Cbr\u002F\u003E\r\n        CometClientProcessor.PushData(Request.QueryString[\u003Cfont color=\"#A31515\"\u003E\"x\"\u003C\u002Ffont\u003E].ToString());\u003Cbr\u002F\u003E\r\n      }\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n  }\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"gray\"\u003E* This source code was highlighted with \u003Cfont color=\"gray\"\u003ESource Code Highlighter\u003C\u002Ffont\u003E.\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nКак уже говорилось выше, данные к нам приходят через параметр в URL, в данном случае для наглядности он носит имя «x». В серверной части осталось только реализовать, собственно, сам асинхронный хэндлер. Но сперва обратимся к части клиентской и напишем (не без помощи библиотеки jQuery) несколько довольно банальных JavaScript-овых функций:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Ca href=\"http:\u002F\u002Fvirtser.net\u002Fblog\u002Fpost\u002Fsource-code-highlighter.aspx\"\u003E\u003C\u002Fa\u003E\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003Evar\u003C\u002Ffont\u003E clientGuid\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n$(\u003Cfont color=\"#0000ff\"\u003Edocument\u003C\u002Ffont\u003E).ready(\u003Cfont color=\"#0000ff\"\u003Efunction\u003C\u002Ffont\u003E() {\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Evar\u003C\u002Ffont\u003E str = window.location.href;\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E (str.indexOf(\u003Cfont color=\"#A31515\"\u003E\"?\"\u003C\u002Ffont\u003E) &lt; 0)\u003Cbr\u002F\u003E\r\n    Connect();\u003Cbr\u002F\u003E\r\n});\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n$(window).unload(\u003Cfont color=\"#0000ff\"\u003Efunction\u003C\u002Ffont\u003E() {\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Evar\u003C\u002Ffont\u003E str = window.location.href;\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E (str.indexOf(\u003Cfont color=\"#A31515\"\u003E\"?\"\u003C\u002Ffont\u003E) &lt; 0)\u003Cbr\u002F\u003E\r\n    Disconnect();\u003Cbr\u002F\u003E\r\n});\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Efunction\u003C\u002Ffont\u003E SendRequest() {\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Evar\u003C\u002Ffont\u003E url = \u003Cfont color=\"#A31515\"\u003E'.\u002FCometAsyncHandler.ashx?cid='\u003C\u002Ffont\u003E + clientGuid;\u003Cbr\u002F\u003E\r\n  $.ajax({\u003Cbr\u002F\u003E\r\n    type: \u003Cfont color=\"#A31515\"\u003E\"POST\"\u003C\u002Ffont\u003E,\u003Cbr\u002F\u003E\r\n    url: url,\u003Cbr\u002F\u003E\r\n    success: ProcessResponse,\u003Cbr\u002F\u003E\r\n    error: SendRequest\u003Cbr\u002F\u003E\r\n  });\u003Cbr\u002F\u003E\r\n}\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Efunction\u003C\u002Ffont\u003E Connect() {\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Evar\u003C\u002Ffont\u003E url = \u003Cfont color=\"#A31515\"\u003E'.\u002FCometAsyncHandler.ashx?cpsp=CONNECT'\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n  $.ajax({\u003Cbr\u002F\u003E\r\n    type: \u003Cfont color=\"#A31515\"\u003E\"POST\"\u003C\u002Ffont\u003E,\u003Cbr\u002F\u003E\r\n    url: url,\u003Cbr\u002F\u003E\r\n    success: OnConnected,\u003Cbr\u002F\u003E\r\n    error: ConnectionRefused\u003Cbr\u002F\u003E\r\n  });\u003Cbr\u002F\u003E\r\n}\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Efunction\u003C\u002Ffont\u003E Disconnect() {\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Evar\u003C\u002Ffont\u003E url = \u003Cfont color=\"#A31515\"\u003E'.\u002FCometAsyncHandler.ashx?cpsp=DISCONNECT'\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n  $.ajax({\u003Cbr\u002F\u003E\r\n    type: \u003Cfont color=\"#A31515\"\u003E\"POST\"\u003C\u002Ffont\u003E,\u003Cbr\u002F\u003E\r\n    url: url\u003Cbr\u002F\u003E\r\n  });\u003Cbr\u002F\u003E\r\n}\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Efunction\u003C\u002Ffont\u003E ProcessResponse(transport) {\u003Cbr\u002F\u003E\r\n  $(\u003Cfont color=\"#A31515\"\u003E\"#contentWrapper\"\u003C\u002Ffont\u003E).html(transport);\u003Cbr\u002F\u003E\r\n  SendRequest();\u003Cbr\u002F\u003E\r\n}\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Efunction\u003C\u002Ffont\u003E OnConnected(transport) {\u003Cbr\u002F\u003E\r\n  clientGuid = transport;\u003Cbr\u002F\u003E\r\n  SendRequest();\u003Cbr\u002F\u003E\r\n}\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Efunction\u003C\u002Ffont\u003E ConnectionRefused() {\u003Cbr\u002F\u003E\r\n  $(\u003Cfont color=\"#A31515\"\u003E\"#contentWrapper\"\u003C\u002Ffont\u003E).html(\u003Cfont color=\"#A31515\"\u003E\"Unable to connect to Comet server. Reconnecting in 5 seconds...\"\u003C\u002Ffont\u003E);\u003Cbr\u002F\u003E\r\n  setTimeout(Connect(), 5000);\u003Cbr\u002F\u003E\r\n}\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"gray\"\u003E* This source code was highlighted with \u003Cfont color=\"gray\"\u003ESource Code Highlighter\u003C\u002Ffont\u003E.\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nКак только документ загружается, мы проверяем URL на наличие параметров в нем (параметризованный URL, еще раз позволю себе напомнить — это передача данных серверу для «пушинга») и вызываем функцию Connect. Та, в свою очередь, уже начинает общаться с нашим хэндлером. Служебные слова, определяющие действие (CONNECT\u002FDISCONNECT), как видим, для простоты, передаются через параметр cpsp. Соответственно, Connect должен инициировать на сервере вызов AddClient, а Disconnect — RemoveClient. Когда соединение установлено и клиент получил свой clientGuid, вызывается функция SendRequest, которая и будет «лонгполлить» сервер, пока клиент не решит от него отсоединиться. Каждый вызов SendRequest будет инициировать выполнение на сервере функции UpdateClient, которая для данного клиента обновит контекст и точку возврата (callback).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЧто-ж, практически все готово, настало время для реализации ядра всего вышепредставленного механизма — асинхронного хэндлера.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Ca href=\"http:\u002F\u002Fvirtser.net\u002Fblog\u002Fpost\u002Fsource-code-highlighter.aspx\"\u003E\u003C\u002Fa\u003E\u003Cfont color=\"black\"\u003E\u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Eenum\u003C\u002Ffont\u003E ConnectionCommand\u003Cbr\u002F\u003E\r\n{\u003Cbr\u002F\u003E\r\n  CONNECT,\u003Cbr\u002F\u003E\r\n  DISCONNECT\u003Cbr\u002F\u003E\r\n}\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Estatic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Eclass\u003C\u002Ffont\u003E ConnectionProtocol\u003Cbr\u002F\u003E\r\n{\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Estatic\u003C\u002Ffont\u003E \u003Cfont color=\"#2B91AF\"\u003EString\u003C\u002Ffont\u003E PROTOCOL_GET_PARAMETER_NAME = \u003Cfont color=\"#A31515\"\u003E\"cpsp\"\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Estatic\u003C\u002Ffont\u003E \u003Cfont color=\"#2B91AF\"\u003EString\u003C\u002Ffont\u003E CLIENT_GUID_PARAMETER_NAME = \u003Cfont color=\"#A31515\"\u003E\"cid\"\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n}\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"gray\"\u003E* This source code was highlighted with \u003Cfont color=\"gray\"\u003ESource Code Highlighter\u003C\u002Ffont\u003E.\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ccode\u003E\u003Ca href=\"http:\u002F\u002Fvirtser.net\u002Fblog\u002Fpost\u002Fsource-code-highlighter.aspx\"\u003E\u003C\u002Fa\u003E\u003Cfont color=\"black\"\u003E&lt;%@ WebHandler Language=\u003Cfont color=\"#A31515\"\u003E\"C#\"\u003C\u002Ffont\u003E Class=\u003Cfont color=\"#A31515\"\u003E\"CometAsyncHandler\"\u003C\u002Ffont\u003E %\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Eusing\u003C\u002Ffont\u003E System;\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Eusing\u003C\u002Ffont\u003E System.Web;\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Eusing\u003C\u002Ffont\u003E DevelopMentor;\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Eclass\u003C\u002Ffont\u003E CometAsyncHandler : IHttpAsyncHandler, System.Web.SessionState.IRequiresSessionState\u003Cbr\u002F\u003E\r\n{\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Estatic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E ThreadPool _threadPool;\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Estatic\u003C\u002Ffont\u003E CometAsyncHandler()\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    _threadPool = \u003Cfont color=\"#0000ff\"\u003Enew\u003C\u002Ffont\u003E ThreadPool(2, 50, \u003Cfont color=\"#A31515\"\u003E\"Comet Pool\"\u003C\u002Ffont\u003E);\u003Cbr\u002F\u003E\r\n    _threadPool.PropogateCallContext = \u003Cfont color=\"#0000ff\"\u003Etrue\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n    _threadPool.PropogateThreadPrincipal = \u003Cfont color=\"#0000ff\"\u003Etrue\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n    _threadPool.PropogateHttpContext = \u003Cfont color=\"#0000ff\"\u003Etrue\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n    _threadPool.Start();\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E IAsyncResult BeginProcessRequest(\u003Cfont color=\"#2B91AF\"\u003EHttpContext\u003C\u002Ffont\u003E ctx, AsyncCallback cb, Object obj)\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    CometAsyncRequestState currentAsyncRequestState = \u003Cfont color=\"#0000ff\"\u003Enew\u003C\u002Ffont\u003E CometAsyncRequestState(ctx, cb, obj);\u003Cbr\u002F\u003E\r\n    _threadPool.PostRequest(\u003Cfont color=\"#0000ff\"\u003Enew\u003C\u002Ffont\u003E WorkRequestDelegate(ProcessServiceRequest), currentAsyncRequestState);\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E currentAsyncRequestState;\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Eprivate\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E ProcessServiceRequest(Object state, \u003Cfont color=\"#2B91AF\"\u003EDateTime\u003C\u002Ffont\u003E requestTime)\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    CometAsyncRequestState currentAsyncRequestState = state \u003Cfont color=\"#0000ff\"\u003Eas\u003C\u002Ffont\u003E CometAsyncRequestState;\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E (currentAsyncRequestState.CurrentContext.Request.QueryString[ConnectionProtocol.PROTOCOL_GET_PARAMETER_NAME] ==\u003Cbr\u002F\u003E\r\n      ConnectionCommand.CONNECT.ToString())\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      CometClientProcessor.AddClient(currentAsyncRequestState);\u003Cbr\u002F\u003E\r\n      currentAsyncRequestState.CurrentContext.Response.Write(currentAsyncRequestState.ClientGuid.ToString());\u003Cbr\u002F\u003E\r\n      currentAsyncRequestState.CompleteRequest();\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eelse\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E (currentAsyncRequestState.CurrentContext.Request.QueryString[ConnectionProtocol.PROTOCOL_GET_PARAMETER_NAME] ==\u003Cbr\u002F\u003E\r\n      ConnectionCommand.DISCONNECT.ToString())\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      CometClientProcessor.RemoveClient(currentAsyncRequestState);\u003Cbr\u002F\u003E\r\n      currentAsyncRequestState.CompleteRequest();\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eelse\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Eif\u003C\u002Ffont\u003E (currentAsyncRequestState.CurrentContext.Request.QueryString[ConnectionProtocol.CLIENT_GUID_PARAMETER_NAME] != \u003Cfont color=\"#0000ff\"\u003Enull\u003C\u002Ffont\u003E)\u003Cbr\u002F\u003E\r\n      {\u003Cbr\u002F\u003E\r\n        CometClientProcessor.UpdateClient(currentAsyncRequestState, \u003Cbr\u002F\u003E\r\n          currentAsyncRequestState.CurrentContext.Request.QueryString[ConnectionProtocol.CLIENT_GUID_PARAMETER_NAME].ToString());\u003Cbr\u002F\u003E\r\n      }\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E EndProcessRequest(IAsyncResult ar)\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Evoid\u003C\u002Ffont\u003E ProcessRequest(\u003Cfont color=\"#2B91AF\"\u003EHttpContext\u003C\u002Ffont\u003E context)\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n  \u003Cfont color=\"#0000ff\"\u003Epublic\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Ebool\u003C\u002Ffont\u003E IsReusable\u003Cbr\u002F\u003E\r\n  {\u003Cbr\u002F\u003E\r\n    \u003Cfont color=\"#0000ff\"\u003Eget\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n    {\u003Cbr\u002F\u003E\r\n      \u003Cfont color=\"#0000ff\"\u003Ereturn\u003C\u002Ffont\u003E \u003Cfont color=\"#0000ff\"\u003Etrue\u003C\u002Ffont\u003E;\u003Cbr\u002F\u003E\r\n    }\u003Cbr\u002F\u003E\r\n  }\u003Cbr\u002F\u003E\r\n}\u003Cbr\u002F\u003E\r\n\u003C\u002Ffont\u003E\u003Cbr\u002F\u003E\r\n\u003Cfont color=\"gray\"\u003E* This source code was highlighted with \u003Cfont color=\"gray\"\u003ESource Code Highlighter\u003C\u002Ffont\u003E.\u003C\u002Ffont\u003E\u003C\u002Fcode\u003E\u003C\u002Fblockquote\u003E\u003Cbr\u002F\u003E\r\nПосле всего вышесказанного, единственный вопрос, который может возникнуть у внимательного читателя — «зачем использовать кастом тредпул»? Ответ довольно прост, хоть и не совсем очевиден: чтобы как можно быстрее «отпустить» рабочий поток тредпула ASP.NET, дабы он мог продолжить обрабатывать входящие реквесты, а непосредственную обработку запроса передать «внутреннему» потоку. Если этого не сделать, то при достаточно большом количестве входящих реквестов, может произойти банальный «затык» по довольно смешной на первый взгляд причине: «у ASP.NET кончились рабочие потоки». По этой же причине не получится использовать ни асинхронный делегат, возбуждаемый методом BeginInvoke, ни метод стандартного тредпула ThreadPool.QueueUserWorkItem, т.к. в обоих этих случая поток будет изыматься из того же тредпула ASP.NET, что приводит нас к ситуации «шило на мыло». В данном примере используется кастом тредпул, реализованный Майком Вудрингом (Mike Woodring); эту и многие другие из его наработок можно посмотреть \u003Ca href=\"http:\u002F\u002Fwww.bearcanyon.com\u002Fdotnet\u002F\"\u003Eздесь\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВот, в общем-то и все. Не так уж и сложно, как казалось вначале. Клиенты коннектятся к нашему Comet-серверу посредством вызова Default.aspx, а данные мы пушим передавая той же странице GET-параметр аля Default.aspx?x=Happy_New_Year. К сожелению провести массирование тестирование масштабируемости такого подхода пока не было возможности, однако если у кого-то есть идеи по этому поводу — пишите, не стесняйтесь.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСпасибо за внимание.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EUPD\u003C\u002Fb\u003E Добавляю ссылку на \u003Ca href=\"http:\u002F\u002Fwww.filefront.com\u002F15428329\u002FCometSkeleton.zip\u002F\"\u003Eархив с сэмпловым проектом\u003C\u002Fa\u003E (~30 KB). Как посмотреть: в VS ставим стартовой страницей CometPage.aspx, запускаем, открываем в браузере\u002Fбраузерах несколько вкладок с тем же URL (только помним про ограничение в оных браузерах количества одновременных подключений), затем в одном из табов к URL дописываем параметр \u003Ci\u003E?x=[любой_текст]\u003C\u002Fi\u003E и наблюдаем, как значение параметра появится во всех открытых вкладках.\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"Comet"},{"titleHtml":"ASP.NET"},{"titleHtml":"AJAX"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F82015\u002F15e5b999166c898d3dfeac29f5bba6cc\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F82015\u002F15e5b999166c898d3dfeac29f5bba6cc\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F82015\\\u002F\"},\"headline\":\"Comet для ASP.NET своими руками\",\"datePublished\":\"2010-01-26T10:10:06+03:00\",\"dateModified\":\"2010-01-26T11:50:25+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Сергей Прокопенко\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Не так давно в рамках разработки крупного ASP.NET проекта возникла следующая подзадача: реализовать визуальное отображение табличных данных, обновляющихся в режи...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F82015\\\u002F#post-content-body\",\"about\":[\"h_net\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F82015\\\u002F15e5b999166c898d3dfeac29f5bba6cc\\\u002F\"]}","metaDescription":"Не так давно в рамках разработки крупного ASP.NET проекта возникла следующая подзадача: реализовать визуальное отображение табличных данных, обновляющихся в режиме real-time. Схема обновления довольно...","mainImageUrl":null,"amp":false},"polls":[],"commentsEnabled":true,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false},"572164":{"id":"572164","timePublished":"2021-09-27T11:37:23+00:00","isCorporative":false,"lang":"ru","titleHtml":"Первые шаги в ОТО: прецессия орбиты Меркурия","editorVersion":"2.0","postType":"article","postLabels":[{"type":"tutorial","data":null}],"author":{"id":"1832999","alias":"Yermack","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F690\u002F140\u002F823\u002F690140823f555d03574a59d46f648d24.jpg","speciality":"Пользователь"},"statistics":{"commentsCount":2,"favoritesCount":26,"readingCount":3177,"score":18,"votesCount":18},"hubs":[{"relatedData":null,"id":"18840","alias":"julia","type":"collective","title":"Julia","titleHtml":"Julia","isProfiled":true},{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"21968","alias":"physics","type":"collective","title":"Физика","titleHtml":"Физика","isProfiled":false},{"relatedData":null,"id":"22022","alias":"astronomy","type":"collective","title":"Астрономия","titleHtml":"Астрономия","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EКогда речь заходит о теории относительности, частенько на ровном месте разрастаются споры, которые были занесены в почву непонимания и обильно удобрены мифами, недосказанностью и недостаточной математической подготовкой. Даже на лекциях от некоторых профессоров можно услышать, что детище гения Эйнштейна не имеет практической пользы, а на робкие попытки пролепетать что-то про спутниковые системы навигации они пренебрежительно отмахиваются, дескать, там все сложно и двояко. \u003C\u002Fp\u003E\u003Cp\u003EТак что совершенно естественно желание попробовать провести некоторые расчеты самолично, потрогать формулы, покрутить параметры, чтобы постепенно заложить интуицию в столь горячей теме.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa9f\u002Ff59\u002Fb65\u002Fa9ff59b65da6e8b1e6f59314aadb8e3d.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa9f\u002Ff59\u002Fb65\u002Fa9ff59b65da6e8b1e6f59314aadb8e3d.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"прецессия"},{"titleHtml":"меркурий"},{"titleHtml":"теория относительности"},{"titleHtml":"уравнения эйнштейна"},{"titleHtml":"метрики"},{"titleHtml":"спасибо scihub"},{"titleHtml":"спасибо mathpix"},{"titleHtml":"астрология_точная_наука"}]},"579772":{"id":"579772","timePublished":"2021-09-27T05:32:01+00:00","isCorporative":true,"lang":"ru","titleHtml":"Сливы процветают. Эксперт-«параноик» Майкл Баззель о защите личных данных","editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Michael Bazzell","originalUrl":"https:\u002F\u002Finteltechniques.com\u002Fblog\u002F2021\u002F07\u002F23\u002Fpersonal-ransomware-exposure\u002F"}}],"author":{"id":"2297567","alias":"SearchInform_team","fullname":null,"avatarUrl":"","speciality":"Пользователь"},"statistics":{"commentsCount":0,"favoritesCount":8,"readingCount":2428,"score":9,"votesCount":9},"hubs":[{"relatedData":null,"id":"22418","alias":"searchinform","type":"corporative","title":"Блог компании SearchInform","titleHtml":"Блог компании SearchInform","isProfiled":false},{"relatedData":null,"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EНаш очередной пост из серии «интересное на иностранном языке» – рассказ Майкла Баззеля о том, как сберечь свои персональные данные от утечек. Майкл – знаковая фигура в сфере OSINT, работал в правительстве США и ФБР, его приглашали в качестве технического эксперта в сериал «Мистер Робот», который считают достойным с точки зрения достоверности. В личной жизни эксперт придерживается настолько жестких правил в отношении информационной гигиены, что некоторые считают его «неадекватом». Так ли это – может быть несколько мнений. \u003C\u002Fp\u003E\u003Cp\u003EОдин из факторов, который убеждает в правильном подходе Майкла, – что риски обнаружить свои данные в интернете стали существенно выше, потому что шифровальщики без разбору сливают в сеть все, до чего дотягиваются при атаках на бизнес. Приводим перевод \u003Ca href=\"https:\u002F\u002Finteltechniques.com\u002Fblog\u002F2021\u002F07\u002F23\u002Fpersonal-ransomware-exposure\u002F\"\u003Eпоста Майкла Баззеля\u003C\u002Fa\u003E. \u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EАтакуют корпорации, а страдают люди\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003EБольшинство людей не задумываются о том, как их касается проблема распространения вирусов-шифровальщиков. Логика такова: речь идет о проблемах компаний, это они вынуждены платить выкуп. При чем тут, казалось бы, обычные люди?! \u003C\u002Fp\u003E\u003Cp\u003EА при том, что преступники сменили тактику: сейчас они не просто шифруют данные, но и скачивают их, выкладывают в открытый доступ, если компании не платят им выкуп. Теперь давайте подумаем, что в этих слитых базах? Множество данных о сотрудниках, клиентах, контрагентах, с которыми компания-жертва работает.\u003C\u002Fp\u003E\u003Cp\u003EХочу сразу уточнить: я это пишу не потому что выступаю за уплату выкупа. Я за то, чтобы сопротивляться избыточному сбору данных там, где это не обязательно. Мы халатно относимся к своим ПДн, раздавая их по первому требованию.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe3b\u002F3e1\u002F2c2\u002Fe3b3e12c2036d90018b804276e31ebea.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe3b\u002F3e1\u002F2c2\u002Fe3b3e12c2036d90018b804276e31ebea.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"персональные данные"},{"titleHtml":"пдн"},{"titleHtml":"сёрчинформ"},{"titleHtml":"Майкл Баззел"},{"titleHtml":"утечки информации"}]},"579854":{"id":"579854","timePublished":"2021-09-27T06:03:01+00:00","isCorporative":true,"lang":"ru","titleHtml":"Видишь уязвимости? А они есть! Наше исследование популярных CMS-систем","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2684283","alias":"Solar_Pentest","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":8,"favoritesCount":25,"readingCount":4066,"score":27,"votesCount":29},"hubs":[{"relatedData":null,"id":"20826","alias":"solarsecurity","type":"corporative","title":"Блог компании Ростелеком-Солар","titleHtml":"Блог компании Ростелеком-Солар","isProfiled":false},{"relatedData":null,"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true},{"relatedData":null,"id":"260","alias":"php","type":"collective","title":"PHP","titleHtml":"PHP","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЛьвиная доля всех работ по анализу защищенности внешнего периметра – это тестирование веб-приложений. Здесь могут быть как корпоративные решения, так и «домашние» разработки на базе различных публичных систем управления контентом (CMS). Мы всегда проводим глубокий анализ подобных решений на тестовых стендах и зачастую находим уязвимости нулевого дня. Собственно, из опыта таких проектов и родилась идея собрать исследовательскую команду и провести глубокий анализ популярных CMS-систем и различных плагинов для них. В этом посте мы поделимся результатами нашего исследования, а также продемонстрируем примеры уязвимого кода наиболее интересных, на наш взгляд, уязвимостей и примеры их эксплуатации. Конечно все эти уязвимости уже исправлены и описываются здесь с разрешения владельцев систем.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6df\u002F317\u002F4e6\u002F6df3174e60bbe263a70bcafdf9e51e6b.jpg","buttonTextHtml":"Не всё то в безопасности, что с Bug Bounty","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6df\u002F317\u002F4e6\u002F6df3174e60bbe263a70bcafdf9e51e6b.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"cms"},{"titleHtml":"уязвимости"},{"titleHtml":"уязвимости и их эксплуатация"},{"titleHtml":"уязвимость нулевого дня"}]},"580008":{"id":"580008","timePublished":"2021-09-27T06:30:02+00:00","isCorporative":false,"lang":"ru","titleHtml":"Летний Магнитогорск","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2614609","alias":"city_scraper","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F8f8\u002Fd6c\u002F328\u002F8f8d6c328ec3a513103b6757c2c21610.png","speciality":"Пользователь"},"statistics":{"commentsCount":6,"favoritesCount":3,"readingCount":3817,"score":14,"votesCount":20},"hubs":[{"relatedData":null,"id":"22012","alias":"Ecology","type":"collective","title":"Экология","titleHtml":"Экология","isProfiled":false},{"relatedData":null,"id":"22024","alias":"urban","type":"collective","title":"Урбанизм","titleHtml":"Урбанизм","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EМагнитогорск Челябинской области – один из крупнейших мировых центров чёрной металлургии. В России это шестой из крупнейших городов, которые не являются центрами субъектов страны. \u003C\u002Fp\u003E\u003Cp\u003EСовсем недавно город был одним из наиболее неблагополучных с точки зрения загрязнения атмосферного воздуха, но в 2021 году был зафиксирован «повышенный» уровень – то есть не «высокий» или «очень высокий», как раньше. \u003C\u002Fp\u003E\u003Cp\u003EКак этот город выглядит летом? Где и как его жители могут проводить время?\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F030\u002F0d1\u002Fcff\u002F0300d1cff2029948d33d803000331724.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F030\u002F0d1\u002Fcff\u002F0300d1cff2029948d33d803000331724.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Магнитогорск"},{"titleHtml":"промышленность"},{"titleHtml":"промышленные города"},{"titleHtml":"урбанизм\u002Fурбания"},{"titleHtml":"урбанистика"},{"titleHtml":"города России"},{"titleHtml":"города"}]},"580050":{"id":"580050","timePublished":"2021-09-27T10:23:25+00:00","isCorporative":false,"lang":"ru","titleHtml":"Один человек ответил на 85+ тысяч вопросов на Stack Overflow (24,1 ответа в день)","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"1585037","alias":"sahsAGU","fullname":"Александр Гуреев","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F43c\u002F6c7\u002F0ab\u002F43c6c70ab024d45474e6abe8db797573.jpg","speciality":"Автор"},"statistics":{"commentsCount":36,"favoritesCount":10,"readingCount":11132,"score":12,"votesCount":20},"hubs":[{"relatedData":null,"id":"260","alias":"php","type":"collective","title":"PHP","titleHtml":"PHP","isProfiled":true},{"relatedData":null,"id":"306","alias":"mysql","type":"collective","title":"MySQL","titleHtml":"MySQL","isProfiled":true},{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"594","alias":"sql","type":"collective","title":"SQL","titleHtml":"SQL","isProfiled":true},{"relatedData":null,"id":"7152","alias":"data_mining","type":"collective","title":"Data Mining","titleHtml":"Data Mining","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003E\u003Cstrong\u003EВ среднем 24,1 ответа в день (если все 365 дней в году считать рабочими) на протяжении почти 10 лет.\u003C\u002Fstrong\u003E \u003C\u002Fp\u003E\u003Cp\u003EНесколько дней назад на некоторых англоязычных ресурсах началось обсуждение одного очень необычного пользователя Stack Overflow. Его зовут Гордон Линофф (Gordon Linoff), он из Нью-Йорка, и за 9 лет и 8 месяцев своего присутствия на платформе он дал 85,201 ответов на различные вопросы, в основном связанные с SQL и дата-майнингом (цифра актуальна на 27.09.2021). \u003C\u002Fp\u003E\u003Cp\u003EЧто это за маг?\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F396\u002F5ac\u002Fef4\u002F3965acef48ae14917c514fa091f60d1a.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F396\u002F5ac\u002Fef4\u002F3965acef48ae14917c514fa091f60d1a.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"sql"},{"titleHtml":"mysql"},{"titleHtml":"stackoverflow"},{"titleHtml":"базы данных"},{"titleHtml":"дата майнинг"},{"titleHtml":"data mining"}]},"580060":{"id":"580060","timePublished":"2021-09-27T09:00:04+00:00","isCorporative":true,"lang":"ru","titleHtml":"Арракис, который мы заслужили","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"238277","alias":"Zelenyikot","fullname":"Виталий Егоров","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F22b\u002F2d7\u002F7a5\u002F22b2d77a57b687aae24784a3e53089c9.jpg","speciality":"Популяризатор космонавтики"},"statistics":{"commentsCount":112,"favoritesCount":40,"readingCount":22231,"score":133,"votesCount":145},"hubs":[{"relatedData":null,"id":"19791","alias":"ruvds","type":"corporative","title":"Блог компании RUVDS.com","titleHtml":"Блог компании RUVDS.com","isProfiled":false},{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"21962","alias":"space","type":"collective","title":"Космонавтика","titleHtml":"Космонавтика","isProfiled":false},{"relatedData":null,"id":"21984","alias":"sci-fi","type":"collective","title":"Научная фантастика","titleHtml":"Научная фантастика","isProfiled":false},{"relatedData":null,"id":"22014","alias":"futurenow","type":"collective","title":"Будущее здесь","titleHtml":"Будущее здесь","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F580060\u002F\"\u003E\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fk0\u002Fds\u002Fy5\u002Fk0dsy5npxclyjdytiroqga7-leu.jpeg\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fa\u003E\u003Cbr\u003E\r\nВо вселенной писателя-фантаста Фрэнка Герберта, Дюна, она же Арракис &mdash; это пустынная и маловодная планета с двумя лунами. По сюжету, она находится за пределами Солнечной системы, но если мы захотим поискать ближайшую схожую параллель,&nbsp;то больше всего подходит планета Марс. Предлагаю воспользоваться возможностями, которые даёт современная космонавтика, и совершить воображаемую прогулку на нашу Дюну.\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Марс"},{"titleHtml":"Дюна"},{"titleHtml":"MRO"},{"titleHtml":"Curiosity"},{"titleHtml":"марсоход"},{"titleHtml":"ruvds_статьи"}]},"580124":{"id":"580124","timePublished":"2021-09-27T13:03:14+00:00","isCorporative":true,"lang":"ru","titleHtml":"Электролюминесцентные индикаторы из прошлого","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"146371","alias":"radiolok","fullname":"Артем Кашканов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fa46\u002Fc6a\u002F151\u002Fa46c6a15193f7c0cac79d2736b107358.jpg","speciality":"Релейно-декатронный маньяк"},"statistics":{"commentsCount":13,"favoritesCount":37,"readingCount":5134,"score":74,"votesCount":74},"hubs":[{"relatedData":null,"id":"19791","alias":"ruvds","type":"corporative","title":"Блог компании RUVDS.com","titleHtml":"Блог компании RUVDS.com","isProfiled":false},{"relatedData":null,"id":"21484","alias":"electronics","type":"collective","title":"Производство и разработка электроники","titleHtml":"Производство и разработка электроники","isProfiled":true},{"relatedData":null,"id":"21906","alias":"history","type":"collective","title":"История IT","titleHtml":"История IT","isProfiled":false},{"relatedData":null,"id":"21930","alias":"antikvariat","type":"collective","title":"Старое железо","titleHtml":"Старое железо","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"Сегодня речь пойдёт об электролюминесцентных индикаторах. Но, не о тех, которые окружают вас повсюду и к которым вы привыкли, а о других — получивших огромную популярность в 60-е годы прошлого века, и так же стремительно канувших в небытие. Заодно запущу свою коллекцию индикаторов, как серийно выпускавшихся, так и уникальных опытных и даже — лабораторных образцов.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F523004\u002F\"\u003E\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F94e\u002F51f\u002F459\u002F94e51f459ae59c9d2fe6c448cb07bcca.gif\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fa\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Индикатор"},{"titleHtml":"электролюминесцентность"},{"titleHtml":"ruvds_статьи"}]},"580150":{"id":"580150","timePublished":"2021-09-27T10:50:03+00:00","isCorporative":true,"lang":"ru","titleHtml":"Топ-5 когнитивных искажений при планировании в IT","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2794469","alias":"KM_QA","fullname":null,"avatarUrl":"","speciality":""},"statistics":{"commentsCount":7,"favoritesCount":54,"readingCount":5968,"score":38,"votesCount":40},"hubs":[{"relatedData":null,"id":"14332","alias":"oleg-bunin","type":"corporative","title":"Блог компании Конференции Олега Бунина (Онтико)","titleHtml":"Блог компании Конференции Олега Бунина (Онтико)","isProfiled":false},{"relatedData":null,"id":"19583","alias":"dev_management","type":"collective","title":"Управление разработкой","titleHtml":"Управление разработкой","isProfiled":true},{"relatedData":null,"id":"20736","alias":"hr_management","type":"collective","title":"Управление персоналом","titleHtml":"Управление персоналом","isProfiled":true},{"relatedData":null,"id":"20754","alias":"tech_events","type":"collective","title":"Конференции","titleHtml":"Конференции","isProfiled":false},{"relatedData":null,"id":"21990","alias":"brain","type":"collective","title":"Мозг","titleHtml":"Мозг","isProfiled":false}],"flows":[{"id":"3","alias":"management","title":"Менеджмент"},{"id":"4","alias":"marketing","title":"Маркетинг"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЭта статья подходит для тимлидов и их подопечных, а также для всех, кто оценивает проекты и задачи. Я расскажу, как и почему мы делаем ошибки из-за когнитивных искажений. Попадаем в них мы почти все, просто потому что мы живые люди. И на примере одного дня из жизни тимлида я хочу показать, в какие искажения чаще всего влетают в IT, и&nbsp; — самое полезное&nbsp; —&nbsp; как из них можно выходить.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EЗамечу, что искать когнитивные искажения стоит, в первую очередь, у себя, а не у коллег. \u003C\u002Fstrong\u003EИ что рассказывать про искажения намного проще, чем не влетать в их на практике, однако, если этому научиться, то в перспективе это изрядно окупается, потому что экономит и время, и деньги, помогая и нам, и команде.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb78\u002F76f\u002F001\u002Fb7876f0010e85c328462a735df0b76e8.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb78\u002F76f\u002F001\u002Fb7876f0010e85c328462a735df0b76e8.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"когнитивные искажения"},{"titleHtml":"нейрофизиология"},{"titleHtml":"мозг"},{"titleHtml":"психология"},{"titleHtml":"тимлидство"},{"titleHtml":"тимлид"},{"titleHtml":"управление людьми"},{"titleHtml":"управление проектами и командой"},{"titleHtml":"управление командой"},{"titleHtml":"управление персоналом"}]},"580164":{"id":"580164","timePublished":"2021-09-27T11:17:58+00:00","isCorporative":true,"lang":"ru","titleHtml":"Измеряем производительность String.format() в Java","editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"@cowtowncoder","originalUrl":"https:\u002F\u002Fcowtowncoder.medium.com\u002Fmeasuring-performance-of-java-string-format-or-lack-thereof-2e1c6a13362c"}}],"author":{"id":"2571061","alias":"GolovinDS","fullname":"Дмитрий Головин","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd27\u002Fccd\u002F743\u002Fd27ccd743d8bccbf1a885e5dadaa7ffe.jpg","speciality":"Контент-маркетолог"},"statistics":{"commentsCount":0,"favoritesCount":16,"readingCount":1732,"score":9,"votesCount":11},"hubs":[{"relatedData":null,"id":"21052","alias":"otus","type":"corporative","title":"Блог компании OTUS","titleHtml":"Блог компании OTUS","isProfiled":false},{"relatedData":null,"id":"4","alias":"hi","type":"collective","title":"Высокая производительность","titleHtml":"Высокая производительность","isProfiled":true},{"relatedData":null,"id":"375","alias":"java","type":"collective","title":"Java","titleHtml":"Java","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЯ раньше считал, что JDK в целом хорошо оптимизирована, и если в JDK есть простой способ решения какой-то задачи, то он вполне подойдет для большинства ситуаций и будет работать хорошо.\u003C\u002Fp\u003E\u003Cp\u003EНо я обнаружил, что иногда некоторые классы или методы работают на удивление плохо. Знание таких аномалий полезно при работе с требовательным к производительности кодом.\u003C\u002Fp\u003E\u003Cp\u003EВ этом посте рассмотрим один из подобных кейсов: поразительно низкая производительность \u003Ccode\u003EString.format()\u003C\u002Fcode\u003E при простой конкатенации строк.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fed4\u002F612\u002F7ef\u002Fed46127ef6d1b8f8d650482dfd335220.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fed4\u002F612\u002F7ef\u002Fed46127ef6d1b8f8d650482dfd335220.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"java"},{"titleHtml":"performance"},{"titleHtml":"jdk"}]},"580166":{"id":"580166","timePublished":"2021-09-27T11:22:03+00:00","isCorporative":false,"lang":"ru","titleHtml":"Новости из жизни Haiku за август-сентябрь 2021","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"375413","alias":"petr97","fullname":"Ахламов Петр","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fadf\u002F830\u002F79c\u002Fadf83079c33fd56935b929935559572a.jpg","speciality":"Пользователь"},"statistics":{"commentsCount":2,"favoritesCount":3,"readingCount":1754,"score":8,"votesCount":8},"hubs":[{"relatedData":null,"id":"144","alias":"open_source","type":"collective","title":"Open source","titleHtml":"Open source","isProfiled":true},{"relatedData":null,"id":"559","alias":"cpp","type":"collective","title":"C++","titleHtml":"C++","isProfiled":true},{"relatedData":null,"id":"7330","alias":"qt_software","type":"collective","title":"Qt","titleHtml":"Qt","isProfiled":true},{"relatedData":null,"id":"21918","alias":"soft","type":"collective","title":"Софт","titleHtml":"Софт","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЗдравствуйте, дорогие друзья. Продолжаю Вас знакомить на Хабре с новостями проекта Haiku.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F877\u002Fa0f\u002Fc9c\u002F877a0fc9c92663d8cd2acc965493dacc.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F877\u002Fa0f\u002Fc9c\u002F877a0fc9c92663d8cd2acc965493dacc.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"Haiku"},{"titleHtml":"Intel"},{"titleHtml":"VESA"},{"titleHtml":"RISC-V"},{"titleHtml":"Веб-камера"},{"titleHtml":"Превью"},{"titleHtml":"Куба"},{"titleHtml":"Wine"},{"titleHtml":"Менеджер окон"}]},"580172":{"id":"580172","timePublished":"2021-09-27T11:45:49+00:00","isCorporative":true,"lang":"ru","titleHtml":"Небинарный ngIf*","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"1050218","alias":"Waterplea","fullname":"Александр Инкин","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fa70\u002F569\u002Ff31\u002Fa70569f31346559ce2b8b875e7f97480.jpg","speciality":"Google Developer Expert | Angular"},"statistics":{"commentsCount":1,"favoritesCount":13,"readingCount":937,"score":15,"votesCount":15},"hubs":[{"relatedData":null,"id":"17420","alias":"tinkoff","type":"corporative","title":"Блог компании TINKOFF","titleHtml":"Блог компании TINKOFF","isProfiled":false},{"relatedData":null,"id":"91","alias":"webdev","type":"collective","title":"Разработка веб-сайтов","titleHtml":"Разработка веб-сайтов","isProfiled":true},{"relatedData":null,"id":"18109","alias":"angular","type":"collective","title":"Angular","titleHtml":"Angular","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EВам когда-нибудь хотелось отобразить состояние загрузки, пока \u003Ccode\u003EngIf\u003C\u002Fcode\u003E ждет ответа от \u003Ccode\u003Easync\u003C\u002Fcode\u003E-пайпа? Или, может, вы мечтали передать в \u003Ccode\u003EngFor\u003C\u002Fcode\u003E шаблон для пустого массива? Возможно, вы бросили это, потому что вам не хотелось реализовывать базовую логику этих директив самому. На самом деле в этом нет нужды! Один и тот же селектор может подцепить несколько директив, что позволяет расширить функциональность встроенных директив дополнительной логикой.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F846\u002F786\u002F3e2\u002F8467863e2df65db32cb31f4b16c822ef.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F846\u002F786\u002F3e2\u002F8467863e2df65db32cb31f4b16c822ef.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"template"},{"titleHtml":"directive"},{"titleHtml":"angular"},{"titleHtml":"structural"}]},"580194":{"id":"580194","timePublished":"2021-09-27T12:36:12+00:00","isCorporative":true,"lang":"ru","titleHtml":"Сотрудники на карте: отвечаем на 10 важных вопросов о трекинге","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"1254716","alias":"Axelus","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F118\u002Fc4f\u002F08f\u002F118c4f08ffa66438ad6be22e205d563d.png","speciality":"Разработчик"},"statistics":{"commentsCount":0,"favoritesCount":7,"readingCount":1087,"score":13,"votesCount":15},"hubs":[{"relatedData":null,"id":"20758","alias":"regionsoft","type":"corporative","title":"Блог компании RegionSoft","titleHtml":"Блог компании RegionSoft","isProfiled":false},{"relatedData":null,"id":"6398","alias":"it-infrastructure","type":"collective","title":"IT-инфраструктура","titleHtml":"IT-инфраструктура","isProfiled":true},{"relatedData":null,"id":"12365","alias":"saas","type":"collective","title":"SaaS \u002F S+S","titleHtml":"SaaS \u002F S+S","isProfiled":true},{"relatedData":null,"id":"17783","alias":"geo","type":"collective","title":"Геоинформационные сервисы","titleHtml":"Геоинформационные сервисы","isProfiled":true},{"relatedData":null,"id":"20736","alias":"hr_management","type":"collective","title":"Управление персоналом","titleHtml":"Управление персоналом","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"3","alias":"management","title":"Менеджмент"},{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EЛюбой контроль сотрудников — опасный и болезненный вопрос, особенно в небольших компаниях. Часто в дружеские и открытые отношения компании не вписывается ни одна из форм контроля, рассчитывать можно только на доверие. Но пресловутый ковид и здесь внёс свои коррективы: расширение удалённой работы, увеличение штата мобильных сотрудников, частичная занятость пополнили ряды полевых сисадминов, аутсорсеров поддержки и остальных «разъездных» работников. Увы, люди разные и вслед за приятными плодами и бонусами удалёнки пришли негативные истории про поведение курьеров, опоздания и откровенные нарушения сотрудников на территории клиентов, неявки на работу или к заказчику и т.д. С этим столкнулись и ритейл, и ИТ, и любая сфера с мобильными сотрудниками. Очень хочется верить в лучшее, но без минимального контроля можно просто потерять бизнес — и тогда пострадают коллеги нерадивых сотрудников.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe4a\u002F5b9\u002Fa9d\u002Fe4a5b9a9d62c342fa897f4531ec9301b.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe4a\u002F5b9\u002Fa9d\u002Fe4a5b9a9d62c342fa897f4531ec9301b.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"geomonitor"},{"titleHtml":"геолокация"},{"titleHtml":"геозона"},{"titleHtml":"трекинг"}]},"580196":{"id":"580196","timePublished":"2021-09-27T12:28:15+00:00","isCorporative":true,"lang":"ru","titleHtml":"Зачем нужен динамический анализ кода, на примере проекта PVS-Studio","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"2302295","alias":"MrROBUST","fullname":"Алексей Говоров","avatarUrl":"","speciality":"Пользователь"},"statistics":{"commentsCount":0,"favoritesCount":3,"readingCount":703,"score":9,"votesCount":9},"hubs":[{"relatedData":null,"id":"18095","alias":"pvs-studio","type":"corporative","title":"Блог компании PVS-Studio","titleHtml":"Блог компании PVS-Studio","isProfiled":false},{"relatedData":null,"id":"559","alias":"cpp","type":"collective","title":"C++","titleHtml":"C++","isProfiled":true},{"relatedData":null,"id":"11606","alias":"vs","type":"collective","title":"Visual Studio","titleHtml":"Visual Studio","isProfiled":true},{"relatedData":null,"id":"21456","alias":"win_dev","type":"collective","title":"Разработка под Windows","titleHtml":"Разработка под Windows","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EВ разговоре с Маршаллом Клоу на подкасте CppCast #300 ABI Stability была затронута достаточно давняя новость о поддержке компиляторами Visual Studio инструмента AddressSanitizer (ASan). Мы уже достаточно давно внедрили ASan в свою систему тестирования и хотим рассказать о паре интересных ошибок, которые он помог найти.\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F7ef\u002F2db\u002F210\u002F7ef2db210d677f9a8c07026d4361d3ba.png\" alt=\"0868_PVS-Studio_ASan_ru\u002Fimage2.png\"\u003E\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"pvs-studio"},{"titleHtml":"clang"},{"titleHtml":"asan"},{"titleHtml":"sanitizer"},{"titleHtml":"динамический анализ кода"}]},"580204":{"id":"580204","timePublished":"2021-09-27T12:31:54+00:00","isCorporative":false,"lang":"ru","titleHtml":"Почему using namespace std; это плохо","editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"sbi, Greg Hewgill","originalUrl":"https:\u002F\u002Fstackoverflow.com\u002Fquestions\u002F1452721\u002Fwhy-is-using-namespace-std-considered-bad-practice"}}],"author":{"id":"936030","alias":"F0iL","fullname":"K. just K.","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fbcd\u002F9c7\u002F270\u002Fbcd9c7270c0727e164ac404a7f929971.jpg","speciality":"Разработчик"},"statistics":{"commentsCount":12,"favoritesCount":12,"readingCount":4785,"score":16,"votesCount":24},"hubs":[{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"524","alias":"complete_code","type":"collective","title":"Совершенный код","titleHtml":"Совершенный код","isProfiled":true},{"relatedData":null,"id":"559","alias":"cpp","type":"collective","title":"C++","titleHtml":"C++","isProfiled":true},{"relatedData":null,"id":"17188","alias":"compilers","type":"collective","title":"Компиляторы","titleHtml":"Компиляторы","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EТо, что написано ниже, для многих квалифицированных C++ разработчиков будет прекрасно известной и очевидной вещью, но тем не менее, я периодически встречаю using namespace std; в коде различных проектов, а недавно в \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F579998\" rel=\"noopener noreferrer nofollow\"\u003Eнашумевшей статье про впечатления от высшего образования\u003C\u002Fa\u003E было упомянуто, что студентов так учат писать код в вузах, поэтому давайте повторим очевидное еще раз.\u003C\u002Fp\u003E\u003Cp\u003EИтак... многие слышали, что \u003Cstrong\u003Eusing namespace std;\u003C\u002Fstrong\u003E в C++ считается плохой практикой. Касательно недопустимости использования using namespace в header-файлах вопросов обычно не возникает, если мы хоть немного понимаем, как работает препроцессор компилятора: .hpp-файлы при использовании директивы #include вставляются в код \"как есть\", и соответственно using автоматически распространится на все затронутые  .hpp- и .cpp-файлы, если файл с ним был заинклюден хоть в одном звене цепочки (на одном из сайтов это метко обозвали как \"заболевание, передающеемя половым путем\"). Но вот про .cpp-файлы все не так очевидно, так что давайте еще раз разберем, что же именно здесь не так.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F662\u002F8a9\u002Fe33\u002F6628a9e3322ab1dbca4e4976098da83d.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F662\u002F8a9\u002Fe33\u002F6628a9e3322ab1dbca4e4976098da83d.jpg","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"с++"},{"titleHtml":"namespace"},{"titleHtml":"namespaces"},{"titleHtml":"best practices"},{"titleHtml":"антипаттерны"}]},"580206":{"id":"580206","timePublished":"2021-09-27T12:51:03+00:00","isCorporative":false,"lang":"ru","titleHtml":"МТС отказался от скрытых мобильных подписок?","editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"2467147","alias":"Plusodin","fullname":"Владимир","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F343\u002Fb77\u002Fd12\u002F343b77d12f047368849a9880276f936e.jpg","speciality":"Пользователь"},"statistics":{"commentsCount":11,"favoritesCount":4,"readingCount":5108,"score":14,"votesCount":14},"hubs":[{"relatedData":null,"id":"22008","alias":"cellular","type":"collective","title":"Сотовая связь","titleHtml":"Сотовая связь","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EПривет, Хабр!\u003C\u002Fp\u003E\u003Cp\u003EНу что, подходит к концу первый сезон сериала «О скрытых мобильных подписках и операторах связи». Предыдущие три серии: \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F550448\u002F\" rel=\"noopener noreferrer nofollow\"\u003EМегафон\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F563260\u002F\" rel=\"noopener noreferrer nofollow\"\u003EБилайн\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F571256\u002F\" rel=\"noopener noreferrer nofollow\"\u003ETele2\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cp\u003EНу и вишенка на этом торте – МТС.\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"мтс"},{"titleHtml":"мобильные подписки"},{"titleHtml":"подписки"},{"titleHtml":"оператор связи"},{"titleHtml":"теле2"},{"titleHtml":"мегафон"},{"titleHtml":"билайн"}]},"580208":{"id":"580208","timePublished":"2021-09-27T12:52:27+00:00","isCorporative":false,"lang":"ru","titleHtml":"Основная проблема образования","editorVersion":"2.0","postType":"article","postLabels":[{"type":"recovery","data":null}],"author":{"id":"2270142","alias":"Chronicler","fullname":"Пушиз де Хрониклер","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Faa3\u002F149\u002Fdb0\u002Faa3149db0de5f6c071dfade7285fcb99.jpg","speciality":"Исследователь ближнего заполярья, почетный манул"},"statistics":{"commentsCount":17,"favoritesCount":15,"readingCount":2515,"score":8,"votesCount":20},"hubs":[{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"17189","alias":"itstandarts","type":"collective","title":"IT-стандарты","titleHtml":"IT-стандарты","isProfiled":true},{"relatedData":null,"id":"20682","alias":"pm","type":"collective","title":"Управление проектами","titleHtml":"Управление проектами","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"3","alias":"management","title":"Менеджмент"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EНа днях на Хабре появилась \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F579998\u002F\" rel=\"noopener noreferrer nofollow\"\u003Eкритическая статья\u003C\u002Fa\u003E о бакалавриате, что называется \"из первых уст\", от очередного первохода. Статья далеко не лишена смысла, однако главная проблема не была в ней затронута. А заключается она вовсе не в обилии посторонних дисциплин и даже не в том, что в учебных заведениях так мало разъясняют суровую конкретику жизни \"научиться штамповать JavaScript сайты за месяц\".  Да, эти проблемы присутствуют, наряду с плохой подготовкой педагогов и отношением к студентам, но не они на корню обесценивают нынешнее образование.\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Что же на самом деле не так?","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"программирование"},{"titleHtml":"образование"},{"titleHtml":"курсы не нужны"},{"titleHtml":"вуз"}]},"580210":{"id":"580210","timePublished":"2021-09-27T12:53:02+00:00","isCorporative":false,"lang":"ru","titleHtml":"PHP Дайджест № 212 (13 – 27 сентября 2021)","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"100489","alias":"pronskiy","fullname":"Роман Пронский","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F27f\u002Fb99\u002Feb3\u002F27fb99eb3e30e3221c5839e88be02395.jpg","speciality":"PHP"},"statistics":{"commentsCount":1,"favoritesCount":14,"readingCount":3636,"score":41,"votesCount":41},"hubs":[{"relatedData":null,"id":"91","alias":"webdev","type":"collective","title":"Разработка веб-сайтов","titleHtml":"Разработка веб-сайтов","isProfiled":true},{"relatedData":null,"id":"260","alias":"php","type":"collective","title":"PHP","titleHtml":"PHP","isProfiled":true},{"relatedData":null,"id":"477","alias":"symfony","type":"collective","title":"Symfony","titleHtml":"Symfony","isProfiled":true},{"relatedData":null,"id":"9554","alias":"yii","type":"collective","title":"Yii","titleHtml":"Yii","isProfiled":true},{"relatedData":null,"id":"18812","alias":"laravel","type":"collective","title":"Laravel","titleHtml":"Laravel","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fek\u002F6r\u002Fr1\u002Fek6rr1odvyzb89tfv0lq4cmfxi4.jpeg\"\u003E\u003C\u002Fdiv\u003E\u003Cbr\u003E\r\nПодборка свежих новостей и материалов из мира PHP.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nВышел PHP 8.1 RC2 и уже доступен первый пакет с использованием перечислений, будет сделан форк Magento, новый тип стандартов PER в дополнение к PSR, стартовала PhpStorm 2021.3 EAP, Symfony 6 будет полностью типизирован — как обновляться?\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nДля PHP 8.2 предложены новые оптимизированные структуры данных.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nТакже в выпуске порция инструментов, полезные статьи, видео и анонсы двух митапов.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nПриятного чтения!\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"дайджест"},{"titleHtml":"php-дайджест"},{"titleHtml":"PHP"},{"titleHtml":"Symfony"},{"titleHtml":"Laravel"},{"titleHtml":"Magento"},{"titleHtml":"PHPUnit"},{"titleHtml":"PHP 8.1"},{"titleHtml":"PHP 8.2"}]},"580228":{"id":"580228","timePublished":"2021-09-27T16:41:21+00:00","isCorporative":true,"lang":"ru","titleHtml":"Идеальная светодиодная лампа за 21 рубль","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"108988","alias":"AlexeyNadezhin","fullname":"Алексей Надежин","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Ffdc\u002F3ac\u002F9a2\u002Ffdc3ac9a2dc0107cc956f1bd0cf5fc2b.jpg","speciality":"Блогер"},"statistics":{"commentsCount":29,"favoritesCount":44,"readingCount":10555,"score":76,"votesCount":80},"hubs":[{"relatedData":null,"id":"21646","alias":"lamptest","type":"corporative","title":"Блог компании LampTest","titleHtml":"Блог компании LampTest","isProfiled":false},{"relatedData":null,"id":"21894","alias":"gadgets","type":"collective","title":"Гаджеты","titleHtml":"Гаджеты","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"Удивительно осознавать, что достаточно сложное электронное устройство, которым является светодиодная лампочка, может стоить 21 рубль. \u003Cbr\u003E\r\n\u003Cbr\u003E\r\nЕщё сложнее поверить, что эта лампочка безукоризненна по всем параметрам.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F20f\u002F849\u002Ffcd\u002F20f849fcd6a3891f506676fc87223bdf.jpg\"\u003E\u003C\u002Fdiv\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"led"},{"titleHtml":"светодиодные лампы"},{"titleHtml":"тест"}]},"580304":{"id":"580304","timePublished":"2021-09-27T18:31:25+00:00","isCorporative":true,"lang":"ru","titleHtml":"Как сделать 248MP фотографию Солнца","editorVersion":"1.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Simon Tang","originalUrl":"https:\u002F\u002Fpetapixel.com\u002F2021\u002F09\u002F15\u002Fa-closer-look-how-i-created-a-248mp-photo-of-the-sun\u002F"}}],"author":{"id":"2192534","alias":"Itelma","fullname":"T-800","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fc3a\u002Fd1e\u002F43d\u002Fc3ad1e43d500046c3228c9494b510912.jpg","speciality":"Пользователь"},"statistics":{"commentsCount":4,"favoritesCount":4,"readingCount":1404,"score":13,"votesCount":13},"hubs":[{"relatedData":null,"id":"22356","alias":"itelma","type":"corporative","title":"Блог компании НПП ИТЭЛМА","titleHtml":"Блог компании НПП ИТЭЛМА","isProfiled":false},{"relatedData":null,"id":"17175","alias":"image_processing","type":"collective","title":"Обработка изображений","titleHtml":"Обработка изображений","isProfiled":true},{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"21932","alias":"photo","type":"collective","title":"Фототехника","titleHtml":"Фототехника","isProfiled":false},{"relatedData":null,"id":"22022","alias":"astronomy","type":"collective","title":"Астрономия","titleHtml":"Астрономия","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"leadData":{"textHtml":"\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fe02\u002F643\u002Fa55\u002Fe02643a550e20aa10c366e20956e4b40.jpg\" alt=\"image\"\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Ci\u003EЭто изображение диска нашего Солнца создано с помощью большого рефракторного (линзового) телескопа и высокоскоростной монохромной CMOS-камеры.\u003C\u002Fi\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nКаждый день над нашими головами висит большой шар света. Он там всегда, и никто не обращает на него внимания. Разумеется, мы не советуем вам долго смотреть на него и при этом ослепнуть, тем не менее, наука дала нам возможность смотреть прямо на солнце совершенно безопасно.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nПоскольку техника стала более доступной, обычный человек может заглянуть в многочисленные слои Солнца с помощью специального оборудования, которое может купить в любом хорошем магазине телескопов.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nВ этой статье мы подробно рассмотрим слой, известный как хромосфера: область Солнца, видимая в оранжево-красном спектре. При помощи специального фильтра это устройство блокирует весь нежелательный свет, пропуская при этом определенный диапазон частот, который нас интересует.\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"обработка изображений"},{"titleHtml":"фототехника"}]},"580326":{"id":"580326","timePublished":"2021-09-27T22:44:08+00:00","isCorporative":false,"lang":"ru","titleHtml":"Почему инженеры презирают Agile","editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Stefan Wolpers","originalUrl":"https:\u002F\u002Fage-of-product.com\u002Fengineers-despise-agile\u002F"}}],"author":{"id":"2015227","alias":"kantocoder","fullname":null,"avatarUrl":"","speciality":"C++"},"statistics":{"commentsCount":20,"favoritesCount":3,"readingCount":1191,"score":9,"votesCount":15},"hubs":[{"relatedData":null,"id":"19583","alias":"dev_management","type":"collective","title":"Управление разработкой","titleHtml":"Управление разработкой","isProfiled":true},{"relatedData":null,"id":"20692","alias":"agile","type":"collective","title":"Agile","titleHtml":"Agile","isProfiled":true}],"flows":[{"id":"3","alias":"management","title":"Менеджмент"}],"relatedData":null,"leadData":{"textHtml":"\u003Cp\u003EМы продолжаем цикл публикаций о недостатках Аgile методологии.  Сегодня перевод статьи о том, почему инженеры презирают Agile (много новых удивительных наблюдений!)\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F34a\u002Ffbe\u002F0e8\u002F34afbe0e8166313ff883d59e59da0785.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F34a\u002Ffbe\u002F0e8\u002F34afbe0e8166313ff883d59e59da0785.png","fit":"cover","positionY":0,"positionX":0}},"status":"published","plannedPublishTime":null,"checked":null,"tags":[{"titleHtml":"agile development"},{"titleHtml":"микроменеджмент"},{"titleHtml":"agile"}]}},"articlesIds":{"ARTICLES_LIST_TOP_PERIOD_DAILY":["580060","580228","580124","580210","580150","579854","572164","580204","580172","580008","580206","580304","580194","580050","580326","580196","580164","579772","580208","580166"]},"isLoading":false,"pagesCount":{"ARTICLES_LIST_TOP_PERIOD_DAILY":3},"route":{"name":"ARTICLES_LIST_TOP_PERIOD","params":{"period":"daily"},"query":{}},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":["119128","116870","83196"],"similarListRefs":{"83196":{"id":"83196","timePublished":"2010-02-05T08:46:35+00:00","isCorporative":false,"lang":"ru","titleHtml":"Создание ASP.NET AJAX контрола с возможностью обмена данными с сервером","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"54164","alias":"glamcoder","fullname":"Георгий Могелашвили","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F659\u002Fe48\u002F4ff\u002F659e484ff4a8ef3e544f127de30b69b3.jpg","speciality":"People manager"},"statistics":{"commentsCount":2,"favoritesCount":6,"readingCount":4504,"score":10,"votesCount":16},"hubs":[{"id":"546","alias":"net","type":"collective","title":".NET","titleHtml":".NET","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":null,"leadData":{"textHtml":"Здравствуй, Хабр!\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nХочу поделиться своим опытом решения проблемы, ответа на которую я трудно найти в Интернете (русскоязычном — уж точно).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСтолкнулся я недавно с тем, что мне было поручено написать ASP.NET AJAX контрол серверной стороны. Это такой контрол, который доступен при редактировании страницы ASP.NET в дизайнере (toolbox), часть логики его находится на сервере, а часть на клиенте, взаимодействие происходит аяксово. Суть работы моего контрола — простой ComboBox, который получал бы данные \u003Cu\u003Eдинамически\u003C\u002Fu\u003E с сервера (предполагается, что данных так много, что загрузить их все разом нельзя), а также фильтровал бы список на основании введенных в текстовое поле символов. Это почти реализовано в AJAX Control Toolkit, только список там грузится целиком. \u003Cbr\u002F\u003E\r\nВ интернете довольно много различных статей и блогов по теме создания своих контролов, однако, как ни странно, все они ограничиваются простенькими примерами, в которых напрочь отсутствует описание механизма взаимодействия клиента и сервера. Большинство источников приводит цитаты из стандартных микрософтовских учебников, где аякс заключается в том, что при наведении мышки на кнопку та меняет свою картинку (дет. сад). Мне же надо было, чтобы в список на клиенте подтягивались данные из списка, который хранился на сервере (это может быть просто список, какой-либо ORM и вообще все, что бывает IEnumerable).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСразу хочу сказать, что здесь Вы не найдете мануала по созданию собственного контрола с нуля, благо по этой части документации \u003Ca title=\"ASP.NET AJAX Control\" href=\"http:\u002F\u002Ftinyurl.com\u002FASP-NET-AJAX-development\"\u003Eхватает\u003C\u002Fa\u003E. Я же опишу, как сделать так, чтобы клиентская часть и ее серверная половинка могли свободно обмениваться информацией в асинхронном режиме.\u003Cbr\u002F\u003E\r\n","imageUrl":null,"buttonTextHtml":"читать далее","image":null},"status":"published","plannedPublishTime":null,"checked":null},"116870":{"id":"116870","timePublished":"2011-04-05T08:50:03+00:00","isCorporative":true,"lang":"ru","titleHtml":"Выпущена новая версия ASP.NET AJAX Control Toolkit","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"35477","alias":"XaocCPS","fullname":"Владимир Юнев","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F6a0\u002Fc9d\u002Fbab\u002F6a0c9dbabacebb48f9984fdc854c9dd4.jpg","speciality":"Chief Architect"},"statistics":{"commentsCount":6,"favoritesCount":7,"readingCount":3555,"score":9,"votesCount":37},"hubs":[{"id":"5058","alias":"microsoft","type":"corporative","title":"Блог компании Microsoft","titleHtml":"Блог компании Microsoft","isProfiled":false}],"flows":[],"relatedData":null,"leadData":{"textHtml":"\u003Cimg title=\"image\" alt=\"image\" src=\"http:\u002F\u002Fmicrogeek.ru\u002Fupload\u002Fblog\u002Faspnet\u002F7d9\u002F7d974843449f1ca90e532ea48a848a35.png\" width=\"578\" height=\"104\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа официальной странице проекта AJAX Control Toolkit представлена новая версия этого набора элементов управления. AJAX Control Toolkit является проектом с открытым исходным кодом, который предлагает разработчикам ASP.NET десятки серверных элементов управления работающих с ajax-запросами.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ новой апрельской версии AJAX Control Toolkit (Version 50401) произведены следующие изменения:\u003Cul\u003E\r\n\u003Cli\u003Eисправлены ошибки и улучшена совместимость элементов управления с Internet Explorer 9; \u003C\u002Fli\u003E\r\n\u003Cli\u003Eрасширения RoundedCorners и DropShadow теперь используют преимущества браузеров, которые поддерживают соответствующие свойства CSS3 по оформлению закруглений и отбрасыванию тени у элементов веб-страницы; \u003C\u002Fli\u003E\r\n\u003Cli\u003Eдобавлен новый проект тестов jQuery для лучшего покрытия тестами элементов управления AJAX Control Toolkit. \u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003EЗагрузить бинарные компоненты для ASP.NET 3.5\u002F4.0 и исходные коды AJAX Control Toolkit можно по \u003Ca href=\"http:\u002F\u002Fajaxcontroltoolkit.codeplex.com\u002Freleases\u002Fview\u002F63654\"\u003Eследующей ссылке\u003C\u002Fa\u003E.","imageUrl":null,"buttonTextHtml":null,"image":null},"status":"published","plannedPublishTime":null,"checked":null},"119128":{"id":"119128","timePublished":"2011-05-12T06:41:32+00:00","isCorporative":true,"lang":"ru","titleHtml":"Очередное обновление ASP.NET AJAX Control Toolkit","editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"35477","alias":"XaocCPS","fullname":"Владимир Юнев","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F6a0\u002Fc9d\u002Fbab\u002F6a0c9dbabacebb48f9984fdc854c9dd4.jpg","speciality":"Chief Architect"},"statistics":{"commentsCount":5,"favoritesCount":3,"readingCount":3585,"score":9,"votesCount":31},"hubs":[{"id":"5058","alias":"microsoft","type":"corporative","title":"Блог компании Microsoft","titleHtml":"Блог компании Microsoft","isProfiled":false}],"flows":[],"relatedData":null,"leadData":{"textHtml":"\u003Cimg title=\"image\" alt=\"image\" src=\"http:\u002F\u002Fmicrogeek.ru\u002Fupload\u002Fblog\u002Faspnet\u002F7d9\u002F7d974843449f1ca90e532ea48a848a35.png\" width=\"578\" height=\"104\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа официальной странице проекта AJAX Control Toolkit представлена новая версия этого набора элементов управления. AJAX Control Toolkit является проектом с открытым исходным кодом, который предлагает разработчикам ASP.NET десятки серверных элементов управления работающих с ajax-запросами.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ новой майской версии AJAX Control Toolkit (Version 50508) произведены следующие изменения:\u003Cul\u003E\r\n\u003Cli\u003Eулучшена работа элемента управления ModalPopup, добавлена поддержка анимаций; \u003C\u002Fli\u003E\r\n\u003Cli\u003Eулучшена работа элемента управления AsyncFileUpload, добавлена поддержка HTML5, исправлена некорректная работа в Firefox 4; \u003C\u002Fli\u003E\r\n\u003Cli\u003Eулучшена работа элемента управления DropShadow, добавлены модульные тесты, исправлена ошибка при совместной работе с UpdatePanel. \u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003EЗагрузить бинарные компоненты для ASP.NET 3.5\u002F4.0 и исходные коды AJAX Control Toolkit можно по \u003Ca href=\"http:\u002F\u002Fajaxcontroltoolkit.codeplex.com\u002Freleases\u002Fview\u002F65800\"\u003Eследующей ссылке\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПодробное описание нововведений можно получить в \u003Ca href=\"http:\u002F\u002Fstephenwalther.com\u002Fblog\u002Farchive\u002F2011\u002F05\u002F09\u002Fmay-2011-release-of-the-ajax-control-toolkit.aspx\"\u003Eэтой статье\u003C\u002Fa\u003E.","imageUrl":null,"buttonTextHtml":null,"image":null},"status":"published","plannedPublishTime":null,"checked":null}}},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{"cromathaar":{"scoreStats":{"score":43,"votesCount":68},"rating":0,"relatedData":null,"contacts":[{"title":"ВКонтакте","url":"https:\u002F\u002Fvk.com\u002Fcromathaar","value":"cromathaar"}],"authorContacts":[{"title":"ВКонтакте","url":"https:\u002F\u002Fvk.com\u002Fcromathaar","value":"cromathaar"}],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"53875","alias":"Cromathaar","fullname":"Сергей Прокопенко","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F392\u002Fa18\u002F2cb\u002F392a182cb77f8a238b4b40cd64e3a860.png","speciality":"Пользователь"}},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.670ab961.js" defer></script><script src="https://assets.habr.com/habr-web/js/chunk-f458c7c4.6e221df6.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.76acc47b.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
